
&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
	
	Организация = Параметры.Организация;
	Период.ДатаНачала = Параметры.ДатаНачала;
	Период.ДатаОкончания = Параметры.ДатаОкончания;
	
КонецПроцедуры

&НаКлиенте
Процедура СравнитьОСВПоГрупповымСчетам(Команда)
	
	Если ОрганизацияЗаполнена() И ПериодЗаполнен() Тогда
		ВладелецФормы.ОткрытьОтчетОСВПоГруппамБезСубконто(Организация, Период.ДатаНачала, Период.ДатаОкончания);
	КонецЕсли;
	
КонецПроцедуры

&НаКлиенте
Процедура СравнитьОСВПоВсемСчетам(Команда)
	
	Если ОрганизацияЗаполнена() И ПериодЗаполнен() Тогда	
		ВладелецФормы.ОткрытьОтчетОСВПоВсемСчетамБезСубконто(Организация, Период.ДатаНачала, Период.ДатаОкончания);
	КонецЕсли;
	
КонецПроцедуры

&НаКлиенте
Процедура СравнитьОСВПоОдномуСчету(Команда)
	
	Если ОрганизацияЗаполнена() И ПериодЗаполнен() И СчетЗаполнен() Тогда	
		
		// Отчет из 7.7 может не получиться открыть, если в 7.7 не рассчитаны итоги.
		УдалосьОткрытьОтчет77 = ВладелецФормы.ОткрытьОтчетОСВССубконто77(Счет, Организация, Период.ДатаНачала, Период.ДатаОкончания);
		
		Если УдалосьОткрытьОтчет77 Тогда
			
			// Отчет из 8 всегда открывается.
			ВладелецФормы.ОткрытьОтчетОСВССубконто8(Счет, Организация, Период.ДатаНачала, Период.ДатаОкончания);
			
			ТекстПредупреждения = НСтр(
			"ru = 'Было открыто два отчета,
			|первый с данными из 1С:Предприятие 7.7,
			|второй с данными из текущей информационной базы.'");
			ПоказатьПредупреждение(, ТекстПредупреждения);
			
		КонецЕсли;
		
	КонецЕсли;
	
КонецПроцедуры

&НаКлиенте
Функция ОрганизацияЗаполнена()
	
	Если ЗначениеЗаполнено(Организация) Тогда
		
		Возврат Истина;
		
	Иначе
		
		Сообщение = Новый СообщениеПользователю;
		Сообщение.Текст = НСтр("ru = 'Поле ""Организация"" не заполнено.'");
		Сообщение.Поле = "Организация";
		Сообщение.Сообщить();
		
		Возврат Ложь;
		
	КонецЕсли;
	
КонецФункции

&НаКлиенте
Функция ПериодЗаполнен()
	
	Если ЗначениеЗаполнено(Период) Тогда
		
		Возврат Истина;
		
	Иначе
		
		Сообщение = Новый СообщениеПользователю;
		Сообщение.Текст = НСтр("ru = 'Поле ""Период"" не заполнено.'");
		Сообщение.Поле = "Период";
		Сообщение.Сообщить();
		
		Возврат Ложь;
		
	КонецЕсли;
	
КонецФункции

&НаКлиенте
Функция СчетЗаполнен()
	
	Если ЗначениеЗаполнено(Счет) Тогда
		
		Возврат Истина;
		
	Иначе
		
		Сообщение = Новый СообщениеПользователю;
		Сообщение.Текст = НСтр("ru = 'Поле ""Счет"" не заполнено.'");
		Сообщение.Поле = "Счет";
		Сообщение.Сообщить();
		
		Возврат Ложь;
		
	КонецЕсли;

КонецФункции