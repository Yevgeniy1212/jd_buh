#Если Сервер Или ТолстыйКлиентОбычноеПриложение Или ВнешнееСоединение Тогда
	
////////////////////////////////////////////////////////////////////////////////
// ПРОГРАММНЫЙ ИНТЕРФЕЙС

#Область ДляВызоваИзДругихПодсистем

// СтандартныеПодсистемы.ВерсионированиеОбъектов

// Определяет настройки объекта для подсистемы ВерсионированиеОбъектов.
//
// Параметры:
//  Настройки - Структура - настройки подсистемы.
Процедура ПриОпределенииНастроекВерсионированияОбъектов(Настройки) Экспорт

КонецПроцедуры

// Конец СтандартныеПодсистемы.ВерсионированиеОбъектов

// СтандартныеПодсистемы.УправлениеДоступом

// См. УправлениеДоступомПереопределяемый.ПриЗаполненииСписковСОграничениемДоступа.
Процедура ПриЗаполненииОграниченияДоступа(Ограничение) Экспорт

КонецПроцедуры

// Конец СтандартныеПодсистемы.УправлениеДоступом

#КонецОбласти

////////////////////////////////////////////////////////////////////////////////
// ОБРАБОТЧИКИ СОБЫТИЙ

////////////////////////////////////////////////////////////////////////////////
// СЛУЖЕБНЫЕ ПРОЦЕДУРЫ И ФУНКЦИИ	

Процедура Автозаполнение(Параметры, АдресХранилища) Экспорт
	
	НачатьТранзакцию();
	
	Если ТипЗнч(Параметры.Документ) = Тип("ДокументСсылка.ОтражениеЗарплатыВРеглУчете") Тогда
		ДокументОбъект = Параметры.Документ.ПолучитьОбъект();
	Иначе
		ДокументОбъект = Параметры.Документ;
	КонецЕсли;
	
	// вспомогательные переменные, используемые в процедуре
	ГоловнаяОрганизация = ОбщегоНазначенияБКВызовСервера.ГоловнаяОрганизацияДляУчетаЗарплаты(Параметры.Организация);

	// пустая ссылка на счет - для проверок способов отражения в бухучете и в налоговом учете
	ПустойСчет 		= ПланыСчетов.Типовой.ПустаяСсылка();
	ПустойСчетНУ 	= ПланыСчетов.Налоговый.ПустаяСсылка();
	
	// счет затрат для отнесения пени ОПВ и СО
	СчетДебетаДляПени 	= ПланыСчетов.Типовой.АдминистративныеРасходы;
	СчетДебетаДляПениНУ = ПроцедурыБухгалтерскогоУчетаВызовСервераПовтИсп.ПреобразоватьСчетаБУвСчетНУ(Новый Структура("СчетБУ, ", СчетДебетаДляПени), , , КонецМесяца(Параметры.ПериодРегистрации));

	ЗаполнятьНКпоИПНВНУ = ПланыСчетов.Налоговый.ИндивидуальныйПодоходныйНалог.ВидыСубконто.Найти(ПланыВидовХарактеристик.ВидыСубконтоТиповые.Контрагенты) <> Неопределено;
	ЗаполнятьНКпоСНВНУ	= ПланыСчетов.Налоговый.ПрочиеНалоги.ВидыСубконто.Найти(ПланыВидовХарактеристик.ВидыСубконтоТиповые.Контрагенты) <> Неопределено;

	// признаки наличия на счетах учета задолженности по налогам аналитики по налоговым комитетам,
	// в которые необходимо отчитываться 
	ЗаполнятьНКпоИПН 	= ПланыСчетов.Типовой.ИндивидуальныйПодоходныйНалог.ВидыСубконто.Найти(ПланыВидовХарактеристик.ВидыСубконтоТиповые.Контрагенты) <> Неопределено;
	ЗаполнятьНКпоСН		= ПланыСчетов.Типовой.СоциальныйНалог.ВидыСубконто.Найти(ПланыВидовХарактеристик.ВидыСубконтоТиповые.Контрагенты) <> Неопределено;

	Если Параметры.ПоддержкаРаботыСоСтруктурнымиПодразделениями Тогда
		ИсчислениеНалоговСтруктурныхЕдиниц = ПолныеПраваПовтИсп.ЗаполнитьИсчислениеНалоговСтруктурныхЕдиниц();
	Иначе
		ЗаполнятьНКпоИПН 	= Ложь;
		ЗаполнятьНКпоСН 	= Ложь;
		ЗаполнятьНКпоИПНВНУ = Ложь;
		ЗаполнятьНКпоСНВНУ 	= Ложь;
	КонецЕсли;
    	
	ВедетсяУчетПоСотрудникам = ОбщегоНазначенияБК.ПолучитьПризнакВеденияУчетаПоСотрудникам();

	ВедениеУчетаВременныхРазницБалансовымМетодом = УчетнаяПолитикаСервер.ВедетсяУчетВременныхРазницБалансовымМетодом(Параметры.Организация, Параметры.Дата);
	
	ОтражениеЗаИП = (Параметры.Организация.ЮрФизЛицо = Перечисления.ЮрФизЛицо.ФизЛицо) И ПроцедурыНалоговогоУчета.ПолучитьПризнакЕжемесячногоРасчетаВзносовИОтчисленийЗаИП(Параметры.Организация, Параметры.ПериодРегистрации);
	
	// составим список физлиц, данные по которым необходимо отразить в документе
	МенеджерВТ = ПодготовитьМенеджерВременныхТаблицСоСпискомФизЛиц(Параметры);

#Область ПодготовкаКОтражению 	

	// отражение начислений
	
	// фактически - создаем структуру промежуточной таблицы
	ПромежуточнаяТаблица = Параметры.ТаблицаОтражениеВУчете.СкопироватьКолонки();
	СтрокаРеквизитовГруппировки = "";
	КоллекцияРеквизитов = Метаданные.Документы.ОтражениеЗарплатыВРеглУчете.ТабличныеЧасти.ОтражениеВУчете.Реквизиты;
	Для Каждого МетаРекв Из КоллекцияРеквизитов Цикл
		Если МетаРекв.Имя = "Сумма" Тогда
			Продолжить;
		КонецЕсли;
		Если НЕ ПустаяСтрока(СтрокаРеквизитовГруппировки) Тогда
			СтрокаРеквизитовГруппировки = СтрокаРеквизитовГруппировки + ", ";
		КонецЕсли;
		СтрокаРеквизитовГруппировки = СтрокаРеквизитовГруппировки + МетаРекв.Имя;
	КонецЦикла;

	ДанныеУчета = ПолучитьДанныеУчета(Параметры, МенеджерВТ);
	
	// обработаем данные
	Пока ДанныеУчета.Следующий() Цикл
		СтрокаДанных = ПромежуточнаяТаблица.Добавить();
		СоздатьСтрокуОтраженияНачислений(ДанныеУчета, СтрокаДанных, ПустойСчет, ПустойСчетНУ);
	КонецЦикла;
	
	ПромежуточнаяТаблицаКонтрагенты = Параметры.ТаблицаОтражениеВУчете.СкопироватьКолонки();
	ПромежуточнаяТаблицаКонтрагенты.Колонки.Добавить("Контрагент",	Новый ОписаниеТипов("СправочникСсылка.Контрагенты"));
	ПромежуточнаяТаблицаКонтрагенты.Колонки.Добавить("ДоговорКонтрагента",	Новый ОписаниеТипов("СправочникСсылка.ДоговорыКонтрагентов"));

	// формируем таблицу данных по контрагентам
	ПромежуточнаяТаблицаКонтрагенты.Очистить();
	ДанныеУчета.Сбросить();
	
	Пока ДанныеУчета.Следующий() Цикл
		Если НЕ ЗначениеЗаполнено(ДанныеУчета.Контрагент) Тогда
			Продолжить;
		КонецЕсли;
		СтрокаДанных = ПромежуточнаяТаблицаКонтрагенты.Добавить();
		СоздатьСтрокуОтраженияНачисленийКонтрагентов(ДанныеУчета, СтрокаДанных, ПустойСчет, ПустойСчетНУ);
	КонецЦикла;	
	
	// данные из промежуточной таблицы по контрагентам уже находятся в ТЧ ОтражениеВУчете
	// поэтому их не нужно переносить в табличную часть с помощью процедуры ПеренестиОтражениеВУчетеИзПромежуточнойТаблицы()
	// ПромежуточнаяТаблицаКонтрагенты понадобиться в дальнейшем для распределения сумм ИПН,
	// исчисленных по контрагентам.
	
    // запишем промежуточное состояние документа
    // это необходимо для выполнения запросов к его табличной части 
    // при формировании проводок по налогам и взносам
	
    // создадим запрос и создадим все необходимые для него параметры
    Запрос = Новый Запрос;
    
    Если МенеджерВТ <> Неопределено Тогда
    	Запрос.МенеджерВременныхТаблиц = МенеджерВТ;
    Иначе
		Возврат;		
    КонецЕсли;
    
	// Параметры из шапки документа
	Запрос.УстановитьПараметр("ДокументСсылка", 					Параметры.ДокументСсылка);
	
	Запрос.УстановитьПараметр("парамОрганизация", 					Параметры.Организация);
	Запрос.УстановитьПараметр("парамГоловнаяОрганизация", 			ГоловнаяОрганизация);
	
	Запрос.УстановитьПараметр("парамНачалоМесяца", 					НачалоМесяца(Параметры.ПериодРегистрации));
	Запрос.УстановитьПараметр("парамКонецМесяца", 					КонецМесяца(Параметры.ПериодРегистрации));

	// ПланСчетов
	Запрос.УстановитьПараметр("парамПустойСчет", 					ПустойСчет);
	Запрос.УстановитьПараметр("парамПустойСчетНУ", 					ПустойСчетНУ);
	Запрос.УстановитьПараметр("парамСчетПрочиеРасходыНУ",			ПланыСчетов.Налоговый.ПрочиеРасходы);
	Запрос.УстановитьПараметр("парамСчетДтДляПени", 				СчетДебетаДляПени);
	Запрос.УстановитьПараметр("парамСчетДтДляПениНУ", 				СчетДебетаДляПениНУ);
	Запрос.УстановитьПараметр("парамСчетКтДляРезервов", 			ПланыСчетов.Типовой.КраткосрочныеОценочныеОбязательстваПоВознаграждениямРаботникам); // 3430
	Запрос.УстановитьПараметр("парамСчетКтНУДляРезервов", 			ПланыСчетов.Налоговый.КраткосрочныеОценочныеОбязательстваПоВознаграждениямРаботникам); // 3430Н
		
	// СпособыОтраженияЗапрлатыВРеглУчете
	Запрос.УстановитьПараметр("парамСпособПоУмолчанию", 			Справочники.СпособыОтраженияЗарплатыВРеглУчете.ОтражениеНачисленийПоУмолчанию);
	Запрос.УстановитьПараметр("парамПустойСпособБУ", 				Справочники.СпособыОтраженияЗарплатыВРеглУчете.ПустаяСсылка());
	Запрос.УстановитьПараметр("парамСпособНеОтражать", 				Справочники.СпособыОтраженияЗарплатыВРеглУчете.НеОтражатьВБухучете);
	
	// ВидыСубконтоТиповые	                                                                             
	Запрос.УстановитьПараметр("парамВидСубконтоРаботникиОрганизаций", 	ПланыВидовХарактеристик.ВидыСубконтоТиповые.РаботникиОрганизаций);
	Запрос.УстановитьПараметр("парамВидСубконтоДебиторыКредиторыОрганизации", ПланыВидовХарактеристик.ВидыСубконтоТиповые.ДебиторыКредиторыОрганизации);
	Запрос.УстановитьПараметр("парамВидСубконтоКонтрагенты", 			ПланыВидовХарактеристик.ВидыСубконтоТиповые.Контрагенты);
	Запрос.УстановитьПараметр("парамВидСубконтоСтатьиЗатрат", 			ПланыВидовХарактеристик.ВидыСубконтоТиповые.СтатьиЗатрат);
	Запрос.УстановитьПараметр("парамВидСубконтоПодразделения", 			ПланыВидовХарактеристик.ВидыСубконтоТиповые.Подразделения);
	
	// Предопределенные статьи затрат
	Запрос.УстановитьПараметр("парамСтатьяЗатратСО", 				Справочники.СтатьиЗатрат.СоциальныеОтчисления);
	Запрос.УстановитьПараметр("парамСтатьяЗатратСН", 				Справочники.СтатьиЗатрат.СоциальныйНалог);
	Запрос.УстановитьПараметр("парамСтатьяЗатратОППВ", 				Справочники.СтатьиЗатрат.ОбязательныеПрофессиональныеПенсионныеВзносы);
	Запрос.УстановитьПараметр("парамСтатьяЗатратОПВР", 				Справочники.СтатьиЗатрат.ОбязательныеПенсионныеВзносыРаботодателя);
	Запрос.УстановитьПараметр("парамСтатьяЗатратООСМС", 			Справочники.СтатьиЗатрат.ОтчисленияОСМС);
	Запрос.УстановитьПараметр("парамСтатьяЗатратЕП", 				Справочники.СтатьиЗатрат.ЕдиныйПлатеж);
	
	// Предопределенные элементы справочника НалогиСборыОтчисления
	Запрос.УстановитьПараметр("парамНалогиСборыСоциальныйНалогИностранныеСпециалисты", Справочники.НалогиСборыОтчисления.СоциальныйНалогИностранныеСпециалисты);
	Запрос.УстановитьПараметр("парамНалогиСборыСоциальныйНалог", 	Справочники.НалогиСборыОтчисления.СоциальныйНалог);
	
	// ВидыДвиженияНакопления
	Запрос.УстановитьПараметр("парамВидДвиженияПриход", 			Параметры.парамПриход);

	// Прочие параметры
	Запрос.УстановитьПараметр("парамПустаяОрганизация", 			Справочники.Организации.ПустаяСсылка());
	Запрос.УстановитьПараметр("НачальнаяДата", 						'00010101');
	Запрос.УстановитьПараметр("парамВидСтрокиИсчисление", 			Перечисления.РасчетыСБюджетомФондамиВидСтроки.Исчисление);
	Запрос.УстановитьПараметр("Уволен", 							Перечисления.ПричиныИзмененияСостояния.Увольнение);
	Запрос.УстановитьПараметр("парамВнутреннееСовместительство", 	Перечисления.ВидыЗанятостиВОрганизации.ВнутреннееСовместительство);
	Запрос.УстановитьПараметр("парамНеОблагаетсяЦеликом", 			Справочники.СпособыНалогообложенияДоходов.НеОблагаетсяЦеликом);
	Запрос.УстановитьПараметр("парамПустойВидРасчета", 				ПланыВидовРасчета.ОсновныеНачисленияОрганизаций.ПустаяСсылка());
	Запрос.УстановитьПараметр("парамПериодРегистрации", 			Параметры.ПериодРегистрации);

	// Параметыры ИП
	Если ОтражениеЗаИП Тогда
		Запрос.УстановитьПараметр("парамИндивидуальныйПредприниматель", Параметры.Организация.ИндивидуальныйПредприниматель);
	Иначе 
		Запрос.УстановитьПараметр("парамИндивидуальныйПредприниматель", Неопределено);
	КонецЕсли;
	
	// Подготовим список счетов резервов по вознаграждениями работников, которые создавались без
	// формирования резерва на социальные отчисления и/или социальный налог, чтобы затраты по ним относились 
	// не на счет резерва, а на основной счет затрат работника.
	// Определяем по состоянию на текущий месяц, если в разные периоды СН и СО то включались в резерв,
	// то не включались, то надо оформлять такие случаи с помощью разных элементов справочника Резервы.
	
	Запрос.Текст = "
	|ВЫБРАТЬ РАЗЛИЧНЫЕ РАЗРЕШЕННЫЕ
	|	РазмерыОтчисленийВРезервы.СчетУчета,
	|	РазмерыОтчисленийВРезервы.Резерв,
	|	РазмерыОтчисленийВРезервы.РазмерСоциальногоНалога,
	|	РазмерыОтчисленийВРезервы.РазмерСоциальныхОтчислений,
	|	РазмерыОтчисленийВРезервы.РазмерПрофессиональныхПенсионныхВзносов,
	|	РазмерыОтчисленийВРезервы.РазмерПенсионныхВзносовРаботодателя,
	|	РазмерыОтчисленийВРезервы.РазмерОтчисленийОСМС
	|ИЗ
	|	РегистрСведений.РазмерыОтчисленийВРезервы.СрезПоследних(
	|			&парамКонецМесяца,
	|			Организация = &парамОрганизация) КАК РазмерыОтчисленийВРезервы
	|ГДЕ
	|	(РазмерыОтчисленийВРезервы.РазмерСоциальногоНалога = 0
	|		ИЛИ РазмерыОтчисленийВРезервы.РазмерСоциальныхОтчислений = 0
	|		ИЛИ РазмерыОтчисленийВРезервы.РазмерПрофессиональныхПенсионныхВзносов = 0
	|		ИЛИ РазмерыОтчисленийВРезервы.РазмерПенсионныхВзносовРаботодателя = 0
	|		ИЛИ РазмерыОтчисленийВРезервы.РазмерОтчисленийОСМС = 0)
	|";

	Выборка = Запрос.Выполнить().Выбрать();
	      
	МассивСчетаРезервовБезСН = Новый Массив();
	МассивСчетаРезервовБезСО = Новый Массив();
	МассивСчетаРезервовБезОППВ = Новый Массив();
	МассивСчетаРезервовБезОПВР = Новый Массив();
	МассивСчетаРезервовБезООСМС = Новый Массив();
	
	МассивРезервыБезСН = Новый Массив();
	МассивРезервыБезСО = Новый Массив();
	МассивРезервыБезОППВ = Новый Массив();
	МассивРезервыБезОПВР = Новый Массив();
	МассивРезервыБезООСМС = Новый Массив();
	
	Пока Выборка.Следующий() Цикл
	
		Если Выборка.РазмерСоциальногоНалога = 0 Тогда
			МассивСчетаРезервовБезСН.Добавить(Выборка.СчетУчета);
			МассивРезервыБезСН.Добавить(Выборка.Резерв);
		КонецЕсли;
	
		Если Выборка.РазмерСоциальныхОтчислений = 0 Тогда
			МассивСчетаРезервовБезСО.Добавить(Выборка.СчетУчета);
			МассивРезервыБезСО.Добавить(Выборка.Резерв);
		КонецЕсли;
		
		Если Выборка.РазмерПрофессиональныхПенсионныхВзносов = 0 Тогда
			МассивСчетаРезервовБезОППВ.Добавить(Выборка.СчетУчета);
			МассивРезервыБезОППВ.Добавить(Выборка.Резерв);
		КонецЕсли;
		
		Если Выборка.РазмерОтчисленийОСМС = 0 Тогда
			МассивСчетаРезервовБезООСМС.Добавить(Выборка.СчетУчета);
			МассивРезервыБезООСМС.Добавить(Выборка.Резерв);
		КонецЕсли;
		
		Если Выборка.РазмерПенсионныхВзносовРаботодателя = 0 Тогда
			МассивСчетаРезервовБезОПВР.Добавить(Выборка.СчетУчета);
			МассивРезервыБезОПВР.Добавить(Выборка.Резерв);
		КонецЕсли;
		
	КонецЦикла; 
	
	Запрос.УстановитьПараметр("парамСчетаРезервовБезСН",   МассивСчетаРезервовБезСН);
	Запрос.УстановитьПараметр("парамСчетаРезервовБезСО",   МассивСчетаРезервовБезСО);
	Запрос.УстановитьПараметр("парамСчетаРезервовБезОППВ", МассивСчетаРезервовБезОППВ);
	Запрос.УстановитьПараметр("парамСчетаРезервовБезОПВР", МассивСчетаРезервовБезОПВР);
	Запрос.УстановитьПараметр("парамСчетаРезервовБезООСМС", МассивСчетаРезервовБезООСМС);
	
	Запрос.УстановитьПараметр("парамРезервыБезСН",   МассивРезервыБезСН);
	Запрос.УстановитьПараметр("парамРезервыБезСО",   МассивРезервыБезСО);
	Запрос.УстановитьПараметр("парамРезервыБезОППВ", МассивРезервыБезОППВ);
	Запрос.УстановитьПараметр("парамРезервыБезОПВР", МассивРезервыБезОПВР);
	Запрос.УстановитьПараметр("парамРезервыБезООСМС", МассивРезервыБезООСМС);
	
	// Перенесем сведения по отражению начислений во временную таблицу,
	// данные сведения необходимы для отражения налогов и взносов в дальнейшем
	Запрос.Текст = 
		"ВЫБРАТЬ
		|	БУНачисления.СтруктурноеПодразделениеДт,
		|	БУНачисления.СчетДт,
		|	БУНачисления.СубконтоДт1,
		|	БУНачисления.СубконтоДт2,
		|	БУНачисления.СубконтоДт3,
		|	БУНачисления.СтруктурноеПодразделениеКт,
		|	БУНачисления.СчетКт,
		|	БУНачисления.СубконтоКт1,
		|	БУНачисления.СубконтоКт2,
		|	БУНачисления.СубконтоКт3,
		|	БУНачисления.Сумма,
		|	БУНачисления.ВидРасчета,
		|	БУНачисления.ФизЛицо,
		|	БУНачисления.СчетДтНУ,
		|	БУНачисления.СубконтоДтНУ1,
		|	БУНачисления.СубконтоДтНУ2,
		|	БУНачисления.СубконтоДтНУ3,
		|	БУНачисления.СчетКтНУ,
		|	БУНачисления.СубконтоКтНУ1,
		|	БУНачисления.СубконтоКтНУ2,
		|	БУНачисления.СубконтоКтНУ3
		|ПОМЕСТИТЬ ВТ_БУНачисления	
		|ИЗ
		|	&БУНачисления_ВнешняяТаблица КАК БУНачисления
		|ИНДЕКСИРОВАТЬ ПО
		|	СчетДт,
		|	СчетКт,
		|	СчетДтНУ,
		|	СчетКтНУ
		|";
	
	Запрос.УстановитьПараметр("БУНачисления_ВнешняяТаблица", ПромежуточнаяТаблица);
	Запрос.Выполнить();
	
	
	//////////////////////////////////////////////////////////////////////////////////////////////////
	// определение подразделения, в котором числится работник на конец месяца
	
	МестаРаботыТекст = 
	"ВЫБРАТЬ РАЗРЕШЕННЫЕ
	|	РаботникиОрганизации.Сотрудник.Физлицо КАК ФизЛицо,
	|	МАКСИМУМ(ВЫБОР
	|			КОГДА РаботникиОрганизации.ПричинаИзмененияСостояния = &Уволен
	|				ТОГДА ДОБАВИТЬКДАТЕ(РаботникиОрганизации.Период, ДЕНЬ, -1)
	|			ИНАЧЕ РаботникиОрганизации.Период
	|		КОНЕЦ) КАК Период
	|ПОМЕСТИТЬ ВТ_МестаРаботы_ДатыПоследнихНазначений
	|ИЗ
	|	РегистрСведений.РаботникиОрганизаций КАК РаботникиОрганизации
	|ГДЕ
	|	РаботникиОрганизации.Организация = &парамГоловнаяОрганизация
	|	И РаботникиОрганизации.Сотрудник.ВидЗанятости <> &парамВнутреннееСовместительство
	|	И РаботникиОрганизации.Период <= &парамКонецМесяца
	|	И РаботникиОрганизации.Активность
	|
	|СГРУППИРОВАТЬ ПО
	|	РаботникиОрганизации.Сотрудник.Физлицо
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	ФизЛицо,
	|	Период
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ РАЗРЕШЕННЫЕ
	|	РаботникиОрганизации.Сотрудник.ФизЛицо КАК ФизЛицо,
	|	РаботникиОрганизации.ПодразделениеОрганизации,
	|	УчетОсновногоЗаработкаРаботниковПодразделенияОрганизации.СпособОтраженияВБухучете
	|
	|ПОМЕСТИТЬ ВТ_МестаРаботы
	|ИЗ 
	|	ВТ_МестаРаботы_ДатыПоследнихНазначений КАК ДатыПоследнихНазначений
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РаботникиОрганизаций КАК РаботникиОрганизации
	|		ПО ДатыПоследнихНазначений.ФизЛицо = РаботникиОрганизации.Сотрудник.ФизЛицо
	|			И ДатыПоследнихНазначений.Период = ВЫБОР
	|													КОГДА РаботникиОрганизации.ПричинаИзмененияСостояния = &Уволен
	|														ТОГДА ДОБАВИТЬКДАТЕ(РаботникиОрганизации.Период, ДЕНЬ, -1)
	|													ИНАЧЕ РаботникиОрганизации.Период
	|												КОНЕЦ
	|			И РаботникиОрганизации.Организация = &парамГоловнаяОрганизация
	|			И (РаботникиОрганизации.Сотрудник.ВидЗанятости <> &парамВнутреннееСовместительство)
	|			И РаботникиОрганизации.Активность
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.УчетОсновногоЗаработкаРаботниковПодразделенияОрганизации.СрезПоследних(&парамКонецМесяца) КАК УчетОсновногоЗаработкаРаботниковПодразделенияОрганизации
	|		ПО РаботникиОрганизации.ПодразделениеОрганизации = УчетОсновногоЗаработкаРаботниковПодразделенияОрганизации.ПодразделениеОрганизации
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	РаботникиОрганизации.Сотрудник.ФизЛицо
	|";

	Запрос.Текст = МестаРаботыТекст;
	Запрос.Выполнить();

	//////////////////////////////////////////////////////////////////////////////////////////////////
	// определение основного способа отражения зарплаты работника в бух.учете
	
	ОсновнойСпособОтраженияТекст = 
	"ВЫБРАТЬ РАЗРЕШЕННЫЕ
	|	РеглУчетПлановыхНачислений.Сотрудник.Физлицо КАК ФизЛицо,
	|	МАКСИМУМ(РеглУчетПлановыхНачислений.Период) КАК Период
	|ПОМЕСТИТЬ ВТ_ПоследниеДатыРеглУчетаПлановыхНачислений
	|ИЗ
	|	РегистрСведений.РеглУчетПлановыхНачисленийРаботниковОрганизаций КАК РеглУчетПлановыхНачислений
	|ГДЕ
	|	РеглУчетПлановыхНачислений.Организация = &парамГоловнаяОрганизация
	|	И РеглУчетПлановыхНачислений.Сотрудник.ВидЗанятости <> &парамВнутреннееСовместительство
	|	И РеглУчетПлановыхНачислений.ВидРасчета.ЗачетОтработанногоВремени
	|	И РеглУчетПлановыхНачислений.Период <= &парамКонецМесяца
	|	И РеглУчетПлановыхНачислений.Активность
	|
	|СГРУППИРОВАТЬ ПО
	|	РеглУчетПлановыхНачислений.Сотрудник.Физлицо
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	ФизЛицо,
	|	Период
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ РАЗРЕШЕННЫЕ
	|	РеглУчетПлановыхНачислений.Сотрудник.Физлицо КАК ФизЛицо,
	|	МАКСИМУМ(РеглУчетПлановыхНачислений.СпособОтраженияВБухучете) КАК СпособОтраженияВБухучете
	|ПОМЕСТИТЬ ВТ_РеглУчетПлановыхНачислений
	|ИЗ
	|	ВТ_ПоследниеДатыРеглУчетаПлановыхНачислений КАК ПоследниеДатыРеглУчетаПлановыхНачислений
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РеглУчетПлановыхНачисленийРаботниковОрганизаций КАК РеглУчетПлановыхНачислений
	|		ПО ПоследниеДатыРеглУчетаПлановыхНачислений.ФизЛицо = РеглУчетПлановыхНачислений.Сотрудник.Физлицо
	|			И ПоследниеДатыРеглУчетаПлановыхНачислений.Период = РеглУчетПлановыхНачислений.Период
	|			И (РеглУчетПлановыхНачислений.Организация = &парамГоловнаяОрганизация)
	|			И (РеглУчетПлановыхНачислений.Сотрудник.ВидЗанятости <> &парамВнутреннееСовместительство)
	|			И (РеглУчетПлановыхНачислений.ВидРасчета.ЗачетОтработанногоВремени)
	|			И (РеглУчетПлановыхНачислений.Активность)
	|
	|СГРУППИРОВАТЬ ПО
	|	РеглУчетПлановыхНачислений.Сотрудник.Физлицо
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	ФизЛицо
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ РАЗРЕШЕННЫЕ
	|	ПлановыеНачисления.Сотрудник.Физлицо КАК ФизЛицо,
	|	МАКСИМУМ(ПлановыеНачисления.Период) КАК Период
	|ПОМЕСТИТЬ ВТ_ПоследниеДатыПлановыхНачислений
	|ИЗ
	|	РегистрСведений.ПлановыеНачисленияРаботниковОрганизаций КАК ПлановыеНачисления
	|ГДЕ
	|	ПлановыеНачисления.Организация = &парамГоловнаяОрганизация
	|	И ПлановыеНачисления.Сотрудник.ВидЗанятости <> &парамВнутреннееСовместительство
	|	И ПлановыеНачисления.ВидРасчетаИзмерение.Код ЕСТЬ NULL 
	|	И ПлановыеНачисления.Период <= &парамКонецМесяца
	|	И ПлановыеНачисления.Активность
	|
	|СГРУППИРОВАТЬ ПО
	|	ПлановыеНачисления.Сотрудник.Физлицо
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	ФизЛицо,
	|	Период
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ РАЗРЕШЕННЫЕ
	|	ПлановыеНачисления.Сотрудник.Физлицо КАК ФизЛицо,
	|	МАКСИМУМ(ПлановыеНачисления.ВидРасчета) КАК ВидРасчета
	|ПОМЕСТИТЬ ВТ_ПлановыеНачисления
	|ИЗ
	|	ВТ_ПоследниеДатыПлановыхНачислений КАК ПоследниеДатыПлановыхНачислений
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ПлановыеНачисленияРаботниковОрганизаций КАК ПлановыеНачисления
	|		ПО ПоследниеДатыПлановыхНачислений.ФизЛицо = ПлановыеНачисления.Сотрудник.Физлицо
	|			И ПоследниеДатыПлановыхНачислений.Период = ПлановыеНачисления.Период
	|			И (ПлановыеНачисления.Организация = &парамГоловнаяОрганизация)
	|			И (ПлановыеНачисления.Сотрудник.ВидЗанятости <> &парамВнутреннееСовместительство)
	|			И (ПлановыеНачисления.ВидРасчетаИзмерение.Код ЕСТЬ NULL )
	|			И (ПлановыеНачисления.Активность)
	|
	|СГРУППИРОВАТЬ ПО
	|	ПлановыеНачисления.Сотрудник.Физлицо
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	ФизЛицо
	|;
	|	
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ РАЗРЕШЕННЫЕ
	|	ОсновныеНачисления.Физлицо КАК Физлицо,
	|	МАКСИМУМ(ОсновныеНачисления.ДатаНачала) КАК ДатаНачала
	|ПОМЕСТИТЬ ВТ_ПоследниеДатыОсновныхНачислений
	|ИЗ
	|	Документ.НачислениеЗарплатыРаботникамОрганизаций.Начисления КАК ОсновныеНачисления
	|ГДЕ
	|	ОсновныеНачисления.Ссылка.Проведен
	|	И ОсновныеНачисления.Ссылка.Организация = &парамОрганизация
	|	И ОсновныеНачисления.Ссылка.ПериодРегистрации <= &парамКонецМесяца
	|	И ОсновныеНачисления.ДатаНачала <= &парамКонецМесяца
	|	И ОсновныеНачисления.ВидРасчета.ЗачетОтработанногоВремени
	|	И ВЫБОР
	|			КОГДА ОсновныеНачисления.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|				ТОГДА ОсновныеНачисления.СпособОтраженияВБухучете
	|			ИНАЧЕ ОсновныеНачисления.Ссылка.СпособОтраженияВБухучете
	|		КОНЕЦ <> &парамПустойСпособБУ
	|	И ОсновныеНачисления.Сотрудник.ВидЗанятости <> &парамВнутреннееСовместительство
	|
	|СГРУППИРОВАТЬ ПО
	|	ОсновныеНачисления.Физлицо
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	Физлицо,
	|	ДатаНачала
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ РАЗРЕШЕННЫЕ
	|	ОсновныеНачисления.Физлицо,
	|	ОсновныеНачисления.ДатаНачала,
	|	МАКСИМУМ(ВЫБОР
	|			КОГДА ОсновныеНачисления.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|				ТОГДА ОсновныеНачисления.СпособОтраженияВБухучете
	|			ИНАЧЕ ОсновныеНачисления.Ссылка.СпособОтраженияВБухучете
	|		КОНЕЦ) КАК СпособОтраженияВБухучете
	|ПОМЕСТИТЬ ВТ_ОсновныеНачисления
	|ИЗ
	|	ВТ_ПоследниеДатыОсновныхНачислений КАК ПоследниеДатыОсновныхНачислений
	|		ЛЕВОЕ СОЕДИНЕНИЕ Документ.НачислениеЗарплатыРаботникамОрганизаций.Начисления КАК ОсновныеНачисления
	|		ПО ПоследниеДатыОсновныхНачислений.Физлицо = ОсновныеНачисления.Физлицо
	|			И ПоследниеДатыОсновныхНачислений.ДатаНачала = ОсновныеНачисления.ДатаНачала
	|			И (ОсновныеНачисления.Ссылка.Организация = &парамОрганизация)
	|			И (ОсновныеНачисления.Ссылка.ПериодРегистрации <= &парамКонецМесяца)
	|			И (ОсновныеНачисления.ВидРасчета.ЗачетОтработанногоВремени)
	|			И (ВЫБОР
	|				КОГДА ОсновныеНачисления.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|					ТОГДА ОсновныеНачисления.СпособОтраженияВБухучете
	|				ИНАЧЕ ОсновныеНачисления.Ссылка.СпособОтраженияВБухучете
	|			КОНЕЦ <> &парамПустойСпособБУ)
	|			И (ОсновныеНачисления.Сотрудник.ВидЗанятости <> &парамВнутреннееСовместительство)
	|
	|СГРУППИРОВАТЬ ПО
	|	ОсновныеНачисления.Физлицо,
	|	ОсновныеНачисления.ДатаНачала
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	ОсновныеНачисления.Физлицо
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ РАЗРЕШЕННЫЕ
	|	ФизическиеЛица.Ссылка КАК ФизЛицо, 
	| 	ВЫБОР 
	|		КОГДА НЕ (ОсновныеНачисления.СпособОтраженияВБухучете ЕСТЬ NULL)
	|				И ОсновныеНачисления.ДатаНачала >= &парамНачалоМесяца
	|			ТОГДА ОсновныеНачисления.СпособОтраженияВБухучете
	| 		КОГДА НЕ(РеглУчетПлановыхНачислений.СпособОтраженияВБухучете ЕСТЬ NULL) 
	| 				И РеглУчетПлановыхНачислений.СпособОтраженияВБухучете <> &парамПустойСпособБУ 
	| 			ТОГДА РеглУчетПлановыхНачислений.СпособОтраженияВБухучете 
	| 		КОГДА НЕ(ПлановыеНачисления.ВидРасчета.СпособОтраженияВБухучете ЕСТЬ NULL) 
	| 				И ПлановыеНачисления.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ 
	| 			ТОГДА ПлановыеНачисления.ВидРасчета.СпособОтраженияВБухучете 
	|		КОГДА НЕ (ОсновныеНачисления.СпособОтраженияВБухучете ЕСТЬ NULL)
	|			ТОГДА ОсновныеНачисления.СпособОтраженияВБухучете
	| 		ИНАЧЕ &парамСпособПоУмолчанию 
	| 	КОНЕЦ КАК СпособОтраженияВБухучете 
	|
	|ПОМЕСТИТЬ ВТ_ОсновнойСпособОтражения
	|ИЗ 
	|	Справочник.ФизическиеЛица КАК ФизическиеЛица
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТСписокФизЛиц КАК СписокФизЛиц
	|		ПО ФизическиеЛица.Ссылка = СписокФизЛиц.ФизЛицо
	|	ЛЕВОЕ СОЕДИНЕНИЕ ВТ_РеглУчетПлановыхНачислений КАК РеглУчетПлановыхНачислений 
	|	ПО ФизическиеЛица.Ссылка = РеглУчетПлановыхНачислений.ФизЛицо
	| 
	| ЛЕВОЕ СОЕДИНЕНИЕ ВТ_ПлановыеНачисления КАК ПлановыеНачисления 
	| ПО ФизическиеЛица.Ссылка = ПлановыеНачисления.ФизЛицо 
	|
	| ЛЕВОЕ СОЕДИНЕНИЕ ВТ_ОсновныеНачисления КАК ОсновныеНачисления
	| ПО ФизическиеЛица.Ссылка = ОсновныеНачисления.ФизЛицо
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	ФизическиеЛица.Ссылка
	|";

	Запрос.Текст = ОсновнойСпособОтраженияТекст;
	Запрос.Выполнить();
	
#КонецОбласти	


#Область Удержания	

	// Соберем все удержания в одном запросе
	//
	УдержанияРаботниковОрганизацийТекст = "
	|ВЫБРАТЬ РАЗРЕШЕННЫЕ
	|	ВЫБОР
	|		КОГДА УдержанияРаботниковОрганизации.Ссылка.Организация.ГоловнаяОрганизация = &парамПустаяОрганизация
	|			ТОГДА УдержанияРаботниковОрганизации.Ссылка.Организация
	|		ИНАЧЕ УдержанияРаботниковОрганизации.Ссылка.Организация.ГоловнаяОрганизация
	|	КОНЕЦ КАК Организация,
	|	УдержанияРаботниковОрганизации.ФизЛицо КАК ФизЛицо,
	|	УдержанияРаботниковОрганизации.ВидРасчета,
	|	УдержанияРаботниковОрганизации.Результат,
	|	ЗНАЧЕНИЕ(Справочник.Контрагенты.ПустаяСсылка) КАК Контрагент,
	|	ВЫБОР
	|		КОГДА УдержанияРаботниковОрганизации.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА УдержанияРаботниковОрганизации.СпособОтраженияВБухучете
	|		ИНАЧЕ УдержанияРаботниковОрганизации.Ссылка.СпособОтраженияВБухучете
	|	КОНЕЦ КАК СпособОтраженияВБухучете,
	|	NULL КАК ДокументОснование,
	|	&парамКонецМесяца КАК БазовыйПериодКонец
	|
	|ПОМЕСТИТЬ ВТ_УдержанияРаботниковОрганизаций
	|ИЗ
	|	Документ.РегистрацияРазовыхУдержанийРаботниковОрганизаций.Удержания КАК УдержанияРаботниковОрганизации
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТСписокФизЛиц КАК СписокФизЛиц
	|		ПО УдержанияРаботниковОрганизации.ФизЛицо = СписокФизЛиц.ФизЛицо
	|
	|ГДЕ
 	|	УдержанияРаботниковОрганизации.Ссылка.Организация = &парамОрганизация И
 	|	УдержанияРаботниковОрганизации.Ссылка.ПериодРегистрации = &парамНачалоМесяца И
 	|	УдержанияРаботниковОрганизации.Ссылка.Проведен И
 	|	УдержанияРаботниковОрганизации.Результат <> 0
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	ВЫБОР
	|		КОГДА УдержанияРаботниковОрганизации.Ссылка.Организация.ГоловнаяОрганизация = &парамПустаяОрганизация
	|			ТОГДА УдержанияРаботниковОрганизации.Ссылка.Организация
	|		ИНАЧЕ УдержанияРаботниковОрганизации.Ссылка.Организация.ГоловнаяОрганизация
	|	КОНЕЦ КАК Организация,
	|	УдержанияРаботниковОрганизации.ФизЛицо,
	|	УдержанияРаботниковОрганизации.ВидРасчета,
	|	УдержанияРаботниковОрганизации.Результат,
	|	УдержанияРаботниковОрганизации.ДокументОснование.Получатель КАК Контрагент,
	|	&парамПустойСпособБУ КАК СпособОтраженияВБухучете,
	|	ВЫБОР
	|		КОГДА УдержанияРаботниковОрганизации.ДокументОснование.Ссылка ЕСТЬ NULL
	|			ТОГДА NULL
	|		ИНАЧЕ УдержанияРаботниковОрганизации.ДокументОснование
	|	КОНЕЦ КАК ДокументОснование,
	|	&парамКонецМесяца КАК БазовыйПериодКонец
	|ИЗ
	|	Документ.РасчетУдержанийРаботниковОрганизаций.Удержания КАК УдержанияРаботниковОрганизации
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТСписокФизЛиц КАК СписокФизЛиц
	|		ПО УдержанияРаботниковОрганизации.ФизЛицо = СписокФизЛиц.ФизЛицо
	|
	|ГДЕ
 	|	УдержанияРаботниковОрганизации.Ссылка.Организация = &парамОрганизация И
 	|	УдержанияРаботниковОрганизации.Ссылка.ПериодРегистрации = &парамНачалоМесяца И
 	|	УдержанияРаботниковОрганизации.Ссылка.Проведен И
 	|	УдержанияРаботниковОрганизации.Результат <> 0
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	ВЫБОР
	|		КОГДА РасчетЕПУдержанияРаботниковОрганизации.Ссылка.Организация.ГоловнаяОрганизация = &парамПустаяОрганизация
	|			ТОГДА РасчетЕПУдержанияРаботниковОрганизации.Ссылка.Организация
	|		ИНАЧЕ РасчетЕПУдержанияРаботниковОрганизации.Ссылка.Организация.ГоловнаяОрганизация
	|	КОНЕЦ КАК Организация,
	|	РасчетЕПУдержанияРаботниковОрганизации.ФизЛицо,
	|	РасчетЕПУдержанияРаботниковОрганизации.ВидРасчета,
	|	РасчетЕПУдержанияРаботниковОрганизации.Результат,
	|	РасчетЕПУдержанияРаботниковОрганизации.ДокументОснование.Получатель КАК Контрагент,
	|	&парамПустойСпособБУ КАК СпособОтраженияВБухучете,
	|	ВЫБОР
	|		КОГДА РасчетЕПУдержанияРаботниковОрганизации.ДокументОснование.Ссылка ЕСТЬ NULL
	|			ТОГДА NULL
	|		ИНАЧЕ РасчетЕПУдержанияРаботниковОрганизации.ДокументОснование
	|	КОНЕЦ КАК ДокументОснование,
	|	&парамКонецМесяца КАК БазовыйПериодКонец
	|ИЗ
	|	Документ.РасчетЕдиногоПлатежа.Удержания КАК РасчетЕПУдержанияРаботниковОрганизации
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТСписокФизЛиц КАК СписокФизЛиц
	|		ПО РасчетЕПУдержанияРаботниковОрганизации.ФизЛицо = СписокФизЛиц.ФизЛицо
	|
	|ГДЕ
 	|	РасчетЕПУдержанияРаботниковОрганизации.Ссылка.Организация = &парамОрганизация И
 	|	РасчетЕПУдержанияРаботниковОрганизации.Ссылка.ПериодРегистрации = &парамНачалоМесяца И
 	|	РасчетЕПУдержанияРаботниковОрганизации.Ссылка.Проведен И
 	|	РасчетЕПУдержанияРаботниковОрганизации.Результат <> 0
 	|
 	|ИНДЕКСИРОВАТЬ ПО
 	|	ФизЛицо,
 	|	ВидРасчета,
 	|	Организация                 
	|";
                                    
	Запрос.Текст = УдержанияРаботниковОрганизацийТекст;
	Запрос.Выполнить();

	// СведенияОбУдержанияхСрез
	//	Поля:
	//		ФизЛицо
	//		ВидРасчета
	//		Период
	// Описание:
 	// вспомогательная таблица для получения среза последних значений в регистре УдержанияРаботниковОрганизации
	//

	СведенияОбУдержанияхСрезТекст = 
	"ВЫБРАТЬ РАЗРЕШЕННЫЕ
 	|	УдержанияРаботниковОрганизации.ФизЛицо КАК ФизЛицо,
 	|	УдержанияРаботниковОрганизации.ВидРасчета КАК ВидРасчета,
	|	МАКСИМУМ(ПлановыеУдержанияРаботниковОрганизаций.Период) КАК Период,
	|	УдержанияРаботниковОрганизации.ДокументОснование
	|
	|ПОМЕСТИТЬ ВТ_СведенияОбУдержанияхСрез
	|ИЗ
 	|	ВТ_УдержанияРаботниковОрганизаций КАК УдержанияРаботниковОрганизации
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ПлановыеУдержанияРаботниковОрганизаций КАК ПлановыеУдержанияРаботниковОрганизаций
	|		ПО УдержанияРаботниковОрганизации.ФизЛицо = ПлановыеУдержанияРаботниковОрганизаций.ФизЛицо
	|			И УдержанияРаботниковОрганизации.ВидРасчета = ПлановыеУдержанияРаботниковОрганизаций.ВидРасчета
	|			И УдержанияРаботниковОрганизации.Организация = ПлановыеУдержанияРаботниковОрганизаций.Организация
	|			И ВЫБОР
	|				КОГДА НЕ (УдержанияРаботниковОрганизации.ДокументОснование ЕСТЬ NULL)
	|					ТОГДА УдержанияРаботниковОрганизации.ДокументОснование = ПлановыеУдержанияРаботниковОрганизаций.ДокументОснование
	|				ИНАЧЕ ИСТИНА
	|			КОНЕЦ
	|			И ПлановыеУдержанияРаботниковОрганизаций.Период <= УдержанияРаботниковОрганизации.БазовыйПериодКонец
	|			И ПлановыеУдержанияРаботниковОрганизаций.Активность
	|
	|СГРУППИРОВАТЬ ПО
 	|	УдержанияРаботниковОрганизации.ФизЛицо,
 	|	УдержанияРаботниковОрганизации.ВидРасчета,
	|	УдержанияРаботниковОрганизации.ДокументОснование
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	ФизЛицо,
	|	ВидРасчета
	|";                                           

	Запрос.Текст = СведенияОбУдержанияхСрезТекст;
	Запрос.Выполнить();

	// ДанныеУчета
	//	Поля:
	//		ФизЛицо
	//		ДокументОснование
	//		СчетДт
	//		СчетКт
	//		СубконтоДт1
	//		СубконтоДт2
	//		СубконтоДт3
	//		СубконтоКт1
	//		СубконтоКт2
	//		СубконтоКт3
	//		Результат
	// Описание:
	// таблица строится по регистру расчета удержаний с присоединением данных о бухучете
	//
	ДанныеУчетаТекст = 
	"ВЫБРАТЬ РАЗРЕШЕННЫЕ
 	|	УдержанияРаботниковОрганизации.ФизЛицо КАК ФизЛицо,
 	|	УдержанияРаботниковОрганизации.ДокументОснование КАК ДокументОснование,
 	|	УдержанияРаботниковОрганизации.Контрагент КАК Контрагент,
 	|	УдержанияРаботниковОрганизации.ВидРасчета КАК ВидРасчета,
	|	ВЫБОР
	|		КОГДА УдержанияРаботниковОрганизации.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА УдержанияРаботниковОрганизации.СпособОтраженияВБухучете
	|		КОГДА ВЫБОР
	|				КОГДА ПлановыеУдержанияРаботниковОрганизаций.ПериодЗавершения <> &НачальнаяДата
	|						И ПлановыеУдержанияРаботниковОрганизаций.ПериодЗавершения < УдержанияРаботниковОрганизации.БазовыйПериодКонец
	|					ТОГДА ПлановыеУдержанияРаботниковОрганизаций.СпособОтраженияВБухучетеЗавершения
	|				ИНАЧЕ ПлановыеУдержанияРаботниковОрганизаций.СпособОтраженияВБухучете
	|			КОНЕЦ <> &парамПустойСпособБУ
	|			ТОГДА ВЫБОР
	|					КОГДА ПлановыеУдержанияРаботниковОрганизаций.ПериодЗавершения <> &НачальнаяДата
	|							И ПлановыеУдержанияРаботниковОрганизаций.ПериодЗавершения < УдержанияРаботниковОрганизации.БазовыйПериодКонец
	|						ТОГДА ПлановыеУдержанияРаботниковОрганизаций.СпособОтраженияВБухучетеЗавершения
	|					ИНАЧЕ ПлановыеУдержанияРаботниковОрганизаций.СпособОтраженияВБухучете
	|				КОНЕЦ
	|		КОГДА УдержанияРаботниковОрганизации.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА УдержанияРаботниковОрганизации.ВидРасчета.СпособОтраженияВБухучете
	|	КОНЕЦ КАК СпособОтраженияВБухучете,
	|	ВЫБОР
	|		КОГДА УдержанияРаботниковОрганизации.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА УдержанияРаботниковОрганизации.СпособОтраженияВБухучете.СчетДт
	|		КОГДА ВЫБОР
	|				КОГДА ПлановыеУдержанияРаботниковОрганизаций.ПериодЗавершения <> &НачальнаяДата
	|						И ПлановыеУдержанияРаботниковОрганизаций.ПериодЗавершения < УдержанияРаботниковОрганизации.БазовыйПериодКонец	
	|					ТОГДА ПлановыеУдержанияРаботниковОрганизаций.СпособОтраженияВБухучетеЗавершения
	|				ИНАЧЕ ПлановыеУдержанияРаботниковОрганизаций.СпособОтраженияВБухучете
	|			КОНЕЦ <> &парамПустойСпособБУ
	|			ТОГДА ВЫБОР
	|					КОГДА ПлановыеУдержанияРаботниковОрганизаций.ПериодЗавершения <> &НачальнаяДата
	|							И ПлановыеУдержанияРаботниковОрганизаций.ПериодЗавершения < УдержанияРаботниковОрганизации.БазовыйПериодКонец		
	|						ТОГДА ПлановыеУдержанияРаботниковОрганизаций.СпособОтраженияВБухучетеЗавершения.СчетДт
	|					ИНАЧЕ ПлановыеУдержанияРаботниковОрганизаций.СпособОтраженияВБухучете.СчетДт
	|				КОНЕЦ
	|		КОГДА УдержанияРаботниковОрганизации.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА УдержанияРаботниковОрганизации.ВидРасчета.СпособОтраженияВБухучете.СчетДт
	|	КОНЕЦ КАК СчетДт,
	|	ВЫБОР
	|		КОГДА УдержанияРаботниковОрганизации.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА УдержанияРаботниковОрганизации.СпособОтраженияВБухучете.СчетКт
	|		КОГДА ВЫБОР
	|				КОГДА ПлановыеУдержанияРаботниковОрганизаций.ПериодЗавершения <> &НачальнаяДата
	|						И ПлановыеУдержанияРаботниковОрганизаций.ПериодЗавершения < УдержанияРаботниковОрганизации.БазовыйПериодКонец		
	|					ТОГДА ПлановыеУдержанияРаботниковОрганизаций.СпособОтраженияВБухучетеЗавершения
	|				ИНАЧЕ ПлановыеУдержанияРаботниковОрганизаций.СпособОтраженияВБухучете
	|			КОНЕЦ <> &парамПустойСпособБУ
	|			ТОГДА ВЫБОР
	|					КОГДА ПлановыеУдержанияРаботниковОрганизаций.ПериодЗавершения <> &НачальнаяДата
	|							И ПлановыеУдержанияРаботниковОрганизаций.ПериодЗавершения < УдержанияРаботниковОрганизации.БазовыйПериодКонец		
	|						ТОГДА ПлановыеУдержанияРаботниковОрганизаций.СпособОтраженияВБухучетеЗавершения.СчетКт
	|					ИНАЧЕ ПлановыеУдержанияРаботниковОрганизаций.СпособОтраженияВБухучете.СчетКт
	|				КОНЕЦ
	|		КОГДА УдержанияРаботниковОрганизации.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА УдержанияРаботниковОрганизации.ВидРасчета.СпособОтраженияВБухучете.СчетКт
	|	КОНЕЦ КАК СчетКт,
	|	ВЫБОР
	|		КОГДА УдержанияРаботниковОрганизации.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА УдержанияРаботниковОрганизации.СпособОтраженияВБухучете.СчетДтНУ
	|		КОГДА ВЫБОР
	|				КОГДА ПлановыеУдержанияРаботниковОрганизаций.ПериодЗавершения <> &НачальнаяДата
	|						И ПлановыеУдержанияРаботниковОрганизаций.ПериодЗавершения < УдержанияРаботниковОрганизации.БазовыйПериодКонец
	|					ТОГДА ПлановыеУдержанияРаботниковОрганизаций.СпособОтраженияВБухучетеЗавершения
	|				ИНАЧЕ ПлановыеУдержанияРаботниковОрганизаций.СпособОтраженияВБухучете
	|			КОНЕЦ <> &парамПустойСпособБУ
	|			ТОГДА ВЫБОР
	|					КОГДА ПлановыеУдержанияРаботниковОрганизаций.ПериодЗавершения <> &НачальнаяДата
	|							И ПлановыеУдержанияРаботниковОрганизаций.ПериодЗавершения < УдержанияРаботниковОрганизации.БазовыйПериодКонец
	|						ТОГДА ПлановыеУдержанияРаботниковОрганизаций.СпособОтраженияВБухучетеЗавершения.СчетДтНУ
	|					ИНАЧЕ ПлановыеУдержанияРаботниковОрганизаций.СпособОтраженияВБухучете.СчетДтНУ
	|				КОНЕЦ
	|		КОГДА УдержанияРаботниковОрганизации.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА УдержанияРаботниковОрганизации.ВидРасчета.СпособОтраженияВБухучете.СчетДтНУ
	|	КОНЕЦ КАК СчетДтНУ,
	|	ВЫБОР
	|		КОГДА УдержанияРаботниковОрганизации.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА УдержанияРаботниковОрганизации.СпособОтраженияВБухучете.СчетКтНУ
	|		КОГДА ВЫБОР
	|				КОГДА ПлановыеУдержанияРаботниковОрганизаций.ПериодЗавершения <> &НачальнаяДата
	|						И ПлановыеУдержанияРаботниковОрганизаций.ПериодЗавершения < УдержанияРаботниковОрганизации.БазовыйПериодКонец	
	|					ТОГДА ПлановыеУдержанияРаботниковОрганизаций.СпособОтраженияВБухучетеЗавершения
	|				ИНАЧЕ ПлановыеУдержанияРаботниковОрганизаций.СпособОтраженияВБухучете
	|			КОНЕЦ <> &парамПустойСпособБУ
	|			ТОГДА ВЫБОР
	|					КОГДА ПлановыеУдержанияРаботниковОрганизаций.ПериодЗавершения <> &НачальнаяДата
	|							И ПлановыеУдержанияРаботниковОрганизаций.ПериодЗавершения < УдержанияРаботниковОрганизации.БазовыйПериодКонец	
	|						ТОГДА ПлановыеУдержанияРаботниковОрганизаций.СпособОтраженияВБухучетеЗавершения.СчетКтНУ
	|					ИНАЧЕ ПлановыеУдержанияРаботниковОрганизаций.СпособОтраженияВБухучете.СчетКтНУ
	|				КОНЕЦ
	|		КОГДА УдержанияРаботниковОрганизации.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА УдержанияРаботниковОрганизации.ВидРасчета.СпособОтраженияВБухучете.СчетКтНУ
	|	КОНЕЦ КАК СчетКтНУ,
	|	ВЫБОР
	|		КОГДА УдержанияРаботниковОрганизации.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА УдержанияРаботниковОрганизации.СпособОтраженияВБухучете.СубконтоДт1
	|		КОГДА ВЫБОР
	|				КОГДА ПлановыеУдержанияРаботниковОрганизаций.ПериодЗавершения <> &НачальнаяДата
	|						И ПлановыеУдержанияРаботниковОрганизаций.ПериодЗавершения < УдержанияРаботниковОрганизации.БазовыйПериодКонец	
	|					ТОГДА ПлановыеУдержанияРаботниковОрганизаций.СпособОтраженияВБухучетеЗавершения
	|				ИНАЧЕ ПлановыеУдержанияРаботниковОрганизаций.СпособОтраженияВБухучете
	|			КОНЕЦ <> &парамПустойСпособБУ
	|			ТОГДА ВЫБОР
	|					КОГДА ПлановыеУдержанияРаботниковОрганизаций.ПериодЗавершения <> &НачальнаяДата
	|							И ПлановыеУдержанияРаботниковОрганизаций.ПериодЗавершения < УдержанияРаботниковОрганизации.БазовыйПериодКонец	
	|						ТОГДА ПлановыеУдержанияРаботниковОрганизаций.СпособОтраженияВБухучетеЗавершения.СубконтоДт1
	|					ИНАЧЕ ПлановыеУдержанияРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДт1
	|				КОНЕЦ
	|		КОГДА УдержанияРаботниковОрганизации.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА УдержанияРаботниковОрганизации.ВидРасчета.СпособОтраженияВБухучете.СубконтоДт1
	|	КОНЕЦ КАК СубконтоДт1,
	|	ВЫБОР
	|		КОГДА УдержанияРаботниковОрганизации.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА УдержанияРаботниковОрганизации.СпособОтраженияВБухучете.СубконтоДт2
	|		КОГДА ВЫБОР
	|				КОГДА ПлановыеУдержанияРаботниковОрганизаций.ПериодЗавершения <> &НачальнаяДата
	|						И ПлановыеУдержанияРаботниковОрганизаций.ПериодЗавершения < УдержанияРаботниковОрганизации.БазовыйПериодКонец	
	|					ТОГДА ПлановыеУдержанияРаботниковОрганизаций.СпособОтраженияВБухучетеЗавершения
	|				ИНАЧЕ ПлановыеУдержанияРаботниковОрганизаций.СпособОтраженияВБухучете
	|			КОНЕЦ <> &парамПустойСпособБУ
	|			ТОГДА ВЫБОР
	|					КОГДА ПлановыеУдержанияРаботниковОрганизаций.ПериодЗавершения <> &НачальнаяДата
	|							И ПлановыеУдержанияРаботниковОрганизаций.ПериодЗавершения < УдержанияРаботниковОрганизации.БазовыйПериодКонец	
	|						ТОГДА ПлановыеУдержанияРаботниковОрганизаций.СпособОтраженияВБухучетеЗавершения.СубконтоДт2
	|					ИНАЧЕ ПлановыеУдержанияРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДт2
	|				КОНЕЦ
	|		КОГДА УдержанияРаботниковОрганизации.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА УдержанияРаботниковОрганизации.ВидРасчета.СпособОтраженияВБухучете.СубконтоДт2
	|	КОНЕЦ КАК СубконтоДт2,
	|	ВЫБОР
	|		КОГДА УдержанияРаботниковОрганизации.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА УдержанияРаботниковОрганизации.СпособОтраженияВБухучете.СубконтоДт3
	|		КОГДА ВЫБОР
	|				КОГДА ПлановыеУдержанияРаботниковОрганизаций.ПериодЗавершения <> &НачальнаяДата
	|						И ПлановыеУдержанияРаботниковОрганизаций.ПериодЗавершения < УдержанияРаботниковОрганизации.БазовыйПериодКонец
	|					ТОГДА ПлановыеУдержанияРаботниковОрганизаций.СпособОтраженияВБухучетеЗавершения
	|				ИНАЧЕ ПлановыеУдержанияРаботниковОрганизаций.СпособОтраженияВБухучете
	|			КОНЕЦ <> &парамПустойСпособБУ
	|			ТОГДА ВЫБОР
	|					КОГДА ПлановыеУдержанияРаботниковОрганизаций.ПериодЗавершения <> &НачальнаяДата
	|							И ПлановыеУдержанияРаботниковОрганизаций.ПериодЗавершения < УдержанияРаботниковОрганизации.БазовыйПериодКонец
	|						ТОГДА ПлановыеУдержанияРаботниковОрганизаций.СпособОтраженияВБухучетеЗавершения.СубконтоДт3
	|					ИНАЧЕ ПлановыеУдержанияРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДт3
	|				КОНЕЦ
	|		КОГДА УдержанияРаботниковОрганизации.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА УдержанияРаботниковОрганизации.ВидРасчета.СпособОтраженияВБухучете.СубконтоДт3
	|	КОНЕЦ КАК СубконтоДт3,
	|	ВЫБОР
	|		КОГДА УдержанияРаботниковОрганизации.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА УдержанияРаботниковОрганизации.СпособОтраженияВБухучете.СубконтоДтНУ1
	|		КОГДА ВЫБОР
	|				КОГДА ПлановыеУдержанияРаботниковОрганизаций.ПериодЗавершения <> &НачальнаяДата
	|						И ПлановыеУдержанияРаботниковОрганизаций.ПериодЗавершения < УдержанияРаботниковОрганизации.БазовыйПериодКонец
	|					ТОГДА ПлановыеУдержанияРаботниковОрганизаций.СпособОтраженияВБухучетеЗавершения
	|				ИНАЧЕ ПлановыеУдержанияРаботниковОрганизаций.СпособОтраженияВБухучете
	|			КОНЕЦ <> &парамПустойСпособБУ
	|			ТОГДА ВЫБОР
	|					КОГДА ПлановыеУдержанияРаботниковОрганизаций.ПериодЗавершения <> &НачальнаяДата
	|							И ПлановыеУдержанияРаботниковОрганизаций.ПериодЗавершения < УдержанияРаботниковОрганизации.БазовыйПериодКонец
	|						ТОГДА ПлановыеУдержанияРаботниковОрганизаций.СпособОтраженияВБухучетеЗавершения.СубконтоДтНУ1
	|					ИНАЧЕ ПлановыеУдержанияРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДтНУ1
	|				КОНЕЦ
	|		КОГДА УдержанияРаботниковОрганизации.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА УдержанияРаботниковОрганизации.ВидРасчета.СпособОтраженияВБухучете.СубконтоДтНУ1
	|	КОНЕЦ КАК СубконтоДтНУ1,
	|	ВЫБОР
	|		КОГДА УдержанияРаботниковОрганизации.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА УдержанияРаботниковОрганизации.СпособОтраженияВБухучете.СубконтоДтНУ2
	|		КОГДА ВЫБОР
	|				КОГДА ПлановыеУдержанияРаботниковОрганизаций.ПериодЗавершения <> &НачальнаяДата
	|						И ПлановыеУдержанияРаботниковОрганизаций.ПериодЗавершения < УдержанияРаботниковОрганизации.БазовыйПериодКонец
	|					ТОГДА ПлановыеУдержанияРаботниковОрганизаций.СпособОтраженияВБухучетеЗавершения
	|				ИНАЧЕ ПлановыеУдержанияРаботниковОрганизаций.СпособОтраженияВБухучете
	|			КОНЕЦ <> &парамПустойСпособБУ
	|			ТОГДА ВЫБОР
	|					КОГДА ПлановыеУдержанияРаботниковОрганизаций.ПериодЗавершения <> &НачальнаяДата
	|							И ПлановыеУдержанияРаботниковОрганизаций.ПериодЗавершения < УдержанияРаботниковОрганизации.БазовыйПериодКонец
	|						ТОГДА ПлановыеУдержанияРаботниковОрганизаций.СпособОтраженияВБухучетеЗавершения.СубконтоДтНУ2
	|					ИНАЧЕ ПлановыеУдержанияРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДтНУ2
	|				КОНЕЦ
	|		КОГДА УдержанияРаботниковОрганизации.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА УдержанияРаботниковОрганизации.ВидРасчета.СпособОтраженияВБухучете.СубконтоДтНУ2
	|	КОНЕЦ КАК СубконтоДтНУ2,
	|	ВЫБОР
	|		КОГДА УдержанияРаботниковОрганизации.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА УдержанияРаботниковОрганизации.СпособОтраженияВБухучете.СубконтоДтНУ3
	|		КОГДА ВЫБОР
	|				КОГДА ПлановыеУдержанияРаботниковОрганизаций.ПериодЗавершения <> &НачальнаяДата
	|						И ПлановыеУдержанияРаботниковОрганизаций.ПериодЗавершения < УдержанияРаботниковОрганизации.БазовыйПериодКонец
	|					ТОГДА ПлановыеУдержанияРаботниковОрганизаций.СпособОтраженияВБухучетеЗавершения
	|				ИНАЧЕ ПлановыеУдержанияРаботниковОрганизаций.СпособОтраженияВБухучете
	|			КОНЕЦ <> &парамПустойСпособБУ
	|			ТОГДА ВЫБОР
	|					КОГДА ПлановыеУдержанияРаботниковОрганизаций.ПериодЗавершения <> &НачальнаяДата
	|							И ПлановыеУдержанияРаботниковОрганизаций.ПериодЗавершения < УдержанияРаботниковОрганизации.БазовыйПериодКонец
	|						ТОГДА ПлановыеУдержанияРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДтНУ3
	|					ИНАЧЕ ПлановыеУдержанияРаботниковОрганизаций.СпособОтраженияВБухучетеЗавершения.СубконтоДтНУ3
	|				КОНЕЦ
	|		КОГДА УдержанияРаботниковОрганизации.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА УдержанияРаботниковОрганизации.ВидРасчета.СпособОтраженияВБухучете.СубконтоДтНУ3
	|	КОНЕЦ КАК СубконтоДтНУ3,
	|	ВЫБОР
	|		КОГДА УдержанияРаботниковОрганизации.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА УдержанияРаботниковОрганизации.СпособОтраженияВБухучете.СубконтоКт1
	|		КОГДА ВЫБОР
	|				КОГДА ПлановыеУдержанияРаботниковОрганизаций.ПериодЗавершения <> &НачальнаяДата
	|						И ПлановыеУдержанияРаботниковОрганизаций.ПериодЗавершения < УдержанияРаботниковОрганизации.БазовыйПериодКонец
	|					ТОГДА ПлановыеУдержанияРаботниковОрганизаций.СпособОтраженияВБухучетеЗавершения
	|				ИНАЧЕ ПлановыеУдержанияРаботниковОрганизаций.СпособОтраженияВБухучете
	|			КОНЕЦ <> &парамПустойСпособБУ
	|			ТОГДА ВЫБОР
	|					КОГДА ПлановыеУдержанияРаботниковОрганизаций.ПериодЗавершения <> &НачальнаяДата
	|							И ПлановыеУдержанияРаботниковОрганизаций.ПериодЗавершения < УдержанияРаботниковОрганизации.БазовыйПериодКонец
	|						ТОГДА ПлановыеУдержанияРаботниковОрганизаций.СпособОтраженияВБухучетеЗавершения.СубконтоКт1
	|					ИНАЧЕ ПлановыеУдержанияРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоКт1
	|				КОНЕЦ
	|		КОГДА УдержанияРаботниковОрганизации.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА УдержанияРаботниковОрганизации.ВидРасчета.СпособОтраженияВБухучете.СубконтоКт1
	|	КОНЕЦ КАК СубконтоКт1,
	|	ВЫБОР
	|		КОГДА УдержанияРаботниковОрганизации.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА УдержанияРаботниковОрганизации.СпособОтраженияВБухучете.СубконтоКт2
	|		КОГДА ВЫБОР
	|				КОГДА ПлановыеУдержанияРаботниковОрганизаций.ПериодЗавершения <> &НачальнаяДата
	|						И ПлановыеУдержанияРаботниковОрганизаций.ПериодЗавершения < УдержанияРаботниковОрганизации.БазовыйПериодКонец
	|					ТОГДА ПлановыеУдержанияРаботниковОрганизаций.СпособОтраженияВБухучетеЗавершения
	|				ИНАЧЕ ПлановыеУдержанияРаботниковОрганизаций.СпособОтраженияВБухучете
	|			КОНЕЦ <> &парамПустойСпособБУ
	|			ТОГДА ВЫБОР
	|					КОГДА ПлановыеУдержанияРаботниковОрганизаций.ПериодЗавершения <> &НачальнаяДата
	|							И ПлановыеУдержанияРаботниковОрганизаций.ПериодЗавершения < УдержанияРаботниковОрганизации.БазовыйПериодКонец
	|						ТОГДА ПлановыеУдержанияРаботниковОрганизаций.СпособОтраженияВБухучетеЗавершения.СубконтоКт2
	|					ИНАЧЕ ПлановыеУдержанияРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоКт2
	|				КОНЕЦ
	|		КОГДА УдержанияРаботниковОрганизации.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА УдержанияРаботниковОрганизации.ВидРасчета.СпособОтраженияВБухучете.СубконтоКт2
	|	КОНЕЦ КАК СубконтоКт2,
	|	ВЫБОР
	|		КОГДА УдержанияРаботниковОрганизации.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА УдержанияРаботниковОрганизации.СпособОтраженияВБухучете.СубконтоКт3
	|		КОГДА ВЫБОР
	|				КОГДА ПлановыеУдержанияРаботниковОрганизаций.ПериодЗавершения <> &НачальнаяДата
	|						И ПлановыеУдержанияРаботниковОрганизаций.ПериодЗавершения < УдержанияРаботниковОрганизации.БазовыйПериодКонец
	|					ТОГДА ПлановыеУдержанияРаботниковОрганизаций.СпособОтраженияВБухучетеЗавершения
	|				ИНАЧЕ ПлановыеУдержанияРаботниковОрганизаций.СпособОтраженияВБухучете
	|			КОНЕЦ <> &парамПустойСпособБУ
	|			ТОГДА ВЫБОР
	|					КОГДА ПлановыеУдержанияРаботниковОрганизаций.ПериодЗавершения <> &НачальнаяДата
	|							И ПлановыеУдержанияРаботниковОрганизаций.ПериодЗавершения < УдержанияРаботниковОрганизации.БазовыйПериодКонец
	|						ТОГДА ПлановыеУдержанияРаботниковОрганизаций.СпособОтраженияВБухучетеЗавершения.СубконтоКт3
	|					ИНАЧЕ ПлановыеУдержанияРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоКт3
	|				КОНЕЦ
	|		КОГДА УдержанияРаботниковОрганизации.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА УдержанияРаботниковОрганизации.ВидРасчета.СпособОтраженияВБухучете.СубконтоКт3
	|	КОНЕЦ КАК СубконтоКт3,
	|	ВЫБОР
	|		КОГДА УдержанияРаботниковОрганизации.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА УдержанияРаботниковОрганизации.СпособОтраженияВБухучете.СубконтоКтНУ1
	|		КОГДА ВЫБОР
	|				КОГДА ПлановыеУдержанияРаботниковОрганизаций.ПериодЗавершения <> &НачальнаяДата
	|						И ПлановыеУдержанияРаботниковОрганизаций.ПериодЗавершения < УдержанияРаботниковОрганизации.БазовыйПериодКонец
	|					ТОГДА ПлановыеУдержанияРаботниковОрганизаций.СпособОтраженияВБухучетеЗавершения
	|				ИНАЧЕ ПлановыеУдержанияРаботниковОрганизаций.СпособОтраженияВБухучете
	|			КОНЕЦ <> &парамПустойСпособБУ
	|			ТОГДА ВЫБОР
	|					КОГДА ПлановыеУдержанияРаботниковОрганизаций.ПериодЗавершения <> &НачальнаяДата
	|							И ПлановыеУдержанияРаботниковОрганизаций.ПериодЗавершения < УдержанияРаботниковОрганизации.БазовыйПериодКонец
	|						ТОГДА ПлановыеУдержанияРаботниковОрганизаций.СпособОтраженияВБухучетеЗавершения.СубконтоКтНУ1
	|					ИНАЧЕ ПлановыеУдержанияРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоКтНУ1
	|				КОНЕЦ
	|		КОГДА УдержанияРаботниковОрганизации.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА УдержанияРаботниковОрганизации.ВидРасчета.СпособОтраженияВБухучете.СубконтоКтНУ1
	|	КОНЕЦ КАК СубконтоКтНУ1,
	|	ВЫБОР
	|		КОГДА УдержанияРаботниковОрганизации.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА УдержанияРаботниковОрганизации.СпособОтраженияВБухучете.СубконтоКтНУ2
	|		КОГДА ВЫБОР
	|				КОГДА ПлановыеУдержанияРаботниковОрганизаций.ПериодЗавершения <> &НачальнаяДата
	|						И ПлановыеУдержанияРаботниковОрганизаций.ПериодЗавершения < УдержанияРаботниковОрганизации.БазовыйПериодКонец
	|					ТОГДА ПлановыеУдержанияРаботниковОрганизаций.СпособОтраженияВБухучетеЗавершения
	|				ИНАЧЕ ПлановыеУдержанияРаботниковОрганизаций.СпособОтраженияВБухучете
	|			КОНЕЦ <> &парамПустойСпособБУ
	|			ТОГДА ВЫБОР
	|					КОГДА ПлановыеУдержанияРаботниковОрганизаций.ПериодЗавершения <> &НачальнаяДата
	|							И ПлановыеУдержанияРаботниковОрганизаций.ПериодЗавершения < УдержанияРаботниковОрганизации.БазовыйПериодКонец
	|						ТОГДА ПлановыеУдержанияРаботниковОрганизаций.СпособОтраженияВБухучетеЗавершения.СубконтоКтНУ2
	|					ИНАЧЕ ПлановыеУдержанияРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоКтНУ2
	|				КОНЕЦ
	|		КОГДА УдержанияРаботниковОрганизации.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА УдержанияРаботниковОрганизации.ВидРасчета.СпособОтраженияВБухучете.СубконтоКтНУ2
	|	КОНЕЦ КАК СубконтоКтНУ2,
	|	ВЫБОР
	|		КОГДА УдержанияРаботниковОрганизации.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА УдержанияРаботниковОрганизации.СпособОтраженияВБухучете.СубконтоКтНУ3
	|		КОГДА ВЫБОР
	|				КОГДА ПлановыеУдержанияРаботниковОрганизаций.ПериодЗавершения <> &НачальнаяДата
	|						И ПлановыеУдержанияРаботниковОрганизаций.ПериодЗавершения < УдержанияРаботниковОрганизации.БазовыйПериодКонец
	|					ТОГДА ПлановыеУдержанияРаботниковОрганизаций.СпособОтраженияВБухучетеЗавершения
	|				ИНАЧЕ ПлановыеУдержанияРаботниковОрганизаций.СпособОтраженияВБухучете
	|			КОНЕЦ <> &парамПустойСпособБУ
	|			ТОГДА ВЫБОР
	|					КОГДА ПлановыеУдержанияРаботниковОрганизаций.ПериодЗавершения <> &НачальнаяДата
	|							И ПлановыеУдержанияРаботниковОрганизаций.ПериодЗавершения < УдержанияРаботниковОрганизации.БазовыйПериодКонец
	|						ТОГДА ПлановыеУдержанияРаботниковОрганизаций.СпособОтраженияВБухучетеЗавершения.СубконтоКтНУ3
	|					ИНАЧЕ ПлановыеУдержанияРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоКтНУ3
	|				КОНЕЦ
	|		КОГДА УдержанияРаботниковОрганизации.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА УдержанияРаботниковОрганизации.ВидРасчета.СпособОтраженияВБухучете.СубконтоКтНУ3
	|	КОНЕЦ КАК СубконтоКтНУ3,
 	|	УдержанияРаботниковОрганизации.Результат КАК Результат
 	|
 	|ПОМЕСТИТЬ ВТ_ДанныеУчетаУдержания
	|ИЗ
 	|	ВТ_УдержанияРаботниковОрганизаций КАК УдержанияРаботниковОрганизации
 	|
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТ_СведенияОбУдержанияхСрез КАК СведенияОбУдержанияхСрез
	|		ПО СведенияОбУдержанияхСрез.ФизЛицо = УдержанияРаботниковОрганизации.ФизЛицо 
	|			И СведенияОбУдержанияхСрез.ВидРасчета = УдержанияРаботниковОрганизации.ВидРасчета
	|			И ВЫБОР
	|				КОГДА НЕ (УдержанияРаботниковОрганизации.ДокументОснование ЕСТЬ NULL) 
	|					ТОГДА СведенияОбУдержанияхСрез.ДокументОснование = УдержанияРаботниковОрганизации.ДокументОснование
	|				ИНАЧЕ ИСТИНА
	|			КОНЕЦ
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ПлановыеУдержанияРаботниковОрганизаций КАК ПлановыеУдержанияРаботниковОрганизаций
 	|		ПО ПлановыеУдержанияРаботниковОрганизаций.ФизЛицо = СведенияОбУдержанияхСрез.ФизЛицо
	|			И ПлановыеУдержанияРаботниковОрганизаций.ВидРасчета = СведенияОбУдержанияхСрез.ВидРасчета
	|			И ПлановыеУдержанияРаботниковОрганизаций.Организация = УдержанияРаботниковОрганизации.Организация
	|			И ВЫБОР
	|				КОГДА НЕ(УдержанияРаботниковОрганизации.ДокументОснование ЕСТЬ NULL)
	|					ТОГДА ПлановыеУдержанияРаботниковОрганизаций.ДокументОснование = СведенияОбУдержанияхСрез.ДокументОснование
	|				ИНАЧЕ ИСТИНА
	|			КОНЕЦ
	|			И СведенияОбУдержанияхСрез.Период = ПлановыеУдержанияРаботниковОрганизаций.Период
	|			И ПлановыеУдержанияРаботниковОрганизаций.Активность
	|ИНДЕКСИРОВАТЬ ПО
	|	СчетДт,
	|	СчетКт,
	|	СчетДтНУ,
	|	СчетКтНУ
 	|";

	Запрос.Текст = ДанныеУчетаТекст;
	Запрос.Выполнить();                            

	// ОтражениеВБухучете                        
	//	Поля:
	//		СчетДт,
	//		СчетКт,
	//		СубконтоДт1,
	//		СубконтоДт2,
	//		СубконтоДт3,
	//		СубконтоКт1,
	//		СубконтоКт2,
	//		СубконтоКт3,
	//		Результат,
	//		Контрагент,
	//		ФизЛицо,
	//		НомерСубконтоРаботникиДт,
 	//		НомерСубконтоРаботникиКт,
 	//		НомерСубконтоКонтрагентыКт 	
	//

	ОтражениеВБухучетеТекст = 
	"ВЫБРАТЬ РАЗРЕШЕННЫЕ
	|	ДанныеУчета.СчетДт,
	|	ДанныеУчета.СчетДтНУ,
	|	ДанныеУчета.СчетКт,
	|	ДанныеУчета.СчетКтНУ,
	|	ДанныеУчета.СубконтоДт1,
	|	ДанныеУчета.СубконтоДт2,
	|	ДанныеУчета.СубконтоДт3,
	|	ДанныеУчета.СубконтоДтНУ1,
	|	ДанныеУчета.СубконтоДтНУ2,
	|	ДанныеУчета.СубконтоДтНУ3,
	|	ДанныеУчета.СубконтоКт1,
	|	ДанныеУчета.СубконтоКт2,
	|	ДанныеУчета.СубконтоКт3,
	|	ДанныеУчета.СубконтоКтНУ1,
	|	ДанныеУчета.СубконтоКтНУ2,
	|	ДанныеУчета.СубконтоКтНУ3,
	|	ДанныеУчета.Результат,	
	|	ДанныеУчета.ФизЛицо,
	|	ДанныеУчета.Контрагент,
	|	ДанныеУчета.ВидРасчета,
	|	ЕСТЬNULL(ВидыСубконтоРаботникиОрганизацийДт.НомерСтроки, 0) КАК НомерСубконтоРаботникиОрганизацийДт,
 	|	ЕСТЬNULL(ВидыСубконтоРаботникиОрганизацийКт.НомерСтроки, 0) КАК НомерСубконтоРаботникиОрганизацийКт,
 	|	ЕСТЬNULL(ВидыСубконтоКонтрагентыКт.НомерСтроки, 0) КАК НомерСубконтоКонтрагентыКт,
 	|   ЕСТЬNULL(ВидыСубконтоДебиторыКредиторыОрганизацииКт.НомерСтроки, 0) КАК НомерСубконтоДебиторыКредиторыОрганизацииКт,
	|	ЕСТЬNULL(ВидыСубконтоРаботникиОрганизацийДтНУ.НомерСтроки, 0) КАК НомерСубконтоРаботникиОрганизацийДтНУ,
 	|	ЕСТЬNULL(ВидыСубконтоРаботникиОрганизацийКтНУ.НомерСтроки, 0) КАК НомерСубконтоРаботникиОрганизацийКтНУ,
 	|	ЕСТЬNULL(ВидыСубконтоКонтрагентыКтНУ.НомерСтроки, 0) КАК НомерСубконтоКонтрагентыКтНУ
	|
	|ИЗ
	|	ВТ_ДанныеУчетаУдержания КАК ДанныеУчета
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Типовой.ВидыСубконто КАК ВидыСубконтоРаботникиОрганизацийДт
	|		ПО (ДанныеУчета.СчетДт <> &парамПустойСчет) 
	|			И ДанныеУчета.СчетДт = ВидыСубконтоРаботникиОрганизацийДт.Ссылка 
	|			И (ВидыСубконтоРаботникиОрганизацийДт.ВидСубконто = &парамВидСубконтоРаботникиОрганизаций)
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Типовой.ВидыСубконто КАК ВидыСубконтоРаботникиОрганизацийКт
	|		ПО (ДанныеУчета.СчетКт <> &парамПустойСчет) 
	|			И ДанныеУчета.СчетКт = ВидыСубконтоРаботникиОрганизацийКт.Ссылка 
	|			И (ВидыСубконтоРаботникиОрганизацийКт.ВидСубконто = &парамВидСубконтоРаботникиОрганизаций)
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Типовой.ВидыСубконто КАК ВидыСубконтоДебиторыКредиторыОрганизацииКт
	|		ПО (ДанныеУчета.СчетКт <> &парамПустойСчет) 
	|			И ДанныеУчета.СчетКт = ВидыСубконтоДебиторыКредиторыОрганизацииКт.Ссылка 
	|			И (ВидыСубконтоДебиторыКредиторыОрганизацииКт.ВидСубконто = &парамВидСубконтоДебиторыКредиторыОрганизации)
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Типовой.ВидыСубконто КАК ВидыСубконтоКонтрагентыКт
	|		ПО (ДанныеУчета.СчетКт <> &парамПустойСчет) 
	|			И ДанныеУчета.СчетКт = ВидыСубконтоКонтрагентыКт.Ссылка 
	|			И (ВидыСубконтоКонтрагентыКт.ВидСубконто = &парамВидСубконтоКонтрагенты)
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Налоговый.ВидыСубконто КАК ВидыСубконтоРаботникиОрганизацийДтНУ
	|		ПО (ДанныеУчета.СчетДтНУ <> &парамПустойСчетНУ) 
	|			И ДанныеУчета.СчетДтНУ = ВидыСубконтоРаботникиОрганизацийДтНУ.Ссылка 
	|			И (ВидыСубконтоРаботникиОрганизацийДтНУ.ВидСубконто = &парамВидСубконтоРаботникиОрганизаций)
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Налоговый.ВидыСубконто КАК ВидыСубконтоРаботникиОрганизацийКтНУ
	|		ПО (ДанныеУчета.СчетКтНУ <> &парамПустойСчетНУ) 
	|			И ДанныеУчета.СчетКтНУ = ВидыСубконтоРаботникиОрганизацийКтНУ.Ссылка 
	|			И (ВидыСубконтоРаботникиОрганизацийКтНУ.ВидСубконто = &парамВидСубконтоРаботникиОрганизаций)
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Налоговый.ВидыСубконто КАК ВидыСубконтоКонтрагентыКтНУ
	|		ПО (ДанныеУчета.СчетКтНУ <> &парамПустойСчетНУ) 
	|			И ДанныеУчета.СчетКтНУ = ВидыСубконтоКонтрагентыКтНУ.Ссылка 
	|			И (ВидыСубконтоКонтрагентыКтНУ.ВидСубконто = &парамВидСубконтоКонтрагенты)
	|
	|ГДЕ
	|	ЕСТЬNULL(ДанныеУчета.СпособОтраженияВБухучете, &парамПустойСпособБУ) <> &парамСпособНеОтражать
	|";

	Запрос.Текст = ОтражениеВБухучетеТекст;
	
	РезультатЗапроса = Запрос.Выполнить();
	Выборка = РезультатЗапроса.Выбрать();
    
	// переносим в табличную часть, выполням автоподставновку субконто
	Пока Выборка.Следующий() Цикл
		Строка = ПромежуточнаяТаблица.Добавить();
		Строка.СчетДт 			= Выборка.СчетДт;
		Строка.СчетДтНУ			= Выборка.СчетДтНУ;
		Строка.СчетКт 			= Выборка.СчетКт;
		Строка.СчетКтНУ 		= Выборка.СчетКтНУ;
		Для Сч = 1 По 3 Цикл
			Если НЕ ЗначениеЗаполнено(Выборка["СубконтоДт"+Сч]) Тогда
				Если Выборка.НомерСубконтоРаботникиОрганизацийДт = Сч Тогда
					Строка["СубконтоДт"+Сч] = Выборка.ФизЛицо;
				КонецЕсли;
			Иначе
				Строка["СубконтоДт"+Сч] = Выборка["СубконтоДт"+Сч];
			КонецЕсли;
			
			Если НЕ ЗначениеЗаполнено(Выборка["СубконтоКт"+Сч]) Тогда
				Если Выборка.НомерСубконтоРаботникиОрганизацийКт = Сч Тогда
					Строка["СубконтоКт"+Сч] = Выборка.ФизЛицо;
				ИначеЕсли Выборка.НомерСубконтоКонтрагентыКт = Сч Тогда
					Строка["СубконтоКт"+Сч] = Выборка.Контрагент;
				ИначеЕсли Выборка.НомерСубконтоДебиторыКредиторыОрганизацииКт = Сч Тогда
					Строка["СубконтоКт"+Сч] = Выборка.ФизЛицо;
				КонецЕсли;				
			Иначе
				Строка["СубконтоКт"+Сч] = Выборка["СубконтоКт"+Сч];
			КонецЕсли;
			
			// тоже по налоговому учету
			Если НЕ ЗначениеЗаполнено(Выборка["СубконтоДтНУ"+Сч]) Тогда
				Если Выборка.НомерСубконтоРаботникиОрганизацийДтНУ = Сч Тогда
					Строка["СубконтоДтНУ"+Сч] = Выборка.ФизЛицо;
				КонецЕсли;
			Иначе
				Строка["СубконтоДтНУ"+Сч] = Выборка["СубконтоДтНУ"+Сч];
			КонецЕсли;
			
			Если НЕ ЗначениеЗаполнено(Выборка["СубконтоКтНУ"+Сч]) Тогда
				Если Выборка.НомерСубконтоРаботникиОрганизацийКтНУ = Сч Тогда
					Строка["СубконтоКтНУ"+Сч] = Выборка.ФизЛицо;
				ИначеЕсли Выборка.НомерСубконтоКонтрагентыКтНУ = Сч Тогда
					Строка["СубконтоКтНУ"+Сч] = Выборка.Контрагент;
				КонецЕсли;				
			Иначе
				Строка["СубконтоКтНУ"+Сч] = Выборка["СубконтоКтНУ"+Сч];
			КонецЕсли;
		КонецЦикла;		
		Строка.Сумма					= Выборка.Результат;
		
		Строка.ФизЛицо 					= Выборка.ФизЛицо;
		Строка.ВидРасчета				= Выборка.ВидРасчета;
		// Поскольку список работников формируется по СП шапки, делаем вывод что это СП является основным местом работы сотрудника
		Строка.СтруктурноеПодразделениеДт	= Параметры.СтруктурноеПодразделение;
		Строка.СтруктурноеПодразделениеКт	= Параметры.СтруктурноеПодразделение;
	КонецЦикла;
	
#КонецОбласти	


#Область ОПВПоСотрудникам
	
	ОПВИсчисленныйТекст = 
	"ВЫБРАТЬ РАЗРЕШЕННЫЕ
	|	ОПВРасчетыСФондами.ФизЛицо,
	|	ВЫБОР
	|		КОГДА ОПВРасчетыСФондами.ПодразделениеОрганизации <> ЗНАЧЕНИЕ(Справочник.ПодразделенияОрганизаций.ПустаяСсылка)
	|			ТОГДА ОПВРасчетыСФондами.ПодразделениеОрганизации
	|		ИНАЧЕ РаботникиОрганизации.ПодразделениеОрганизации
	|	КОНЕЦ КАК ПодразделениеОрганизации,	
	|	ОПВРасчетыСФондами.ВидПлатежа,
	|	СУММА(ОПВРасчетыСФондами.Взнос) КАК Взнос,
	|	ВЫБОР
	|		КОГДА РасчетПениОПВиСО.СчетЗатратБУ ЕСТЬ NULL ИЛИ РасчетПениОПВиСО.СчетЗатратБУ = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
	|			ТОГДА &парамСчетДтДляПени
	|		ИНАЧЕ РасчетПениОПВиСО.СчетЗатратБУ
	|	КОНЕЦ КАК СчетДтДляПени,
	|	ВЫБОР
	|		КОГДА РасчетПениОПВиСО.СчетЗатратБУ ЕСТЬ NULL ИЛИ РасчетПениОПВиСО.СчетЗатратБУ = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
	|			ТОГДА НЕОПРЕДЕЛЕНО
	|		ИНАЧЕ ЕСТЬNULL(РасчетПениОПВиСО.СубконтоЗатратБУ1, НЕОПРЕДЕЛЕНО)  
	|	КОНЕЦ КАК СубконтоДтДляПени1,
	|	ВЫБОР
	|		КОГДА РасчетПениОПВиСО.СчетЗатратБУ ЕСТЬ NULL ИЛИ РасчетПениОПВиСО.СчетЗатратБУ = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
	|			ТОГДА НЕОПРЕДЕЛЕНО
	|		ИНАЧЕ ЕСТЬNULL(РасчетПениОПВиСО.СубконтоЗатратБУ2, НЕОПРЕДЕЛЕНО)  
	|	КОНЕЦ КАК СубконтоДтДляПени2,
	|	ВЫБОР
	|		КОГДА РасчетПениОПВиСО.СчетЗатратБУ ЕСТЬ NULL ИЛИ РасчетПениОПВиСО.СчетЗатратБУ = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
	|			ТОГДА НЕОПРЕДЕЛЕНО
	|		ИНАЧЕ ЕСТЬNULL(РасчетПениОПВиСО.СубконтоЗатратБУ3, НЕОПРЕДЕЛЕНО)  
	|	КОНЕЦ КАК СубконтоДтДляПени3,
	|	ВЫБОР
	|		КОГДА РасчетПениОПВиСО.СчетЗатратНУ ЕСТЬ NULL ИЛИ РасчетПениОПВиСО.СчетЗатратНУ = ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
	|			ТОГДА &парамСчетДтДляПениНУ
	|		ИНАЧЕ РасчетПениОПВиСО.СчетЗатратНУ
	|	КОНЕЦ КАК СчетДтДляПениНУ,
	|	ВЫБОР
	|		КОГДА РасчетПениОПВиСО.СчетЗатратНУ ЕСТЬ NULL ИЛИ РасчетПениОПВиСО.СчетЗатратНУ = ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
	|			ТОГДА НЕОПРЕДЕЛЕНО
	|		ИНАЧЕ ЕСТЬNULL(РасчетПениОПВиСО.СубконтоЗатратНУ1, НЕОПРЕДЕЛЕНО) 
	|	КОНЕЦ КАК СубконтоДтДляПениНУ1,
	|	ВЫБОР
	|		КОГДА РасчетПениОПВиСО.СчетЗатратНУ ЕСТЬ NULL ИЛИ РасчетПениОПВиСО.СчетЗатратНУ = ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
	|			ТОГДА НЕОПРЕДЕЛЕНО
	|		ИНАЧЕ ЕСТЬNULL(РасчетПениОПВиСО.СубконтоЗатратНУ2, НЕОПРЕДЕЛЕНО) 
	|	КОНЕЦ КАК СубконтоДтДляПениНУ2,
	|	ВЫБОР
	|		КОГДА РасчетПениОПВиСО.СчетЗатратНУ ЕСТЬ NULL ИЛИ РасчетПениОПВиСО.СчетЗатратНУ = ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
	|			ТОГДА НЕОПРЕДЕЛЕНО
	|		ИНАЧЕ ЕСТЬNULL(РасчетПениОПВиСО.СубконтоЗатратНУ3, НЕОПРЕДЕЛЕНО)  
	|	КОНЕЦ КАК СубконтоДтДляПениНУ3,
	|	ЕСТЬNULL(ВидСубконтоСтатьиЗатратДляПени.НомерСтроки, 0) КАК НомерСубконтоСтатьиЗатратДляПени,
	|	ЕСТЬNULL(ВидСубконтоПодразделенияДляПени.НомерСтроки, 0) КАК НомерСубконтоПодразделенияДляПени,
	|	ЕСТЬNULL(ВидСубконтоСтатьиЗатратДляПениНУ.НомерСтроки, 0) КАК НомерСубконтоСтатьиЗатратДляПениНУ,
	|	ЕСТЬNULL(ВидСубконтоПодразделенияДляПениНУ.НомерСтроки, 0) КАК НомерСубконтоПодразделенияДляПениНУ
	|ИЗ
	|	РегистрНакопления.ОПВРасчетыСФондами КАК ОПВРасчетыСФондами
	|
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТСписокФизЛиц КАК СписокФизЛиц
	|		ПО ОПВРасчетыСФондами.ФизЛицо = СписокФизЛиц.ФизЛицо
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ ВТ_МестаРаботы КАК РаботникиОрганизации
	|		ПО ОПВРасчетыСФондами.ФизЛицо = РаботникиОрганизации.ФизЛицо
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ Документ.РасчетПениОПВиСО КАК РасчетПениОПВиСО
	|		ПО ОПВРасчетыСФондами.Регистратор = РасчетПениОПВиСО.Ссылка
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Типовой.ВидыСубконто КАК ВидСубконтоСтатьиЗатратДляПени
	|		ПО ВидСубконтоСтатьиЗатратДляПени.Ссылка = (ВЫБОР
	|														КОГДА РасчетПениОПВиСО.СчетЗатратБУ ЕСТЬ NULL ИЛИ РасчетПениОПВиСО.СчетЗатратБУ = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
	|															ТОГДА &парамСчетДтДляПени
	|														ИНАЧЕ РасчетПениОПВиСО.СчетЗатратБУ
	|													КОНЕЦ)
	|		   И ВидСубконтоСтатьиЗатратДляПени.ВидСубконто = &парамВидСубконтоСтатьиЗатрат
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Типовой.ВидыСубконто КАК ВидСубконтоПодразделенияДляПени
	|		ПО ВидСубконтоПодразделенияДляПени.Ссылка = (ВЫБОР
	|														КОГДА РасчетПениОПВиСО.СчетЗатратБУ ЕСТЬ NULL ИЛИ РасчетПениОПВиСО.СчетЗатратБУ = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
	|															ТОГДА &парамСчетДтДляПени
	|														ИНАЧЕ РасчетПениОПВиСО.СчетЗатратБУ
	|													КОНЕЦ)
	|		   И ВидСубконтоПодразделенияДляПени.ВидСубконто = &парамВидСубконтоПодразделения
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Налоговый.ВидыСубконто КАК ВидСубконтоСтатьиЗатратДляПениНУ
	|		ПО ВидСубконтоСтатьиЗатратДляПениНУ.Ссылка = (ВЫБОР
	|															КОГДА РасчетПениОПВиСО.СчетЗатратНУ ЕСТЬ NULL ИЛИ РасчетПениОПВиСО.СчетЗатратНУ = ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
	|																ТОГДА &парамСчетДтДляПениНУ
	|															ИНАЧЕ РасчетПениОПВиСО.СчетЗатратНУ
	|														КОНЕЦ)
	|		   И ВидСубконтоСтатьиЗатратДляПениНУ.ВидСубконто = &парамВидСубконтоСтатьиЗатрат
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Налоговый.ВидыСубконто КАК ВидСубконтоПодразделенияДляПениНУ
	|		ПО ВидСубконтоПодразделенияДляПениНУ.Ссылка = (ВЫБОР
	|															КОГДА РасчетПениОПВиСО.СчетЗатратНУ ЕСТЬ NULL ИЛИ РасчетПениОПВиСО.СчетЗатратНУ = ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
	|																ТОГДА &парамСчетДтДляПениНУ
	|															ИНАЧЕ РасчетПениОПВиСО.СчетЗатратНУ
	|														КОНЕЦ)
	|		   И ВидСубконтоПодразделенияДляПениНУ.ВидСубконто = &парамВидСубконтоПодразделения
	|
	|
	|ГДЕ
	|	ОПВРасчетыСФондами.Период >= &парамНачалоМесяца И 
	|	ОПВРасчетыСФондами.Период <= &парамКонецМесяца И 
	|	ОПВРасчетыСФондами.Организация = &парамОрганизация И 
	|	ОПВРасчетыСФондами.ВидДвижения = &парамВидДвиженияПриход И
	|	ОПВРасчетыСФондами.ВидСтроки = &парамВидСтрокиИсчисление И
	|	ОПВРасчетыСФондами.Взнос <> 0 И
	|	НЕ ОПВРасчетыСФондами.Регистратор ССЫЛКА Документ.ОтражениеНалоговойОтчетностиВРеглУчете И
	|	ОПВРасчетыСФондами.Активность " + ?(ОтражениеЗаИП, "И
	|	ОПВРасчетыСФондами.ФизЛицо <> &парамИндивидуальныйПредприниматель", "") + "  И
	|	ОПВРасчетыСФондами.НеОтражатьВРеглУчете = ЛОЖЬ И
	|	ОПВРасчетыСФондами.ФизЛицо ССЫЛКА Справочник.ФизическиеЛица 
	|
	|СГРУППИРОВАТЬ ПО
	|	ОПВРасчетыСФондами.ФизЛицо,
	|	ВЫБОР
	|		КОГДА ОПВРасчетыСФондами.ПодразделениеОрганизации <> ЗНАЧЕНИЕ(Справочник.ПодразделенияОрганизаций.ПустаяСсылка)
	|			ТОГДА ОПВРасчетыСФондами.ПодразделениеОрганизации
	|		ИНАЧЕ РаботникиОрганизации.ПодразделениеОрганизации
	|	КОНЕЦ,
	|	ОПВРасчетыСФондами.ВидПлатежа,
	|	ВЫБОР
	|		КОГДА РасчетПениОПВиСО.СчетЗатратБУ ЕСТЬ NULL ИЛИ РасчетПениОПВиСО.СчетЗатратБУ = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
	|			ТОГДА &парамСчетДтДляПени
	|		ИНАЧЕ РасчетПениОПВиСО.СчетЗатратБУ
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА РасчетПениОПВиСО.СчетЗатратБУ ЕСТЬ NULL ИЛИ РасчетПениОПВиСО.СчетЗатратБУ = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
	|			ТОГДА НЕОПРЕДЕЛЕНО
	|		ИНАЧЕ ЕСТЬNULL(РасчетПениОПВиСО.СубконтоЗатратБУ1, НЕОПРЕДЕЛЕНО)  
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА РасчетПениОПВиСО.СчетЗатратБУ ЕСТЬ NULL ИЛИ РасчетПениОПВиСО.СчетЗатратБУ = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
	|			ТОГДА НЕОПРЕДЕЛЕНО
	|		ИНАЧЕ ЕСТЬNULL(РасчетПениОПВиСО.СубконтоЗатратБУ2, НЕОПРЕДЕЛЕНО)  
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА РасчетПениОПВиСО.СчетЗатратБУ ЕСТЬ NULL ИЛИ РасчетПениОПВиСО.СчетЗатратБУ = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
	|			ТОГДА НЕОПРЕДЕЛЕНО
	|		ИНАЧЕ ЕСТЬNULL(РасчетПениОПВиСО.СубконтоЗатратБУ3, НЕОПРЕДЕЛЕНО)  
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА РасчетПениОПВиСО.СчетЗатратНУ ЕСТЬ NULL ИЛИ РасчетПениОПВиСО.СчетЗатратНУ = ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
	|			ТОГДА &парамСчетДтДляПениНУ
	|		ИНАЧЕ РасчетПениОПВиСО.СчетЗатратНУ
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА РасчетПениОПВиСО.СчетЗатратНУ ЕСТЬ NULL ИЛИ РасчетПениОПВиСО.СчетЗатратНУ = ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
	|			ТОГДА НЕОПРЕДЕЛЕНО
	|		ИНАЧЕ ЕСТЬNULL(РасчетПениОПВиСО.СубконтоЗатратНУ1, НЕОПРЕДЕЛЕНО) 
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА РасчетПениОПВиСО.СчетЗатратНУ ЕСТЬ NULL ИЛИ РасчетПениОПВиСО.СчетЗатратНУ = ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
	|			ТОГДА НЕОПРЕДЕЛЕНО
	|		ИНАЧЕ ЕСТЬNULL(РасчетПениОПВиСО.СубконтоЗатратНУ2, НЕОПРЕДЕЛЕНО) 
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА РасчетПениОПВиСО.СчетЗатратНУ ЕСТЬ NULL ИЛИ РасчетПениОПВиСО.СчетЗатратНУ = ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
	|			ТОГДА НЕОПРЕДЕЛЕНО
	|		ИНАЧЕ ЕСТЬNULL(РасчетПениОПВиСО.СубконтоЗатратНУ3, НЕОПРЕДЕЛЕНО)  
	|	КОНЕЦ,
	|	ЕСТЬNULL(ВидСубконтоСтатьиЗатратДляПени.НомерСтроки, 0),
	|	ЕСТЬNULL(ВидСубконтоПодразделенияДляПени.НомерСтроки, 0),
	|	ЕСТЬNULL(ВидСубконтоСтатьиЗатратДляПениНУ.НомерСтроки, 0),
	|	ЕСТЬNULL(ВидСубконтоПодразделенияДляПениНУ.НомерСтроки, 0)
	|";

	Запрос.Текст = ОПВИсчисленныйТекст;

	СчетДебета = ПланыСчетов.Типовой.КраткосрочнаяЗадолженностьПоОплатеТруда;
	
	СчетДебетаНУПоУмолчанию = ПланыСчетов.Налоговый.ВзаиморасчетыСРаботниками;	
	СчетДебетаНУ = ПроцедурыБухгалтерскогоУчета.ЗаполнитьСчетНалоговогоУчетаПоУмолчанию(СчетДебета, КонецМесяца(Параметры.ПериодРегистрации),СчетДебетаНУПоУмолчанию);
	
	СчетКредита = Справочники.НалогиСборыОтчисления.ОбязательныеПенсионныеВзносы.СчетУчетаРасчетовСКонтрагентомБУ;
	Если НЕ ЗначениеЗаполнено(СчетКредита) Тогда
		СчетКредита = ПланыСчетов.Типовой.ОбязательстваПоПенсионнымОтчислениям;
	КонецЕсли;
	
	СчетКредитаНУ = ПроцедурыНалоговогоУчетаВызовСервераПовтИсп.ПолучитьСчетУчетаНУОПВ(СчетКредита,КонецМесяца(Параметры.ПериодРегистрации));
	
	СтатьяЗатратПеняПоОПВ = Справочники.СтатьиЗатрат.ПеняПоОПВ;
	ВидНалогаСбораОтчисленияОПВ = Справочники.НалогиСборыОтчисления.ОбязательныеПенсионныеВзносы;
	
	Выборка = Запрос.Выполнить().Выбрать();
	
	Пока Выборка.Следующий() Цикл
		Строка = Параметры.ТаблицаОтражениеВУчете.Добавить();
		
		// Ставим на разные счета затрат в зависимости от вида платежа
		Если Выборка.ВидПлатежа = Перечисления.ВидыПлатежейВБюджетИФонды.Налог
			 Или Выборка.ВидПлатежа = Перечисления.ВидыПлатежейВБюджетИФонды.НалогАкт 
			 Или Выборка.ВидПлатежа = Перечисления.ВидыПлатежейВБюджетИФонды.НалогСам Тогда
			Строка.ВидРасчета	= ВидНалогаСбораОтчисленияОПВ;
			Строка.СчетДт 		= СчетДебета;
			Если ВедетсяУчетПоСотрудникам Тогда
				Строка.СубконтоДт1 	= Выборка.Физлицо;
			КонецЕсли;
			Строка.СчетДтНУ 		= СчетДебетаНУ;
			Если ВедетсяУчетПоСотрудникам Тогда
				ОбщегоНазначенияБККлиентСервер.ЗаменитьСубконтоНУ(Строка, СчетДебета, СчетДебетаНУ, 1, Выборка.ФизЛицо, "СубконтоДтНУ");
				Строка.СубконтоДтНУ1 	= Выборка.Физлицо;
			КонецЕсли;
		Иначе // Пеня по ОПВ
			Строка.ВидРасчета		= СтатьяЗатратПеняПоОПВ;
			Строка.СчетДт			= Выборка.СчетДтДляПени;
			Строка.СчетДтНУ 		= Выборка.СчетДтДляПениНУ;
			
			Если Выборка.НомерСубконтоСтатьиЗатратДляПени <> 0 Тогда
				Если ЗначениеЗаполнено(Выборка["СубконтоДтДляПени" + Выборка.НомерСубконтоСтатьиЗатратДляПени]) Тогда
					Строка["СубконтоДт" + Выборка.НомерСубконтоСтатьиЗатратДляПени] = Выборка["СубконтоДтДляПени" + Выборка.НомерСубконтоСтатьиЗатратДляПени];
				Иначе
					Строка["СубконтоДт" + Выборка.НомерСубконтоСтатьиЗатратДляПени] = СтатьяЗатратПеняПоОПВ;
				КонецЕсли;
				ОбщегоНазначенияБККлиентСервер.ЗаменитьСубконтоНУ(Строка, СчетДебетаДляПени, СчетДебетаДляПениНУ, Выборка.НомерСубконтоСтатьиЗатратДляПени, СтатьяЗатратПеняПоОПВ, "СубконтоДтНУ");
			КонецЕсли;
			Если Выборка.НомерСубконтоСтатьиЗатратДляПениНУ <> 0 Тогда
				Если ЗначениеЗаполнено(Выборка["СубконтоДтДляПениНУ" + Выборка.НомерСубконтоСтатьиЗатратДляПениНУ]) Тогда
					Строка["СубконтоДтНУ" + Выборка.НомерСубконтоСтатьиЗатратДляПениНУ] = Выборка["СубконтоДтДляПениНУ" + Выборка.НомерСубконтоСтатьиЗатратДляПениНУ];
				Иначе
					Строка["СубконтоДтНУ" + Выборка.НомерСубконтоСтатьиЗатратДляПениНУ] = СтатьяЗатратПеняПоОПВ;
				КонецЕсли;
			КонецЕсли;
			Если Выборка.НомерСубконтоПодразделенияДляПени <> 0 Тогда
				Если ЗначениеЗаполнено(Выборка["СубконтоДтДляПени" + Выборка.НомерСубконтоПодразделенияДляПени]) Тогда
					Строка["СубконтоДт" + Выборка.НомерСубконтоПодразделенияДляПени] = Выборка["СубконтоДтДляПени" + Выборка.НомерСубконтоПодразделенияДляПени];
				Иначе 
					Строка["СубконтоДт" + Выборка.НомерСубконтоПодразделенияДляПени]= Выборка.ПодразделениеОрганизации;
				КонецЕсли;
				ОбщегоНазначенияБККлиентСервер.ЗаменитьСубконтоНУ(Строка, СчетДебетаДляПени, СчетДебетаДляПениНУ, Выборка.НомерСубконтоПодразделенияДляПени, Выборка.ПодразделениеОрганизации, "СубконтоДтНУ");
			КонецЕсли;
			Если Выборка.НомерСубконтоПодразделенияДляПениНУ <> 0 Тогда
				Если ЗначениеЗаполнено(Выборка["СубконтоДтДляПениНУ" + Выборка.НомерСубконтоПодразделенияДляПениНУ]) Тогда
					Строка["СубконтоДтНУ" + Выборка.НомерСубконтоПодразделенияДляПениНУ] = Выборка["СубконтоДтДляПениНУ" + Выборка.НомерСубконтоПодразделенияДляПениНУ];
				Иначе 
					Строка["СубконтоДтНУ" + Выборка.НомерСубконтоПодразделенияДляПениНУ]= Выборка.ПодразделениеОрганизации;
				КонецЕсли;
			КонецЕсли;
			
			// Заполним оставшиеся субконто
			Для Ном = 1 По 3 Цикл
				Если НЕ ЗначениеЗаполнено(Строка["СубконтоДт" + Ном]) Тогда
					Строка["СубконтоДт" + Ном] = Выборка["СубконтоДтДляПени" + Ном];
				КонецЕсли;
				Если НЕ ЗначениеЗаполнено(Строка["СубконтоДтНУ" + Ном]) Тогда
					Если ЗначениеЗаполнено(Выборка["СубконтоДтДляПениНУ" + Ном]) Тогда
						Строка["СубконтоДтНУ" + Ном] = Выборка["СубконтоДтДляПениНУ" + Ном];
					Иначе
						ОбщегоНазначенияБККлиентСервер.ЗаменитьСубконтоНУ(Строка, СчетДебетаДляПени, СчетДебетаДляПениНУ, Ном, СтатьяЗатратПеняПоОПВ, "СубконтоДтНУ");
					КонецЕсли;
				КонецЕсли;
			КонецЦикла;

		КонецЕсли;
		
		Строка.СчетКт 		= СчетКредита;
		Строка.СубконтоКт1 	= Справочники.НалогиСборыОтчисления.ОбязательныеПенсионныеВзносы;
		Строка.СубконтоКт2 	= Выборка.ВидПлатежа;
		Если ВедетсяУчетПоСотрудникам Тогда
			Строка.СубконтоКт3	= Выборка.Физлицо;		
		КонецЕсли;
		
		Строка.СчетКтНУ 	= СчетКредитаНУ;
		ОбщегоНазначенияБККлиентСервер.ЗаменитьСубконтоНУ(Строка, СчетКредита, СчетКредитаНУ, 1, Справочники.НалогиСборыОтчисления.ОбязательныеПенсионныеВзносы, "СубконтоКтНУ");
		ОбщегоНазначенияБККлиентСервер.ЗаменитьСубконтоНУ(Строка, СчетКредита, СчетКредитаНУ, 2, Выборка.ВидПлатежа, "СубконтоКтНУ");
		Если ВедетсяУчетПоСотрудникам Тогда
			ОбщегоНазначенияБККлиентСервер.ЗаменитьСубконтоНУ(Строка, СчетКредита, СчетКредитаНУ, 3, Выборка.Физлицо, "СубконтоКтНУ");   		
		КонецЕсли;
		
		Строка.Сумма		= Выборка.Взнос;
		Строка.ФизЛицо 		= Выборка.ФизЛицо;
		Строка.СтруктурноеПодразделениеДт = Параметры.СтруктурноеПодразделение;
		Строка.СтруктурноеПодразделениеКт = Параметры.СтруктурноеПодразделение;
	КонецЦикла;	
	
#КонецОбласти

#Область ОПВПоКонтрагентам

 ОПВИсчисленныйТекст = 
	"ВЫБРАТЬ РАЗРЕШЕННЫЕ
	|	ОПВРасчетыСФондами.ФизЛицо КАК Контрагент,
	|	ОПВРасчетыСФондами.ПодразделениеОрганизации КАК ПодразделениеОрганизации,
	|	ОПВРасчетыСФондами.ВидПлатежа КАК ВидПлатежа,
	|	ОПВРасчетыСФондами.Регистратор КАК Регистратор,
	|	СУММА(ОПВРасчетыСФондами.Взнос) КАК Взнос
	|ПОМЕСТИТЬ ВТ_ОПВРасчетыСФондами
	|ИЗ
	|	РегистрНакопления.ОПВРасчетыСФондами КАК ОПВРасчетыСФондами
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТСписокФизЛиц КАК СписокФизЛиц
	|		ПО ОПВРасчетыСФондами.ФизЛицо = СписокФизЛиц.ФизЛицо
	|ГДЕ
	|	ОПВРасчетыСФондами.Период >= &парамНачалоМесяца
	|	И ОПВРасчетыСФондами.Период <= &парамКонецМесяца
	|	И ОПВРасчетыСФондами.Организация = &парамОрганизация
	|	И ОПВРасчетыСФондами.ВидДвижения = &парамВидДвиженияПриход
	|	И ОПВРасчетыСФондами.ВидСтроки = &парамВидСтрокиИсчисление
	|	И ОПВРасчетыСФондами.Взнос <> 0
	|	И ОПВРасчетыСФондами.НеОтражатьВРеглУчете = ЛОЖЬ
	|	И НЕ ОПВРасчетыСФондами.Регистратор ССЫЛКА Документ.ОтражениеНалоговойОтчетностиВРеглУчете
	|	И ОПВРасчетыСФондами.ФизЛицо ССЫЛКА Справочник.Контрагенты " + ?(ОтражениеЗаИП, "И
	|	ОПВРасчетыСФондами.ФизЛицо <> &парамИндивидуальныйПредприниматель", "") + "  И
	|	ОПВРасчетыСФондами.Активность
	|
	|СГРУППИРОВАТЬ ПО
	|	ОПВРасчетыСФондами.ФизЛицо,
	|	ОПВРасчетыСФондами.ПодразделениеОрганизации,
	|	ОПВРасчетыСФондами.ВидПлатежа,
	|	ОПВРасчетыСФондами.Регистратор
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	ДоходыКонтрагентов.Контрагент КАК Контрагент,
	|	ДоходыКонтрагентов.ФизЛицо КАК ФизЛицо,
	|	ДоходыКонтрагентов.ВидРасчета КАК ВидРасчета,
	|	ДоходыКонтрагентов.СчетКт КАК СчетКт,
	|	ДоходыКонтрагентов.СубконтоКт1 КАК СубконтоКт1,
	|	ДоходыКонтрагентов.СубконтоКт2 КАК СубконтоКт2,
	|	ДоходыКонтрагентов.СубконтоКт3 КАК СубконтоКт3,
	|	ДоходыКонтрагентов.СчетКтНУ КАК СчетКтНУ,
	|	ДоходыКонтрагентов.СубконтоКтНУ1 КАК СубконтоКтНУ1,
	|	ДоходыКонтрагентов.СубконтоКтНУ2 КАК СубконтоКтНУ2,
	|	ДоходыКонтрагентов.СубконтоКтНУ3 КАК СубконтоКтНУ3,
	|	ДоходыКонтрагентов.Сумма КАК Результат
	|ПОМЕСТИТЬ ВТ_ВнешняяТаблицаОПВ
	|ИЗ
	|	&ВнешнийИсточник КАК ДоходыКонтрагентов
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	Контрагент
	|;
	|
	|/////////////////////////////////////////
	|ВЫБРАТЬ РАЗРЕШЕННЫЕ
	|	ДоходыКонтрагентов.Контрагент КАК Контрагент,
	|	ДоходыКонтрагентов.ФизЛицо,		
	|	ДоходыКонтрагентов.СчетКт КАК СчетДт,
	|	ДоходыКонтрагентов.СубконтоКт1 КАК СубконтоДт1,
	|	ДоходыКонтрагентов.СубконтоКт2 КАК СубконтоДт2,
	|	ДоходыКонтрагентов.СубконтоКт3 КАК СубконтоДт3,
	|	ДоходыКонтрагентов.СчетКтНУ КАК СчетДтНУ,
	|	ДоходыКонтрагентов.СубконтоКтНУ1 КАК СубконтоДтНУ1,
	|	ДоходыКонтрагентов.СубконтоКтНУ2 КАК СубконтоДтНУ2,
	|	ДоходыКонтрагентов.СубконтоКтНУ3 КАК СубконтоДтНУ3,
	|	СУММА(ДоходыКонтрагентов.Результат) КАК Результат
	|ПОМЕСТИТЬ ВТ_БУДоходыКонтрагентовОПВ
	|ИЗ
	|	ВТ_ВнешняяТаблицаОПВ КАК ДоходыКонтрагентов
	|
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТСписокФизЛиц КАК СписокФизЛиц
	|		ПО ДоходыКонтрагентов.Контрагент = СписокФизЛиц.ФизЛицо
	|ГДЕ
	|	ДоходыКонтрагентов.ВидРасчета.ОблагаетсяОПВ <> &парамНеОблагаетсяЦеликом
	|СГРУППИРОВАТЬ ПО
	|	ДоходыКонтрагентов.Контрагент,
	|	ДоходыКонтрагентов.ФизЛицо,		
	|	ДоходыКонтрагентов.СчетКт,
	|	ДоходыКонтрагентов.СубконтоКт1,
	|	ДоходыКонтрагентов.СубконтоКт2,
	|	ДоходыКонтрагентов.СубконтоКт3,
	|	ДоходыКонтрагентов.СчетКтНУ,
	|	ДоходыКонтрагентов.СубконтоКтНУ1,
	|	ДоходыКонтрагентов.СубконтоКтНУ2,
	|	ДоходыКонтрагентов.СубконтоКтНУ3
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	ДоходыКонтрагентов.Контрагент,
	|	ДоходыКонтрагентов.ФизЛицо	
	|;
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ РАЗРЕШЕННЫЕ
	|	ОПВРасчетыСФондами.Контрагент КАК Контрагент,
	|	ОПВРасчетыСФондами.ПодразделениеОрганизации КАК ПодразделениеОрганизации,
	|	ОПВРасчетыСФондами.Контрагент.ФизЛицо КАК ФизЛицо,
	|	ОПВРасчетыСФондами.ВидПлатежа КАК ВидПлатежа,
	|	БУДоходыКонтрагентов.СчетДт КАК СчетДт,
	|	БУДоходыКонтрагентов.СубконтоДт1 КАК СубконтоДт1,
	|	БУДоходыКонтрагентов.СубконтоДт2 КАК СубконтоДт2,
	|	БУДоходыКонтрагентов.СубконтоДт3 КАК СубконтоДт3,
	|	БУДоходыКонтрагентов.СчетДтНУ КАК СчетДтНУ,
	|	БУДоходыКонтрагентов.СубконтоДтНУ1 КАК СубконтоДтНУ1,
	|	БУДоходыКонтрагентов.СубконтоДтНУ2 КАК СубконтоДтНУ2,
	|	БУДоходыКонтрагентов.СубконтоДтНУ3 КАК СубконтоДтНУ3,
	|	СУММА(ОПВРасчетыСФондами.Взнос) КАК Взнос,
	|	СУММА(ВЫБОР
	|			КОГДА ЕСТЬNULL(БУСуммаНачислений.Результат, 0) <> 0
	|				ТОГДА ВЫРАЗИТЬ(ОПВРасчетыСФондами.Взнос * ЕСТЬNULL(БУДоходыКонтрагентов.Результат, 0) / БУСуммаНачислений.Результат КАК ЧИСЛО(15, 2))
	|			ИНАЧЕ ОПВРасчетыСФондами.Взнос
	|		КОНЕЦ) КАК СуммаПроводки,
	|	ВЫБОР
	|		КОГДА РасчетПениОПВиСО.СчетЗатратБУ ЕСТЬ NULL
	|				ИЛИ РасчетПениОПВиСО.СчетЗатратБУ = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
	|			ТОГДА &парамСчетДтДляПени
	|		ИНАЧЕ РасчетПениОПВиСО.СчетЗатратБУ
	|	КОНЕЦ КАК СчетДтДляПени,
	|	ВЫБОР
	|		КОГДА РасчетПениОПВиСО.СчетЗатратБУ ЕСТЬ NULL
	|				ИЛИ РасчетПениОПВиСО.СчетЗатратБУ = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
	|			ТОГДА НЕОПРЕДЕЛЕНО
	|		ИНАЧЕ ЕСТЬNULL(РасчетПениОПВиСО.СубконтоЗатратБУ1, НЕОПРЕДЕЛЕНО)
	|	КОНЕЦ КАК СубконтоДтДляПени1,
	|	ВЫБОР
	|		КОГДА РасчетПениОПВиСО.СчетЗатратБУ ЕСТЬ NULL
	|				ИЛИ РасчетПениОПВиСО.СчетЗатратБУ = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
	|			ТОГДА НЕОПРЕДЕЛЕНО
	|		ИНАЧЕ ЕСТЬNULL(РасчетПениОПВиСО.СубконтоЗатратБУ2, НЕОПРЕДЕЛЕНО)
	|	КОНЕЦ КАК СубконтоДтДляПени2,
	|	ВЫБОР
	|		КОГДА РасчетПениОПВиСО.СчетЗатратБУ ЕСТЬ NULL
	|				ИЛИ РасчетПениОПВиСО.СчетЗатратБУ = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
	|			ТОГДА НЕОПРЕДЕЛЕНО
	|		ИНАЧЕ ЕСТЬNULL(РасчетПениОПВиСО.СубконтоЗатратБУ3, НЕОПРЕДЕЛЕНО)
	|	КОНЕЦ КАК СубконтоДтДляПени3,
	|	ВЫБОР
	|		КОГДА РасчетПениОПВиСО.СчетЗатратНУ ЕСТЬ NULL
	|				ИЛИ РасчетПениОПВиСО.СчетЗатратНУ = ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
	|			ТОГДА &парамСчетДтДляПениНУ
	|		ИНАЧЕ РасчетПениОПВиСО.СчетЗатратНУ
	|	КОНЕЦ КАК СчетДтДляПениНУ,
	|	ВЫБОР
	|		КОГДА РасчетПениОПВиСО.СчетЗатратНУ ЕСТЬ NULL
	|				ИЛИ РасчетПениОПВиСО.СчетЗатратНУ = ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
	|			ТОГДА НЕОПРЕДЕЛЕНО
	|		ИНАЧЕ ЕСТЬNULL(РасчетПениОПВиСО.СубконтоЗатратНУ1, НЕОПРЕДЕЛЕНО)
	|	КОНЕЦ КАК СубконтоДтДляПениНУ1,
	|	ВЫБОР
	|		КОГДА РасчетПениОПВиСО.СчетЗатратНУ ЕСТЬ NULL
	|				ИЛИ РасчетПениОПВиСО.СчетЗатратНУ = ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
	|			ТОГДА НЕОПРЕДЕЛЕНО
	|		ИНАЧЕ ЕСТЬNULL(РасчетПениОПВиСО.СубконтоЗатратНУ2, НЕОПРЕДЕЛЕНО)
	|	КОНЕЦ КАК СубконтоДтДляПениНУ2,
	|	ВЫБОР
	|		КОГДА РасчетПениОПВиСО.СчетЗатратНУ ЕСТЬ NULL
	|				ИЛИ РасчетПениОПВиСО.СчетЗатратНУ = ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
	|			ТОГДА НЕОПРЕДЕЛЕНО
	|		ИНАЧЕ ЕСТЬNULL(РасчетПениОПВиСО.СубконтоЗатратНУ3, НЕОПРЕДЕЛЕНО)
	|	КОНЕЦ КАК СубконтоДтДляПениНУ3,
	|	ЕСТЬNULL(ВидСубконтоСтатьиЗатратДляПени.НомерСтроки, 0) КАК НомерСубконтоСтатьиЗатратДляПени,
	|	ЕСТЬNULL(ВидСубконтоПодразделенияДляПени.НомерСтроки, 0) КАК НомерСубконтоПодразделенияДляПени,
	|	ЕСТЬNULL(ВидСубконтоСтатьиЗатратДляПениНУ.НомерСтроки, 0) КАК НомерСубконтоСтатьиЗатратДляПениНУ,
	|	ЕСТЬNULL(ВидСубконтоПодразделенияДляПениНУ.НомерСтроки, 0) КАК НомерСубконтоПодразделенияДляПениНУ
	|ИЗ
	|	ВТ_ОПВРасчетыСФондами КАК ОПВРасчетыСФондами
	|		ЛЕВОЕ СОЕДИНЕНИЕ ВТ_БУДоходыКонтрагентовОПВ КАК БУДоходыКонтрагентов
	|		ПО ОПВРасчетыСФондами.Контрагент = БУДоходыКонтрагентов.Контрагент
	|			И ОПВРасчетыСФондами.Контрагент.ФизЛицо = БУДоходыКонтрагентов.ФизЛицо
	|		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
	|			БУДоходыКонтрагентов.Контрагент КАК Контрагент,
	|			СУММА(БУДоходыКонтрагентов.Результат) КАК Результат
	|		ИЗ
	|			ВТ_БУДоходыКонтрагентовОПВ КАК БУДоходыКонтрагентов
	|		
	|		СГРУППИРОВАТЬ ПО
	|			БУДоходыКонтрагентов.Контрагент) КАК БУСуммаНачислений
	|		ПО ОПВРасчетыСФондами.Контрагент = БУСуммаНачислений.Контрагент
	|		ЛЕВОЕ СОЕДИНЕНИЕ Документ.РасчетПениОПВиСО КАК РасчетПениОПВиСО
	|		ПО ОПВРасчетыСФондами.Регистратор = РасчетПениОПВиСО.Ссылка
	|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Типовой.ВидыСубконто КАК ВидСубконтоСтатьиЗатратДляПени
	|		ПО (ВидСубконтоСтатьиЗатратДляПени.Ссылка = ВЫБОР
	|				КОГДА РасчетПениОПВиСО.СчетЗатратБУ ЕСТЬ NULL
	|						ИЛИ РасчетПениОПВиСО.СчетЗатратБУ = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
	|					ТОГДА &парамСчетДтДляПени
	|				ИНАЧЕ РасчетПениОПВиСО.СчетЗатратБУ
	|			КОНЕЦ)
	|			И (ВидСубконтоСтатьиЗатратДляПени.ВидСубконто = &парамВидСубконтоСтатьиЗатрат)
	|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Типовой.ВидыСубконто КАК ВидСубконтоПодразделенияДляПени
	|		ПО (ВидСубконтоПодразделенияДляПени.Ссылка = ВЫБОР
	|				КОГДА РасчетПениОПВиСО.СчетЗатратБУ ЕСТЬ NULL
	|						ИЛИ РасчетПениОПВиСО.СчетЗатратБУ = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
	|					ТОГДА &парамСчетДтДляПени
	|				ИНАЧЕ РасчетПениОПВиСО.СчетЗатратБУ
	|			КОНЕЦ)
	|			И (ВидСубконтоПодразделенияДляПени.ВидСубконто = &парамВидСубконтоПодразделения)
	|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Налоговый.ВидыСубконто КАК ВидСубконтоСтатьиЗатратДляПениНУ
	|		ПО (ВидСубконтоСтатьиЗатратДляПениНУ.Ссылка = ВЫБОР
	|				КОГДА РасчетПениОПВиСО.СчетЗатратНУ ЕСТЬ NULL
	|						ИЛИ РасчетПениОПВиСО.СчетЗатратНУ = ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
	|					ТОГДА &парамСчетДтДляПениНУ
	|				ИНАЧЕ РасчетПениОПВиСО.СчетЗатратНУ
	|			КОНЕЦ)
	|			И (ВидСубконтоСтатьиЗатратДляПениНУ.ВидСубконто = &парамВидСубконтоСтатьиЗатрат)
	|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Налоговый.ВидыСубконто КАК ВидСубконтоПодразделенияДляПениНУ
	|		ПО (ВидСубконтоПодразделенияДляПениНУ.Ссылка = ВЫБОР
	|				КОГДА РасчетПениОПВиСО.СчетЗатратНУ ЕСТЬ NULL
	|						ИЛИ РасчетПениОПВиСО.СчетЗатратНУ = ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
	|					ТОГДА &парамСчетДтДляПениНУ
	|				ИНАЧЕ РасчетПениОПВиСО.СчетЗатратНУ
	|			КОНЕЦ)
	|			И (ВидСубконтоПодразделенияДляПениНУ.ВидСубконто = &парамВидСубконтоПодразделения)
	|
	|СГРУППИРОВАТЬ ПО
	|	ОПВРасчетыСФондами.Контрагент,
	|	ОПВРасчетыСФондами.ПодразделениеОрганизации,
	|	ОПВРасчетыСФондами.ВидПлатежа,
	|	БУДоходыКонтрагентов.СчетДт,
	|	БУДоходыКонтрагентов.СубконтоДт1,
	|	БУДоходыКонтрагентов.СубконтоДт2,
	|	БУДоходыКонтрагентов.СубконтоДт3,
	|	БУДоходыКонтрагентов.СчетДтНУ,
	|	БУДоходыКонтрагентов.СубконтоДтНУ1,
	|	БУДоходыКонтрагентов.СубконтоДтНУ2,
	|	БУДоходыКонтрагентов.СубконтоДтНУ3,
	|	ВЫБОР
	|		КОГДА РасчетПениОПВиСО.СчетЗатратБУ ЕСТЬ NULL
	|				ИЛИ РасчетПениОПВиСО.СчетЗатратБУ = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
	|			ТОГДА &парамСчетДтДляПени
	|		ИНАЧЕ РасчетПениОПВиСО.СчетЗатратБУ
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА РасчетПениОПВиСО.СчетЗатратБУ ЕСТЬ NULL
	|				ИЛИ РасчетПениОПВиСО.СчетЗатратБУ = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
	|			ТОГДА НЕОПРЕДЕЛЕНО
	|		ИНАЧЕ ЕСТЬNULL(РасчетПениОПВиСО.СубконтоЗатратБУ1, НЕОПРЕДЕЛЕНО)
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА РасчетПениОПВиСО.СчетЗатратБУ ЕСТЬ NULL
	|				ИЛИ РасчетПениОПВиСО.СчетЗатратБУ = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
	|			ТОГДА НЕОПРЕДЕЛЕНО
	|		ИНАЧЕ ЕСТЬNULL(РасчетПениОПВиСО.СубконтоЗатратБУ2, НЕОПРЕДЕЛЕНО)
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА РасчетПениОПВиСО.СчетЗатратБУ ЕСТЬ NULL
	|				ИЛИ РасчетПениОПВиСО.СчетЗатратБУ = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
	|			ТОГДА НЕОПРЕДЕЛЕНО
	|		ИНАЧЕ ЕСТЬNULL(РасчетПениОПВиСО.СубконтоЗатратБУ3, НЕОПРЕДЕЛЕНО)
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА РасчетПениОПВиСО.СчетЗатратНУ ЕСТЬ NULL
	|				ИЛИ РасчетПениОПВиСО.СчетЗатратНУ = ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
	|			ТОГДА &парамСчетДтДляПениНУ
	|		ИНАЧЕ РасчетПениОПВиСО.СчетЗатратНУ
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА РасчетПениОПВиСО.СчетЗатратНУ ЕСТЬ NULL
	|				ИЛИ РасчетПениОПВиСО.СчетЗатратНУ = ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
	|			ТОГДА НЕОПРЕДЕЛЕНО
	|		ИНАЧЕ ЕСТЬNULL(РасчетПениОПВиСО.СубконтоЗатратНУ1, НЕОПРЕДЕЛЕНО)
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА РасчетПениОПВиСО.СчетЗатратНУ ЕСТЬ NULL
	|				ИЛИ РасчетПениОПВиСО.СчетЗатратНУ = ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
	|			ТОГДА НЕОПРЕДЕЛЕНО
	|		ИНАЧЕ ЕСТЬNULL(РасчетПениОПВиСО.СубконтоЗатратНУ2, НЕОПРЕДЕЛЕНО)
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА РасчетПениОПВиСО.СчетЗатратНУ ЕСТЬ NULL
	|				ИЛИ РасчетПениОПВиСО.СчетЗатратНУ = ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
	|			ТОГДА НЕОПРЕДЕЛЕНО
	|		ИНАЧЕ ЕСТЬNULL(РасчетПениОПВиСО.СубконтоЗатратНУ3, НЕОПРЕДЕЛЕНО)
	|	КОНЕЦ,
	|	ЕСТЬNULL(ВидСубконтоСтатьиЗатратДляПени.НомерСтроки, 0),
	|	ЕСТЬNULL(ВидСубконтоПодразделенияДляПени.НомерСтроки, 0),
	|	ЕСТЬNULL(ВидСубконтоСтатьиЗатратДляПениНУ.НомерСтроки, 0),
	|	ЕСТЬNULL(ВидСубконтоПодразделенияДляПениНУ.НомерСтроки, 0),
	|	ОПВРасчетыСФондами.Контрагент.ФизЛицо";

	
	Запрос.Текст = ОПВИсчисленныйТекст;
	Запрос.УстановитьПараметр("ВнешнийИсточник", ПромежуточнаяТаблицаКонтрагенты);
	
	СчетДебетаПоУмолчанию = ПланыСчетов.Типовой.ПрочаяКраткосрочнаяКредиторскаяЗадолженность; //3397
	
	СчетДебетаНУПоУмолчаниюДляПодстановки = ПланыСчетов.Налоговый.ПоступлениеИВыбытиеИмуществаработУслугПрав;	//3310Н
	СчетДебетаНУПоУмолчанию = ПроцедурыБухгалтерскогоУчета.ЗаполнитьСчетНалоговогоУчетаПоУмолчанию(СчетДебетаПоУмолчанию, КонецМесяца(Параметры.ПериодРегистрации), СчетДебетаНУПоУмолчаниюДляПодстановки);
	
	СчетКредита = Справочники.НалогиСборыОтчисления.ОбязательныеПенсионныеВзносы.СчетУчетаРасчетовСКонтрагентомБУ;
	Если НЕ ЗначениеЗаполнено(СчетКредита) Тогда
		СчетКредита = ПланыСчетов.Типовой.ОбязательстваПоПенсионнымОтчислениям;
	КонецЕсли;
	
	СчетКредитаНУ = ПроцедурыНалоговогоУчетаВызовСервераПовтИсп.ПолучитьСчетУчетаНУОПВ(СчетКредита,КонецМесяца(Параметры.ПериодРегистрации));
	
	СтатьяЗатратПеняПоОПВ = Справочники.СтатьиЗатрат.ПеняПоОПВ;
	ВидНалогаСбораОтчисленияОПВ = Справочники.НалогиСборыОтчисления.ОбязательныеПенсионныеВзносы;
	
	Выборка = Запрос.Выполнить().Выбрать();
	
	Пока Выборка.Следующий() Цикл
		Строка = Параметры.ТаблицаОтражениеВУчете.Добавить();
		
		// Ставим на разные счета затрат в зависимости от вида платежа
		Если Выборка.ВидПлатежа = Перечисления.ВидыПлатежейВБюджетИФонды.Налог
			 Или Выборка.ВидПлатежа = Перечисления.ВидыПлатежейВБюджетИФонды.НалогАкт 
			 Или Выборка.ВидПлатежа = Перечисления.ВидыПлатежейВБюджетИФонды.НалогСам Тогда
			Строка.ВидРасчета	= ВидНалогаСбораОтчисленияОПВ;
						
			Строка.СчетДт 		= ?(ЗначениеЗаполнено(Выборка.СчетДт), Выборка.СчетДт, СчетДебетаПоУмолчанию);
			Строка.СубконтоДт1 	= ?(ЗначениеЗаполнено(Выборка.СубконтоДт1), Выборка.СубконтоДт1, Выборка.Контрагент);
			Строка.СубконтоДт2 	= ?(ЗначениеЗаполнено(Выборка.СубконтоДт2), Выборка.СубконтоДт2, ОбщегоНазначенияБК.ДоступныйДоговорКонтрагента(Выборка.Контрагент["ОсновнойДоговорКонтрагента"]));
		
			Строка.СчетДтНУ		= ?(ЗначениеЗаполнено(Выборка.СчетДтНУ), Выборка.СчетДтНУ, СчетДебетаНУПоУмолчанию);
			Строка.СубконтоДтНУ1 	= ?(ЗначениеЗаполнено(Выборка.СубконтоДтНУ1), Выборка.СубконтоДтНУ1, Выборка.Контрагент);
			Строка.СубконтоДтНУ2 	= ?(ЗначениеЗаполнено(Выборка.СубконтоДтНУ2), Выборка.СубконтоДтНУ2, ОбщегоНазначенияБК.ДоступныйДоговорКонтрагента(Выборка.Контрагент["ОсновнойДоговорКонтрагента"]));
			
		Иначе // Пеня по ОПВ
			Строка.ВидРасчета		= СтатьяЗатратПеняПоОПВ;
			Строка.СчетДт			= Выборка.СчетДтДляПени;
			Строка.СчетДтНУ 		= Выборка.СчетДтДляПениНУ;
			
			Если Выборка.НомерСубконтоСтатьиЗатратДляПени <> 0 Тогда
				Если ЗначениеЗаполнено(Выборка["СубконтоДтДляПени" + Выборка.НомерСубконтоСтатьиЗатратДляПени]) Тогда
					Строка["СубконтоДт" + Выборка.НомерСубконтоСтатьиЗатратДляПени] = Выборка["СубконтоДтДляПени" + Выборка.НомерСубконтоСтатьиЗатратДляПени];
				Иначе
					Строка["СубконтоДт" + Выборка.НомерСубконтоСтатьиЗатратДляПени] = СтатьяЗатратПеняПоОПВ;
				КонецЕсли;
				ОбщегоНазначенияБККлиентСервер.ЗаменитьСубконтоНУ(Строка, СчетДебетаДляПени, СчетДебетаДляПениНУ, Выборка.НомерСубконтоСтатьиЗатратДляПени, СтатьяЗатратПеняПоОПВ, "СубконтоДтНУ");
			КонецЕсли;
			Если Выборка.НомерСубконтоСтатьиЗатратДляПениНУ <> 0 Тогда
				Если ЗначениеЗаполнено(Выборка["СубконтоДтДляПениНУ" + Выборка.НомерСубконтоСтатьиЗатратДляПениНУ]) Тогда
					Строка["СубконтоДтНУ" + Выборка.НомерСубконтоСтатьиЗатратДляПениНУ] = Выборка["СубконтоДтДляПениНУ" + Выборка.НомерСубконтоСтатьиЗатратДляПениНУ];
				Иначе
					Строка["СубконтоДтНУ" + Выборка.НомерСубконтоСтатьиЗатратДляПениНУ] = СтатьяЗатратПеняПоОПВ;
				КонецЕсли;
			КонецЕсли;
			Если Выборка.НомерСубконтоПодразделенияДляПени <> 0 Тогда
				Если ЗначениеЗаполнено(Выборка["СубконтоДтДляПени" + Выборка.НомерСубконтоПодразделенияДляПени]) Тогда
					Строка["СубконтоДт" + Выборка.НомерСубконтоПодразделенияДляПени] = Выборка["СубконтоДтДляПени" + Выборка.НомерСубконтоПодразделенияДляПени];
				Иначе 
					Строка["СубконтоДт" + Выборка.НомерСубконтоПодразделенияДляПени]= Выборка.ПодразделениеОрганизации;
				КонецЕсли;
				ОбщегоНазначенияБККлиентСервер.ЗаменитьСубконтоНУ(Строка, СчетДебетаДляПени, СчетДебетаДляПениНУ, Выборка.НомерСубконтоПодразделенияДляПени, Выборка.ПодразделениеОрганизации, "СубконтоДтНУ");
			КонецЕсли;
			Если Выборка.НомерСубконтоПодразделенияДляПениНУ <> 0 Тогда
				Если ЗначениеЗаполнено(Выборка["СубконтоДтДляПениНУ" + Выборка.НомерСубконтоПодразделенияДляПениНУ]) Тогда
					Строка["СубконтоДтНУ" + Выборка.НомерСубконтоПодразделенияДляПениНУ] = Выборка["СубконтоДтДляПениНУ" + Выборка.НомерСубконтоПодразделенияДляПениНУ];
				Иначе 
					Строка["СубконтоДтНУ" + Выборка.НомерСубконтоПодразделенияДляПениНУ]= Выборка.ПодразделениеОрганизации;
				КонецЕсли;
			КонецЕсли;
			
			// Заполним оставшиеся субконто
			Для Ном = 1 По 3 Цикл
				Если НЕ ЗначениеЗаполнено(Строка["СубконтоДт" + Ном]) Тогда
					Строка["СубконтоДт" + Ном] = Выборка["СубконтоДтДляПени" + Ном];
				КонецЕсли;
				Если НЕ ЗначениеЗаполнено(Строка["СубконтоДтНУ" + Ном]) Тогда
					Если ЗначениеЗаполнено(Выборка["СубконтоДтДляПениНУ" + Ном]) Тогда
						Строка["СубконтоДтНУ" + Ном] = Выборка["СубконтоДтДляПениНУ" + Ном];
					Иначе
						ОбщегоНазначенияБККлиентСервер.ЗаменитьСубконтоНУ(Строка, СчетДебетаДляПени, СчетДебетаДляПениНУ, Ном, СтатьяЗатратПеняПоОПВ, "СубконтоДтНУ");
					КонецЕсли;
				КонецЕсли;
			КонецЦикла;

		КонецЕсли;
		
		Строка.СчетКт 		= СчетКредита;
		Строка.СубконтоКт1 	= Справочники.НалогиСборыОтчисления.ОбязательныеПенсионныеВзносы;
		Строка.СубконтоКт2 	= Выборка.ВидПлатежа;
		Если ВедетсяУчетПоСотрудникам Тогда
			Строка.СубконтоКт3	= Выборка.Физлицо;		
		КонецЕсли;    		
		Строка.СчетКтНУ 	= СчетКредитаНУ;
		ОбщегоНазначенияБККлиентСервер.ЗаменитьСубконтоНУ(Строка, СчетКредита, СчетКредитаНУ, 1, Справочники.НалогиСборыОтчисления.ОбязательныеПенсионныеВзносы, "СубконтоКтНУ");
		ОбщегоНазначенияБККлиентСервер.ЗаменитьСубконтоНУ(Строка, СчетКредита, СчетКредитаНУ, 2, Выборка.ВидПлатежа, "СубконтоКтНУ");
		Если ВедетсяУчетПоСотрудникам Тогда
			ОбщегоНазначенияБККлиентСервер.ЗаменитьСубконтоНУ(Строка, СчетКредита, СчетКредитаНУ, 3, Выборка.Физлицо, "СубконтоКтНУ");   		
		КонецЕсли;
		
		Строка.Сумма		= Выборка.СуммаПроводки;
		Строка.ФизЛицо 		= Выборка.ФизЛицо;
		Строка.СтруктурноеПодразделениеДт = Параметры.СтруктурноеПодразделение;
		Строка.СтруктурноеПодразделениеКт = Параметры.СтруктурноеПодразделение;
	КонецЦикла;	

#КонецОбласти

#Область ИПНПоРаботникам
	
	// ИПНИсчисленный
	// Поля:
	//		Физлицо
	//		Налог
	// Описание:
	// Содержит ИПН исчисленный для заданной организации в заданном периоде регистрации
	
	ИПНИсчисленныйТекст = 
	"ВЫБРАТЬ РАЗРЕШЕННЫЕ
	|	ИПНРасчетыСБюджетом.ФизЛицо,
	|	ИПНРасчетыСБюджетом.СтруктурнаяЕдиница,
	|	ВЫБОР
	|		КОГДА ГражданствоФизЛиц.Страна ЕСТЬ NULL
	|			ТОГДА ЗНАЧЕНИЕ(Справочник.КлассификаторСтранМира.Казахстан)
	|		ИНАЧЕ ГражданствоФизЛиц.Страна
	|	КОНЕЦ КАК Страна, 
	|	СУММА(ИПНРасчетыСБюджетом.Налог) КАК Налог
	|ИЗ
	|	РегистрНакопления.ИПНРасчетыСБюджетом КАК ИПНРасчетыСБюджетом
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ГражданствоФизЛиц.СрезПоследних(&парамКонецМесяца) КАК ГражданствоФизЛиц
	|		ПО ИПНРасчетыСБюджетом.ФизЛицо = ГражданствоФизЛиц.ФизЛицо
	|
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТСписокФизЛиц КАК СписокФизЛиц
	|		ПО ИПНРасчетыСБюджетом.ФизЛицо = СписокФизЛиц.ФизЛицо
	|ГДЕ
	|	ИПНРасчетыСБюджетом.Период >= &парамНачалоМесяца И 
	|	ИПНРасчетыСБюджетом.Период <= &парамКонецМесяца И 
	|	ИПНРасчетыСБюджетом.Организация = &парамОрганизация И 
	|	ИПНРасчетыСБюджетом.ВидДвижения = &парамВидДвиженияПриход И
	|	ИПНРасчетыСБюджетом.ВидСтроки = &парамВидСтрокиИсчисление И
	|	ИПНРасчетыСБюджетом.Налог <> 0 И
	|	ИПНРасчетыСБюджетом.НеОтражатьВРеглУчете = ЛОЖЬ И
	|	ИПНРасчетыСБюджетом.ФизЛицо ССЫЛКА Справочник.ФизическиеЛица И
	|	НЕ ИПНРасчетыСБюджетом.Регистратор ССЫЛКА Документ.ОтражениеНалоговойОтчетностиВРеглУчете И 
	|	ИПНРасчетыСБюджетом.Активность
	|
	|СГРУППИРОВАТЬ ПО
	|	ИПНРасчетыСБюджетом.ФизЛицо,
	|	ИПНРасчетыСБюджетом.СтруктурнаяЕдиница,
	|	ВЫБОР
	|		КОГДА ГражданствоФизЛиц.Страна ЕСТЬ NULL
	|			ТОГДА ЗНАЧЕНИЕ(Справочник.КлассификаторСтранМира.Казахстан)
	|		ИНАЧЕ ГражданствоФизЛиц.Страна
	|	КОНЕЦ
	|";
	
	Запрос.Текст = ИПНИсчисленныйТекст;
	
	Выборка = Запрос.Выполнить().Выбрать();
	
	СчетДебета = ПланыСчетов.Типовой.КраткосрочнаяЗадолженностьПоОплатеТруда;
	
	СчетДебетаНУПоУмолчанию = ПланыСчетов.Налоговый.ВзаиморасчетыСРаботниками;	
	СчетДебетаНУ = ПроцедурыБухгалтерскогоУчета.ЗаполнитьСчетНалоговогоУчетаПоУмолчанию(СчетДебета, КонецМесяца(Параметры.ПериодРегистрации),СчетДебетаНУПоУмолчанию);
	
	СчетКредита = Справочники.НалогиСборыОтчисления.ИндивидуальныйПодоходныйНалог.СчетУчетаРасчетовСКонтрагентомБУ;
	Если НЕ ЗначениеЗаполнено(СчетКредита) Тогда
		СчетКредита = ПланыСчетов.Типовой.ИндивидуальныйПодоходныйНалог;
	КонецЕсли;
	
	СчетКредитаНУ =  ПроцедурыНалоговогоУчетаВызовСервераПовтИсп.ПолучитьСчетУчетаНУИПН(СчетКредита, КонецМесяца(Параметры.ПериодРегистрации));
	                    			
	СубконтоКт2 = Перечисления.ВидыПлатежейВБюджетИФонды.Налог;
	
	Пока Выборка.Следующий() Цикл
		Строка = Параметры.ТаблицаОтражениеВУчете.Добавить();
		Строка.СчетДт 		= СчетДебета;
		Если ВедетсяУчетПоСотрудникам Тогда
			Строка.СубконтоДт1 	= Выборка.Физлицо;		
		КонецЕсли;
		
		Строка.СчетДтНУ 	= СчетДебетаНУ;
		Если ВедетсяУчетПоСотрудникам Тогда
			ОбщегоНазначенияБККлиентСервер.ЗаменитьСубконтоНУ(Строка, СчетДебета, СчетДебетаНУ, 1, Выборка.Физлицо, "СубконтоДтНУ");
		КонецЕсли;
		
		Если Параметры.ПериодРегистрации >= Дата(2015, 07, 01) Тогда
			СубконтоКт1 = Справочники.НалогиСборыОтчисления.ИндивидуальныйПодоходныйНалог;
		Иначе	
			Если Выборка.Страна = Справочники.КлассификаторСтранМира.Казахстан Тогда
				СубконтоКт1 = Справочники.НалогиСборыОтчисления.ИндивидуальныйПодоходныйНалог;
			Иначе
				СубконтоКт1 = Справочники.НалогиСборыОтчисления.ИндивидуальныйПодоходныйНалогИностранныеГраждане;
			КонецЕсли;
		КонецЕсли;
		
		Строка.СчетКт 		= СчетКредита;
		Строка.СубконтоКт1	= СубконтоКт1;
		Строка.СубконтоКт2 	= СубконтоКт2;
		НалоговыйКомитетВСтроке = Неопределено;
		Если ЗаполнятьНКпоИПН ИЛИ ЗаполнятьНКпоИПНВНУ Тогда
			НалоговыйКомитетВСтроке = ПроцедурыНалоговогоУчета.ПолучитьНалоговыйКомитетСтруктурнойЕдиницы(Выборка.СтруктурнаяЕдиница, 
																										Параметры.Организация,
																										ИсчислениеНалоговСтруктурныхЕдиниц,
																										Перечисления.РазделыНалоговогоУчета.НалогиСЗаработнойПлаты);
		КонецЕсли;	
		
		Если ЗаполнятьНКпоИПН Тогда
			// узнаем налоговый комитет структурной единицы
			Строка.СубконтоКт3 = НалоговыйКомитетВСтроке;
		КонецЕсли;
		
		Строка.СчетКтНУ 	= СчетКредитаНУ;
		ОбщегоНазначенияБККлиентСервер.ЗаменитьСубконтоНУ(Строка, СчетКредита, СчетКредитаНУ, 1, СубконтоКт1, "СубконтоКтНУ");
		ОбщегоНазначенияБККлиентСервер.ЗаменитьСубконтоНУ(Строка, СчетКредита, СчетКредитаНУ, 2, СубконтоКт2, "СубконтоКтНУ");
		Если ЗаполнятьНКпоИПНВНУ Тогда
			// узнаем налоговый комитет структурной единицы
			Строка.СубконтоКтНУ3 = НалоговыйКомитетВСтроке;			
		КонецЕсли;
		
				
		Строка.Сумма		= Выборка.Налог;
		Строка.ФизЛицо		= Выборка.ФизЛицо;
		Строка.СтруктурноеПодразделениеДт = Параметры.СтруктурноеПодразделение;
		Строка.СтруктурноеПодразделениеКт = Параметры.СтруктурноеПодразделение;
		Строка.ВидРасчета 	= СубконтоКт1;
	КонецЦикла;	
	
#КонецОбласти


#Область ИПНПоКонтрагентам

	ИПНИсчисленныйТекст = 
		"ВЫБРАТЬ РАЗРЕШЕННЫЕ
		|	ИПНРасчетыСБюджетом.ФизЛицо КАК Контрагент,
		|	ИПНРасчетыСБюджетом.СтруктурнаяЕдиница,		
		|	СУММА(ИПНРасчетыСБюджетом.Налог) КАК Налог
		|ПОМЕСТИТЬ ВТ_ИПНРасчетыСБюджетом
		|ИЗ
		|	РегистрНакопления.ИПНРасчетыСБюджетом КАК ИПНРасчетыСБюджетом
		|
		|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТСписокФизЛиц КАК СписокФизЛиц
		|		ПО ИПНРасчетыСБюджетом.ФизЛицо = СписокФизЛиц.ФизЛицо
		|
		|ГДЕ
		|	ИПНРасчетыСБюджетом.Период >= &парамНачалоМесяца И 
		|	ИПНРасчетыСБюджетом.Период <= &парамКонецМесяца И 
		|	ИПНРасчетыСБюджетом.Организация = &парамОрганизация И 
		|	ИПНРасчетыСБюджетом.ВидДвижения = &парамВидДвиженияПриход И
		|	ИПНРасчетыСБюджетом.ВидСтроки = &парамВидСтрокиИсчисление И
		|	ИПНРасчетыСБюджетом.Налог <> 0 И
		|	ИПНРасчетыСБюджетом.НеОтражатьВРеглУчете = ЛОЖЬ И
		|	ИПНРасчетыСБюджетом.ФизЛицо ССЫЛКА Справочник.Контрагенты И
		|	НЕ ИПНРасчетыСБюджетом.Регистратор ССЫЛКА Документ.ОтражениеНалоговойОтчетностиВРеглУчете И
		|	ИПНРасчетыСБюджетом.Активность
		|
		|СГРУППИРОВАТЬ ПО
		|	ИПНРасчетыСБюджетом.ФизЛицо,
		|	ИПНРасчетыСБюджетом.СтруктурнаяЕдиница
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	ИПНРасчетыСБюджетом.ФизЛицо
		|;
		|
		|// Получим данные отражения доходов контрагентов, 
		|// счета учета доходов используем как счета Дт для отражения подоходного налога
		|/////////////////////////////////////////
		|ВЫБРАТЬ
		|	ДоходыКонтрагентов.Контрагент КАК Контрагент,
		|	ДоходыКонтрагентов.ФизЛицо,		
		|	ДоходыКонтрагентов.ВидРасчета,
		|	ДоходыКонтрагентов.СчетКт,
		|	ДоходыКонтрагентов.СубконтоКт1,
		|	ДоходыКонтрагентов.СубконтоКт2,
		|	ДоходыКонтрагентов.СубконтоКт3,
		|	ДоходыКонтрагентов.СчетКтНУ,
		|	ДоходыКонтрагентов.СубконтоКтНУ1,
		|	ДоходыКонтрагентов.СубконтоКтНУ2,
		|	ДоходыКонтрагентов.СубконтоКтНУ3,
		|	ДоходыКонтрагентов.Сумма КАК Результат
		|ПОМЕСТИТЬ ВТ_ВнешняяТаблица
		|ИЗ
		|	&ВнешнийИсточник КАК ДоходыКонтрагентов
		|ИНДЕКСИРОВАТЬ ПО
		|	Контрагент
		|;
		|/////////////////////////////////////////
		|ВЫБРАТЬ РАЗРЕШЕННЫЕ
		|	ДоходыКонтрагентов.Контрагент КАК Контрагент,
		|	ДоходыКонтрагентов.ФизЛицо,		
		|	ДоходыКонтрагентов.СчетКт КАК СчетДт,
		|	ДоходыКонтрагентов.СубконтоКт1 КАК СубконтоДт1,
		|	ДоходыКонтрагентов.СубконтоКт2 КАК СубконтоДт2,
		|	ДоходыКонтрагентов.СубконтоКт3 КАК СубконтоДт3,
		|	ДоходыКонтрагентов.СчетКтНУ КАК СчетДтНУ,
		|	ДоходыКонтрагентов.СубконтоКтНУ1 КАК СубконтоДтНУ1,
		|	ДоходыКонтрагентов.СубконтоКтНУ2 КАК СубконтоДтНУ2,
		|	ДоходыКонтрагентов.СубконтоКтНУ3 КАК СубконтоДтНУ3,
		|	СУММА(ДоходыКонтрагентов.Результат) КАК Результат
		|ПОМЕСТИТЬ ВТ_БУДоходыКонтрагентов
		|ИЗ
		|	ВТ_ВнешняяТаблица КАК ДоходыКонтрагентов
		|
		|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТСписокФизЛиц КАК СписокФизЛиц
		|		ПО ДоходыКонтрагентов.Контрагент = СписокФизЛиц.ФизЛицо
		|ГДЕ
		|	ДоходыКонтрагентов.ВидРасчета.ОблагаетсяИПН <> &парамНеОблагаетсяЦеликом		
		|
		|СГРУППИРОВАТЬ ПО
		|	ДоходыКонтрагентов.Контрагент,
		|	ДоходыКонтрагентов.ФизЛицо,		
		|	ДоходыКонтрагентов.СчетКт,
		|	ДоходыКонтрагентов.СубконтоКт1,
		|	ДоходыКонтрагентов.СубконтоКт2,
		|	ДоходыКонтрагентов.СубконтоКт3,
		|	ДоходыКонтрагентов.СчетКтНУ,
		|	ДоходыКонтрагентов.СубконтоКтНУ1,
		|	ДоходыКонтрагентов.СубконтоКтНУ2,
		|	ДоходыКонтрагентов.СубконтоКтНУ3
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	ДоходыКонтрагентов.Контрагент,
		|	ДоходыКонтрагентов.ФизЛицо
		|;
		|
		|// Распределим исчисленный ИПН по данным отражения начислений 
		|/////////////////////////////////////////
		|ВЫБРАТЬ
		|	ИПНРасчетыСБюджетом.Контрагент КАК Контрагент,
		|	ИПНРасчетыСБюджетом.Контрагент.ФизЛицо КАК ФизЛицо,
		|	ИПНРасчетыСБюджетом.СтруктурнаяЕдиница,
		|	ВЫБОР
		|		КОГДА ГражданствоФизЛиц.Страна ЕСТЬ NULL 
		|			ТОГДА ЗНАЧЕНИЕ(Справочник.КлассификаторСтранМира.Казахстан)
		|		ИНАЧЕ ГражданствоФизЛиц.Страна
		|	КОНЕЦ КАК Страна, 
		|	БУДоходыКонтрагентов.СчетДт,
		|	БУДоходыКонтрагентов.СубконтоДт1,
		|	БУДоходыКонтрагентов.СубконтоДт2,
		|	БУДоходыКонтрагентов.СубконтоДт3,
		|	БУДоходыКонтрагентов.СчетДтНУ,
		|	БУДоходыКонтрагентов.СубконтоДтНУ1,
		|	БУДоходыКонтрагентов.СубконтоДтНУ2,
		|	БУДоходыКонтрагентов.СубконтоДтНУ3,
		|	СУММА(ВЫБОР
		|			КОГДА ЕСТЬNULL(БУСуммаНачислений.Результат, 0) <> 0
		|				ТОГДА ВЫРАЗИТЬ(ИПНРасчетыСБюджетом.Налог * ЕСТЬNULL(БУДоходыКонтрагентов.Результат, 0) / БУСуммаНачислений.Результат КАК ЧИСЛО(15, 2))
		|			ИНАЧЕ ИПНРасчетыСБюджетом.Налог
		|		КОНЕЦ) КАК СуммаПроводки
		|ИЗ
		|	ВТ_ИПНРасчетыСБюджетом КАК ИПНРасчетыСБюджетом
		|
		|		ЛЕВОЕ СОЕДИНЕНИЕ ВТ_БУДоходыКонтрагентов КАК БУДоходыКонтрагентов
		|		ПО ИПНРасчетыСБюджетом.Контрагент = БУДоходыКонтрагентов.Контрагент		
		|		 И ИПНРасчетыСБюджетом.Контрагент.ФизЛицо = БУДоходыКонтрагентов.ФизЛицо		
		|
		|		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
		|			БУДоходыКонтрагентов.Контрагент КАК Контрагент,		
		|			СУММА(БУДоходыКонтрагентов.Результат) КАК Результат
		|		ИЗ
		|			ВТ_БУДоходыКонтрагентов КАК БУДоходыКонтрагентов
		|		
		|		СГРУППИРОВАТЬ ПО
		|			БУДоходыКонтрагентов.Контрагент) КАК БУСуммаНачислений
		|		ПО ИПНРасчетыСБюджетом.Контрагент = БУСуммаНачислений.Контрагент		
		|
		|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ГражданствоФизЛиц.СрезПоследних(&парамКонецМесяца) КАК ГражданствоФизЛиц
		|		ПО ИПНРасчетыСБюджетом.Контрагент.ФизЛицо = ГражданствоФизЛиц.ФизЛицо
		|
		|СГРУППИРОВАТЬ ПО
		|	ИПНРасчетыСБюджетом.Контрагент,
		|	ИПНРасчетыСБюджетом.Контрагент.ФизЛицо,
		|	ИПНРасчетыСБюджетом.СтруктурнаяЕдиница,
		|	ВЫБОР
		|		КОГДА ГражданствоФизЛиц.Страна ЕСТЬ NULL 
		|			ТОГДА ЗНАЧЕНИЕ(Справочник.КлассификаторСтранМира.Казахстан)
		|		ИНАЧЕ ГражданствоФизЛиц.Страна
		|	КОНЕЦ, 
		|	БУДоходыКонтрагентов.СчетДт,
		|	БУДоходыКонтрагентов.СубконтоДт1,
		|	БУДоходыКонтрагентов.СубконтоДт2,
		|	БУДоходыКонтрагентов.СубконтоДт3,
		|	БУДоходыКонтрагентов.СчетДтНУ,
		|	БУДоходыКонтрагентов.СубконтоДтНУ1,
		|	БУДоходыКонтрагентов.СубконтоДтНУ2,
		|	БУДоходыКонтрагентов.СубконтоДтНУ3";	
	
	Запрос.Текст = ИПНИсчисленныйТекст;
	Запрос.УстановитьПараметр("ВнешнийИсточник", ПромежуточнаяТаблицаКонтрагенты);
	
	Выборка = Запрос.Выполнить().Выбрать();
	
	СчетДебетаПоУмолчанию = ПланыСчетов.Типовой.ПрочаяКраткосрочнаяКредиторскаяЗадолженность; //3397
	
	СчетДебетаНУПоУмолчаниюДляПодстановки = ПланыСчетов.Налоговый.ПоступлениеИВыбытиеИмуществаработУслугПрав;	//3310Н
	СчетДебетаНУПоУмолчанию = ПроцедурыБухгалтерскогоУчета.ЗаполнитьСчетНалоговогоУчетаПоУмолчанию(СчетДебетаПоУмолчанию, КонецМесяца(Параметры.ПериодРегистрации), СчетДебетаНУПоУмолчаниюДляПодстановки);
	
	СчетКредита = Справочники.НалогиСборыОтчисления.ИндивидуальныйПодоходныйНалог.СчетУчетаРасчетовСКонтрагентомБУ;
	Если НЕ ЗначениеЗаполнено(СчетКредита) Тогда
		СчетКредита = ПланыСчетов.Типовой.ИндивидуальныйПодоходныйНалог;  //3120
	КонецЕсли;
	
	СчетКредитаНУ =  ПроцедурыНалоговогоУчетаВызовСервераПовтИсп.ПолучитьСчетУчетаНУИПН(СчетКредита, КонецМесяца(Параметры.ПериодРегистрации));
	
	СубконтоКт2 = Перечисления.ВидыПлатежейВБюджетИФонды.Налог;
	
	Пока Выборка.Следующий() Цикл

		Строка = Параметры.ТаблицаОтражениеВУчете.Добавить();
		Строка.ФизЛицо 		= Выборка.ФизЛицо;
		Строка.СчетДт 		= ?(ЗначениеЗаполнено(Выборка.СчетДт), Выборка.СчетДт, СчетДебетаПоУмолчанию);
		Строка.СубконтоДт1 	= ?(ЗначениеЗаполнено(Выборка.СубконтоДт1), Выборка.СубконтоДт1, Выборка.Контрагент);
		Строка.СубконтоДт2 	= ?(ЗначениеЗаполнено(Выборка.СубконтоДт2), Выборка.СубконтоДт2, ОбщегоНазначенияБК.ДоступныйДоговорКонтрагента(Выборка.Контрагент["ОсновнойДоговорКонтрагента"]));
		Строка.СчетКт 		= СчетКредита;
		
		Если Параметры.ПериодРегистрации >= Дата(2015, 07, 01) Тогда
			СубконтоКт1 = Справочники.НалогиСборыОтчисления.ИндивидуальныйПодоходныйНалог;
		Иначе	
			Если Выборка.Страна = Справочники.КлассификаторСтранМира.Казахстан Тогда
				СубконтоКт1 = Справочники.НалогиСборыОтчисления.ИндивидуальныйПодоходныйНалог;
			Иначе
				СубконтоКт1 = Справочники.НалогиСборыОтчисления.ИндивидуальныйПодоходныйНалогИностранныеГраждане;
			КонецЕсли;
		КонецЕсли;
		
		Строка.СубконтоКт1	= СубконтоКт1;		
		Строка.СубконтоКт2 	= СубконтоКт2;
		
		НалоговыйКомитетВСтроке = Неопределено;
		Если ЗаполнятьНКпоИПН ИЛИ ЗаполнятьНКпоИПНВНУ Тогда
			НалоговыйКомитетВСтроке = ПроцедурыНалоговогоУчета.ПолучитьНалоговыйКомитетСтруктурнойЕдиницы(Выборка.СтруктурнаяЕдиница, 
																										Параметры.Организация,
																										ИсчислениеНалоговСтруктурныхЕдиниц,
																										Перечисления.РазделыНалоговогоУчета.НалогиСЗаработнойПлаты);
		КонецЕсли;	
		
		Если ЗаполнятьНКпоИПН Тогда
			// узнаем налоговый комитет структурной единицы
			Строка.СубконтоКт3 = НалоговыйКомитетВСтроке;
		КонецЕсли;
		
		Строка.СчетДтНУ		= ?(ЗначениеЗаполнено(Выборка.СчетДтНУ), Выборка.СчетДтНУ, СчетДебетаНУПоУмолчанию);
		Строка.СубконтоДтНУ1 	= ?(ЗначениеЗаполнено(Выборка.СубконтоДтНУ1), Выборка.СубконтоДтНУ1, Выборка.Контрагент);
		Строка.СубконтоДтНУ2 	= ?(ЗначениеЗаполнено(Выборка.СубконтоДтНУ2), Выборка.СубконтоДтНУ2, ОбщегоНазначенияБК.ДоступныйДоговорКонтрагента(Выборка.Контрагент["ОсновнойДоговорКонтрагента"]));
		
		Строка.СчетКтНУ 	= СчетКредитаНУ;
		ОбщегоНазначенияБККлиентСервер.ЗаменитьСубконтоНУ(Строка, СчетКредита, СчетКредитаНУ, 1, СубконтоКт1, "СубконтоКтНУ");
		ОбщегоНазначенияБККлиентСервер.ЗаменитьСубконтоНУ(Строка, СчетКредита, СчетКредитаНУ, 2, СубконтоКт2, "СубконтоКтНУ");
		Если ЗаполнятьНКпоИПНВНУ Тогда
			// узнаем налоговый комитет структурной единицы
			Строка.СубконтоКтНУ3 = НалоговыйКомитетВСтроке;			
		КонецЕсли;

		Строка.Сумма		= Выборка.СуммаПроводки;
		
		Строка.СтруктурноеПодразделениеДт = Параметры.СтруктурноеПодразделение;
		Строка.СтруктурноеПодразделениеКт = Параметры.СтруктурноеПодразделение;
		Строка.ВидРасчета 	= СубконтоКт1;
	КонецЦикла;	
	
#КонецОбласти


#Область ВзносыОСМСПоРаботникам
	
	ВОСМСИсчисленныйТекст = 
	"ВЫБРАТЬ РАЗРЕШЕННЫЕ
	|	ВОСМСРасчетыСФондами.ФизЛицо,
	|	ВЫБОР
	|		КОГДА ВОСМСРасчетыСФондами.ПодразделениеОрганизации <> ЗНАЧЕНИЕ(Справочник.ПодразделенияОрганизаций.ПустаяСсылка)
	|			ТОГДА ВОСМСРасчетыСФондами.ПодразделениеОрганизации
	|		ИНАЧЕ РаботникиОрганизации.ПодразделениеОрганизации
	|	КОНЕЦ КАК ПодразделениеОрганизации,	
	|	ВОСМСРасчетыСФондами.ВидПлатежа,
	|	СУММА(ВОСМСРасчетыСФондами.Взнос) КАК Взнос,
	|	ВЫБОР
	|		КОГДА РасчетПениОПВиСО.СчетЗатратБУ ЕСТЬ NULL ИЛИ РасчетПениОПВиСО.СчетЗатратБУ = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
	|			ТОГДА &парамСчетДтДляПени
	|		ИНАЧЕ РасчетПениОПВиСО.СчетЗатратБУ
	|	КОНЕЦ КАК СчетДтДляПени,
	|	ВЫБОР
	|		КОГДА РасчетПениОПВиСО.СчетЗатратБУ ЕСТЬ NULL ИЛИ РасчетПениОПВиСО.СчетЗатратБУ = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
	|			ТОГДА НЕОПРЕДЕЛЕНО
	|		ИНАЧЕ ЕСТЬNULL(РасчетПениОПВиСО.СубконтоЗатратБУ1, НЕОПРЕДЕЛЕНО)  
	|	КОНЕЦ КАК СубконтоДтДляПени1,
	|	ВЫБОР
	|		КОГДА РасчетПениОПВиСО.СчетЗатратБУ ЕСТЬ NULL ИЛИ РасчетПениОПВиСО.СчетЗатратБУ = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
	|			ТОГДА НЕОПРЕДЕЛЕНО
	|		ИНАЧЕ ЕСТЬNULL(РасчетПениОПВиСО.СубконтоЗатратБУ2, НЕОПРЕДЕЛЕНО)  
	|	КОНЕЦ КАК СубконтоДтДляПени2,
	|	ВЫБОР
	|		КОГДА РасчетПениОПВиСО.СчетЗатратБУ ЕСТЬ NULL ИЛИ РасчетПениОПВиСО.СчетЗатратБУ = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
	|			ТОГДА НЕОПРЕДЕЛЕНО
	|		ИНАЧЕ ЕСТЬNULL(РасчетПениОПВиСО.СубконтоЗатратБУ3, НЕОПРЕДЕЛЕНО)  
	|	КОНЕЦ КАК СубконтоДтДляПени3,
	|	ВЫБОР
	|		КОГДА РасчетПениОПВиСО.СчетЗатратНУ ЕСТЬ NULL ИЛИ РасчетПениОПВиСО.СчетЗатратНУ = ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
	|			ТОГДА &парамСчетДтДляПениНУ
	|		ИНАЧЕ РасчетПениОПВиСО.СчетЗатратНУ
	|	КОНЕЦ КАК СчетДтДляПениНУ,
	|	ВЫБОР
	|		КОГДА РасчетПениОПВиСО.СчетЗатратНУ ЕСТЬ NULL ИЛИ РасчетПениОПВиСО.СчетЗатратНУ = ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
	|			ТОГДА НЕОПРЕДЕЛЕНО
	|		ИНАЧЕ ЕСТЬNULL(РасчетПениОПВиСО.СубконтоЗатратНУ1, НЕОПРЕДЕЛЕНО) 
	|	КОНЕЦ КАК СубконтоДтДляПениНУ1,
	|	ВЫБОР
	|		КОГДА РасчетПениОПВиСО.СчетЗатратНУ ЕСТЬ NULL ИЛИ РасчетПениОПВиСО.СчетЗатратНУ = ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
	|			ТОГДА НЕОПРЕДЕЛЕНО
	|		ИНАЧЕ ЕСТЬNULL(РасчетПениОПВиСО.СубконтоЗатратНУ2, НЕОПРЕДЕЛЕНО) 
	|	КОНЕЦ КАК СубконтоДтДляПениНУ2,
	|	ВЫБОР
	|		КОГДА РасчетПениОПВиСО.СчетЗатратНУ ЕСТЬ NULL ИЛИ РасчетПениОПВиСО.СчетЗатратНУ = ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
	|			ТОГДА НЕОПРЕДЕЛЕНО
	|		ИНАЧЕ ЕСТЬNULL(РасчетПениОПВиСО.СубконтоЗатратНУ3, НЕОПРЕДЕЛЕНО)  
	|	КОНЕЦ КАК СубконтоДтДляПениНУ3,
	|	ЕСТЬNULL(ВидСубконтоСтатьиЗатратДляПени.НомерСтроки, 0) КАК НомерСубконтоСтатьиЗатратДляПени,
	|	ЕСТЬNULL(ВидСубконтоПодразделенияДляПени.НомерСтроки, 0) КАК НомерСубконтоПодразделенияДляПени,
	|	ЕСТЬNULL(ВидСубконтоСтатьиЗатратДляПениНУ.НомерСтроки, 0) КАК НомерСубконтоСтатьиЗатратДляПениНУ,
	|	ЕСТЬNULL(ВидСубконтоПодразделенияДляПениНУ.НомерСтроки, 0) КАК НомерСубконтоПодразделенияДляПениНУ
	|ИЗ
	|	РегистрНакопления.ВОСМСРасчетыСФондами КАК ВОСМСРасчетыСФондами
	|
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТСписокФизЛиц КАК СписокФизЛиц
	|		ПО ВОСМСРасчетыСФондами.ФизЛицо = СписокФизЛиц.ФизЛицо
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ ВТ_МестаРаботы КАК РаботникиОрганизации
	|		ПО ВОСМСРасчетыСФондами.ФизЛицо = РаботникиОрганизации.ФизЛицо
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ Документ.РасчетПениОПВиСО КАК РасчетПениОПВиСО
	|		ПО ВОСМСРасчетыСФондами.Регистратор = РасчетПениОПВиСО.Ссылка
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Типовой.ВидыСубконто КАК ВидСубконтоСтатьиЗатратДляПени
	|		ПО ВидСубконтоСтатьиЗатратДляПени.Ссылка = (ВЫБОР
	|														КОГДА РасчетПениОПВиСО.СчетЗатратБУ ЕСТЬ NULL ИЛИ РасчетПениОПВиСО.СчетЗатратБУ = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
	|															ТОГДА &парамСчетДтДляПени
	|														ИНАЧЕ РасчетПениОПВиСО.СчетЗатратБУ
	|													КОНЕЦ)
	|		   И ВидСубконтоСтатьиЗатратДляПени.ВидСубконто = &парамВидСубконтоСтатьиЗатрат
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Типовой.ВидыСубконто КАК ВидСубконтоПодразделенияДляПени
	|		ПО ВидСубконтоПодразделенияДляПени.Ссылка = (ВЫБОР
	|														КОГДА РасчетПениОПВиСО.СчетЗатратБУ ЕСТЬ NULL ИЛИ РасчетПениОПВиСО.СчетЗатратБУ = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
	|															ТОГДА &парамСчетДтДляПени
	|														ИНАЧЕ РасчетПениОПВиСО.СчетЗатратБУ
	|													КОНЕЦ)
	|		   И ВидСубконтоПодразделенияДляПени.ВидСубконто = &парамВидСубконтоПодразделения
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Налоговый.ВидыСубконто КАК ВидСубконтоСтатьиЗатратДляПениНУ
	|		ПО ВидСубконтоСтатьиЗатратДляПениНУ.Ссылка = (ВЫБОР
	|															КОГДА РасчетПениОПВиСО.СчетЗатратНУ ЕСТЬ NULL ИЛИ РасчетПениОПВиСО.СчетЗатратНУ = ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
	|																ТОГДА &парамСчетДтДляПениНУ
	|															ИНАЧЕ РасчетПениОПВиСО.СчетЗатратНУ
	|														КОНЕЦ)
	|		   И ВидСубконтоСтатьиЗатратДляПениНУ.ВидСубконто = &парамВидСубконтоСтатьиЗатрат
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Налоговый.ВидыСубконто КАК ВидСубконтоПодразделенияДляПениНУ
	|		ПО ВидСубконтоПодразделенияДляПениНУ.Ссылка = (ВЫБОР
	|															КОГДА РасчетПениОПВиСО.СчетЗатратНУ ЕСТЬ NULL ИЛИ РасчетПениОПВиСО.СчетЗатратНУ = ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
	|																ТОГДА &парамСчетДтДляПениНУ
	|															ИНАЧЕ РасчетПениОПВиСО.СчетЗатратНУ
	|														КОНЕЦ)
	|		   И ВидСубконтоПодразделенияДляПениНУ.ВидСубконто = &парамВидСубконтоПодразделения
	|
	|
	|ГДЕ
	|	ВОСМСРасчетыСФондами.Период >= &парамНачалоМесяца И 
	|	ВОСМСРасчетыСФондами.Период <= &парамКонецМесяца И 
	|	ВОСМСРасчетыСФондами.Организация = &парамОрганизация И 
	|	ВОСМСРасчетыСФондами.ВидДвижения = &парамВидДвиженияПриход И
	|	ВОСМСРасчетыСФондами.ВидСтроки = &парамВидСтрокиИсчисление И
	|	ВОСМСРасчетыСФондами.Взнос <> 0 И
	|	ВОСМСРасчетыСФондами.НеОтражатьВРеглУчете = ЛОЖЬ И
	|	НЕ ВОСМСРасчетыСФондами.Регистратор ССЫЛКА Документ.ОтражениеНалоговойОтчетностиВРеглУчете И
	|	ВОСМСРасчетыСФондами.ФизЛицо ССЫЛКА Справочник.ФизическиеЛица И 
	|	ВОСМСРасчетыСФондами.Активность " + ?(ОтражениеЗаИП, "И
	|	ВОСМСРасчетыСФондами.ФизЛицо <> &парамИндивидуальныйПредприниматель", "") + "
	|
	|СГРУППИРОВАТЬ ПО
	|	ВОСМСРасчетыСФондами.ФизЛицо,
	|	ВЫБОР
	|		КОГДА ВОСМСРасчетыСФондами.ПодразделениеОрганизации <> ЗНАЧЕНИЕ(Справочник.ПодразделенияОрганизаций.ПустаяСсылка)
	|			ТОГДА ВОСМСРасчетыСФондами.ПодразделениеОрганизации
	|		ИНАЧЕ РаботникиОрганизации.ПодразделениеОрганизации
	|	КОНЕЦ,
	|	ВОСМСРасчетыСФондами.ВидПлатежа,
	|	ВЫБОР
	|		КОГДА РасчетПениОПВиСО.СчетЗатратБУ ЕСТЬ NULL ИЛИ РасчетПениОПВиСО.СчетЗатратБУ = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
	|			ТОГДА &парамСчетДтДляПени
	|		ИНАЧЕ РасчетПениОПВиСО.СчетЗатратБУ
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА РасчетПениОПВиСО.СчетЗатратБУ ЕСТЬ NULL ИЛИ РасчетПениОПВиСО.СчетЗатратБУ = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
	|			ТОГДА НЕОПРЕДЕЛЕНО
	|		ИНАЧЕ ЕСТЬNULL(РасчетПениОПВиСО.СубконтоЗатратБУ1, НЕОПРЕДЕЛЕНО)  
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА РасчетПениОПВиСО.СчетЗатратБУ ЕСТЬ NULL ИЛИ РасчетПениОПВиСО.СчетЗатратБУ = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
	|			ТОГДА НЕОПРЕДЕЛЕНО
	|		ИНАЧЕ ЕСТЬNULL(РасчетПениОПВиСО.СубконтоЗатратБУ2, НЕОПРЕДЕЛЕНО)  
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА РасчетПениОПВиСО.СчетЗатратБУ ЕСТЬ NULL ИЛИ РасчетПениОПВиСО.СчетЗатратБУ = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
	|			ТОГДА НЕОПРЕДЕЛЕНО
	|		ИНАЧЕ ЕСТЬNULL(РасчетПениОПВиСО.СубконтоЗатратБУ3, НЕОПРЕДЕЛЕНО)  
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА РасчетПениОПВиСО.СчетЗатратНУ ЕСТЬ NULL ИЛИ РасчетПениОПВиСО.СчетЗатратНУ = ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
	|			ТОГДА &парамСчетДтДляПениНУ
	|		ИНАЧЕ РасчетПениОПВиСО.СчетЗатратНУ
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА РасчетПениОПВиСО.СчетЗатратНУ ЕСТЬ NULL ИЛИ РасчетПениОПВиСО.СчетЗатратНУ = ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
	|			ТОГДА НЕОПРЕДЕЛЕНО
	|		ИНАЧЕ ЕСТЬNULL(РасчетПениОПВиСО.СубконтоЗатратНУ1, НЕОПРЕДЕЛЕНО) 
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА РасчетПениОПВиСО.СчетЗатратНУ ЕСТЬ NULL ИЛИ РасчетПениОПВиСО.СчетЗатратНУ = ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
	|			ТОГДА НЕОПРЕДЕЛЕНО
	|		ИНАЧЕ ЕСТЬNULL(РасчетПениОПВиСО.СубконтоЗатратНУ2, НЕОПРЕДЕЛЕНО) 
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА РасчетПениОПВиСО.СчетЗатратНУ ЕСТЬ NULL ИЛИ РасчетПениОПВиСО.СчетЗатратНУ = ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
	|			ТОГДА НЕОПРЕДЕЛЕНО
	|		ИНАЧЕ ЕСТЬNULL(РасчетПениОПВиСО.СубконтоЗатратНУ3, НЕОПРЕДЕЛЕНО)  
	|	КОНЕЦ,
	|	ЕСТЬNULL(ВидСубконтоСтатьиЗатратДляПени.НомерСтроки, 0),
	|	ЕСТЬNULL(ВидСубконтоПодразделенияДляПени.НомерСтроки, 0),
	|	ЕСТЬNULL(ВидСубконтоСтатьиЗатратДляПениНУ.НомерСтроки, 0),
	|	ЕСТЬNULL(ВидСубконтоПодразделенияДляПениНУ.НомерСтроки, 0)
	|";

	Запрос.Текст = ВОСМСИсчисленныйТекст;

	СчетДебета = ПланыСчетов.Типовой.КраткосрочнаяЗадолженностьПоОплатеТруда;
	
	СчетДебетаНУПоУмолчанию = ПланыСчетов.Налоговый.ВзаиморасчетыСРаботниками;	
	СчетДебетаНУ = ПроцедурыБухгалтерскогоУчета.ЗаполнитьСчетНалоговогоУчетаПоУмолчанию(СчетДебета, КонецМесяца(Параметры.ПериодРегистрации),СчетДебетаНУПоУмолчанию);
	
	СчетКредита = Справочники.НалогиСборыОтчисления.ВзносыОбязательноеСоциальноеМедицинскоеСтрахование.СчетУчетаРасчетовСКонтрагентомБУ;
	Если НЕ ЗначениеЗаполнено(СчетКредита) Тогда
		СчетКредита = ПланыСчетов.Типовой.ОбязательстваПоВзносамОСМС;
	КонецЕсли;
	
	СчетКредитаНУ = ПроцедурыНалоговогоУчетаВызовСервераПовтИсп.ПолучитьСчетУчетаНУВОСМС(СчетКредита,КонецМесяца(Параметры.ПериодРегистрации));
	
	СтатьяЗатратПеняПоВОСМС = Справочники.СтатьиЗатрат.ПеняПоВОСМС;
	ВидНалогаСбораОтчисленияВОСМС = Справочники.НалогиСборыОтчисления.ВзносыОбязательноеСоциальноеМедицинскоеСтрахование;
	
	Выборка = Запрос.Выполнить().Выбрать();
	
	Пока Выборка.Следующий() Цикл
		Строка = Параметры.ТаблицаОтражениеВУчете.Добавить();
		
		// Ставим на разные счета затрат в зависимости от вида платежа
		Если Выборка.ВидПлатежа = Перечисления.ВидыПлатежейВБюджетИФонды.Налог
			 Или Выборка.ВидПлатежа = Перечисления.ВидыПлатежейВБюджетИФонды.НалогАкт 
			 Или Выборка.ВидПлатежа = Перечисления.ВидыПлатежейВБюджетИФонды.НалогСам Тогда
			Строка.ВидРасчета	= ВидНалогаСбораОтчисленияВОСМС;
			Строка.СчетДт 		= СчетДебета;
			Если ВедетсяУчетПоСотрудникам Тогда
				Строка.СубконтоДт1 	= Выборка.Физлицо;
			КонецЕсли;
			Строка.СчетДтНУ 		= СчетДебетаНУ;
			Если ВедетсяУчетПоСотрудникам Тогда
				ОбщегоНазначенияБККлиентСервер.ЗаменитьСубконтоНУ(Строка, СчетДебета, СчетДебетаНУ, 1, Выборка.ФизЛицо, "СубконтоДтНУ");
				Строка.СубконтоДтНУ1 	= Выборка.Физлицо;
			КонецЕсли;
		Иначе // Пеня по ВОСМС
			Строка.ВидРасчета		= СтатьяЗатратПеняПоВОСМС;
			Строка.СчетДт			= Выборка.СчетДтДляПени;
			Строка.СчетДтНУ 		= Выборка.СчетДтДляПениНУ;
			
			Если Выборка.НомерСубконтоСтатьиЗатратДляПени <> 0 Тогда
				Если ЗначениеЗаполнено(Выборка["СубконтоДтДляПени" + Выборка.НомерСубконтоСтатьиЗатратДляПени]) Тогда
					Строка["СубконтоДт" + Выборка.НомерСубконтоСтатьиЗатратДляПени] = Выборка["СубконтоДтДляПени" + Выборка.НомерСубконтоСтатьиЗатратДляПени];
				Иначе
					Строка["СубконтоДт" + Выборка.НомерСубконтоСтатьиЗатратДляПени] = СтатьяЗатратПеняПоВОСМС;
				КонецЕсли;
				ОбщегоНазначенияБККлиентСервер.ЗаменитьСубконтоНУ(Строка, СчетДебетаДляПени, СчетДебетаДляПениНУ, Выборка.НомерСубконтоСтатьиЗатратДляПени, СтатьяЗатратПеняПоВОСМС, "СубконтоДтНУ");
			КонецЕсли;
			Если Выборка.НомерСубконтоСтатьиЗатратДляПениНУ <> 0 Тогда
				Если ЗначениеЗаполнено(Выборка["СубконтоДтДляПениНУ" + Выборка.НомерСубконтоСтатьиЗатратДляПениНУ]) Тогда
					Строка["СубконтоДтНУ" + Выборка.НомерСубконтоСтатьиЗатратДляПениНУ] = Выборка["СубконтоДтДляПениНУ" + Выборка.НомерСубконтоСтатьиЗатратДляПениНУ];
				Иначе
					Строка["СубконтоДтНУ" + Выборка.НомерСубконтоСтатьиЗатратДляПениНУ] = СтатьяЗатратПеняПоВОСМС;
				КонецЕсли;
			КонецЕсли;
			Если Выборка.НомерСубконтоПодразделенияДляПени <> 0 Тогда
				Если ЗначениеЗаполнено(Выборка["СубконтоДтДляПени" + Выборка.НомерСубконтоПодразделенияДляПени]) Тогда
					Строка["СубконтоДт" + Выборка.НомерСубконтоПодразделенияДляПени] = Выборка["СубконтоДтДляПени" + Выборка.НомерСубконтоПодразделенияДляПени];
				Иначе 
					Строка["СубконтоДт" + Выборка.НомерСубконтоПодразделенияДляПени]= Выборка.ПодразделениеОрганизации;
				КонецЕсли;
				ОбщегоНазначенияБККлиентСервер.ЗаменитьСубконтоНУ(Строка, СчетДебетаДляПени, СчетДебетаДляПениНУ, Выборка.НомерСубконтоПодразделенияДляПени, Выборка.ПодразделениеОрганизации, "СубконтоДтНУ");
			КонецЕсли;
			Если Выборка.НомерСубконтоПодразделенияДляПениНУ <> 0 Тогда
				Если ЗначениеЗаполнено(Выборка["СубконтоДтДляПениНУ" + Выборка.НомерСубконтоПодразделенияДляПениНУ]) Тогда
					Строка["СубконтоДтНУ" + Выборка.НомерСубконтоПодразделенияДляПениНУ] = Выборка["СубконтоДтДляПениНУ" + Выборка.НомерСубконтоПодразделенияДляПениНУ];
				Иначе 
					Строка["СубконтоДтНУ" + Выборка.НомерСубконтоПодразделенияДляПениНУ]= Выборка.ПодразделениеОрганизации;
				КонецЕсли;
			КонецЕсли;
			
			// Заполним оставшиеся субконто
			Для Ном = 1 По 3 Цикл
				Если НЕ ЗначениеЗаполнено(Строка["СубконтоДт" + Ном]) Тогда
					Строка["СубконтоДт" + Ном] = Выборка["СубконтоДтДляПени" + Ном];
				КонецЕсли;
				Если НЕ ЗначениеЗаполнено(Строка["СубконтоДтНУ" + Ном]) Тогда
					Если ЗначениеЗаполнено(Выборка["СубконтоДтДляПениНУ" + Ном]) Тогда
						Строка["СубконтоДтНУ" + Ном] = Выборка["СубконтоДтДляПениНУ" + Ном];
					Иначе
						ОбщегоНазначенияБККлиентСервер.ЗаменитьСубконтоНУ(Строка, СчетДебетаДляПени, СчетДебетаДляПениНУ, Ном, СтатьяЗатратПеняПоВОСМС, "СубконтоДтНУ");
					КонецЕсли;
				КонецЕсли;
			КонецЦикла;

		КонецЕсли;
		
		Строка.СчетКт 		= СчетКредита;
		Строка.СубконтоКт1 	= Выборка.ВидПлатежа;
		Если ВедетсяУчетПоСотрудникам Тогда
			Строка.СубконтоКт2	= Выборка.Физлицо;		
		КонецЕсли;
		
		Строка.СчетКтНУ 	= СчетКредитаНУ;
		ОбщегоНазначенияБККлиентСервер.ЗаменитьСубконтоНУ(Строка, СчетКредита, СчетКредитаНУ, 1, Выборка.ВидПлатежа, "СубконтоКтНУ");
		Если ВедетсяУчетПоСотрудникам Тогда
			ОбщегоНазначенияБККлиентСервер.ЗаменитьСубконтоНУ(Строка, СчетКредита, СчетКредитаНУ, 2, Выборка.Физлицо, "СубконтоКтНУ");   		
		КонецЕсли;
		
		Строка.Сумма		= Выборка.Взнос;
		Строка.ФизЛицо 		= Выборка.ФизЛицо;
		Строка.СтруктурноеПодразделениеДт = Параметры.СтруктурноеПодразделение;
		Строка.СтруктурноеПодразделениеКт = Параметры.СтруктурноеПодразделение;
	КонецЦикла;	
	
#КонецОбласти


#Область ВзносыОСМСПоКонтрагентам
	
	ВОСМСИсчисленныйТекст = 
	"ВЫБРАТЬ РАЗРЕШЕННЫЕ
	|	ВОСМСРасчетыСФондами.ФизЛицо КАК Контрагент,
	|   ВОСМСРасчетыСФондами.ПодразделениеОрганизации КАК ПодразделениеОрганизации,		
	|	ВОСМСРасчетыСФондами.ВидПлатежа,
	|	ВОСМСРасчетыСФондами.Регистратор,
	|	СУММА(ВОСМСРасчетыСФондами.Взнос) КАК Взнос
	|ПОМЕСТИТЬ ВТ_ВОСМСРасчетыСФондами
	|ИЗ
	|	РегистрНакопления.ВОСМСРасчетыСФондами КАК ВОСМСРасчетыСФондами
	|
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТСписокФизЛиц КАК СписокФизЛиц
	|		ПО ВОСМСРасчетыСФондами.ФизЛицо = СписокФизЛиц.ФизЛицо
	|
	|ГДЕ
	|	ВОСМСРасчетыСФондами.Период >= &парамНачалоМесяца И 
	|	ВОСМСРасчетыСФондами.Период <= &парамКонецМесяца И 
	|	ВОСМСРасчетыСФондами.Организация = &парамОрганизация И 
	|	ВОСМСРасчетыСФондами.ВидДвижения = &парамВидДвиженияПриход И
	|	ВОСМСРасчетыСФондами.ВидСтроки = &парамВидСтрокиИсчисление И
	|	ВОСМСРасчетыСФондами.Взнос <> 0 И
	|	ВОСМСРасчетыСФондами.НеОтражатьВРеглУчете = ЛОЖЬ И
	|	НЕ ВОСМСРасчетыСФондами.Регистратор ССЫЛКА Документ.ОтражениеНалоговойОтчетностиВРеглУчете И
	|	ВОСМСРасчетыСФондами.ФизЛицо ССЫЛКА Справочник.Контрагенты " + ?(ОтражениеЗаИП, "И
	|	ВОСМСРасчетыСФондами.ФизЛицо <> &парамИндивидуальныйПредприниматель", "") + "  И
	|	ВОСМСРасчетыСФондами.Активность
	|
	|СГРУППИРОВАТЬ ПО
	|	ВОСМСРасчетыСФондами.ФизЛицо,
	|   ВОСМСРасчетыСФондами.ПодразделениеОрганизации,
	|	ВОСМСРасчетыСФондами.ВидПлатежа,
	|	ВОСМСРасчетыСФондами.Регистратор
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	ДоходыКонтрагентов.Контрагент КАК Контрагент,
	|	ДоходыКонтрагентов.ФизЛицо КАК ФизЛицо,
	|	ДоходыКонтрагентов.ВидРасчета КАК ВидРасчета,
	|	ДоходыКонтрагентов.СчетКт КАК СчетКт,
	|	ДоходыКонтрагентов.СубконтоКт1 КАК СубконтоКт1,
	|	ДоходыКонтрагентов.СубконтоКт2 КАК СубконтоКт2,
	|	ДоходыКонтрагентов.СубконтоКт3 КАК СубконтоКт3,
	|	ДоходыКонтрагентов.СчетКтНУ КАК СчетКтНУ,
	|	ДоходыКонтрагентов.СубконтоКтНУ1 КАК СубконтоКтНУ1,
	|	ДоходыКонтрагентов.СубконтоКтНУ2 КАК СубконтоКтНУ2,
	|	ДоходыКонтрагентов.СубконтоКтНУ3 КАК СубконтоКтНУ3,
	|	ДоходыКонтрагентов.Сумма КАК Результат
	|ПОМЕСТИТЬ ВТ_ВнешняяТаблицаВОСМС
	|ИЗ
	|	&ВнешнийИсточник КАК ДоходыКонтрагентов
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	Контрагент
	|;
	|
	|/////////////////////////////////////////
	|ВЫБРАТЬ РАЗРЕШЕННЫЕ
	|	ДоходыКонтрагентов.Контрагент КАК Контрагент,
	|	ДоходыКонтрагентов.ФизЛицо,		
	|	ДоходыКонтрагентов.СчетКт КАК СчетДт,
	|	ДоходыКонтрагентов.СубконтоКт1 КАК СубконтоДт1,
	|	ДоходыКонтрагентов.СубконтоКт2 КАК СубконтоДт2,
	|	ДоходыКонтрагентов.СубконтоКт3 КАК СубконтоДт3,
	|	ДоходыКонтрагентов.СчетКтНУ КАК СчетДтНУ,
	|	ДоходыКонтрагентов.СубконтоКтНУ1 КАК СубконтоДтНУ1,
	|	ДоходыКонтрагентов.СубконтоКтНУ2 КАК СубконтоДтНУ2,
	|	ДоходыКонтрагентов.СубконтоКтНУ3 КАК СубконтоДтНУ3,
	|	СУММА(ДоходыКонтрагентов.Результат) КАК Результат
	|ПОМЕСТИТЬ ВТ_БУДоходыКонтрагентовВОСМС
	|ИЗ
	|	ВТ_ВнешняяТаблицаВОСМС КАК ДоходыКонтрагентов
	|
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТСписокФизЛиц КАК СписокФизЛиц
	|		ПО ДоходыКонтрагентов.Контрагент = СписокФизЛиц.ФизЛицо
	|ГДЕ
	|	ДоходыКонтрагентов.ВидРасчета.ОблагаетсяВОСМС <> &парамНеОблагаетсяЦеликом
	|СГРУППИРОВАТЬ ПО
	|	ДоходыКонтрагентов.Контрагент,
	|	ДоходыКонтрагентов.ФизЛицо,		
	|	ДоходыКонтрагентов.СчетКт,
	|	ДоходыКонтрагентов.СубконтоКт1,
	|	ДоходыКонтрагентов.СубконтоКт2,
	|	ДоходыКонтрагентов.СубконтоКт3,
	|	ДоходыКонтрагентов.СчетКтНУ,
	|	ДоходыКонтрагентов.СубконтоКтНУ1,
	|	ДоходыКонтрагентов.СубконтоКтНУ2,
	|	ДоходыКонтрагентов.СубконтоКтНУ3
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	ДоходыКонтрагентов.Контрагент,
	|	ДоходыКонтрагентов.ФизЛицо	
	|;
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ РАЗРЕШЕННЫЕ
	|	ВОСМСРасчетыСФондами.Контрагент,
	|   ВОСМСРасчетыСФондами.ПодразделениеОрганизации,
	|	ВОСМСРасчетыСФондами.Контрагент.ФизЛицо КАК ФизЛицо,
	|	ВОСМСРасчетыСФондами.ВидПлатежа,
	|	БУДоходыКонтрагентов.СчетДт,
	|	БУДоходыКонтрагентов.СубконтоДт1,
	|	БУДоходыКонтрагентов.СубконтоДт2,
	|	БУДоходыКонтрагентов.СубконтоДт3,
	|	БУДоходыКонтрагентов.СчетДтНУ,
	|	БУДоходыКонтрагентов.СубконтоДтНУ1,
	|	БУДоходыКонтрагентов.СубконтоДтНУ2,
	|	БУДоходыКонтрагентов.СубконтоДтНУ3,
	|	СУММА(ВОСМСРасчетыСФондами.Взнос) КАК Взнос,
	|	СУММА(ВЫБОР
	|			КОГДА ЕСТЬNULL(БУСуммаНачислений.Результат, 0) <> 0
	|				ТОГДА ВЫРАЗИТЬ(ВОСМСРасчетыСФондами.Взнос * ЕСТЬNULL(БУДоходыКонтрагентов.Результат, 0) / БУСуммаНачислений.Результат КАК ЧИСЛО(15, 2))
	|			ИНАЧЕ ВОСМСРасчетыСФондами.Взнос
	|		КОНЕЦ) КАК СуммаПроводки,
	|	ВЫБОР
	|		КОГДА РасчетПениОПВиСО.СчетЗатратБУ ЕСТЬ NULL ИЛИ РасчетПениОПВиСО.СчетЗатратБУ = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
	|			ТОГДА &парамСчетДтДляПени
	|		ИНАЧЕ РасчетПениОПВиСО.СчетЗатратБУ
	|	КОНЕЦ КАК СчетДтДляПени,
	|	ВЫБОР
	|		КОГДА РасчетПениОПВиСО.СчетЗатратБУ ЕСТЬ NULL ИЛИ РасчетПениОПВиСО.СчетЗатратБУ = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
	|			ТОГДА НЕОПРЕДЕЛЕНО
	|		ИНАЧЕ ЕСТЬNULL(РасчетПениОПВиСО.СубконтоЗатратБУ1, НЕОПРЕДЕЛЕНО)  
	|	КОНЕЦ КАК СубконтоДтДляПени1,
	|	ВЫБОР
	|		КОГДА РасчетПениОПВиСО.СчетЗатратБУ ЕСТЬ NULL ИЛИ РасчетПениОПВиСО.СчетЗатратБУ = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
	|			ТОГДА НЕОПРЕДЕЛЕНО
	|		ИНАЧЕ ЕСТЬNULL(РасчетПениОПВиСО.СубконтоЗатратБУ2, НЕОПРЕДЕЛЕНО)  
	|	КОНЕЦ КАК СубконтоДтДляПени2,
	|	ВЫБОР
	|		КОГДА РасчетПениОПВиСО.СчетЗатратБУ ЕСТЬ NULL ИЛИ РасчетПениОПВиСО.СчетЗатратБУ = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
	|			ТОГДА НЕОПРЕДЕЛЕНО
	|		ИНАЧЕ ЕСТЬNULL(РасчетПениОПВиСО.СубконтоЗатратБУ3, НЕОПРЕДЕЛЕНО)  
	|	КОНЕЦ КАК СубконтоДтДляПени3,
	|	ВЫБОР
	|		КОГДА РасчетПениОПВиСО.СчетЗатратНУ ЕСТЬ NULL ИЛИ РасчетПениОПВиСО.СчетЗатратНУ = ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
	|			ТОГДА &парамСчетДтДляПениНУ
	|		ИНАЧЕ РасчетПениОПВиСО.СчетЗатратНУ
	|	КОНЕЦ КАК СчетДтДляПениНУ,
	|	ВЫБОР
	|		КОГДА РасчетПениОПВиСО.СчетЗатратНУ ЕСТЬ NULL ИЛИ РасчетПениОПВиСО.СчетЗатратНУ = ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
	|			ТОГДА НЕОПРЕДЕЛЕНО
	|		ИНАЧЕ ЕСТЬNULL(РасчетПениОПВиСО.СубконтоЗатратНУ1, НЕОПРЕДЕЛЕНО) 
	|	КОНЕЦ КАК СубконтоДтДляПениНУ1,
	|	ВЫБОР
	|		КОГДА РасчетПениОПВиСО.СчетЗатратНУ ЕСТЬ NULL ИЛИ РасчетПениОПВиСО.СчетЗатратНУ = ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
	|			ТОГДА НЕОПРЕДЕЛЕНО
	|		ИНАЧЕ ЕСТЬNULL(РасчетПениОПВиСО.СубконтоЗатратНУ2, НЕОПРЕДЕЛЕНО) 
	|	КОНЕЦ КАК СубконтоДтДляПениНУ2,
	|	ВЫБОР
	|		КОГДА РасчетПениОПВиСО.СчетЗатратНУ ЕСТЬ NULL ИЛИ РасчетПениОПВиСО.СчетЗатратНУ = ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
	|			ТОГДА НЕОПРЕДЕЛЕНО
	|		ИНАЧЕ ЕСТЬNULL(РасчетПениОПВиСО.СубконтоЗатратНУ3, НЕОПРЕДЕЛЕНО)  
	|	КОНЕЦ КАК СубконтоДтДляПениНУ3,
	|	ЕСТЬNULL(ВидСубконтоСтатьиЗатратДляПени.НомерСтроки, 0) КАК НомерСубконтоСтатьиЗатратДляПени,
	|	ЕСТЬNULL(ВидСубконтоПодразделенияДляПени.НомерСтроки, 0) КАК НомерСубконтоПодразделенияДляПени,
	|	ЕСТЬNULL(ВидСубконтоСтатьиЗатратДляПениНУ.НомерСтроки, 0) КАК НомерСубконтоСтатьиЗатратДляПениНУ,
	|	ЕСТЬNULL(ВидСубконтоПодразделенияДляПениНУ.НомерСтроки, 0) КАК НомерСубконтоПодразделенияДляПениНУ
	|ИЗ
	|	ВТ_ВОСМСРасчетыСФондами КАК ВОСМСРасчетыСФондами
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ ВТ_БУДоходыКонтрагентовВОСМС КАК БУДоходыКонтрагентов
	|		ПО ВОСМСРасчетыСФондами.Контрагент = БУДоходыКонтрагентов.Контрагент		
	|			И ВОСМСРасчетыСФондами.Контрагент.ФизЛицо = БУДоходыКонтрагентов.ФизЛицо
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
	|			БУДоходыКонтрагентов.Контрагент КАК Контрагент,		
	|			СУММА(БУДоходыКонтрагентов.Результат) КАК Результат
	|		ИЗ
	|			ВТ_БУДоходыКонтрагентовВОСМС КАК БУДоходыКонтрагентов
	|		
	|		СГРУППИРОВАТЬ ПО
	|			БУДоходыКонтрагентов.Контрагент) КАК БУСуммаНачислений
	|		ПО ВОСМСРасчетыСФондами.Контрагент = БУСуммаНачислений.Контрагент
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ Документ.РасчетПениОПВиСО КАК РасчетПениОПВиСО
	|		ПО ВОСМСРасчетыСФондами.Регистратор = РасчетПениОПВиСО.Ссылка
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Типовой.ВидыСубконто КАК ВидСубконтоСтатьиЗатратДляПени
	|		ПО ВидСубконтоСтатьиЗатратДляПени.Ссылка = (ВЫБОР
	|														КОГДА РасчетПениОПВиСО.СчетЗатратБУ ЕСТЬ NULL ИЛИ РасчетПениОПВиСО.СчетЗатратБУ = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
	|															ТОГДА &парамСчетДтДляПени
	|														ИНАЧЕ РасчетПениОПВиСО.СчетЗатратБУ
	|													КОНЕЦ)
	|		   И ВидСубконтоСтатьиЗатратДляПени.ВидСубконто = &парамВидСубконтоСтатьиЗатрат
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Типовой.ВидыСубконто КАК ВидСубконтоПодразделенияДляПени
	|		ПО ВидСубконтоПодразделенияДляПени.Ссылка = (ВЫБОР
	|														КОГДА РасчетПениОПВиСО.СчетЗатратБУ ЕСТЬ NULL ИЛИ РасчетПениОПВиСО.СчетЗатратБУ = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
	|															ТОГДА &парамСчетДтДляПени
	|														ИНАЧЕ РасчетПениОПВиСО.СчетЗатратБУ
	|													КОНЕЦ)
	|		   И ВидСубконтоПодразделенияДляПени.ВидСубконто = &парамВидСубконтоПодразделения
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Налоговый.ВидыСубконто КАК ВидСубконтоСтатьиЗатратДляПениНУ
	|		ПО ВидСубконтоСтатьиЗатратДляПениНУ.Ссылка = (ВЫБОР
	|															КОГДА РасчетПениОПВиСО.СчетЗатратНУ ЕСТЬ NULL ИЛИ РасчетПениОПВиСО.СчетЗатратНУ = ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
	|																ТОГДА &парамСчетДтДляПениНУ
	|															ИНАЧЕ РасчетПениОПВиСО.СчетЗатратНУ
	|														КОНЕЦ)
	|		   И ВидСубконтоСтатьиЗатратДляПениНУ.ВидСубконто = &парамВидСубконтоСтатьиЗатрат
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Налоговый.ВидыСубконто КАК ВидСубконтоПодразделенияДляПениНУ
	|		ПО ВидСубконтоПодразделенияДляПениНУ.Ссылка = (ВЫБОР
	|															КОГДА РасчетПениОПВиСО.СчетЗатратНУ ЕСТЬ NULL ИЛИ РасчетПениОПВиСО.СчетЗатратНУ = ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
	|																ТОГДА &парамСчетДтДляПениНУ
	|															ИНАЧЕ РасчетПениОПВиСО.СчетЗатратНУ
	|														КОНЕЦ)
	|		   И ВидСубконтоПодразделенияДляПениНУ.ВидСубконто = &парамВидСубконтоПодразделения
	|
	|
	|
	|СГРУППИРОВАТЬ ПО
	|	ВОСМСРасчетыСФондами.Контрагент,
	|   ВОСМСРасчетыСФондами.ПодразделениеОрганизации,
	|	ВОСМСРасчетыСФондами.ВидПлатежа,
	|	БУДоходыКонтрагентов.СчетДт,
	|	БУДоходыКонтрагентов.СубконтоДт1,
	|	БУДоходыКонтрагентов.СубконтоДт2,
	|	БУДоходыКонтрагентов.СубконтоДт3,
	|	БУДоходыКонтрагентов.СчетДтНУ,
	|	БУДоходыКонтрагентов.СубконтоДтНУ1,
	|	БУДоходыКонтрагентов.СубконтоДтНУ2,
	|	БУДоходыКонтрагентов.СубконтоДтНУ3,
	|	ВЫБОР
	|		КОГДА РасчетПениОПВиСО.СчетЗатратБУ ЕСТЬ NULL ИЛИ РасчетПениОПВиСО.СчетЗатратБУ = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
	|			ТОГДА &парамСчетДтДляПени
	|		ИНАЧЕ РасчетПениОПВиСО.СчетЗатратБУ
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА РасчетПениОПВиСО.СчетЗатратБУ ЕСТЬ NULL ИЛИ РасчетПениОПВиСО.СчетЗатратБУ = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
	|			ТОГДА НЕОПРЕДЕЛЕНО
	|		ИНАЧЕ ЕСТЬNULL(РасчетПениОПВиСО.СубконтоЗатратБУ1, НЕОПРЕДЕЛЕНО)  
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА РасчетПениОПВиСО.СчетЗатратБУ ЕСТЬ NULL ИЛИ РасчетПениОПВиСО.СчетЗатратБУ = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
	|			ТОГДА НЕОПРЕДЕЛЕНО
	|		ИНАЧЕ ЕСТЬNULL(РасчетПениОПВиСО.СубконтоЗатратБУ2, НЕОПРЕДЕЛЕНО)  
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА РасчетПениОПВиСО.СчетЗатратБУ ЕСТЬ NULL ИЛИ РасчетПениОПВиСО.СчетЗатратБУ = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
	|			ТОГДА НЕОПРЕДЕЛЕНО
	|		ИНАЧЕ ЕСТЬNULL(РасчетПениОПВиСО.СубконтоЗатратБУ3, НЕОПРЕДЕЛЕНО)  
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА РасчетПениОПВиСО.СчетЗатратНУ ЕСТЬ NULL ИЛИ РасчетПениОПВиСО.СчетЗатратНУ = ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
	|			ТОГДА &парамСчетДтДляПениНУ
	|		ИНАЧЕ РасчетПениОПВиСО.СчетЗатратНУ
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА РасчетПениОПВиСО.СчетЗатратНУ ЕСТЬ NULL ИЛИ РасчетПениОПВиСО.СчетЗатратНУ = ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
	|			ТОГДА НЕОПРЕДЕЛЕНО
	|		ИНАЧЕ ЕСТЬNULL(РасчетПениОПВиСО.СубконтоЗатратНУ1, НЕОПРЕДЕЛЕНО) 
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА РасчетПениОПВиСО.СчетЗатратНУ ЕСТЬ NULL ИЛИ РасчетПениОПВиСО.СчетЗатратНУ = ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
	|			ТОГДА НЕОПРЕДЕЛЕНО
	|		ИНАЧЕ ЕСТЬNULL(РасчетПениОПВиСО.СубконтоЗатратНУ2, НЕОПРЕДЕЛЕНО) 
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА РасчетПениОПВиСО.СчетЗатратНУ ЕСТЬ NULL ИЛИ РасчетПениОПВиСО.СчетЗатратНУ = ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
	|			ТОГДА НЕОПРЕДЕЛЕНО
	|		ИНАЧЕ ЕСТЬNULL(РасчетПениОПВиСО.СубконтоЗатратНУ3, НЕОПРЕДЕЛЕНО)  
	|	КОНЕЦ,
	|	ЕСТЬNULL(ВидСубконтоСтатьиЗатратДляПени.НомерСтроки, 0),
	|	ЕСТЬNULL(ВидСубконтоПодразделенияДляПени.НомерСтроки, 0),
	|	ЕСТЬNULL(ВидСубконтоСтатьиЗатратДляПениНУ.НомерСтроки, 0),
	|	ЕСТЬNULL(ВидСубконтоПодразделенияДляПениНУ.НомерСтроки, 0)
	|";

	Запрос.Текст = ВОСМСИсчисленныйТекст;

	
	СчетДебетаПоУмолчанию = ПланыСчетов.Типовой.ПрочаяКраткосрочнаяКредиторскаяЗадолженность; //3397
	
	СчетДебетаНУПоУмолчаниюДляПодстановки = ПланыСчетов.Налоговый.ПоступлениеИВыбытиеИмуществаработУслугПрав;	//3310Н
	СчетДебетаНУПоУмолчанию = ПроцедурыБухгалтерскогоУчета.ЗаполнитьСчетНалоговогоУчетаПоУмолчанию(СчетДебетаПоУмолчанию, КонецМесяца(Параметры.ПериодРегистрации), СчетДебетаНУПоУмолчаниюДляПодстановки);
	
	СчетКредита = Справочники.НалогиСборыОтчисления.ВзносыОбязательноеСоциальноеМедицинскоеСтрахование.СчетУчетаРасчетовСКонтрагентомБУ;
	Если НЕ ЗначениеЗаполнено(СчетКредита) Тогда
		СчетКредита = ПланыСчетов.Типовой.ОбязательстваПоВзносамОСМС;
	КонецЕсли;
	
	СчетКредитаНУ = ПроцедурыНалоговогоУчетаВызовСервераПовтИсп.ПолучитьСчетУчетаНУВОСМС(СчетКредита,КонецМесяца(Параметры.ПериодРегистрации));
	
	СтатьяЗатратПеняПоВОСМС = Справочники.СтатьиЗатрат.ПеняПоВОСМС;
	ВидНалогаСбораОтчисленияВОСМС = Справочники.НалогиСборыОтчисления.ВзносыОбязательноеСоциальноеМедицинскоеСтрахование;
	
	Выборка = Запрос.Выполнить().Выбрать();
	
	Пока Выборка.Следующий() Цикл
		Строка = Параметры.ТаблицаОтражениеВУчете.Добавить();
		
		// Ставим на разные счета затрат в зависимости от вида платежа
		Если Выборка.ВидПлатежа = Перечисления.ВидыПлатежейВБюджетИФонды.Налог
			Или Выборка.ВидПлатежа = Перечисления.ВидыПлатежейВБюджетИФонды.НалогАкт 
			Или Выборка.ВидПлатежа = Перечисления.ВидыПлатежейВБюджетИФонды.НалогСам Тогда
			Строка.ВидРасчета	= ВидНалогаСбораОтчисленияВОСМС;
			
			Строка.СчетДт 		= ?(ЗначениеЗаполнено(Выборка.СчетДт), Выборка.СчетДт, СчетДебетаПоУмолчанию);
			Строка.СубконтоДт1 	= ?(ЗначениеЗаполнено(Выборка.СубконтоДт1), Выборка.СубконтоДт1, Выборка.Контрагент);
			Строка.СубконтоДт2 	= ?(ЗначениеЗаполнено(Выборка.СубконтоДт2), Выборка.СубконтоДт2, ОбщегоНазначенияБК.ДоступныйДоговорКонтрагента(Выборка.Контрагент["ОсновнойДоговорКонтрагента"]));
		
			Строка.СчетДтНУ		= ?(ЗначениеЗаполнено(Выборка.СчетДтНУ), Выборка.СчетДтНУ, СчетДебетаНУПоУмолчанию);
			Строка.СубконтоДтНУ1 	= ?(ЗначениеЗаполнено(Выборка.СубконтоДтНУ1), Выборка.СубконтоДтНУ1, Выборка.Контрагент);
			Строка.СубконтоДтНУ2 	= ?(ЗначениеЗаполнено(Выборка.СубконтоДтНУ2), Выборка.СубконтоДтНУ2, ОбщегоНазначенияБК.ДоступныйДоговорКонтрагента(Выборка.Контрагент["ОсновнойДоговорКонтрагента"]));
			
		Иначе // Пеня по ВОСМС
			Строка.ВидРасчета		= СтатьяЗатратПеняПоВОСМС;
			Строка.СчетДт			= Выборка.СчетДтДляПени;
			Строка.СчетДтНУ 		= Выборка.СчетДтДляПениНУ;
			
			Если Выборка.НомерСубконтоСтатьиЗатратДляПени <> 0 Тогда
				Если ЗначениеЗаполнено(Выборка["СубконтоДтДляПени" + Выборка.НомерСубконтоСтатьиЗатратДляПени]) Тогда
					Строка["СубконтоДт" + Выборка.НомерСубконтоСтатьиЗатратДляПени] = Выборка["СубконтоДтДляПени" + Выборка.НомерСубконтоСтатьиЗатратДляПени];
				Иначе
					Строка["СубконтоДт" + Выборка.НомерСубконтоСтатьиЗатратДляПени] = СтатьяЗатратПеняПоВОСМС;
				КонецЕсли;
				ОбщегоНазначенияБККлиентСервер.ЗаменитьСубконтоНУ(Строка, СчетДебетаДляПени, СчетДебетаДляПениНУ, Выборка.НомерСубконтоСтатьиЗатратДляПени, СтатьяЗатратПеняПоВОСМС, "СубконтоДтНУ");
			КонецЕсли;
			Если Выборка.НомерСубконтоСтатьиЗатратДляПениНУ <> 0 Тогда
				Если ЗначениеЗаполнено(Выборка["СубконтоДтДляПениНУ" + Выборка.НомерСубконтоСтатьиЗатратДляПениНУ]) Тогда
					Строка["СубконтоДтНУ" + Выборка.НомерСубконтоСтатьиЗатратДляПениНУ] = Выборка["СубконтоДтДляПениНУ" + Выборка.НомерСубконтоСтатьиЗатратДляПениНУ];
				Иначе
					Строка["СубконтоДтНУ" + Выборка.НомерСубконтоСтатьиЗатратДляПениНУ] = СтатьяЗатратПеняПоВОСМС;
				КонецЕсли;
			КонецЕсли;
			Если Выборка.НомерСубконтоПодразделенияДляПени <> 0 Тогда
				Если ЗначениеЗаполнено(Выборка["СубконтоДтДляПени" + Выборка.НомерСубконтоПодразделенияДляПени]) Тогда
					Строка["СубконтоДт" + Выборка.НомерСубконтоПодразделенияДляПени] = Выборка["СубконтоДтДляПени" + Выборка.НомерСубконтоПодразделенияДляПени];
				Иначе 
					Строка["СубконтоДт" + Выборка.НомерСубконтоПодразделенияДляПени]= Выборка.ПодразделениеОрганизации;
				КонецЕсли;
				ОбщегоНазначенияБККлиентСервер.ЗаменитьСубконтоНУ(Строка, СчетДебетаДляПени, СчетДебетаДляПениНУ, Выборка.НомерСубконтоПодразделенияДляПени, Выборка.ПодразделениеОрганизации, "СубконтоДтНУ");
			КонецЕсли;
			Если Выборка.НомерСубконтоПодразделенияДляПениНУ <> 0 Тогда
				Если ЗначениеЗаполнено(Выборка["СубконтоДтДляПениНУ" + Выборка.НомерСубконтоПодразделенияДляПениНУ]) Тогда
					Строка["СубконтоДтНУ" + Выборка.НомерСубконтоПодразделенияДляПениНУ] = Выборка["СубконтоДтДляПениНУ" + Выборка.НомерСубконтоПодразделенияДляПениНУ];
				Иначе 
					Строка["СубконтоДтНУ" + Выборка.НомерСубконтоПодразделенияДляПениНУ]= Выборка.ПодразделениеОрганизации;
				КонецЕсли;
			КонецЕсли;
			
			// Заполним оставшиеся субконто
			Для Ном = 1 По 3 Цикл
				Если НЕ ЗначениеЗаполнено(Строка["СубконтоДт" + Ном]) Тогда
					Строка["СубконтоДт" + Ном] = Выборка["СубконтоДтДляПени" + Ном];
				КонецЕсли;
				Если НЕ ЗначениеЗаполнено(Строка["СубконтоДтНУ" + Ном]) Тогда
					Если ЗначениеЗаполнено(Выборка["СубконтоДтДляПениНУ" + Ном]) Тогда
						Строка["СубконтоДтНУ" + Ном] = Выборка["СубконтоДтДляПениНУ" + Ном];
					Иначе
						ОбщегоНазначенияБККлиентСервер.ЗаменитьСубконтоНУ(Строка, СчетДебетаДляПени, СчетДебетаДляПениНУ, Ном, СтатьяЗатратПеняПоВОСМС, "СубконтоДтНУ");
					КонецЕсли;
				КонецЕсли;
			КонецЦикла;

		КонецЕсли;
		
		Строка.СчетКт 		= СчетКредита;
		Строка.СубконтоКт1 	= Выборка.ВидПлатежа;
		Если ВедетсяУчетПоСотрудникам Тогда
			Строка.СубконтоКт2	= Выборка.ФизЛицо;		
		КонецЕсли;
		
		Строка.СчетКтНУ 	= СчетКредитаНУ;
		ОбщегоНазначенияБККлиентСервер.ЗаменитьСубконтоНУ(Строка, СчетКредита, СчетКредитаНУ, 1, Выборка.ВидПлатежа, "СубконтоКтНУ");
		Если ВедетсяУчетПоСотрудникам Тогда
			ОбщегоНазначенияБККлиентСервер.ЗаменитьСубконтоНУ(Строка, СчетКредита, СчетКредитаНУ, 2, Выборка.Физлицо, "СубконтоКтНУ");   		
		КонецЕсли;
		
		Строка.Сумма		= Выборка.СуммаПроводки;
		Строка.ФизЛицо 		= Выборка.ФизЛицо;
		
		Строка.СтруктурноеПодразделениеДт = Параметры.СтруктурноеПодразделение;
		Строка.СтруктурноеПодразделениеКт = Параметры.СтруктурноеПодразделение;
	КонецЦикла;	
	
#КонецОбласти


#Область СО

   	// СОИсчисленный
	//	Поля:
	//		ФизЛицо
	//		ВидПлатежа
	//		Отчисление
	//	
	//	Описание:
	//	Исчисленные социальные отчисления по видам платежа

    СОИсчисленныйТекст = "
    |ВЫБРАТЬ РАЗРЕШЕННЫЕ
	|	СОРасчетыСФондами.Регистратор КАК Регистратор,
    |	СОРасчетыСФондами.ФизЛицо КАК ФизЛицо,
    |	СОРасчетыСФондами.ВидПлатежа КАК ВидПлатежа,
    |	СУММА(СОРасчетыСФондами.Отчисление) КАК Отчисление
    |ПОМЕСТИТЬ ВТ_СОИсчисленный
    |ИЗ
    |	РегистрНакопления.СОРасчетыСФондами КАК СОРасчетыСФондами
	|
    |	ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТСписокФизЛиц КАК СписокФизЛиц
    |		ПО СОРасчетыСФондами.ФизЛицо = СписокФизЛиц.ФизЛицо
    |ГДЕ
	|	СОРасчетыСФондами.Период >= &парамНачалоМесяца И 
	|	СОРасчетыСФондами.Период <= &парамКонецМесяца И 
	|	СОРасчетыСФондами.Организация = &парамОрганизация И 
	|	СОРасчетыСФондами.ВидДвижения = &парамВидДвиженияПриход И
	|	СОРасчетыСФондами.ВидСтроки = &парамВидСтрокиИсчисление И
	|	СОРасчетыСФондами.Отчисление <> 0 И
	|	НЕ СОРасчетыСФондами.Регистратор ССЫЛКА Документ.ОтражениеНалоговойОтчетностиВРеглУчете И
	|	СОРасчетыСФондами.Активность " + ?(ОтражениеЗаИП, " И 
	|	СОРасчетыСФондами.ФизЛицо <> &парамИндивидуальныйПредприниматель", "") + "
	|
	|СГРУППИРОВАТЬ ПО
	|   СОРасчетыСФондами.Регистратор,
	|	СОРасчетыСФондами.ФизЛицо,
	|   СОРасчетыСФондами.ВидПлатежа
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	ФизЛицо
    |";
    
    Запрос.Текст = СОИсчисленныйТекст;
    Запрос.Выполнить();
    
   	// БУДоходыПоСчетам
	//	Поля:
	//		ФизЛицо
	//		ВидРасчета
	//		ПодразделениеОрганизации
	//		СчетДт
	//		СубконтоДт1
	//		СубконтоДт2
	//		СубконтоДт3
	//		Результат
	//	
	//	Описание:
	//	Данные отражения начислений в бухучете

    БУДоходыПоСчетам = 
    	"ВЫБРАТЬ
    	|	БУНачисления.ФизЛицо,
    	|	БУНачисления.СчетДт КАК СчетДт,
    	|	БУНачисления.СчетДтНУ КАК СчетДтНУ,
    	|	БУНачисления.СтруктурноеПодразделениеДт,
    	|	ВЫБОР
    	|		КОГДА ВидыСубконтоДт1.ВидСубконто = &парамВидСубконтоСтатьиЗатрат
    	|			ТОГДА &парамСтатьяЗатратСО
    	|		ИНАЧЕ БУНачисления.СубконтоДт1
    	|	КОНЕЦ КАК СубконтоДт1,
    	|	ВЫБОР
    	|		КОГДА ВидыСубконтоДт2.ВидСубконто = &парамВидСубконтоСтатьиЗатрат
    	|			ТОГДА &парамСтатьяЗатратСО
    	|		ИНАЧЕ БУНачисления.СубконтоДт2
    	|	КОНЕЦ КАК СубконтоДт2,
    	|	ВЫБОР
    	|		КОГДА ВидыСубконтоДт3.ВидСубконто = &парамВидСубконтоСтатьиЗатрат
    	|			ТОГДА &парамСтатьяЗатратСО
    	|		ИНАЧЕ БУНачисления.СубконтоДт3
    	|	КОНЕЦ КАК СубконтоДт3,
    	|	ВЫБОР
    	|		КОГДА ВидыСубконтоДтНУ1.ВидСубконто = &парамВидСубконтоСтатьиЗатрат
    	|			ТОГДА &парамСтатьяЗатратСО
    	|		ИНАЧЕ БУНачисления.СубконтоДтНУ1
    	|	КОНЕЦ КАК СубконтоДтНУ1,
    	|	ВЫБОР
    	|		КОГДА ВидыСубконтоДтНУ2.ВидСубконто = &парамВидСубконтоСтатьиЗатрат
    	|			ТОГДА &парамСтатьяЗатратСО
    	|		ИНАЧЕ БУНачисления.СубконтоДтНУ2
    	|	КОНЕЦ КАК СубконтоДтНУ2,
    	|	ВЫБОР
    	|		КОГДА ВидыСубконтоДтНУ3.ВидСубконто = &парамВидСубконтоСтатьиЗатрат
    	|			ТОГДА &парамСтатьяЗатратСО
    	|		ИНАЧЕ БУНачисления.СубконтоДтНУ3
    	|	КОНЕЦ КАК СубконтоДтНУ3,
    	|	БУНачисления.Сумма КАК Результат
    	|ПОМЕСТИТЬ ВТ_БУНачисленияСО
    	|ИЗ
    	|	ВТ_БУНачисления КАК БУНачисления
    	|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Типовой.ВидыСубконто КАК ВидыСубконтоДт1
    	|		ПО БУНачисления.СчетДт = ВидыСубконтоДт1.Ссылка
    	|			И (ВидыСубконтоДт1.НомерСтроки = 1)
    	|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Типовой.ВидыСубконто КАК ВидыСубконтоДт2
    	|		ПО БУНачисления.СчетДт = ВидыСубконтоДт2.Ссылка
    	|			И (ВидыСубконтоДт2.НомерСтроки = 2)
    	|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Типовой.ВидыСубконто КАК ВидыСубконтоДт3
    	|		ПО БУНачисления.СчетДт = ВидыСубконтоДт3.Ссылка
    	|			И (ВидыСубконтоДт3.НомерСтроки = 3)
    	|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Налоговый.ВидыСубконто КАК ВидыСубконтоДтНУ1
    	|		ПО БУНачисления.СчетДтНУ = ВидыСубконтоДтНУ1.Ссылка
    	|			И (ВидыСубконтоДтНУ1.НомерСтроки = 1)
    	|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Налоговый.ВидыСубконто КАК ВидыСубконтоДтНУ2
    	|		ПО БУНачисления.СчетДтНУ = ВидыСубконтоДтНУ2.Ссылка
    	|			И (ВидыСубконтоДтНУ2.НомерСтроки = 2)
    	|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Налоговый.ВидыСубконто КАК ВидыСубконтоДтНУ3
    	|		ПО БУНачисления.СчетДтНУ = ВидыСубконтоДтНУ3.Ссылка
    	|			И (ВидыСубконтоДтНУ3.НомерСтроки = 3)
    	|ГДЕ
    	|	БУНачисления.ВидРасчета ССЫЛКА ПланВидовРасчета.ОсновныеНачисленияОрганизаций
    	|	И БУНачисления.ВидРасчета <> &парамПустойВидРасчета
    	|	И БУНачисления.ВидРасчета <> НЕОПРЕДЕЛЕНО
    	|	И БУНачисления.ВидРасчета.ОблагаетсяСО <> &парамНеОблагаетсяЦеликом
		|	
    	|;
    	|
    	|////////////////////////////////////////////////////////////////////////////////
    	|ВЫБРАТЬ РАЗРЕШЕННЫЕ
    	|	БУНачисления.ФизЛицо,
    	|	БУНачисления.СтруктурноеПодразделениеДт,
    	|	БУНачисления.СчетДт,
    	|	БУНачисления.СчетДтНУ,
    	|	БУНачисления.СубконтоДт1,
    	|	БУНачисления.СубконтоДт2,
    	|	БУНачисления.СубконтоДт3,
    	|	БУНачисления.СубконтоДтНУ1,
    	|	БУНачисления.СубконтоДтНУ2,
    	|	БУНачисления.СубконтоДтНУ3,
    	|	СУММА(БУНачисления.Результат) КАК Результат
    	|ПОМЕСТИТЬ ВТ_БУДоходыПоСчетамСО
    	|ИЗ
    	|	ВТ_БУНачисленияСО КАК БУНачисления
    	|
    	|СГРУППИРОВАТЬ ПО
    	|	БУНачисления.ФизЛицо,
    	|	БУНачисления.СтруктурноеПодразделениеДт,
    	|	БУНачисления.СчетДт,
    	|	БУНачисления.СчетДтНУ,
    	|	БУНачисления.СубконтоДт1,
    	|	БУНачисления.СубконтоДт2,
    	|	БУНачисления.СубконтоДт3,
    	|	БУНачисления.СубконтоДтНУ1,
    	|	БУНачисления.СубконтоДтНУ2,
    	|	БУНачисления.СубконтоДтНУ3
    	|
    	|ИНДЕКСИРОВАТЬ ПО
    	|	БУНачисления.ФизЛицо";

	Запрос.Текст = БУДоходыПоСчетам;
	Запрос.Выполнить();

	// сначала определим счет, на который будем относить затраты по социальным отчислениям и распределим пропорционально сумме начислений,
	// а потом на основании счета подставим значения некоторых субконто по умолчанию
	РаспределениеСОПоСчетамЗатрат = 
		"ВЫБРАТЬ РАЗРЕШЕННЫЕ
		//исправление замечаний в рамках ТП Реализация СО за ГПХ:
		//В Документ Отражение ЗП в регл уч попадает отражение пени по СО за ГПХ, но физ лиц при этом не определяется
		//В отражение ЗП в рег уч попадает ошибочно СО за ГПХ,которое уже было отражено документом Расчет налогов при поступлении активов и услуг
		|	ВЫБОР
		|		КОГДА СОРасчетыСФондами.ФизЛицо ССЫЛКА Справочник.Контрагенты
		|			ТОГДА СОРасчетыСФондами.ФизЛицо.ФизЛицо
		|		ИНАЧЕ СОРасчетыСФондами.ФизЛицо
		|	КОНЕЦ КАК ФизЛицо,
		|	СОРасчетыСФондами.ВидПлатежа КАК ВидПлатежа,
		|	СУММА(СОРасчетыСФондами.Отчисление) КАК Отчисление,
		|	СУММА(ВЫБОР
		|			КОГДА БУСуммаНачислений.Результат <> 0
		|				ТОГДА ВЫРАЗИТЬ(СОРасчетыСФондами.Отчисление * БУНачисления.Результат / БУСуммаНачислений.Результат КАК ЧИСЛО(15, 2))
		|			ИНАЧЕ 0
		|		КОНЕЦ) КАК СуммаПроводки,
		|	ВЫБОР
		|		КОГДА НЕ БУНачисления.СчетДт ЕСТЬ NULL
		|				И НЕ(БУНачисления.СчетДт В (&парамСчетаРезервовБезСО)
		|						И БУНачисления.СубконтоДт1 В (&парамРезервыБезСО))
		|			ТОГДА БУНачисления.СчетДт
		|		КОГДА ОсновнойСпособОтражения.СпособОтраженияВБухучете = &парамСпособПоУмолчанию
		|				И НЕ МестаРаботы.СпособОтраженияВБухучете ЕСТЬ NULL
		|			ТОГДА МестаРаботы.СпособОтраженияВБухучете.СчетДт
		|		ИНАЧЕ ОсновнойСпособОтражения.СпособОтраженияВБухучете.СчетДт
		|	КОНЕЦ КАК СчетДт,
		|	ВЫБОР
		|		КОГДА НЕ БУНачисления.СчетДтНУ ЕСТЬ NULL
		|				И НЕ(БУНачисления.СчетДт В (&парамСчетаРезервовБезСО)
		|						И БУНачисления.СубконтоДт1 В (&парамРезервыБезСО))
		|			ТОГДА БУНачисления.СчетДтНУ
		|		КОГДА ОсновнойСпособОтражения.СпособОтраженияВБухучете = &парамСпособПоУмолчанию
		|				И НЕ МестаРаботы.СпособОтраженияВБухучете ЕСТЬ NULL
		|			ТОГДА МестаРаботы.СпособОтраженияВБухучете.СчетДтНУ
		|		ИНАЧЕ ОсновнойСпособОтражения.СпособОтраженияВБухучете.СчетДтНУ
		|	КОНЕЦ КАК СчетДтНУ,
		|	БУНачисления.СтруктурноеПодразделениеДт КАК СтруктурноеПодразделениеДт,
		|	БУНачисления.СчетДт КАК СчетДтОплатаТруда,
		|	БУНачисления.СубконтоДт1 КАК СубконтоДт1,
		|	БУНачисления.СубконтоДт2 КАК СубконтоДт2,
		|	БУНачисления.СубконтоДт3 КАК СубконтоДт3,
		|	БУНачисления.СубконтоДтНУ1 КАК СубконтоДтНУ1,
		|	БУНачисления.СубконтоДтНУ2 КАК СубконтоДтНУ2,
		|	БУНачисления.СубконтоДтНУ3 КАК СубконтоДтНУ3,
		|	ВЫБОР
		|		КОГДА РасчетПениОПВиСО.СчетЗатратБУ ЕСТЬ NULL
		|				ИЛИ РасчетПениОПВиСО.СчетЗатратБУ = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
		|			ТОГДА &парамСчетДтДляПени
		|		ИНАЧЕ РасчетПениОПВиСО.СчетЗатратБУ
		|	КОНЕЦ КАК СчетДтДляПени,
		|	ВЫБОР
		|		КОГДА РасчетПениОПВиСО.СчетЗатратБУ ЕСТЬ NULL
		|				ИЛИ РасчетПениОПВиСО.СчетЗатратБУ = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
		|			ТОГДА НЕОПРЕДЕЛЕНО
		|		ИНАЧЕ ЕСТЬNULL(РасчетПениОПВиСО.СубконтоЗатратБУ1, НЕОПРЕДЕЛЕНО)
		|	КОНЕЦ КАК СубконтоДтДляПени1,
		|	ВЫБОР
		|		КОГДА РасчетПениОПВиСО.СчетЗатратБУ ЕСТЬ NULL
		|				ИЛИ РасчетПениОПВиСО.СчетЗатратБУ = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
		|			ТОГДА НЕОПРЕДЕЛЕНО
		|		ИНАЧЕ ЕСТЬNULL(РасчетПениОПВиСО.СубконтоЗатратБУ2, НЕОПРЕДЕЛЕНО)
		|	КОНЕЦ КАК СубконтоДтДляПени2,
		|	ВЫБОР
		|		КОГДА РасчетПениОПВиСО.СчетЗатратБУ ЕСТЬ NULL
		|				ИЛИ РасчетПениОПВиСО.СчетЗатратБУ = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
		|			ТОГДА НЕОПРЕДЕЛЕНО
		|		ИНАЧЕ ЕСТЬNULL(РасчетПениОПВиСО.СубконтоЗатратБУ3, НЕОПРЕДЕЛЕНО)
		|	КОНЕЦ КАК СубконтоДтДляПени3,
		|	ВЫБОР
		|		КОГДА РасчетПениОПВиСО.СчетЗатратНУ ЕСТЬ NULL
		|				ИЛИ РасчетПениОПВиСО.СчетЗатратНУ = ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
		|			ТОГДА &парамСчетДтДляПениНУ
		|		ИНАЧЕ РасчетПениОПВиСО.СчетЗатратНУ
		|	КОНЕЦ КАК СчетДтДляПениНУ,
		|	ВЫБОР
		|		КОГДА РасчетПениОПВиСО.СчетЗатратНУ ЕСТЬ NULL
		|				ИЛИ РасчетПениОПВиСО.СчетЗатратНУ = ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
		|			ТОГДА НЕОПРЕДЕЛЕНО
		|		ИНАЧЕ ЕСТЬNULL(РасчетПениОПВиСО.СубконтоЗатратНУ1, НЕОПРЕДЕЛЕНО)
		|	КОНЕЦ КАК СубконтоДтДляПениНУ1,
		|	ВЫБОР
		|		КОГДА РасчетПениОПВиСО.СчетЗатратНУ ЕСТЬ NULL
		|				ИЛИ РасчетПениОПВиСО.СчетЗатратНУ = ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
		|			ТОГДА НЕОПРЕДЕЛЕНО
		|		ИНАЧЕ ЕСТЬNULL(РасчетПениОПВиСО.СубконтоЗатратНУ2, НЕОПРЕДЕЛЕНО)
		|	КОНЕЦ КАК СубконтоДтДляПениНУ2,
		|	ВЫБОР
		|		КОГДА РасчетПениОПВиСО.СчетЗатратНУ ЕСТЬ NULL
		|				ИЛИ РасчетПениОПВиСО.СчетЗатратНУ = ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
		|			ТОГДА НЕОПРЕДЕЛЕНО
		|		ИНАЧЕ ЕСТЬNULL(РасчетПениОПВиСО.СубконтоЗатратНУ3, НЕОПРЕДЕЛЕНО)
		|	КОНЕЦ КАК СубконтоДтДляПениНУ3,
		|	МестаРаботы.ПодразделениеОрганизации КАК ПодразделениеОрганизации,
		|	МестаРаботы.СпособОтраженияВБухучете КАК СпособОтраженияВБухучетеДляПодразделения,
		|	ОсновнойСпособОтражения.СпособОтраженияВБухучете КАК ОсновнойСпособОтраженияВБухучете,
		|	ЕСТЬNULL(ВидыСубконтоПодразделенияДляПени.НомерСтроки, 0) КАК НомерСубконтоПодразделенияДляПени,
		|	ЕСТЬNULL(ВидыСубконтоСтатьиЗатратДляПени.НомерСтроки, 0) КАК НомерСубконтоСтатьиЗатратДляПени,
		|	ЕСТЬNULL(ВидСубконтоСтатьиЗатратДляПениНУ.НомерСтроки, 0) КАК НомерСубконтоСтатьиЗатратДляПениНУ,
		|	ЕСТЬNULL(ВидСубконтоПодразделенияДляПениНУ.НомерСтроки, 0) КАК НомерСубконтоПодразделенияДляПениНУ
		|ПОМЕСТИТЬ ВТ_СОПоСчетамЗатрат
		|ИЗ
		|	ВТ_СОИсчисленный КАК СОРасчетыСФондами
		|		ЛЕВОЕ СОЕДИНЕНИЕ Документ.РасчетПениОПВиСО КАК РасчетПениОПВиСО
		|		ПО СОРасчетыСФондами.Регистратор = РасчетПениОПВиСО.Ссылка
		|		ЛЕВОЕ СОЕДИНЕНИЕ ВТ_БУДоходыПоСчетамСО КАК БУНачисления
		|		ПО СОРасчетыСФондами.ФизЛицо = БУНачисления.ФизЛицо
		|		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
		|			БУНачисления.ФизЛицо КАК ФизЛицо,
		|			СУММА(БУНачисления.Результат) КАК Результат
		|		ИЗ
		|			ВТ_БУДоходыПоСчетамСО КАК БУНачисления
		|		
		|		СГРУППИРОВАТЬ ПО
		|			БУНачисления.ФизЛицо) КАК БУСуммаНачислений
		|		ПО СОРасчетыСФондами.ФизЛицо = БУСуммаНачислений.ФизЛицо
		|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Типовой.ВидыСубконто КАК ВидыСубконтоПодразделенияДляПени
		|		ПО (ВидыСубконтоПодразделенияДляПени.Ссылка = ВЫБОР
		|				КОГДА РасчетПениОПВиСО.СчетЗатратБУ ЕСТЬ NULL
		|						ИЛИ РасчетПениОПВиСО.СчетЗатратБУ = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
		|					ТОГДА &парамСчетДтДляПени
		|				ИНАЧЕ РасчетПениОПВиСО.СчетЗатратБУ
		|			КОНЕЦ)
		|			И (ВидыСубконтоПодразделенияДляПени.ВидСубконто = &парамВидСубконтоПодразделения)
		|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Типовой.ВидыСубконто КАК ВидыСубконтоСтатьиЗатратДляПени
		|		ПО (ВидыСубконтоСтатьиЗатратДляПени.Ссылка = ВЫБОР
		|				КОГДА РасчетПениОПВиСО.СчетЗатратБУ ЕСТЬ NULL
		|						ИЛИ РасчетПениОПВиСО.СчетЗатратБУ = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
		|					ТОГДА &парамСчетДтДляПени
		|				ИНАЧЕ РасчетПениОПВиСО.СчетЗатратБУ
		|			КОНЕЦ)
		|			И (ВидыСубконтоСтатьиЗатратДляПени.ВидСубконто = &парамВидСубконтоСтатьиЗатрат)
		|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Налоговый.ВидыСубконто КАК ВидСубконтоСтатьиЗатратДляПениНУ
		|		ПО (ВидСубконтоСтатьиЗатратДляПениНУ.Ссылка = ВЫБОР
		|				КОГДА РасчетПениОПВиСО.СчетЗатратНУ ЕСТЬ NULL
		|						ИЛИ РасчетПениОПВиСО.СчетЗатратНУ = ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
		|					ТОГДА &парамСчетДтДляПениНУ
		|				ИНАЧЕ РасчетПениОПВиСО.СчетЗатратНУ
		|			КОНЕЦ)
		|			И (ВидСубконтоСтатьиЗатратДляПениНУ.ВидСубконто = &парамВидСубконтоСтатьиЗатрат)
		|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Налоговый.ВидыСубконто КАК ВидСубконтоПодразделенияДляПениНУ
		|		ПО (ВидСубконтоПодразделенияДляПениНУ.Ссылка = ВЫБОР
		|				КОГДА РасчетПениОПВиСО.СчетЗатратНУ ЕСТЬ NULL
		|						ИЛИ РасчетПениОПВиСО.СчетЗатратНУ = ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
		|					ТОГДА &парамСчетДтДляПениНУ
		|				ИНАЧЕ РасчетПениОПВиСО.СчетЗатратНУ
		|			КОНЕЦ)
		|			И (ВидСубконтоПодразделенияДляПениНУ.ВидСубконто = &парамВидСубконтоПодразделения)
		|		ЛЕВОЕ СОЕДИНЕНИЕ ВТ_ОсновнойСпособОтражения КАК ОсновнойСпособОтражения
		|		ПО СОРасчетыСФондами.ФизЛицо = ОсновнойСпособОтражения.ФизЛицо
		|		ЛЕВОЕ СОЕДИНЕНИЕ ВТ_МестаРаботы КАК МестаРаботы
		|		ПО СОРасчетыСФондами.ФизЛицо = МестаРаботы.ФизЛицо
		//исправление замечаний в рамках ТП Реализация СО за ГПХ:
		//В Документ Отражение ЗП в регл уч попадает отражение пени по СО за ГПХ, но физ лиц при этом не определяется
		//В отражение ЗП в рег уч попадает ошибочно СО за ГПХ,которое уже было отражено документом Расчет налогов при поступлении активов и услуг
		|ГДЕ
		|	ВЫБОР
		|			КОГДА СОРасчетыСФондами.ВидПлатежа = ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФОнды.Налог)
		|				ТОГДА СОРасчетыСФондами.ФизЛицо ССЫЛКА Справочник.ФизическиеЛица
		|			ИНАЧЕ ИСТИНА
		|		КОНЕЦ
		|
		|СГРУППИРОВАТЬ ПО
		|	ВЫБОР
		|		КОГДА СОРасчетыСФондами.ФизЛицо ССЫЛКА Справочник.Контрагенты
		|			ТОГДА СОРасчетыСФондами.ФизЛицо.ФизЛицо
		|		ИНАЧЕ СОРасчетыСФондами.ФизЛицо
		|	КОНЕЦ,
		|	СОРасчетыСФондами.ВидПлатежа,
		|	БУНачисления.СтруктурноеПодразделениеДт,
		|	БУНачисления.СчетДт,
		|	БУНачисления.СубконтоДт1,
		|	БУНачисления.СубконтоДт2,
		|	БУНачисления.СубконтоДт3,
		|	БУНачисления.СубконтоДтНУ1,
		|	БУНачисления.СубконтоДтНУ2,
		|	БУНачисления.СубконтоДтНУ3,
		|	МестаРаботы.ПодразделениеОрганизации,
		|	МестаРаботы.СпособОтраженияВБухучете,
		|	ОсновнойСпособОтражения.СпособОтраженияВБухучете,
		|	ВЫБОР
		|		КОГДА НЕ БУНачисления.СчетДт ЕСТЬ NULL
		|				И НЕ(БУНачисления.СчетДт В (&парамСчетаРезервовБезСО)
		|						И БУНачисления.СубконтоДт1 В (&парамРезервыБезСО))
		|			ТОГДА БУНачисления.СчетДт
		|		КОГДА ОсновнойСпособОтражения.СпособОтраженияВБухучете = &парамСпособПоУмолчанию
		|				И НЕ МестаРаботы.СпособОтраженияВБухучете ЕСТЬ NULL
		|			ТОГДА МестаРаботы.СпособОтраженияВБухучете.СчетДт
		|		ИНАЧЕ ОсновнойСпособОтражения.СпособОтраженияВБухучете.СчетДт
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА НЕ БУНачисления.СчетДтНУ ЕСТЬ NULL
		|				И НЕ(БУНачисления.СчетДт В (&парамСчетаРезервовБезСО)
		|						И БУНачисления.СубконтоДт1 В (&парамРезервыБезСО))
		|			ТОГДА БУНачисления.СчетДтНУ
		|		КОГДА ОсновнойСпособОтражения.СпособОтраженияВБухучете = &парамСпособПоУмолчанию
		|				И НЕ МестаРаботы.СпособОтраженияВБухучете ЕСТЬ NULL
		|			ТОГДА МестаРаботы.СпособОтраженияВБухучете.СчетДтНУ
		|		ИНАЧЕ ОсновнойСпособОтражения.СпособОтраженияВБухучете.СчетДтНУ
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА РасчетПениОПВиСО.СчетЗатратБУ ЕСТЬ NULL
		|				ИЛИ РасчетПениОПВиСО.СчетЗатратБУ = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
		|			ТОГДА &парамСчетДтДляПени
		|		ИНАЧЕ РасчетПениОПВиСО.СчетЗатратБУ
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА РасчетПениОПВиСО.СчетЗатратБУ ЕСТЬ NULL
		|				ИЛИ РасчетПениОПВиСО.СчетЗатратБУ = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
		|			ТОГДА НЕОПРЕДЕЛЕНО
		|		ИНАЧЕ ЕСТЬNULL(РасчетПениОПВиСО.СубконтоЗатратБУ1, НЕОПРЕДЕЛЕНО)
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА РасчетПениОПВиСО.СчетЗатратБУ ЕСТЬ NULL
		|				ИЛИ РасчетПениОПВиСО.СчетЗатратБУ = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
		|			ТОГДА НЕОПРЕДЕЛЕНО
		|		ИНАЧЕ ЕСТЬNULL(РасчетПениОПВиСО.СубконтоЗатратБУ2, НЕОПРЕДЕЛЕНО)
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА РасчетПениОПВиСО.СчетЗатратБУ ЕСТЬ NULL
		|				ИЛИ РасчетПениОПВиСО.СчетЗатратБУ = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
		|			ТОГДА НЕОПРЕДЕЛЕНО
		|		ИНАЧЕ ЕСТЬNULL(РасчетПениОПВиСО.СубконтоЗатратБУ3, НЕОПРЕДЕЛЕНО)
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА РасчетПениОПВиСО.СчетЗатратНУ ЕСТЬ NULL
		|				ИЛИ РасчетПениОПВиСО.СчетЗатратНУ = ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
		|			ТОГДА &парамСчетДтДляПениНУ
		|		ИНАЧЕ РасчетПениОПВиСО.СчетЗатратНУ
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА РасчетПениОПВиСО.СчетЗатратНУ ЕСТЬ NULL
		|				ИЛИ РасчетПениОПВиСО.СчетЗатратНУ = ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
		|			ТОГДА НЕОПРЕДЕЛЕНО
		|		ИНАЧЕ ЕСТЬNULL(РасчетПениОПВиСО.СубконтоЗатратНУ1, НЕОПРЕДЕЛЕНО)
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА РасчетПениОПВиСО.СчетЗатратНУ ЕСТЬ NULL
		|				ИЛИ РасчетПениОПВиСО.СчетЗатратНУ = ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
		|			ТОГДА НЕОПРЕДЕЛЕНО
		|		ИНАЧЕ ЕСТЬNULL(РасчетПениОПВиСО.СубконтоЗатратНУ2, НЕОПРЕДЕЛЕНО)
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА РасчетПениОПВиСО.СчетЗатратНУ ЕСТЬ NULL
		|				ИЛИ РасчетПениОПВиСО.СчетЗатратНУ = ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
		|			ТОГДА НЕОПРЕДЕЛЕНО
		|		ИНАЧЕ ЕСТЬNULL(РасчетПениОПВиСО.СубконтоЗатратНУ3, НЕОПРЕДЕЛЕНО)
		|	КОНЕЦ,
		|	ЕСТЬNULL(ВидыСубконтоПодразделенияДляПени.НомерСтроки, 0),
		|	ЕСТЬNULL(ВидыСубконтоСтатьиЗатратДляПени.НомерСтроки, 0),
		|	ЕСТЬNULL(ВидСубконтоСтатьиЗатратДляПениНУ.НомерСтроки, 0),
		|	ЕСТЬNULL(ВидСубконтоПодразделенияДляПениНУ.НомерСтроки, 0)
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	СчетДт,
		|	СчетДтНУ";
	Запрос.Текст = РаспределениеСОПоСчетамЗатрат;
	Запрос.Выполнить();

	// Распределяем социальные отчисления по счетам затрат пропорционально сумме начислений,
	// с которых брались эти отчисления
	РаспределениеСОПоСчетамЗатрат = "
	|ВЫБРАТЬ РАЗРЕШЕННЫЕ
	|	ДанныеУчета.ФизЛицо,
	|	ДанныеУчета.СтруктурноеПодразделениеДт,
	|	ДанныеУчета.ВидПлатежа,
	|	ДанныеУчета.Отчисление,
	|	ДанныеУчета.СуммаПроводки,
	|	ДанныеУчета.СчетДт,
	|	ДанныеУчета.СчетДтНУ,
	|
	|	ВЫБОР
	|		КОГДА НЕ(ДанныеУчета.СубконтоДт1 ЕСТЬ NULL)
	|				И НЕ(ДанныеУчета.СчетДтОплатаТруда В (&парамСчетаРезервовБезСО) И ДанныеУчета.СубконтоДт1 В (&парамРезервыБезСО))
	|			ТОГДА ДанныеУчета.СубконтоДт1
	|		КОГДА ВидыСубконтоДт1.ВидСубконто = &парамВидСубконтоСтатьиЗатрат ТОГДА &парамСтатьяЗатратСО
	|		КОГДА ВидыСубконтоДт1.ВидСубконто = &парамВидСубконтоПодразделения ТОГДА ДанныеУчета.ПодразделениеОрганизации
	|		КОГДА ДанныеУчета.ОсновнойСпособОтраженияВБухучете = &парамСпособПоУмолчанию
	|					И НЕ (ДанныеУчета.СпособОтраженияВБухучетеДляПодразделения ЕСТЬ NULL)
	|			ТОГДА ДанныеУчета.СпособОтраженияВБухучетеДляПодразделения.СубконтоДт1
	|		ИНАЧЕ ДанныеУчета.ОсновнойСпособОтраженияВБухучете.СубконтоДт1
	|	КОНЕЦ КАК СубконтоДт1,
	|
	|	ВЫБОР
	|		КОГДА НЕ(ДанныеУчета.СубконтоДт2 ЕСТЬ NULL)
	|				И НЕ(ДанныеУчета.СчетДтОплатаТруда В (&парамСчетаРезервовБезСО) И ДанныеУчета.СубконтоДт1 В (&парамРезервыБезСО))
	|			ТОГДА ДанныеУчета.СубконтоДт2
	|		КОГДА ВидыСубконтоДт2.ВидСубконто = &парамВидСубконтоСтатьиЗатрат ТОГДА &парамСтатьяЗатратСО
	|		КОГДА ВидыСубконтоДт2.ВидСубконто = &парамВидСубконтоПодразделения ТОГДА ДанныеУчета.ПодразделениеОрганизации
	|		КОГДА ДанныеУчета.ОсновнойСпособОтраженияВБухучете = &парамСпособПоУмолчанию
	|					И НЕ (ДанныеУчета.СпособОтраженияВБухучетеДляПодразделения ЕСТЬ NULL)
	|			ТОГДА ДанныеУчета.СпособОтраженияВБухучетеДляПодразделения.СубконтоДт2
	|		ИНАЧЕ ДанныеУчета.ОсновнойСпособОтраженияВБухучете.СубконтоДт2
	|	КОНЕЦ КАК СубконтоДт2,
	|
	|	ВЫБОР
	|		КОГДА НЕ(ДанныеУчета.СубконтоДт3 ЕСТЬ NULL)
	|				И НЕ(ДанныеУчета.СчетДтОплатаТруда В (&парамСчетаРезервовБезСО) И ДанныеУчета.СубконтоДт1 В (&парамРезервыБезСО))
	|			ТОГДА ДанныеУчета.СубконтоДт3
	|		КОГДА ВидыСубконтоДт3.ВидСубконто = &парамВидСубконтоСтатьиЗатрат ТОГДА &парамСтатьяЗатратСО
	|		КОГДА ВидыСубконтоДт3.ВидСубконто = &парамВидСубконтоПодразделения ТОГДА ДанныеУчета.ПодразделениеОрганизации
	|		КОГДА ДанныеУчета.ОсновнойСпособОтраженияВБухучете = &парамСпособПоУмолчанию
	|					И НЕ (ДанныеУчета.СпособОтраженияВБухучетеДляПодразделения ЕСТЬ NULL)
	|			ТОГДА ДанныеУчета.СпособОтраженияВБухучетеДляПодразделения.СубконтоДт3
	|		ИНАЧЕ ДанныеУчета.ОсновнойСпособОтраженияВБухучете.СубконтоДт3
	|	КОНЕЦ КАК СубконтоДт3,
	|
	|	ВЫБОР
	|		КОГДА НЕ(ДанныеУчета.СубконтоДтНУ1 ЕСТЬ NULL)
	|				И НЕ(ДанныеУчета.СчетДтОплатаТруда В (&парамСчетаРезервовБезСО) И ДанныеУчета.СубконтоДт1 В (&парамРезервыБезСО))
	|			ТОГДА ДанныеУчета.СубконтоДтНУ1
	|		КОГДА ВидыСубконтоДтНУ1.ВидСубконто = &парамВидСубконтоСтатьиЗатрат ТОГДА &парамСтатьяЗатратСО
	|		КОГДА ВидыСубконтоДтНУ1.ВидСубконто = &парамВидСубконтоПодразделения ТОГДА ДанныеУчета.ПодразделениеОрганизации
	|		КОГДА ДанныеУчета.ОсновнойСпособОтраженияВБухучете = &парамСпособПоУмолчанию
	|					И НЕ (ДанныеУчета.СпособОтраженияВБухучетеДляПодразделения ЕСТЬ NULL)
	|			ТОГДА ДанныеУчета.СпособОтраженияВБухучетеДляПодразделения.СубконтоДтНУ1
	|		ИНАЧЕ ДанныеУчета.ОсновнойСпособОтраженияВБухучете.СубконтоДтНУ1
	|	КОНЕЦ КАК СубконтоДтНУ1,
	|
	|	ВЫБОР
	|		КОГДА НЕ(ДанныеУчета.СубконтоДтНУ2 ЕСТЬ NULL)
	|				И НЕ(ДанныеУчета.СчетДтОплатаТруда В (&парамСчетаРезервовБезСО) И ДанныеУчета.СубконтоДт1 В (&парамРезервыБезСО))
	|			ТОГДА ДанныеУчета.СубконтоДтНУ2
	|		КОГДА ВидыСубконтоДтНУ2.ВидСубконто = &парамВидСубконтоСтатьиЗатрат ТОГДА &парамСтатьяЗатратСО
	|		КОГДА ВидыСубконтоДтНУ2.ВидСубконто = &парамВидСубконтоПодразделения ТОГДА ДанныеУчета.ПодразделениеОрганизации
	|		КОГДА ДанныеУчета.ОсновнойСпособОтраженияВБухучете = &парамСпособПоУмолчанию
	|					И НЕ (ДанныеУчета.СпособОтраженияВБухучетеДляПодразделения ЕСТЬ NULL)
	|			ТОГДА ДанныеУчета.СпособОтраженияВБухучетеДляПодразделения.СубконтоДтНУ2
	|		ИНАЧЕ ДанныеУчета.ОсновнойСпособОтраженияВБухучете.СубконтоДтНУ2
	|	КОНЕЦ КАК СубконтоДтНУ2,
	|
	|	ВЫБОР
	|		КОГДА НЕ(ДанныеУчета.СубконтоДтНУ3 ЕСТЬ NULL)
	|				И НЕ(ДанныеУчета.СчетДтОплатаТруда В (&парамСчетаРезервовБезСО) И ДанныеУчета.СубконтоДт1 В (&парамРезервыБезСО))
	|			ТОГДА ДанныеУчета.СубконтоДтНУ3
	|		КОГДА ВидыСубконтоДтНУ3.ВидСубконто = &парамВидСубконтоСтатьиЗатрат ТОГДА &парамСтатьяЗатратСО
	|		КОГДА ВидыСубконтоДтНУ3.ВидСубконто = &парамВидСубконтоПодразделения ТОГДА ДанныеУчета.ПодразделениеОрганизации
	|		КОГДА ДанныеУчета.ОсновнойСпособОтраженияВБухучете = &парамСпособПоУмолчанию
	|					И НЕ (ДанныеУчета.СпособОтраженияВБухучетеДляПодразделения ЕСТЬ NULL)
	|			ТОГДА ДанныеУчета.СпособОтраженияВБухучетеДляПодразделения.СубконтоДтНУ3
	|		ИНАЧЕ ДанныеУчета.ОсновнойСпособОтраженияВБухучете.СубконтоДтНУ3
	|	КОНЕЦ КАК СубконтоДтНУ3,
	|	ДанныеУчета.СчетДтДляПени,
	|	ДанныеУчета.СубконтоДтДляПени1,
	|	ДанныеУчета.СубконтоДтДляПени2,
	|	ДанныеУчета.СубконтоДтДляПени3,
	|	ДанныеУчета.СчетДтДляПениНУ,
	|	ДанныеУчета.СубконтоДтДляПениНУ1,
	|	ДанныеУчета.СубконтоДтДляПениНУ2,
	|	ДанныеУчета.СубконтоДтДляПениНУ3,
	|
	|	ДанныеУчета.ПодразделениеОрганизации,
	|	ДанныеУчета.НомерСубконтоПодразделенияДляПени,
	|	ДанныеУчета.НомерСубконтоСтатьиЗатратДляПени,
	|	ДанныеУчета.НомерСубконтоПодразделенияДляПениНУ,
	|	ДанныеУчета.НомерСубконтоСтатьиЗатратДляПениНУ
	|
	|ИЗ	
	|	ВТ_СОПоСчетамЗатрат КАК ДанныеУчета
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Типовой.ВидыСубконто КАК ВидыСубконтоДт1
	|		ПО ДанныеУчета.СчетДт = ВидыСубконтоДт1.Ссылка
	|		   И ВидыСубконтоДт1.НомерСтроки = 1
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Типовой.ВидыСубконто КАК ВидыСубконтоДт2
	|		ПО ДанныеУчета.СчетДт = ВидыСубконтоДт2.Ссылка
	|		   И ВидыСубконтоДт2.НомерСтроки = 2
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Типовой.ВидыСубконто КАК ВидыСубконтоДт3
	|		ПО ДанныеУчета.СчетДт = ВидыСубконтоДт3.Ссылка
	|		   И ВидыСубконтоДт3.НомерСтроки = 3
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Налоговый.ВидыСубконто КАК ВидыСубконтоДтНУ1
	|		ПО ДанныеУчета.СчетДтНУ = ВидыСубконтоДтНУ1.Ссылка
	|		   И ВидыСубконтоДтНУ1.НомерСтроки = 1
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Налоговый.ВидыСубконто КАК ВидыСубконтоДтНУ2
	|		ПО ДанныеУчета.СчетДтНУ = ВидыСубконтоДтНУ2.Ссылка
	|		   И ВидыСубконтоДтНУ2.НомерСтроки = 2
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Налоговый.ВидыСубконто КАК ВидыСубконтоДтНУ3
	|		ПО ДанныеУчета.СчетДтНУ = ВидыСубконтоДтНУ3.Ссылка
	|		   И ВидыСубконтоДтНУ3.НомерСтроки = 3
	|
	|УПОРЯДОЧИТЬ ПО
	|	ДанныеУчета.ФизЛицо,
	|	ДанныеУчета.ВидПлатежа
	|";

	Запрос.Текст = РаспределениеСОПоСчетамЗатрат;
	Запрос.Выполнить();
	
	СчетКредита = Справочники.НалогиСборыОтчисления.ОбязательныеСоциальныеОтчисления.СчетУчетаРасчетовСКонтрагентомБУ;
	Если НЕ ЗначениеЗаполнено(СчетКредита) Тогда
		СчетКредита = ПланыСчетов.Типовой.ОбязательстваПоСоциальномуСтрахованию;
	КонецЕсли;  	
	
	СчетКредитаНУ = ПроцедурыНалоговогоУчетаВызовСервераПовтИсп.ПолучитьСчетУчетаНУСО(СчетКредита, КонецМесяца(Параметры.ПериодРегистрации));
	
	СтатьяЗатратПеняПоСО = Справочники.СтатьиЗатрат.ПеняПоСО;	
	ВидНалогаСбораОтчисленияСО = Справочники.НалогиСборыОтчисления.ОбязательныеСоциальныеОтчисления;
	          
	Выборка = Запрос.Выполнить().Выбрать();

	ЕстьДанные = Выборка.Следующий();
	Пока ЕстьДанные Цикл
		ТекущееФизЛицо = Выборка.ФизЛицо;
		ТекущийВидПлатежа = Выборка.ВидПлатежа;
		СуммаКРаспределению = Выборка.Отчисление;
		РаспределеннаяСумма = 0;
		
		Пока ЕстьДанные И Выборка.ФизЛицо = ТекущееФизЛицо 
			 И Выборка.ВидПлатежа = ТекущийВидПлатежа Цикл
			Строка = ПромежуточнаяТаблица.Добавить();
			
			// В зависимости от вида платежа (Налог/Взнос или пеня) ставим на разные счета затрат
			Если ТекущийВидПлатежа = Перечисления.ВидыПлатежейВБюджетИФонды.Налог
				 ИЛИ ТекущийВидПлатежа = Перечисления.ВидыПлатежейВБюджетИФонды.НалогАкт
				 ИЛИ ТекущийВидПлатежа = Перечисления.ВидыПлатежейВБюджетИФонды.НалогСам Тогда
				Строка.ВидРасчета	= ВидНалогаСбораОтчисленияСО;
				Строка.СчетДт 		= Выборка.СчетДт;
				Строка.СубконтоДт1 	= Выборка.СубконтоДт1;
				Строка.СубконтоДт2 	= Выборка.СубконтоДт2;
				Строка.СубконтоДт3 	= Выборка.СубконтоДт3;
				
				Строка.СчетДтНУ = Выборка.СчетДтНУ;
				Строка.СубконтоДтНУ1 = Выборка.СубконтоДтНУ1;
				Строка.СубконтоДтНУ2 = Выборка.СубконтоДтНУ2;
				Строка.СубконтоДтНУ3 = Выборка.СубконтоДтНУ3;
			Иначе
				Строка.ВидРасчета	= СтатьяЗатратПеняПоСО;
				Строка.СчетДт	    = Выборка.СчетДтДляПени;
				Если Выборка.НомерСубконтоСтатьиЗатратДляПени <> 0 Тогда
					Если ЗначениеЗаполнено(Выборка["СубконтоДтДляПени" + Выборка.НомерСубконтоСтатьиЗатратДляПени]) Тогда
						Строка["СубконтоДт" + Выборка.НомерСубконтоСтатьиЗатратДляПени] = Выборка["СубконтоДтДляПени" + Выборка.НомерСубконтоСтатьиЗатратДляПени];
					Иначе 
						Строка["СубконтоДт" + Выборка.НомерСубконтоСтатьиЗатратДляПени]	= СтатьяЗатратПеняПоСО;
					КонецЕсли;
				КонецЕсли;
				Если Выборка.НомерСубконтоСтатьиЗатратДляПениНУ <> 0 Тогда
					Если ЗначениеЗаполнено(Выборка["СубконтоДтДляПениНУ" + Выборка.НомерСубконтоСтатьиЗатратДляПениНУ]) Тогда
						Строка["СубконтоДтНУ" + Выборка.НомерСубконтоСтатьиЗатратДляПениНУ] = Выборка["СубконтоДтДляПениНУ" + Выборка.НомерСубконтоСтатьиЗатратДляПениНУ];
					Иначе 
						Строка["СубконтоДтНУ" + Выборка.НомерСубконтоСтатьиЗатратДляПениНУ]	= СтатьяЗатратПеняПоСО;
					КонецЕсли;
				КонецЕсли;
				Если Выборка.НомерСубконтоПодразделенияДляПени <> 0 Тогда
					Если ЗначениеЗаполнено(Выборка["СубконтоДтДляПени" + Выборка.НомерСубконтоПодразделенияДляПени]) Тогда
						Строка["СубконтоДт" + Выборка.НомерСубконтоПодразделенияДляПени] = Выборка["СубконтоДтДляПени" + Выборка.НомерСубконтоПодразделенияДляПени];
					Иначе 
						Строка["СубконтоДт" + Выборка.НомерСубконтоПодразделенияДляПени]= Выборка.ПодразделениеОрганизации;
					КонецЕсли;
				КонецЕсли;
				Если Выборка.НомерСубконтоПодразделенияДляПениНУ <> 0 Тогда
					Если ЗначениеЗаполнено(Выборка["СубконтоДтДляПениНУ" + Выборка.НомерСубконтоПодразделенияДляПениНУ]) Тогда
						Строка["СубконтоДтНУ" + Выборка.НомерСубконтоПодразделенияДляПениНУ] = Выборка["СубконтоДтДляПениНУ" + Выборка.НомерСубконтоПодразделенияДляПениНУ];
					Иначе 
						Строка["СубконтоДтНУ" + Выборка.НомерСубконтоПодразделенияДляПениНУ]= Выборка.ПодразделениеОрганизации;
					КонецЕсли;
				КонецЕсли;

				// Заполним оставшиеся субконто
				Для Ном = 1 по 3 Цикл
					Если НЕ ЗначениеЗаполнено(Строка["СубконтоДт" + Ном]) Тогда 
						Строка["СубконтоДт" + Ном] = Выборка["СубконтоДтДляПени" + Ном];
					КонецЕсли;
					Если НЕ ЗначениеЗаполнено(Строка["СубконтоДтНУ" + Ном]) Тогда
						Если ЗначениеЗаполнено(Выборка["СубконтоДтДляПениНУ" + Ном]) Тогда
							Строка["СубконтоДтНУ" + Ном] = Выборка["СубконтоДтДляПениНУ" + Ном];
						Иначе
							ОбщегоНазначенияБККлиентСервер.ЗаменитьСубконтоНУ(Строка, СчетДебетаДляПени, СчетДебетаДляПениНУ, Ном, СтатьяЗатратПеняПоСО, "СубконтоДтНУ");
						КонецЕсли;
					КонецЕсли;
				КонецЦикла;

				Строка.СчетДтНУ = Выборка.СчетДтДляПениНУ;			
				ОбщегоНазначенияБККлиентСервер.ЗаменитьСубконтоНУ(Строка, Строка.СчетДт, Строка.СчетДтНУ, 1, Строка.СубконтоДт1, "СубконтоДтНУ");
				ОбщегоНазначенияБККлиентСервер.ЗаменитьСубконтоНУ(Строка, Строка.СчетДт, Строка.СчетДтНУ, 2, Строка.СубконтоДт2, "СубконтоДтНУ");
				ОбщегоНазначенияБККлиентСервер.ЗаменитьСубконтоНУ(Строка, Строка.СчетДт, Строка.СчетДтНУ, 3, Строка.СубконтоДт3, "СубконтоДтНУ");
			КонецЕсли;			
		
			Строка.СчетКт 		= СчетКредита;
			Строка.СубконтоКт1 	= Выборка.ВидПлатежа;
			Если ВедетсяУчетПоСотрудникам Тогда
				Строка.СубконтоКт2	= Выборка.Физлицо;
			КонецЕсли;
			
			Строка.СчетКтНУ = СчетКредитаНУ;
			ОбщегоНазначенияБККлиентСервер.ЗаменитьСубконтоНУ(Строка, Строка.СчетКт, Строка.СчетКтНУ, 1, Строка.СубконтоКт1, "СубконтоКтНУ");
			ОбщегоНазначенияБККлиентСервер.ЗаменитьСубконтоНУ(Строка, Строка.СчетКт, Строка.СчетКтНУ, 2, Строка.СубконтоКт2, "СубконтоКтНУ");
			
			Строка.Сумма					= Выборка.СуммаПроводки;
			Строка.ФизЛицо					= Выборка.ФизЛицо;
			Строка.СтруктурноеПодразделениеДт = Выборка.СтруктурноеПодразделениеДт;
			Строка.СтруктурноеПодразделениеКт = Параметры.СтруктурноеПодразделение;
			РаспределеннаяСумма 			= РаспределеннаяСумма + Выборка.СуммаПроводки;
			
			ЕстьДанные = Выборка.Следующий();
		КонецЦикла;
		
		// Остаток на последнюю строку по работнику
		Если СуммаКРаспределению <> РаспределеннаяСумма Тогда
			Строка.Сумма = Строка.Сумма + (СуммаКРаспределению - РаспределеннаяСумма);
		КонецЕсли;
	КонецЦикла;	

#КонецОбласти


#Область СН

	// ФизлицаИностранныеСпециалисты
	//	Поля:
	//		Физлицо
	//
	//	Описание:
	//	сисок физлиц-иностранных специалистов
	ФизлицаИностранныеСпециалистыТекст = "
	|ВЫБРАТЬ РАЗРЕШЕННЫЕ РАЗЛИЧНЫЕ
	|	ГражданствоФизЛиц.ФизЛицо
	|ПОМЕСТИТЬ ВТ_ФизлицаИностранныеСпециалисты
	|ИЗ
	|	РегистрСведений.ГражданствоФизЛиц.СрезПоследних(&парамКонецМесяца) КАК ГражданствоФизЛиц
	|
	|ГДЕ
	|	(ГражданствоФизЛиц.ИностранныйСпециалист)
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	ФизЛицо
	|";

	Запрос.Текст = ФизлицаИностранныеСпециалистыТекст;
	Запрос.Выполнить();

	// СНИсчисленный
	//	Поля:
	//		ФизЛицо
	//		Налог
	//	
	//	Описание:
	//	Исчисленный социальный налог

    СНИсчисленныйТекст = "
    |ВЫБРАТЬ РАЗРЕШЕННЫЕ
    |	СНИсчисленный.ФизЛицо КАК ФизЛицо,
    |	СНИсчисленный.СтруктурнаяЕдиница,
    |	СУММА(СНИсчисленный.Налог) КАК Налог
    |
    |ПОМЕСТИТЬ ВТ_СНИсчисленный
    |ИЗ
    |	РегистрНакопления.СНИсчисленный КАК СНИсчисленный
	|
    |	ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТСписокФизЛиц КАК СписокФизЛиц
    |		ПО СНИсчисленный.ФизЛицо = СписокФизЛиц.ФизЛицо
	|
    |ГДЕ
	|	СНИсчисленный.Период >= &парамНачалоМесяца И 
	|	СНИсчисленный.Период <= &парамКонецМесяца И 
	|	СНИсчисленный.Организация = &парамОрганизация И
	|	СНИсчисленный.Налог <> 0 И
	|	СНИсчисленный.НеОтражатьВРеглУчете = ЛОЖЬ И
	|	НЕ СНИсчисленный.Регистратор ССЫЛКА Документ.ОтражениеНалоговойОтчетностиВРеглУчете И
	|	СНИсчисленный.Активность " + ?(ОтражениеЗаИП, " И 
	|	СНИсчисленный.ФизЛицо <> &парамИндивидуальныйПредприниматель", "") + "
	|
	|СГРУППИРОВАТЬ ПО
	|   СНИсчисленный.ФизЛицо,
	|	СНИсчисленный.СтруктурнаяЕдиница
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	ФизЛицо
    |";
    
    Запрос.Текст = СНИсчисленныйТекст;
    Запрос.Выполнить();
    
   	// БУДоходыПоСчетам
	//	Поля:
	//		ФизЛицо
	//		СчетДт
	//		СубконтоДт1
	//		СубконтоДт2
	//		СубконтоДт3
	//		Результат
	//	
	//	Описание:
	//	Данные отражения начислений в бухучете
	
    БУДоходыПоСчетам = "
    |ВЫБРАТЬ
    |	БУНачисления.ФизЛицо,
	|	БУНачисления.СтруктурноеПодразделениеДт,
    |	БУНачисления.СчетДт КАК СчетДт,
    |	БУНачисления.СчетДтНУ КАК СчетДтНУ,
    |	ВЫБОР 
    |		КОГДА ВидыСубконтоДт1.ВидСубконто = &парамВидСубконтоСтатьиЗатрат ТОГДА &парамСтатьяЗатратСН
    |		ИНАЧЕ БУНачисления.СубконтоДт1
    |	КОНЕЦ КАК СубконтоДт1,
    |	ВЫБОР 
    |		КОГДА ВидыСубконтоДт2.ВидСубконто = &парамВидСубконтоСтатьиЗатрат ТОГДА &парамСтатьяЗатратСН
    |		ИНАЧЕ БУНачисления.СубконтоДт2
    |	КОНЕЦ КАК СубконтоДт2,
    |	ВЫБОР 
    |		КОГДА ВидыСубконтоДт3.ВидСубконто = &парамВидСубконтоСтатьиЗатрат ТОГДА &парамСтатьяЗатратСН
    |		ИНАЧЕ БУНачисления.СубконтоДт3
    |	КОНЕЦ КАК СубконтоДт3,
    |	ВЫБОР 
    |		КОГДА ВидыСубконтоДтНУ1.ВидСубконто = &парамВидСубконтоСтатьиЗатрат ТОГДА &парамСтатьяЗатратСН
    |		ИНАЧЕ БУНачисления.СубконтоДтНУ1
    |	КОНЕЦ КАК СубконтоДтНУ1,
    |	ВЫБОР 
    |		КОГДА ВидыСубконтоДтНУ2.ВидСубконто = &парамВидСубконтоСтатьиЗатрат ТОГДА &парамСтатьяЗатратСН
    |		ИНАЧЕ БУНачисления.СубконтоДтНУ2
    |	КОНЕЦ КАК СубконтоДтНУ2,
    |	ВЫБОР 
    |		КОГДА ВидыСубконтоДтНУ3.ВидСубконто = &парамВидСубконтоСтатьиЗатрат ТОГДА &парамСтатьяЗатратСН
    |		ИНАЧЕ БУНачисления.СубконтоДтНУ3
    |	КОНЕЦ КАК СубконтоДтНУ3,
	|	БУНачисления.Сумма КАК Результат
	|ПОМЕСТИТЬ ВТ_БУНачисленияСН
	|ИЗ
	|	ВТ_БУНачисления КАК БУНачисления
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Типовой.ВидыСубконто КАК ВидыСубконтоДт1
	|		ПО БУНачисления.СчетДт = ВидыСубконтоДт1.Ссылка
	|		   И ВидыСубконтоДт1.НомерСтроки = 1
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Типовой.ВидыСубконто КАК ВидыСубконтоДт2
	|		ПО БУНачисления.СчетДт = ВидыСубконтоДт2.Ссылка
	|		   И ВидыСубконтоДт2.НомерСтроки = 2
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Типовой.ВидыСубконто КАК ВидыСубконтоДт3
	|		ПО БУНачисления.СчетДт = ВидыСубконтоДт3.Ссылка
	|		   И ВидыСубконтоДт3.НомерСтроки = 3
	|
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Налоговый.ВидыСубконто КАК ВидыСубконтоДтНУ1
	|		ПО БУНачисления.СчетДтНУ = ВидыСубконтоДтНУ1.Ссылка
	|		   И ВидыСубконтоДтНУ1.НомерСтроки = 1
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Налоговый.ВидыСубконто КАК ВидыСубконтоДтНУ2
	|		ПО БУНачисления.СчетДтНУ = ВидыСубконтоДтНУ2.Ссылка
	|		   И ВидыСубконтоДтНУ2.НомерСтроки = 2
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Налоговый.ВидыСубконто КАК ВидыСубконтоДтНУ3
	|		ПО БУНачисления.СчетДтНУ = ВидыСубконтоДтНУ3.Ссылка
	|		   И ВидыСубконтоДтНУ3.НомерСтроки = 3
	|
	|ГДЕ
	|	БУНачисления.ВидРасчета ССЫЛКА ПланВидовРасчета.ОсновныеНачисленияОрганизаций И
	|	БУНачисления.ВидРасчета <> &парамПустойВидРасчета И
	|	БУНачисления.ВидРасчета <> НЕОПРЕДЕЛЕНО И
	|	БУНачисления.ВидРасчета.ОблагаетсяСН <> &парамНеОблагаетсяЦеликом
    |;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ РАЗРЕШЕННЫЕ
	|	БУНачисления.ФизЛицо,
	|	БУНачисления.СтруктурноеПодразделениеДт,
	|	БУНачисления.СчетДт,
	|	БУНачисления.СчетДтНУ,
	|	БУНачисления.СубконтоДт1,
	|	БУНачисления.СубконтоДт2,
	|	БУНачисления.СубконтоДт3,
	|	БУНачисления.СубконтоДтНУ1,
	|	БУНачисления.СубконтоДтНУ2,
	|	БУНачисления.СубконтоДтНУ3,
	|	СУММА(БУНачисления.Результат) КАК Результат
	|
	|ПОМЕСТИТЬ ВТ_БУДоходыПоСчетамСН
	|ИЗ
	|	ВТ_БУНачисленияСН КАК БУНачисления
	|СГРУППИРОВАТЬ ПО
	|	БУНачисления.ФизЛицо,
	|	БУНачисления.СтруктурноеПодразделениеДт,
	|	БУНачисления.СчетДт,
	|	БУНачисления.СчетДтНУ,
	|	БУНачисления.СубконтоДт1,
	|	БУНачисления.СубконтоДт2,
	|	БУНачисления.СубконтоДт3,
	|	БУНачисления.СубконтоДтНУ1,
	|	БУНачисления.СубконтоДтНУ2,
	|	БУНачисления.СубконтоДтНУ3
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	ФизЛицо
	|";

	Запрос.Текст = БУДоходыПоСчетам;
	Запрос.Выполнить();

	// сначала определим счет, на который будем относить затраты по социальному налогу и распределим пропорционально сумме начислений,
	// а потом на основании счета подставим значения некоторых субконто по умолчанию
	РаспределениеСНПоСчетамЗатрат = 
	"ВЫБРАТЬ РАЗРЕШЕННЫЕ
	|	СНИсчисленный.ФизЛицо,
	|	СНИсчисленный.СтруктурнаяЕдиница,
	|	СНИсчисленный.Налог,
	|	ВЫБОР
	|		КОГДА БУСуммаНачислений.Результат <> 0
	|			ТОГДА ВЫРАЗИТЬ(СНИсчисленный.Налог * БУНачисления.Результат / БУСуммаНачислений.Результат КАК ЧИСЛО(15, 2))
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК СуммаПроводки,
	|	ВЫБОР
	|		КОГДА НЕ БУНачисления.СчетДт ЕСТЬ NULL 
	|				И НЕ(БУНачисления.СчетДт В (&парамСчетаРезервовБезСН)
	|						И БУНачисления.СубконтоДт1 В (&парамРезервыБезСН))
	|			ТОГДА БУНачисления.СчетДт
	|		КОГДА ОсновнойСпособОтражения.СпособОтраженияВБухучете = &парамСпособПоУмолчанию
	|				И НЕ МестаРаботы.СпособОтраженияВБухучете ЕСТЬ NULL 
	|			ТОГДА МестаРаботы.СпособОтраженияВБухучете.СчетДт
	|		ИНАЧЕ ОсновнойСпособОтражения.СпособОтраженияВБухучете.СчетДт
	|	КОНЕЦ КАК СчетДт,
	|	ВЫБОР
	|		КОГДА НЕ БУНачисления.СчетДтНУ ЕСТЬ NULL 
	|				И НЕ(БУНачисления.СчетДт В (&парамСчетаРезервовБезСН)
	|						И БУНачисления.СубконтоДт1 В (&парамРезервыБезСН))
	|			ТОГДА БУНачисления.СчетДтНУ
	|		КОГДА ОсновнойСпособОтражения.СпособОтраженияВБухучете = &парамСпособПоУмолчанию
	|				И НЕ МестаРаботы.СпособОтраженияВБухучете ЕСТЬ NULL 
	|			ТОГДА МестаРаботы.СпособОтраженияВБухучете.СчетДтНУ
	|		ИНАЧЕ ОсновнойСпособОтражения.СпособОтраженияВБухучете.СчетДтНУ
	|	КОНЕЦ КАК СчетДтНУ,
	|	БУНачисления.СтруктурноеПодразделениеДт,
	|	БУНачисления.СчетДт КАК СчетДтОплатаТруда,
	|	БУНачисления.СубконтоДт1,
	|	БУНачисления.СубконтоДт2,
	|	БУНачисления.СубконтоДт3,
	|	БУНачисления.СубконтоДтНУ1,
	|	БУНачисления.СубконтоДтНУ2,
	|	БУНачисления.СубконтоДтНУ3,
	|	ВЫБОР
	|		КОГДА &парамПериодРегистрации >= ДАТАВРЕМЯ(2015, 7, 1)
	|			ТОГДА &парамНалогиСборыСоциальныйНалог
	|		ИНАЧЕ ВЫБОР
	|				КОГДА ИностранныеСпециалисты.ФизЛицо ЕСТЬ NULL 
	|					ТОГДА &парамНалогиСборыСоциальныйНалог
	|				ИНАЧЕ &парамНалогиСборыСоциальныйНалогИностранныеСпециалисты
	|			КОНЕЦ
	|	КОНЕЦ КАК СубконтоКт1,
	|	МестаРаботы.ПодразделениеОрганизации,
	|	МестаРаботы.СпособОтраженияВБухучете КАК СпособОтраженияВБухучетеДляПодразделения,
	|	ОсновнойСпособОтражения.СпособОтраженияВБухучете КАК ОсновнойСпособОтраженияВБухучете
	|ПОМЕСТИТЬ ВТ_СНПоСчетамЗатрат
	|ИЗ
	|	ВТ_СНИсчисленный КАК СНИсчисленный
	|		ЛЕВОЕ СОЕДИНЕНИЕ ВТ_БУДоходыПоСчетамСН КАК БУНачисления
	|		ПО СНИсчисленный.ФизЛицо = БУНачисления.ФизЛицо
	|		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
	|			БУНачисления.ФизЛицо КАК ФизЛицо,
	|			СУММА(БУНачисления.Результат) КАК Результат
	|		ИЗ
	|			ВТ_БУДоходыПоСчетамСН КАК БУНачисления
	|		
	|		СГРУППИРОВАТЬ ПО
	|			БУНачисления.ФизЛицо) КАК БУСуммаНачислений
	|		ПО СНИсчисленный.ФизЛицо = БУСуммаНачислений.ФизЛицо
	|		ЛЕВОЕ СОЕДИНЕНИЕ ВТ_ФизлицаИностранныеСпециалисты КАК ИностранныеСпециалисты
	|		ПО (ИностранныеСпециалисты.ФизЛицо = СНИсчисленный.ФизЛицо)
	|		ЛЕВОЕ СОЕДИНЕНИЕ ВТ_ОсновнойСпособОтражения КАК ОсновнойСпособОтражения
	|		ПО СНИсчисленный.ФизЛицо = ОсновнойСпособОтражения.ФизЛицо
	|		ЛЕВОЕ СОЕДИНЕНИЕ ВТ_МестаРаботы КАК МестаРаботы
	|		ПО СНИсчисленный.ФизЛицо = МестаРаботы.ФизЛицо
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	СчетДт,
	|	СчетДтНУ";
	Запрос.Текст = РаспределениеСНПоСчетамЗатрат;
	Запрос.Выполнить();

	// Распределяем социальный налог по счетам затрат пропорционально сумме начислений,
	// с которых брался этот налог
	РаспределениеСНПоСчетамЗатрат = "
	|ВЫБРАТЬ РАЗРЕШЕННЫЕ
	|	ДанныеУчета.ФизЛицо,
	|	ДанныеУчета.СтруктурноеПодразделениеДт,
	|	ДанныеУчета.СтруктурнаяЕдиница,
	|	ДанныеУчета.Налог,
	|	ДанныеУчета.СуммаПроводки,
	|	ДанныеУчета.СчетДт,
	|	ДанныеУчета.СчетДтНУ,
	|
	|	ВЫБОР
	|		КОГДА НЕ(ДанныеУчета.СубконтоДт1 ЕСТЬ NULL) 
	|				И НЕ(ДанныеУчета.СчетДтОплатаТруда В (&парамСчетаРезервовБезСН) И ДанныеУчета.СубконтоДт1 В (&парамРезервыБезСН))
	|			ТОГДА ДанныеУчета.СубконтоДт1
	|		КОГДА ВидыСубконтоДт1.ВидСубконто = &парамВидСубконтоСтатьиЗатрат ТОГДА &парамСтатьяЗатратСН
	|		КОГДА ВидыСубконтоДт1.ВидСубконто = &парамВидСубконтоПодразделения ТОГДА ДанныеУчета.ПодразделениеОрганизации
	|		КОГДА ДанныеУчета.ОсновнойСпособОтраженияВБухучете = &парамСпособПоУмолчанию
	|					И НЕ (ДанныеУчета.СпособОтраженияВБухучетеДляПодразделения ЕСТЬ NULL)
	|			ТОГДА ДанныеУчета.СпособОтраженияВБухучетеДляПодразделения.СубконтоДт1
	|		ИНАЧЕ ДанныеУчета.ОсновнойСпособОтраженияВБухучете.СубконтоДт1
	|	КОНЕЦ КАК СубконтоДт1,
	|
	|	ВЫБОР
	|		КОГДА НЕ(ДанныеУчета.СубконтоДт2 ЕСТЬ NULL) 
	|				И НЕ(ДанныеУчета.СчетДтОплатаТруда В (&парамСчетаРезервовБезСН) И ДанныеУчета.СубконтоДт1 В (&парамРезервыБезСН))
	|			ТОГДА ДанныеУчета.СубконтоДт2
	|		КОГДА ВидыСубконтоДт2.ВидСубконто = &парамВидСубконтоСтатьиЗатрат ТОГДА &парамСтатьяЗатратСН
	|		КОГДА ВидыСубконтоДт2.ВидСубконто = &парамВидСубконтоПодразделения ТОГДА ДанныеУчета.ПодразделениеОрганизации
	|		КОГДА ДанныеУчета.ОсновнойСпособОтраженияВБухучете = &парамСпособПоУмолчанию
	|					И НЕ (ДанныеУчета.СпособОтраженияВБухучетеДляПодразделения ЕСТЬ NULL)
	|			ТОГДА ДанныеУчета.СпособОтраженияВБухучетеДляПодразделения.СубконтоДт2
	|		ИНАЧЕ ДанныеУчета.ОсновнойСпособОтраженияВБухучете.СубконтоДт2
	|	КОНЕЦ КАК СубконтоДт2,
	|
	|	ВЫБОР
	|		КОГДА НЕ(ДанныеУчета.СубконтоДт3 ЕСТЬ NULL) 
	|				И НЕ(ДанныеУчета.СчетДтОплатаТруда В (&парамСчетаРезервовБезСН) И ДанныеУчета.СубконтоДт1 В (&парамРезервыБезСН))
	|			ТОГДА ДанныеУчета.СубконтоДт3
	|		КОГДА ВидыСубконтоДт3.ВидСубконто = &парамВидСубконтоСтатьиЗатрат ТОГДА &парамСтатьяЗатратСН
	|		КОГДА ВидыСубконтоДт3.ВидСубконто = &парамВидСубконтоПодразделения ТОГДА ДанныеУчета.ПодразделениеОрганизации
	|		КОГДА ДанныеУчета.ОсновнойСпособОтраженияВБухучете = &парамСпособПоУмолчанию
	|					И НЕ (ДанныеУчета.СпособОтраженияВБухучетеДляПодразделения ЕСТЬ NULL)
	|			ТОГДА ДанныеУчета.СпособОтраженияВБухучетеДляПодразделения.СубконтоДт3
	|		ИНАЧЕ ДанныеУчета.ОсновнойСпособОтраженияВБухучете.СубконтоДт3
	|	КОНЕЦ КАК СубконтоДт3,
	|
	|	ВЫБОР
	|		КОГДА НЕ(ДанныеУчета.СубконтоДтНУ1 ЕСТЬ NULL) 
	|				И НЕ(ДанныеУчета.СчетДтОплатаТруда В (&парамСчетаРезервовБезСН) И ДанныеУчета.СубконтоДт1 В (&парамРезервыБезСН))
	|			ТОГДА ДанныеУчета.СубконтоДтНУ1
	|		КОГДА ВидыСубконтоДтНУ1.ВидСубконто = &парамВидСубконтоСтатьиЗатрат ТОГДА &парамСтатьяЗатратСН
	|		КОГДА ВидыСубконтоДтНУ1.ВидСубконто = &парамВидСубконтоПодразделения ТОГДА ДанныеУчета.ПодразделениеОрганизации
	|		КОГДА ДанныеУчета.ОсновнойСпособОтраженияВБухучете = &парамСпособПоУмолчанию
	|					И НЕ (ДанныеУчета.СпособОтраженияВБухучетеДляПодразделения ЕСТЬ NULL)
	|			ТОГДА ДанныеУчета.СпособОтраженияВБухучетеДляПодразделения.СубконтоДтНУ1
	|		ИНАЧЕ ДанныеУчета.ОсновнойСпособОтраженияВБухучете.СубконтоДтНУ1
	|	КОНЕЦ КАК СубконтоДтНУ1,
	|
	|	ВЫБОР
	|		КОГДА НЕ(ДанныеУчета.СубконтоДтНУ2 ЕСТЬ NULL) 
	|				И НЕ(ДанныеУчета.СчетДтОплатаТруда В (&парамСчетаРезервовБезСН) И ДанныеУчета.СубконтоДт1 В (&парамРезервыБезСН))
	|			ТОГДА ДанныеУчета.СубконтоДтНУ2
	|		КОГДА ВидыСубконтоДтНУ2.ВидСубконто = &парамВидСубконтоСтатьиЗатрат ТОГДА &парамСтатьяЗатратСН
	|		КОГДА ВидыСубконтоДтНУ2.ВидСубконто = &парамВидСубконтоПодразделения ТОГДА ДанныеУчета.ПодразделениеОрганизации
	|		КОГДА ДанныеУчета.ОсновнойСпособОтраженияВБухучете = &парамСпособПоУмолчанию
	|					И НЕ (ДанныеУчета.СпособОтраженияВБухучетеДляПодразделения ЕСТЬ NULL)
	|			ТОГДА ДанныеУчета.СпособОтраженияВБухучетеДляПодразделения.СубконтоДтНУ2
	|		ИНАЧЕ ДанныеУчета.ОсновнойСпособОтраженияВБухучете.СубконтоДтНУ2
	|	КОНЕЦ КАК СубконтоДтНУ2,
	|
	|	ВЫБОР
	|		КОГДА НЕ(ДанныеУчета.СубконтоДтНУ3 ЕСТЬ NULL) 
	|				И НЕ(ДанныеУчета.СчетДтОплатаТруда В (&парамСчетаРезервовБезСН) И ДанныеУчета.СубконтоДт1 В (&парамРезервыБезСН))
	|			ТОГДА ДанныеУчета.СубконтоДтНУ3
	|		КОГДА ВидыСубконтоДтНУ3.ВидСубконто = &парамВидСубконтоСтатьиЗатрат ТОГДА &парамСтатьяЗатратСН
	|		КОГДА ВидыСубконтоДтНУ3.ВидСубконто = &парамВидСубконтоПодразделения ТОГДА ДанныеУчета.ПодразделениеОрганизации
	|		КОГДА ДанныеУчета.ОсновнойСпособОтраженияВБухучете = &парамСпособПоУмолчанию
	|					И НЕ (ДанныеУчета.СпособОтраженияВБухучетеДляПодразделения ЕСТЬ NULL)
	|			ТОГДА ДанныеУчета.СпособОтраженияВБухучетеДляПодразделения.СубконтоДтНУ3
	|		ИНАЧЕ ДанныеУчета.ОсновнойСпособОтраженияВБухучете.СубконтоДтНУ3
	|	КОНЕЦ КАК СубконтоДтНУ3,
	|
	|	ДанныеУчета.СубконтоКт1
	|ИЗ	
	|	ВТ_СНПоСчетамЗатрат КАК ДанныеУчета
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Типовой.ВидыСубконто КАК ВидыСубконтоДт1
	|		ПО ДанныеУчета.СчетДт = ВидыСубконтоДт1.Ссылка
	|		   И ВидыСубконтоДт1.НомерСтроки = 1 
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Типовой.ВидыСубконто КАК ВидыСубконтоДт2
	|		ПО ДанныеУчета.СчетДт = ВидыСубконтоДт2.Ссылка
	|		   И ВидыСубконтоДт2.НомерСтроки = 2
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Типовой.ВидыСубконто КАК ВидыСубконтоДт3
	|		ПО ДанныеУчета.СчетДт = ВидыСубконтоДт3.Ссылка
	|		   И ВидыСубконтоДт3.НомерСтроки = 3
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Налоговый.ВидыСубконто КАК ВидыСубконтоДтНУ1
	|		ПО ДанныеУчета.СчетДтНУ = ВидыСубконтоДтНУ1.Ссылка
	|		   И ВидыСубконтоДтНУ1.НомерСтроки = 1 
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Налоговый.ВидыСубконто КАК ВидыСубконтоДтНУ2
	|		ПО ДанныеУчета.СчетДтНУ = ВидыСубконтоДтНУ2.Ссылка
	|		   И ВидыСубконтоДтНУ2.НомерСтроки = 2
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Налоговый.ВидыСубконто КАК ВидыСубконтоДтНУ3
	|		ПО ДанныеУчета.СчетДтНУ = ВидыСубконтоДтНУ3.Ссылка
	|		   И ВидыСубконтоДтНУ3.НомерСтроки = 3
	|	
	|УПОРЯДОЧИТЬ ПО
	|	ДанныеУчета.ФизЛицо
	|";

	Запрос.Текст = РаспределениеСНПоСчетамЗатрат;
	
	Выборка = Запрос.Выполнить().Выбрать();
	
	СчетКредита = Справочники.НалогиСборыОтчисления.СоциальныйНалог.СчетУчетаРасчетовСКонтрагентомБУ;
	Если НЕ ЗначениеЗаполнено(СчетКредита) Тогда
		СчетКредита = ПланыСчетов.Типовой.СоциальныйНалог;
	КонецЕсли;
	
	СчетКредитаНУ = ПроцедурыНалоговогоУчетаВызовСервераПовтИсп.ПолучитьСчетУчетаНУСН(СчетКредита, КонецМесяца(Параметры.ПериодРегистрации));
	
	СубконтоКт2 = Перечисления.ВидыПлатежейВБюджетИФонды.Налог;

	ЕстьДанные = Выборка.Следующий();
	Пока ЕстьДанные Цикл
		ТекущееФизЛицо 		= Выборка.ФизЛицо;
		ТекущаяСтруктурнаяЕдиница = Выборка.СтруктурнаяЕдиница;
		СуммаКРаспределению = Выборка.Налог;
		РаспределеннаяСумма = 0;
		
		Пока ЕстьДанные И Выборка.ФизЛицо = ТекущееФизЛицо 
			И Выборка.СтруктурнаяЕдиница = ТекущаяСтруктурнаяЕдиница Цикл 
			Строка = ПромежуточнаяТаблица.Добавить();
			Строка.СчетДт 		= Выборка.СчетДт;
			Строка.СубконтоДт1 	= Выборка.СубконтоДт1;
			Строка.СубконтоДт2 	= Выборка.СубконтоДт2;
			Строка.СубконтоДт3 	= Выборка.СубконтоДт3;

			Строка.СчетДтНУ		= Выборка.СчетДтНУ;
			Строка.СубконтоДтНУ1= Выборка.СубконтоДтНУ1;
			Строка.СубконтоДтНУ2= Выборка.СубконтоДтНУ2;
			Строка.СубконтоДтНУ3= Выборка.СубконтоДтНУ3;

			Строка.СчетКт 		= СчетКредита;
			Строка.СубконтоКт1	= Выборка.СубконтоКт1;
			Строка.СубконтоКт2 	= СубконтоКт2;
			НалоговыйКомитетВСтроке = Неопределено;
			Если ЗаполнятьНКпоСН  ИЛИ ЗаполнятьНКпоСНВНУ Тогда
				НалоговыйКомитетВСтроке = ПроцедурыНалоговогоУчета.ПолучитьНалоговыйКомитетСтруктурнойЕдиницы(Выборка.СтруктурнаяЕдиница,
																											Параметры.Организация,
																											ИсчислениеНалоговСтруктурныхЕдиниц,
																											Перечисления.РазделыНалоговогоУчета.НалогиСЗаработнойПлаты);
			КонецЕсли;	
			
			Если ЗаполнятьНКпоСН Тогда
				Строка.СубконтоКт3 = НалоговыйКомитетВСтроке;
			КонецЕсли;
						
			Строка.СчетКтНУ = СчетКредитаНУ;			
			ОбщегоНазначенияБККлиентСервер.ЗаменитьСубконтоНУ(Строка, Строка.СчетКт, Строка.СчетКтНУ, 1, Строка.СубконтоКт1, "СубконтоКтНУ");
			ОбщегоНазначенияБККлиентСервер.ЗаменитьСубконтоНУ(Строка, Строка.СчетКт, Строка.СчетКтНУ, 2, Строка.СубконтоКт2, "СубконтоКтНУ");
			Если ЗаполнятьНКпоСНВНУ Тогда
				Строка.СубконтоКтНУ3 = НалоговыйКомитетВСтроке;
			КонецЕсли;
			
			Строка.Сумма					= Выборка.СуммаПроводки;
			Строка.ФизЛицо					= Выборка.ФизЛицо;
			Строка.СтруктурноеПодразделениеДт = Выборка.СтруктурноеПодразделениеДт;
			Строка.СтруктурноеПодразделениеКт = Параметры.СтруктурноеПодразделение;
			Строка.ВидРасчета				= Выборка.СубконтоКт1;
			РаспределеннаяСумма 			= РаспределеннаяСумма + Выборка.СуммаПроводки;
			
			ЕстьДанные = Выборка.Следующий();
		КонецЦикла;
		
		// Остаток на последнюю строку по работнику
		Если СуммаКРаспределению <> РаспределеннаяСумма Тогда
			Строка.Сумма = Строка.Сумма + (СуммаКРаспределению - РаспределеннаяСумма);
		КонецЕсли;
	КонецЦикла;	

#КонецОбласти


#Область ОППВ 

   	// ОППВИсчисленный
	//	Поля:
	//		ФизЛицо
	//		ВидПлатежа
	//		Взнос
	//	
	//	Описание:
	//	Исчисленные профессиональные пенсионные взносы по видам платежа

    ОППВИсчисленныйТекст = "
    |ВЫБРАТЬ РАЗРЕШЕННЫЕ
    |	ОППВРасчетыСФондами.Регистратор КАК Регистратор,
	|	ОППВРасчетыСФондами.ФизЛицо КАК ФизЛицо,
    |	ОППВРасчетыСФондами.ВидПлатежа КАК ВидПлатежа,
    |	СУММА(ОППВРасчетыСФондами.Взнос) КАК Взнос
    |
    |ПОМЕСТИТЬ ВТ_ОППВИсчисленный
    |ИЗ
    |	РегистрНакопления.ОППВРасчетыСФондами КАК ОППВРасчетыСФондами
	|
    |	ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТСписокФизЛиц КАК СписокФизЛиц
    |		ПО ОППВРасчетыСФондами.ФизЛицо = СписокФизЛиц.ФизЛицо
	|
    |ГДЕ
	|	ОППВРасчетыСФондами.Период >= &парамНачалоМесяца И 
	|	ОППВРасчетыСФондами.Период <= &парамКонецМесяца И 
	|	ОППВРасчетыСФондами.Организация = &парамОрганизация И 
	|	ОППВРасчетыСФондами.ВидДвижения = &парамВидДвиженияПриход И
	|	ОППВРасчетыСФондами.ВидСтроки = &парамВидСтрокиИсчисление И
	|	ОППВРасчетыСФондами.Взнос <> 0 И
	|	ОППВРасчетыСФондами.Активность
	|
	|СГРУППИРОВАТЬ ПО
	|   ОППВРасчетыСФондами.Регистратор,
	|	ОППВРасчетыСФондами.ФизЛицо,
	|   ОППВРасчетыСФондами.ВидПлатежа
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	ФизЛицо
    |";
    
    Запрос.Текст = ОППВИсчисленныйТекст;
    Запрос.Выполнить();
    
   	// БУДоходыПоСчетам
	//	Поля:
	//		ФизЛицо
	//		СчетДт
	//		СубконтоДт1
	//		СубконтоДт2
	//		СубконтоДт3
	//		Результат
	//	
	//	Описание:
	//	Данные отражения начислений в бухучете

    БУДоходыПоСчетам = "
    |ВЫБРАТЬ РАЗРЕШЕННЫЕ
    |	БУНачисления.ФизЛицо,
    |	БУНачисления.СчетДт,
	|	БУНачисления.СчетДтНУ КАК СчетДтНУ,
	|	БУНачисления.СтруктурноеПодразделениеДт,
    |	ВЫБОР 
    |		КОГДА ВидыСубконтоДт1.ВидСубконто = &парамВидСубконтоСтатьиЗатрат ТОГДА &парамСтатьяЗатратОППВ
    |		ИНАЧЕ БУНачисления.СубконтоДт1
    |	КОНЕЦ КАК СубконтоДт1,
    |	ВЫБОР 
    |		КОГДА ВидыСубконтоДт2.ВидСубконто = &парамВидСубконтоСтатьиЗатрат ТОГДА &парамСтатьяЗатратОППВ
    |		ИНАЧЕ БУНачисления.СубконтоДт2
    |	КОНЕЦ КАК СубконтоДт2,
    |	ВЫБОР 
    |		КОГДА ВидыСубконтоДт3.ВидСубконто = &парамВидСубконтоСтатьиЗатрат ТОГДА &парамСтатьяЗатратОППВ
    |		ИНАЧЕ БУНачисления.СубконтоДт3
    |	КОНЕЦ КАК СубконтоДт3,
	|	ВЫБОР 
    |		КОГДА ВидыСубконтоДтНУ1.ВидСубконто = &парамВидСубконтоСтатьиЗатрат ТОГДА &парамСтатьяЗатратОППВ
    |		ИНАЧЕ БУНачисления.СубконтоДтНУ1
    |	КОНЕЦ КАК СубконтоДтНУ1,
    |	ВЫБОР 
    |		КОГДА ВидыСубконтоДтНУ2.ВидСубконто = &парамВидСубконтоСтатьиЗатрат ТОГДА &парамСтатьяЗатратОППВ
    |		ИНАЧЕ БУНачисления.СубконтоДтНУ2
    |	КОНЕЦ КАК СубконтоДтНУ2,
    |	ВЫБОР 
    |		КОГДА ВидыСубконтоДтНУ3.ВидСубконто = &парамВидСубконтоСтатьиЗатрат ТОГДА &парамСтатьяЗатратОППВ
    |		ИНАЧЕ БУНачисления.СубконтоДтНУ3
    |	КОНЕЦ КАК СубконтоДтНУ3,
	|	БУНачисления.Сумма КАК Результат
	|ПОМЕСТИТЬ ВТ_БУНачисленияОППВ	
	|ИЗ
	|	ВТ_БУНачисления КАК БУНачисления
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Типовой.ВидыСубконто КАК ВидыСубконтоДт1
	|		ПО БУНачисления.СчетДт = ВидыСубконтоДт1.Ссылка
	|		   И ВидыСубконтоДт1.НомерСтроки = 1
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Типовой.ВидыСубконто КАК ВидыСубконтоДт2
	|		ПО БУНачисления.СчетДт = ВидыСубконтоДт2.Ссылка
	|		   И ВидыСубконтоДт2.НомерСтроки = 2
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Типовой.ВидыСубконто КАК ВидыСубконтоДт3
	|		ПО БУНачисления.СчетДт = ВидыСубконтоДт3.Ссылка
	|		   И ВидыСубконтоДт3.НомерСтроки = 3
	|
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Налоговый.ВидыСубконто КАК ВидыСубконтоДтНУ1
	|		ПО БУНачисления.СчетДтНУ = ВидыСубконтоДтНУ1.Ссылка
	|		   И ВидыСубконтоДтНУ1.НомерСтроки = 1
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Налоговый.ВидыСубконто КАК ВидыСубконтоДтНУ2
	|		ПО БУНачисления.СчетДтНУ = ВидыСубконтоДтНУ2.Ссылка
	|		   И ВидыСубконтоДтНУ2.НомерСтроки = 2
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Налоговый.ВидыСубконто КАК ВидыСубконтоДтНУ3
	|		ПО БУНачисления.СчетДтНУ = ВидыСубконтоДтНУ3.Ссылка
	|		   И ВидыСубконтоДтНУ3.НомерСтроки = 3
	|ГДЕ
	|	БУНачисления.ВидРасчета ССЫЛКА ПланВидовРасчета.ОсновныеНачисленияОрганизаций И
	|	БУНачисления.ВидРасчета <> &парамПустойВидРасчета И
	|	БУНачисления.ВидРасчета <> НЕОПРЕДЕЛЕНО И
	|	БУНачисления.ВидРасчета.ОблагаетсяОППВ <> &парамНеОблагаетсяЦеликом
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ РАЗРЕШЕННЫЕ
	|	БУНачисления.ФизЛицо,
	|	БУНачисления.СтруктурноеПодразделениеДт,
	|	БУНачисления.СчетДт,
	|	БУНачисления.СчетДтНУ,
	|	БУНачисления.СубконтоДт1,
	|	БУНачисления.СубконтоДт2,
	|	БУНачисления.СубконтоДт3,
	|	БУНачисления.СубконтоДтНУ1,
	|	БУНачисления.СубконтоДтНУ2,
	|	БУНачисления.СубконтоДтНУ3,
	|	СУММА(БУНачисления.Результат) КАК Результат
	|
	|ПОМЕСТИТЬ ВТ_БУДоходыПоСчетамОППВ
	|ИЗ
	|	ВТ_БУНачисленияОППВ КАК БУНачисления
	|
	|СГРУППИРОВАТЬ ПО
	|	БУНачисления.ФизЛицо,
	|	БУНачисления.СтруктурноеПодразделениеДт,
	|	БУНачисления.СчетДт,
	|	БУНачисления.СчетДтНУ,
	|	БУНачисления.СубконтоДт1,
	|	БУНачисления.СубконтоДт2,
	|	БУНачисления.СубконтоДт3,
	|	БУНачисления.СубконтоДтНУ1,
	|	БУНачисления.СубконтоДтНУ2,
	|	БУНачисления.СубконтоДтНУ3
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	ФизЛицо
	|";

	Запрос.Текст = БУДоходыПоСчетам;
	Запрос.Выполнить();
	     
	// сначала определим счет, на который будем относить затраты по обязательным профессиональным пенсионным взносам и 
	// распределим пропорционально сумме начислений, а потом на основании счета подставим значения некоторых субконто по умолчанию
	РаспределениеОППВПоСчетамЗатрат = "ВЫБРАТЬ РАЗРЕШЕННЫЕ
	                                  |	ОППВРасчетыСФондами.ФизЛицо,
	                                  |	ОППВРасчетыСФондами.ВидПлатежа,
	                                  |	СУММА(ОППВРасчетыСФондами.Взнос) КАК Взнос,
	                                  |	СУММА(ВЫБОР
	                                  |			КОГДА БУСуммаНачислений.Результат <> 0
	                                  |				ТОГДА ВЫРАЗИТЬ(ОППВРасчетыСФондами.Взнос * БУНачисления.Результат / БУСуммаНачислений.Результат КАК ЧИСЛО(15, 2))
	                                  |			ИНАЧЕ 0
	                                  |		КОНЕЦ) КАК СуммаПроводки,
	                                  |	ВЫБОР
	                                  |		КОГДА НЕ БУНачисления.СчетДт ЕСТЬ NULL 
	                                  |				И НЕ(БУНачисления.СчетДт В (&парамСчетаРезервовБезОППВ)
	                                  |						И БУНачисления.СубконтоДт1 В (&парамРезервыБезОППВ))
	                                  |			ТОГДА БУНачисления.СчетДт
	                                  |		КОГДА ОсновнойСпособОтражения.СпособОтраженияВБухучете = &парамСпособПоУмолчанию
	                                  |				И НЕ МестаРаботы.СпособОтраженияВБухучете ЕСТЬ NULL 
	                                  |			ТОГДА МестаРаботы.СпособОтраженияВБухучете.СчетДт
	                                  |		ИНАЧЕ ОсновнойСпособОтражения.СпособОтраженияВБухучете.СчетДт
	                                  |	КОНЕЦ КАК СчетДт,
	                                  |	ВЫБОР
	                                  |		КОГДА НЕ БУНачисления.СчетДтНУ ЕСТЬ NULL 
	                                  |				И НЕ(БУНачисления.СчетДт В (&парамСчетаРезервовБезОППВ)
	                                  |						И БУНачисления.СубконтоДт1 В (&парамРезервыБезОППВ))
	                                  |			ТОГДА БУНачисления.СчетДтНУ
	                                  |		КОГДА ОсновнойСпособОтражения.СпособОтраженияВБухучете = &парамСпособПоУмолчанию
	                                  |				И НЕ МестаРаботы.СпособОтраженияВБухучете ЕСТЬ NULL 
	                                  |			ТОГДА МестаРаботы.СпособОтраженияВБухучете.СчетДтНУ
	                                  |		ИНАЧЕ ОсновнойСпособОтражения.СпособОтраженияВБухучете.СчетДтНУ
	                                  |	КОНЕЦ КАК СчетДтНУ,
	                                  |	БУНачисления.СтруктурноеПодразделениеДт,
	                                  |	БУНачисления.СчетДт КАК СчетДтОплатаТруда,
	                                  |	БУНачисления.СубконтоДт1,
	                                  |	БУНачисления.СубконтоДт2,
	                                  |	БУНачисления.СубконтоДт3,
	                                  |	БУНачисления.СубконтоДтНУ1,
	                                  |	БУНачисления.СубконтоДтНУ2,
	                                  |	БУНачисления.СубконтоДтНУ3,
	                                  |	ВЫБОР
	                                  |		КОГДА РасчетПениОПВиСО.СчетЗатратБУ ЕСТЬ NULL 
	                                  |				ИЛИ РасчетПениОПВиСО.СчетЗатратБУ = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
	                                  |			ТОГДА &парамСчетДтДляПени
	                                  |		ИНАЧЕ РасчетПениОПВиСО.СчетЗатратБУ
	                                  |	КОНЕЦ КАК СчетДтДляПени,
	                                  |	ВЫБОР
	                                  |		КОГДА РасчетПениОПВиСО.СчетЗатратБУ ЕСТЬ NULL 
	                                  |				ИЛИ РасчетПениОПВиСО.СчетЗатратБУ = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
	                                  |			ТОГДА НЕОПРЕДЕЛЕНО
	                                  |		ИНАЧЕ ЕСТЬNULL(РасчетПениОПВиСО.СубконтоЗатратБУ1, НЕОПРЕДЕЛЕНО)
	                                  |	КОНЕЦ КАК СубконтоДтДляПени1,
	                                  |	ВЫБОР
	                                  |		КОГДА РасчетПениОПВиСО.СчетЗатратБУ ЕСТЬ NULL 
	                                  |				ИЛИ РасчетПениОПВиСО.СчетЗатратБУ = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
	                                  |			ТОГДА НЕОПРЕДЕЛЕНО
	                                  |		ИНАЧЕ ЕСТЬNULL(РасчетПениОПВиСО.СубконтоЗатратБУ2, НЕОПРЕДЕЛЕНО)
	                                  |	КОНЕЦ КАК СубконтоДтДляПени2,
	                                  |	ВЫБОР
	                                  |		КОГДА РасчетПениОПВиСО.СчетЗатратБУ ЕСТЬ NULL 
	                                  |				ИЛИ РасчетПениОПВиСО.СчетЗатратБУ = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
	                                  |			ТОГДА НЕОПРЕДЕЛЕНО
	                                  |		ИНАЧЕ ЕСТЬNULL(РасчетПениОПВиСО.СубконтоЗатратБУ3, НЕОПРЕДЕЛЕНО)
	                                  |	КОНЕЦ КАК СубконтоДтДляПени3,
	                                  |	ВЫБОР
	                                  |		КОГДА РасчетПениОПВиСО.СчетЗатратНУ ЕСТЬ NULL 
	                                  |				ИЛИ РасчетПениОПВиСО.СчетЗатратНУ = ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
	                                  |			ТОГДА &парамСчетДтДляПениНУ
	                                  |		ИНАЧЕ РасчетПениОПВиСО.СчетЗатратНУ
	                                  |	КОНЕЦ КАК СчетДтДляПениНУ,
	                                  |	ВЫБОР
	                                  |		КОГДА РасчетПениОПВиСО.СчетЗатратНУ ЕСТЬ NULL 
	                                  |				ИЛИ РасчетПениОПВиСО.СчетЗатратНУ = ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
	                                  |			ТОГДА НЕОПРЕДЕЛЕНО
	                                  |		ИНАЧЕ ЕСТЬNULL(РасчетПениОПВиСО.СубконтоЗатратНУ1, НЕОПРЕДЕЛЕНО)
	                                  |	КОНЕЦ КАК СубконтоДтДляПениНУ1,
	                                  |	ВЫБОР
	                                  |		КОГДА РасчетПениОПВиСО.СчетЗатратНУ ЕСТЬ NULL 
	                                  |				ИЛИ РасчетПениОПВиСО.СчетЗатратНУ = ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
	                                  |			ТОГДА НЕОПРЕДЕЛЕНО
	                                  |		ИНАЧЕ ЕСТЬNULL(РасчетПениОПВиСО.СубконтоЗатратНУ2, НЕОПРЕДЕЛЕНО)
	                                  |	КОНЕЦ КАК СубконтоДтДляПениНУ2,
	                                  |	ВЫБОР
	                                  |		КОГДА РасчетПениОПВиСО.СчетЗатратНУ ЕСТЬ NULL 
	                                  |				ИЛИ РасчетПениОПВиСО.СчетЗатратНУ = ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
	                                  |			ТОГДА НЕОПРЕДЕЛЕНО
	                                  |		ИНАЧЕ ЕСТЬNULL(РасчетПениОПВиСО.СубконтоЗатратНУ3, НЕОПРЕДЕЛЕНО)
	                                  |	КОНЕЦ КАК СубконтоДтДляПениНУ3,
	                                  |	МестаРаботы.ПодразделениеОрганизации,
	                                  |	МестаРаботы.СпособОтраженияВБухучете КАК СпособОтраженияВБухучетеДляПодразделения,
	                                  |	ОсновнойСпособОтражения.СпособОтраженияВБухучете КАК ОсновнойСпособОтраженияВБухучете,
	                                  |	ЕСТЬNULL(ВидыСубконтоПодразделенияДляПени.НомерСтроки, 0) КАК НомерСубконтоПодразделенияДляПени,
	                                  |	ЕСТЬNULL(ВидыСубконтоСтатьиЗатратДляПени.НомерСтроки, 0) КАК НомерСубконтоСтатьиЗатратДляПени,
	                                  |	ЕСТЬNULL(ВидСубконтоПодразделенияДляПениНУ.НомерСтроки, 0) КАК НомерСубконтоПодразделенияДляПениНУ,
	                                  |	ЕСТЬNULL(ВидСубконтоСтатьиЗатратДляПениНУ.НомерСтроки, 0) КАК НомерСубконтоСтатьиЗатратДляПениНУ
	                                  |ПОМЕСТИТЬ ВТ_ОППВПоСчетамЗатрат
	                                  |ИЗ
	                                  |	ВТ_ОППВИсчисленный КАК ОППВРасчетыСФондами
	                                  |		ЛЕВОЕ СОЕДИНЕНИЕ Документ.РасчетПениОПВиСО КАК РасчетПениОПВиСО
	                                  |		ПО ОППВРасчетыСФондами.Регистратор = РасчетПениОПВиСО.Ссылка
	                                  |		ЛЕВОЕ СОЕДИНЕНИЕ ВТ_БУДоходыПоСчетамОППВ КАК БУНачисления
	                                  |		ПО ОППВРасчетыСФондами.ФизЛицо = БУНачисления.ФизЛицо
	                                  |		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
	                                  |			БУНачисления.ФизЛицо КАК ФизЛицо,
	                                  |			СУММА(БУНачисления.Результат) КАК Результат
	                                  |		ИЗ
	                                  |			ВТ_БУДоходыПоСчетамОППВ КАК БУНачисления
	                                  |		
	                                  |		СГРУППИРОВАТЬ ПО
	                                  |			БУНачисления.ФизЛицо) КАК БУСуммаНачислений
	                                  |		ПО ОППВРасчетыСФондами.ФизЛицо = БУСуммаНачислений.ФизЛицо
	                                  |		ЛЕВОЕ СОЕДИНЕНИЕ ВТ_ОсновнойСпособОтражения КАК ОсновнойСпособОтражения
	                                  |		ПО ОППВРасчетыСФондами.ФизЛицо = ОсновнойСпособОтражения.ФизЛицо
	                                  |		ЛЕВОЕ СОЕДИНЕНИЕ ВТ_МестаРаботы КАК МестаРаботы
	                                  |		ПО ОППВРасчетыСФондами.ФизЛицо = МестаРаботы.ФизЛицо
	                                  |		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Типовой.ВидыСубконто КАК ВидыСубконтоПодразделенияДляПени
	                                  |		ПО (ВидыСубконтоПодразделенияДляПени.Ссылка = ВЫБОР
	                                  |				КОГДА РасчетПениОПВиСО.СчетЗатратБУ ЕСТЬ NULL 
	                                  |						ИЛИ РасчетПениОПВиСО.СчетЗатратБУ = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
	                                  |					ТОГДА &парамСчетДтДляПени
	                                  |				ИНАЧЕ РасчетПениОПВиСО.СчетЗатратБУ
	                                  |			КОНЕЦ)
	                                  |			И (ВидыСубконтоПодразделенияДляПени.ВидСубконто = &парамВидСубконтоПодразделения)
	                                  |		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Типовой.ВидыСубконто КАК ВидыСубконтоСтатьиЗатратДляПени
	                                  |		ПО (ВидыСубконтоСтатьиЗатратДляПени.Ссылка = ВЫБОР
	                                  |				КОГДА РасчетПениОПВиСО.СчетЗатратБУ ЕСТЬ NULL 
	                                  |						ИЛИ РасчетПениОПВиСО.СчетЗатратБУ = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
	                                  |					ТОГДА &парамСчетДтДляПени
	                                  |				ИНАЧЕ РасчетПениОПВиСО.СчетЗатратБУ
	                                  |			КОНЕЦ)
	                                  |			И (ВидыСубконтоСтатьиЗатратДляПени.ВидСубконто = &парамВидСубконтоСтатьиЗатрат)
	                                  |		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Налоговый.ВидыСубконто КАК ВидСубконтоСтатьиЗатратДляПениНУ
	                                  |		ПО (ВидСубконтоСтатьиЗатратДляПениНУ.Ссылка = ВЫБОР
	                                  |				КОГДА РасчетПениОПВиСО.СчетЗатратНУ ЕСТЬ NULL 
	                                  |						ИЛИ РасчетПениОПВиСО.СчетЗатратНУ = ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
	                                  |					ТОГДА &парамСчетДтДляПениНУ
	                                  |				ИНАЧЕ РасчетПениОПВиСО.СчетЗатратНУ
	                                  |			КОНЕЦ)
	                                  |			И (ВидСубконтоСтатьиЗатратДляПениНУ.ВидСубконто = &парамВидСубконтоСтатьиЗатрат)
	                                  |		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Налоговый.ВидыСубконто КАК ВидСубконтоПодразделенияДляПениНУ
	                                  |		ПО (ВидСубконтоПодразделенияДляПениНУ.Ссылка = ВЫБОР
	                                  |				КОГДА РасчетПениОПВиСО.СчетЗатратНУ ЕСТЬ NULL 
	                                  |						ИЛИ РасчетПениОПВиСО.СчетЗатратНУ = ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
	                                  |					ТОГДА &парамСчетДтДляПениНУ
	                                  |				ИНАЧЕ РасчетПениОПВиСО.СчетЗатратНУ
	                                  |			КОНЕЦ)
	                                  |			И (ВидСубконтоПодразделенияДляПениНУ.ВидСубконто = &парамВидСубконтоПодразделения)
	                                  |
	                                  |СГРУППИРОВАТЬ ПО
	                                  |	ОППВРасчетыСФондами.ФизЛицо,
	                                  |	ОППВРасчетыСФондами.ВидПлатежа,
	                                  |	БУНачисления.СтруктурноеПодразделениеДт,
	                                  |	БУНачисления.СчетДт,
	                                  |	БУНачисления.СубконтоДт1,
	                                  |	БУНачисления.СубконтоДт2,
	                                  |	БУНачисления.СубконтоДт3,
	                                  |	БУНачисления.СубконтоДтНУ1,
	                                  |	БУНачисления.СубконтоДтНУ2,
	                                  |	БУНачисления.СубконтоДтНУ3,
	                                  |	МестаРаботы.ПодразделениеОрганизации,
	                                  |	МестаРаботы.СпособОтраженияВБухучете,
	                                  |	ОсновнойСпособОтражения.СпособОтраженияВБухучете,
	                                  |	ВЫБОР
	                                  |		КОГДА НЕ БУНачисления.СчетДт ЕСТЬ NULL 
	                                  |				И НЕ(БУНачисления.СчетДт В (&парамСчетаРезервовБезОППВ)
	                                  |						И БУНачисления.СубконтоДт1 В (&парамРезервыБезОППВ))
	                                  |			ТОГДА БУНачисления.СчетДт
	                                  |		КОГДА ОсновнойСпособОтражения.СпособОтраженияВБухучете = &парамСпособПоУмолчанию
	                                  |				И НЕ МестаРаботы.СпособОтраженияВБухучете ЕСТЬ NULL 
	                                  |			ТОГДА МестаРаботы.СпособОтраженияВБухучете.СчетДт
	                                  |		ИНАЧЕ ОсновнойСпособОтражения.СпособОтраженияВБухучете.СчетДт
	                                  |	КОНЕЦ,
	                                  |	ВЫБОР
	                                  |		КОГДА НЕ БУНачисления.СчетДтНУ ЕСТЬ NULL 
	                                  |				И НЕ(БУНачисления.СчетДт В (&парамСчетаРезервовБезОППВ)
	                                  |						И БУНачисления.СубконтоДт1 В (&парамРезервыБезОППВ))
	                                  |			ТОГДА БУНачисления.СчетДтНУ
	                                  |		КОГДА ОсновнойСпособОтражения.СпособОтраженияВБухучете = &парамСпособПоУмолчанию
	                                  |				И НЕ МестаРаботы.СпособОтраженияВБухучете ЕСТЬ NULL 
	                                  |			ТОГДА МестаРаботы.СпособОтраженияВБухучете.СчетДтНУ
	                                  |		ИНАЧЕ ОсновнойСпособОтражения.СпособОтраженияВБухучете.СчетДтНУ
	                                  |	КОНЕЦ,
	                                  |	ВЫБОР
	                                  |		КОГДА РасчетПениОПВиСО.СчетЗатратБУ ЕСТЬ NULL 
	                                  |				ИЛИ РасчетПениОПВиСО.СчетЗатратБУ = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
	                                  |			ТОГДА &парамСчетДтДляПени
	                                  |		ИНАЧЕ РасчетПениОПВиСО.СчетЗатратБУ
	                                  |	КОНЕЦ,
	                                  |	ВЫБОР
	                                  |		КОГДА РасчетПениОПВиСО.СчетЗатратБУ ЕСТЬ NULL 
	                                  |				ИЛИ РасчетПениОПВиСО.СчетЗатратБУ = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
	                                  |			ТОГДА НЕОПРЕДЕЛЕНО
	                                  |		ИНАЧЕ ЕСТЬNULL(РасчетПениОПВиСО.СубконтоЗатратБУ1, НЕОПРЕДЕЛЕНО)
	                                  |	КОНЕЦ,
	                                  |	ВЫБОР
	                                  |		КОГДА РасчетПениОПВиСО.СчетЗатратБУ ЕСТЬ NULL 
	                                  |				ИЛИ РасчетПениОПВиСО.СчетЗатратБУ = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
	                                  |			ТОГДА НЕОПРЕДЕЛЕНО
	                                  |		ИНАЧЕ ЕСТЬNULL(РасчетПениОПВиСО.СубконтоЗатратБУ2, НЕОПРЕДЕЛЕНО)
	                                  |	КОНЕЦ,
	                                  |	ВЫБОР
	                                  |		КОГДА РасчетПениОПВиСО.СчетЗатратБУ ЕСТЬ NULL 
	                                  |				ИЛИ РасчетПениОПВиСО.СчетЗатратБУ = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
	                                  |			ТОГДА НЕОПРЕДЕЛЕНО
	                                  |		ИНАЧЕ ЕСТЬNULL(РасчетПениОПВиСО.СубконтоЗатратБУ3, НЕОПРЕДЕЛЕНО)
	                                  |	КОНЕЦ,
	                                  |	ВЫБОР
	                                  |		КОГДА РасчетПениОПВиСО.СчетЗатратНУ ЕСТЬ NULL 
	                                  |				ИЛИ РасчетПениОПВиСО.СчетЗатратНУ = ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
	                                  |			ТОГДА &парамСчетДтДляПениНУ
	                                  |		ИНАЧЕ РасчетПениОПВиСО.СчетЗатратНУ
	                                  |	КОНЕЦ,
	                                  |	ВЫБОР
	                                  |		КОГДА РасчетПениОПВиСО.СчетЗатратНУ ЕСТЬ NULL 
	                                  |				ИЛИ РасчетПениОПВиСО.СчетЗатратНУ = ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
	                                  |			ТОГДА НЕОПРЕДЕЛЕНО
	                                  |		ИНАЧЕ ЕСТЬNULL(РасчетПениОПВиСО.СубконтоЗатратНУ1, НЕОПРЕДЕЛЕНО)
	                                  |	КОНЕЦ,
	                                  |	ВЫБОР
	                                  |		КОГДА РасчетПениОПВиСО.СчетЗатратНУ ЕСТЬ NULL 
	                                  |				ИЛИ РасчетПениОПВиСО.СчетЗатратНУ = ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
	                                  |			ТОГДА НЕОПРЕДЕЛЕНО
	                                  |		ИНАЧЕ ЕСТЬNULL(РасчетПениОПВиСО.СубконтоЗатратНУ2, НЕОПРЕДЕЛЕНО)
	                                  |	КОНЕЦ,
	                                  |	ВЫБОР
	                                  |		КОГДА РасчетПениОПВиСО.СчетЗатратНУ ЕСТЬ NULL 
	                                  |				ИЛИ РасчетПениОПВиСО.СчетЗатратНУ = ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
	                                  |			ТОГДА НЕОПРЕДЕЛЕНО
	                                  |		ИНАЧЕ ЕСТЬNULL(РасчетПениОПВиСО.СубконтоЗатратНУ3, НЕОПРЕДЕЛЕНО)
	                                  |	КОНЕЦ,
	                                  |	ЕСТЬNULL(ВидыСубконтоПодразделенияДляПени.НомерСтроки, 0),
	                                  |	ЕСТЬNULL(ВидыСубконтоСтатьиЗатратДляПени.НомерСтроки, 0),
	                                  |	ЕСТЬNULL(ВидСубконтоПодразделенияДляПениНУ.НомерСтроки, 0),
	                                  |	ЕСТЬNULL(ВидСубконтоСтатьиЗатратДляПениНУ.НомерСтроки, 0)
	                                  |
	                                  |ИНДЕКСИРОВАТЬ ПО
	                                  |	СчетДт,
	                                  |	СчетДтНУ";
	
	Запрос.Текст = РаспределениеОППВПоСчетамЗатрат;
	Запрос.Выполнить();
                                		
	// Распределяем обязательные профессиональные пенсионные взносы по счетам затрат 
	// пропорционально сумме начислений, с которых брались эти взносы
	РаспределениеОППВПоСчетамЗатрат = "
	|ВЫБРАТЬ РАЗРЕШЕННЫЕ
	|	ДанныеУчета.ФизЛицо,
	|	ДанныеУчета.СтруктурноеПодразделениеДт,
	|	ДанныеУчета.ВидПлатежа,
	|	ДанныеУчета.Взнос,
	|	ДанныеУчета.СуммаПроводки,
	|	ДанныеУчета.СчетДт,
	|	ДанныеУчета.СчетДтНУ,
	|
	|	ВЫБОР
	|		КОГДА НЕ(ДанныеУчета.СубконтоДт1 ЕСТЬ NULL)
	|				И НЕ(ДанныеУчета.СчетДтОплатаТруда В (&парамСчетаРезервовБезОППВ) И ДанныеУчета.СубконтоДт1 В (&парамРезервыБезОППВ))
	|			ТОГДА ДанныеУчета.СубконтоДт1
	|		КОГДА ВидыСубконтоДт1.ВидСубконто = &парамВидСубконтоСтатьиЗатрат ТОГДА &парамСтатьяЗатратОППВ	
	|		КОГДА ВидыСубконтоДт1.ВидСубконто = &парамВидСубконтоПодразделения ТОГДА ДанныеУчета.ПодразделениеОрганизации
	|		КОГДА ДанныеУчета.ОсновнойСпособОтраженияВБухучете = &парамСпособПоУмолчанию
	|					И НЕ (ДанныеУчета.СпособОтраженияВБухучетеДляПодразделения ЕСТЬ NULL)
	|			ТОГДА ДанныеУчета.СпособОтраженияВБухучетеДляПодразделения.СубконтоДт1
	|		ИНАЧЕ ДанныеУчета.ОсновнойСпособОтраженияВБухучете.СубконтоДт1
	|	КОНЕЦ КАК СубконтоДт1,
	|
	|	ВЫБОР
	|		КОГДА НЕ(ДанныеУчета.СубконтоДт2 ЕСТЬ NULL)
	|				И НЕ(ДанныеУчета.СчетДтОплатаТруда В (&парамСчетаРезервовБезОППВ) И ДанныеУчета.СубконтоДт1 В (&парамРезервыБезОППВ))
	|			ТОГДА ДанныеУчета.СубконтоДт2
	|		КОГДА ВидыСубконтоДт2.ВидСубконто = &парамВидСубконтоСтатьиЗатрат ТОГДА &парамСтатьяЗатратОППВ
	|		КОГДА ВидыСубконтоДт2.ВидСубконто = &парамВидСубконтоПодразделения ТОГДА ДанныеУчета.ПодразделениеОрганизации
	|		КОГДА ДанныеУчета.ОсновнойСпособОтраженияВБухучете = &парамСпособПоУмолчанию
	|					И НЕ (ДанныеУчета.СпособОтраженияВБухучетеДляПодразделения ЕСТЬ NULL)
	|			ТОГДА ДанныеУчета.СпособОтраженияВБухучетеДляПодразделения.СубконтоДт2
	|		ИНАЧЕ ДанныеУчета.ОсновнойСпособОтраженияВБухучете.СубконтоДт2
	|	КОНЕЦ КАК СубконтоДт2,
	|
	|	ВЫБОР
	|		КОГДА НЕ(ДанныеУчета.СубконтоДт3 ЕСТЬ NULL)
	|				И НЕ(ДанныеУчета.СчетДтОплатаТруда В (&парамСчетаРезервовБезОППВ) И ДанныеУчета.СубконтоДт1 В (&парамРезервыБезОППВ))
	|			ТОГДА ДанныеУчета.СубконтоДт3
	|		КОГДА ВидыСубконтоДт3.ВидСубконто = &парамВидСубконтоСтатьиЗатрат ТОГДА &парамСтатьяЗатратОППВ
	|		КОГДА ВидыСубконтоДт3.ВидСубконто = &парамВидСубконтоПодразделения ТОГДА ДанныеУчета.ПодразделениеОрганизации
	|		КОГДА ДанныеУчета.ОсновнойСпособОтраженияВБухучете = &парамСпособПоУмолчанию
	|					И НЕ (ДанныеУчета.СпособОтраженияВБухучетеДляПодразделения ЕСТЬ NULL)
	|			ТОГДА ДанныеУчета.СпособОтраженияВБухучетеДляПодразделения.СубконтоДт3
	|		ИНАЧЕ ДанныеУчета.ОсновнойСпособОтраженияВБухучете.СубконтоДт3
	|	КОНЕЦ КАК СубконтоДт3,
	|
	|	ВЫБОР
	|		КОГДА НЕ(ДанныеУчета.СубконтоДтНУ1 ЕСТЬ NULL)
	|				И НЕ(ДанныеУчета.СчетДтОплатаТруда В (&парамСчетаРезервовБезОППВ) И ДанныеУчета.СубконтоДт1 В (&парамРезервыБезОППВ))
	|			ТОГДА ДанныеУчета.СубконтоДтНУ1
	|		КОГДА ВидыСубконтоДтНУ1.ВидСубконто = &парамВидСубконтоСтатьиЗатрат ТОГДА &парамСтатьяЗатратОППВ
	|		КОГДА ВидыСубконтоДтНУ1.ВидСубконто = &парамВидСубконтоПодразделения ТОГДА ДанныеУчета.ПодразделениеОрганизации
	|		КОГДА ДанныеУчета.ОсновнойСпособОтраженияВБухучете = &парамСпособПоУмолчанию
	|					И НЕ (ДанныеУчета.СпособОтраженияВБухучетеДляПодразделения ЕСТЬ NULL)
	|			ТОГДА ДанныеУчета.СпособОтраженияВБухучетеДляПодразделения.СубконтоДтНУ1
	|		ИНАЧЕ ДанныеУчета.ОсновнойСпособОтраженияВБухучете.СубконтоДтНУ1
	|	КОНЕЦ КАК СубконтоДтНУ1,
	|
	|	ВЫБОР
	|		КОГДА НЕ(ДанныеУчета.СубконтоДтНУ2 ЕСТЬ NULL)
	|				И НЕ(ДанныеУчета.СчетДтОплатаТруда В (&парамСчетаРезервовБезОППВ) И ДанныеУчета.СубконтоДт1 В (&парамРезервыБезОППВ))
	|			ТОГДА ДанныеУчета.СубконтоДтНУ2
	|		КОГДА ВидыСубконтоДтНУ2.ВидСубконто = &парамВидСубконтоСтатьиЗатрат ТОГДА &парамСтатьяЗатратОППВ
	|		КОГДА ВидыСубконтоДтНУ2.ВидСубконто = &парамВидСубконтоПодразделения ТОГДА ДанныеУчета.ПодразделениеОрганизации
	|		КОГДА ДанныеУчета.ОсновнойСпособОтраженияВБухучете = &парамСпособПоУмолчанию
	|					И НЕ (ДанныеУчета.СпособОтраженияВБухучетеДляПодразделения ЕСТЬ NULL)
	|			ТОГДА ДанныеУчета.СпособОтраженияВБухучетеДляПодразделения.СубконтоДтНУ2
	|		ИНАЧЕ ДанныеУчета.ОсновнойСпособОтраженияВБухучете.СубконтоДтНУ2
	|	КОНЕЦ КАК СубконтоДтНУ2,
	|
	|	ВЫБОР
	|		КОГДА НЕ(ДанныеУчета.СубконтоДтНУ3 ЕСТЬ NULL)
	|				И НЕ(ДанныеУчета.СчетДтОплатаТруда В (&парамСчетаРезервовБезОППВ) И ДанныеУчета.СубконтоДт1 В (&парамРезервыБезОППВ))
	|			ТОГДА ДанныеУчета.СубконтоДтНУ3
	|		КОГДА ВидыСубконтоДтНУ3.ВидСубконто = &парамВидСубконтоСтатьиЗатрат ТОГДА &парамСтатьяЗатратОППВ
	|		КОГДА ВидыСубконтоДтНУ3.ВидСубконто = &парамВидСубконтоПодразделения ТОГДА ДанныеУчета.ПодразделениеОрганизации
	|		КОГДА ДанныеУчета.ОсновнойСпособОтраженияВБухучете = &парамСпособПоУмолчанию
	|					И НЕ (ДанныеУчета.СпособОтраженияВБухучетеДляПодразделения ЕСТЬ NULL)
	|			ТОГДА ДанныеУчета.СпособОтраженияВБухучетеДляПодразделения.СубконтоДтНУ3
	|		ИНАЧЕ ДанныеУчета.ОсновнойСпособОтраженияВБухучете.СубконтоДтНУ3
	|	КОНЕЦ КАК СубконтоДтНУ3,
	|	ДанныеУчета.СчетДтДляПени,
	|	ДанныеУчета.СубконтоДтДляПени1,
	|	ДанныеУчета.СубконтоДтДляПени2,
	|	ДанныеУчета.СубконтоДтДляПени3,
	|	ДанныеУчета.СчетДтДляПениНУ,
	|	ДанныеУчета.СубконтоДтДляПениНУ1,
	|	ДанныеУчета.СубконтоДтДляПениНУ2,
	|	ДанныеУчета.СубконтоДтДляПениНУ3,
	|	ДанныеУчета.ПодразделениеОрганизации,
	|	ДанныеУчета.НомерСубконтоПодразделенияДляПени,
	|	ДанныеУчета.НомерСубконтоСтатьиЗатратДляПени,
	|	ДанныеУчета.НомерСубконтоПодразделенияДляПениНУ,
	|	ДанныеУчета.НомерСубконтоСтатьиЗатратДляПениНУ
	|
	|ИЗ
	|	ВТ_ОППВПоСчетамЗатрат КАК ДанныеУчета
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Типовой.ВидыСубконто КАК ВидыСубконтоДт1
	|		ПО ДанныеУчета.СчетДт = ВидыСубконтоДт1.Ссылка
	|		   И ВидыСубконтоДт1.НомерСтроки = 1 
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Типовой.ВидыСубконто КАК ВидыСубконтоДт2
	|		ПО ДанныеУчета.СчетДт = ВидыСубконтоДт2.Ссылка
	|		   И ВидыСубконтоДт2.НомерСтроки = 2
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Типовой.ВидыСубконто КАК ВидыСубконтоДт3
	|		ПО ДанныеУчета.СчетДт = ВидыСубконтоДт3.Ссылка
	|		   И ВидыСубконтоДт3.НомерСтроки = 3
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Налоговый.ВидыСубконто КАК ВидыСубконтоДтНУ1
	|		ПО ДанныеУчета.СчетДтНУ = ВидыСубконтоДтНУ1.Ссылка
	|		   И ВидыСубконтоДтНУ1.НомерСтроки = 1
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Налоговый.ВидыСубконто КАК ВидыСубконтоДтНУ2
	|		ПО ДанныеУчета.СчетДтНУ = ВидыСубконтоДтНУ2.Ссылка
	|		   И ВидыСубконтоДтНУ2.НомерСтроки = 2
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Налоговый.ВидыСубконто КАК ВидыСубконтоДтНУ3
	|		ПО ДанныеУчета.СчетДтНУ = ВидыСубконтоДтНУ3.Ссылка
	|		   И ВидыСубконтоДтНУ3.НомерСтроки = 3
	|
	|УПОРЯДОЧИТЬ ПО
	|	ДанныеУчета.Физлицо,
	|	ДанныеУчета.ВидПлатежа
	|";
	
	Запрос.Текст = РаспределениеОППВПоСчетамЗатрат;
	
	СчетКредита = Справочники.НалогиСборыОтчисления.ОбязательныеПрофессиональныеПенсионныеВзносы.СчетУчетаРасчетовСКонтрагентомБУ;	
	Если НЕ ЗначениеЗаполнено(СчетКредита) Тогда
		СчетКредита	= ПланыСчетов.Типовой.ОбязательстваПоПенсионнымОтчислениям;
	КонецЕсли;
	
	СчетКредитаНУ = ПроцедурыНалоговогоУчетаВызовСервераПовтИсп.ПолучитьСчетУчетаНУОППВ(СчетКредита, КонецМесяца(Параметры.ПериодРегистрации));
	                      
	СтатьяЗатратПеняПоОППВ = Справочники.СтатьиЗатрат.ПеняПоОППВ;	
	ВидНалогаСбораОтчисленияОППВ = Справочники.НалогиСборыОтчисления.ОбязательныеПрофессиональныеПенсионныеВзносы;
	
	Выборка = Запрос.Выполнить().Выбрать();

	ЕстьДанные = Выборка.Следующий();
	Пока ЕстьДанные Цикл
		ТекущееФизЛицо = Выборка.ФизЛицо;
		ТекущийВидПлатежа = Выборка.ВидПлатежа;
		СуммаКРаспределению = Выборка.Взнос;
		РаспределеннаяСумма = 0;
		
		Пока ЕстьДанные 
		   И Выборка.ФизЛицо = ТекущееФизЛицо 
		   И Выборка.ВидПлатежа = ТекущийВидПлатежа Цикл
			
			Строка = ПромежуточнаяТаблица.Добавить();			
			
			// В зависимости от вида платежа (Налог/Взнос или пеня) ставим на разные счета затрат
			Если ТекущийВидПлатежа = Перечисления.ВидыПлатежейВБюджетИФонды.Налог
				 Или ТекущийВидПлатежа = Перечисления.ВидыПлатежейВБюджетИФонды.НалогАкт
				 Или ТекущийВидПлатежа = Перечисления.ВидыПлатежейВБюджетИФонды.НалогСам Тогда
				Строка.ВидРасчета	= ВидНалогаСбораОтчисленияОППВ;
				Строка.СчетДт 		= Выборка.СчетДт;
				Строка.СубконтоДт1 	= Выборка.СубконтоДт1;
				Строка.СубконтоДт2 	= Выборка.СубконтоДт2;
				Строка.СубконтоДт3 	= Выборка.СубконтоДт3;
				
				Строка.СчетДтНУ = Выборка.СчетДтНУ;
				Строка.СубконтоДтНУ1 = Выборка.СубконтоДтНУ1;
				Строка.СубконтоДтНУ2 = Выборка.СубконтоДтНУ2;
				Строка.СубконтоДтНУ3 = Выборка.СубконтоДтНУ3;
			Иначе
				Строка.ВидРасчета	= СтатьяЗатратПеняПоОППВ;
				Строка.СчетДт	    = Выборка.СчетДтДляПени;
				Если Выборка.НомерСубконтоСтатьиЗатратДляПени <> 0 Тогда
					Если ЗначениеЗаполнено(Выборка["СубконтоДтДляПени" + Выборка.НомерСубконтоСтатьиЗатратДляПени]) Тогда
						Строка["СубконтоДт" + Выборка.НомерСубконтоСтатьиЗатратДляПени]	= Выборка["СубконтоДтДляПени" + Выборка.НомерСубконтоСтатьиЗатратДляПени];
					Иначе 
						Строка["СубконтоДт" + Выборка.НомерСубконтоСтатьиЗатратДляПени]	= СтатьяЗатратПеняПоОППВ;
					КонецЕсли;
				КонецЕсли;
				Если Выборка.НомерСубконтоСтатьиЗатратДляПениНУ <> 0 Тогда
					Если ЗначениеЗаполнено(Выборка["СубконтоДтДляПениНУ" + Выборка.НомерСубконтоСтатьиЗатратДляПениНУ]) Тогда
						Строка["СубконтоДтНУ" + Выборка.НомерСубконтоСтатьиЗатратДляПениНУ] = Выборка["СубконтоДтДляПениНУ" + Выборка.НомерСубконтоСтатьиЗатратДляПениНУ];
					Иначе
						Строка["СубконтоДтНУ" + Выборка.НомерСубконтоСтатьиЗатратДляПениНУ] = СтатьяЗатратПеняПоОППВ;
					КонецЕсли;
				КонецЕсли;
				Если Выборка.НомерСубконтоПодразделенияДляПени <> 0 Тогда
					Если ЗначениеЗаполнено(Выборка["СубконтоДтДляПени" + Выборка.НомерСубконтоПодразделенияДляПени]) Тогда
						Строка["СубконтоДт" + Выборка.НомерСубконтоПодразделенияДляПени] = Выборка["СубконтоДтДляПени" + Выборка.НомерСубконтоПодразделенияДляПени];
					Иначе 
						Строка["СубконтоДт" + Выборка.НомерСубконтоПодразделенияДляПени] = Выборка.ПодразделениеОрганизации;
					КонецЕсли;
				КонецЕсли;
				Если Выборка.НомерСубконтоПодразделенияДляПениНУ <> 0 Тогда
					Если ЗначениеЗаполнено(Выборка["СубконтоДтДляПениНУ" + Выборка.НомерСубконтоПодразделенияДляПениНУ]) Тогда
						Строка["СубконтоДтНУ" + Выборка.НомерСубконтоПодразделенияДляПениНУ] = Выборка["СубконтоДтДляПениНУ" + Выборка.НомерСубконтоПодразделенияДляПениНУ];
					Иначе 
						Строка["СубконтоДтНУ" + Выборка.НомерСубконтоПодразделенияДляПениНУ] = Выборка.ПодразделениеОрганизации;
					КонецЕсли;
				КонецЕсли;
				
				// Заполним оставшиеся субконто
				Для Ном = 1 По 3 Цикл
					Если НЕ ЗначениеЗаполнено(Строка["СубконтоДт" + Ном]) Тогда
						Строка["СубконтоДт" + Ном] = Выборка["СубконтоДтДляПени" + Ном];
					КонецЕсли;
					Если НЕ ЗначениеЗаполнено(Строка["СубконтоДтНУ" + Ном]) Тогда
						Если ЗначениеЗаполнено(Выборка["СубконтоДтДляПениНУ" + Ном]) Тогда
							Строка["СубконтоДтНУ" + Ном] = Выборка["СубконтоДтДляПениНУ" + Ном];
						Иначе
							ОбщегоНазначенияБККлиентСервер.ЗаменитьСубконтоНУ(Строка, СчетДебетаДляПени, СчетДебетаДляПениНУ, Ном, СтатьяЗатратПеняПоОППВ, "СубконтоДтНУ");
						КонецЕсли;
					КонецЕсли;
				КонецЦикла;
				
				Строка.СчетДтНУ = Выборка.СчетДтДляПениНУ;			
				ОбщегоНазначенияБККлиентСервер.ЗаменитьСубконтоНУ(Строка, Строка.СчетДт, Строка.СчетДтНУ, 1, Строка.СубконтоДт1, "СубконтоДтНУ");
				ОбщегоНазначенияБККлиентСервер.ЗаменитьСубконтоНУ(Строка, Строка.СчетДт, Строка.СчетДтНУ, 2, Строка.СубконтоДт2, "СубконтоДтНУ");
				ОбщегоНазначенияБККлиентСервер.ЗаменитьСубконтоНУ(Строка, Строка.СчетДт, Строка.СчетДтНУ, 3, Строка.СубконтоДт3, "СубконтоДтНУ");
			КонецЕсли;			
			
			Строка.СчетКт 		= СчетКредита;
			Строка.СубконтоКт1 	= Справочники.НалогиСборыОтчисления.ОбязательныеПрофессиональныеПенсионныеВзносы;
			Строка.СубконтоКт2 	= Выборка.ВидПлатежа;
			Если ВедетсяУчетПоСотрудникам Тогда
				Строка.СубконтоКт3	= Выборка.Физлицо;
			КонецЕсли;
			
			Строка.СчетКтНУ = СчетКредитаНУ;
			ОбщегоНазначенияБККлиентСервер.ЗаменитьСубконтоНУ(Строка, Строка.СчетКт, Строка.СчетКтНУ, 1, Строка.СубконтоКт1, "СубконтоКтНУ");
			ОбщегоНазначенияБККлиентСервер.ЗаменитьСубконтоНУ(Строка, Строка.СчетКт, Строка.СчетКтНУ, 2, Строка.СубконтоКт2, "СубконтоКтНУ");
			Если ВедетсяУчетПоСотрудникам Тогда
				ОбщегоНазначенияБККлиентСервер.ЗаменитьСубконтоНУ(Строка, Строка.СчетКт, Строка.СчетКтНУ, 3, Строка.СубконтоКт3, "СубконтоКтНУ");
			КонецЕсли;
						
			Строка.Сумма		= Выборка.СуммаПроводки;
			Строка.ФизЛицо					= Выборка.ФизЛицо;
			Строка.СтруктурноеПодразделениеДт = Выборка.СтруктурноеПодразделениеДт;
			Строка.СтруктурноеПодразделениеКт = Параметры.СтруктурноеПодразделение;
			РаспределеннаяСумма = РаспределеннаяСумма + Выборка.СуммаПроводки;
			
			ЕстьДанные = Выборка.Следующий();
		КонецЦикла;
		
		// Остаток на последнюю строку по работнику
		Если СуммаКРаспределению <> РаспределеннаяСумма Тогда
			Строка.Сумма = Строка.Сумма + (СуммаКРаспределению - РаспределеннаяСумма);
		КонецЕсли;
	КонецЦикла;	

#КонецОбласти



#Область ОПВР 

   	// ОПВРИсчисленный
	//	Поля:
	//		ФизЛицо
	//		ВидПлатежа
	//		Взнос
	//	
	//	Описание:
	//	Исчисленные пенсионные взносы работодателя по видам платежа

    ОПВРИсчисленныйТекст = "
    |ВЫБРАТЬ РАЗРЕШЕННЫЕ
    |	ОПВРРасчетыСФондами.Регистратор КАК Регистратор,
	|	ОПВРРасчетыСФондами.ФизЛицо КАК ФизЛицо,
    |	ОПВРРасчетыСФондами.ВидПлатежа КАК ВидПлатежа,
    |	СУММА(ОПВРРасчетыСФондами.Взнос) КАК Взнос
    |
    |ПОМЕСТИТЬ ВТ_ОПВРИсчисленный
    |ИЗ
    |	РегистрНакопления.ОПВРРасчетыСФондами КАК ОПВРРасчетыСФондами
	|
    |	ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТСписокФизЛиц КАК СписокФизЛиц
    |		ПО ОПВРРасчетыСФондами.ФизЛицо = СписокФизЛиц.ФизЛицо
	|
    |ГДЕ
	|	ОПВРРасчетыСФондами.Период >= &парамНачалоМесяца И 
	|	ОПВРРасчетыСФондами.Период <= &парамКонецМесяца И 
	|	ОПВРРасчетыСФондами.Организация = &парамОрганизация И 
	|	ОПВРРасчетыСФондами.ВидДвижения = &парамВидДвиженияПриход И
	|	ОПВРРасчетыСФондами.ВидСтроки = &парамВидСтрокиИсчисление И
	|	ОПВРРасчетыСФондами.Взнос <> 0 И
	|	ОПВРРасчетыСФондами.Активность " + ?(ОтражениеЗаИП, "И
	|	ОПВРРасчетыСФондами.ФизЛицо <> &парамИндивидуальныйПредприниматель", "") + " 	
	|
	|СГРУППИРОВАТЬ ПО
	|   ОПВРРасчетыСФондами.Регистратор,
	|	ОПВРРасчетыСФондами.ФизЛицо,
	|   ОПВРРасчетыСФондами.ВидПлатежа
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	ФизЛицо
    |";
    
    Запрос.Текст = ОПВРИсчисленныйТекст;
    Запрос.Выполнить();
    
   	// БУДоходыПоСчетам
	//	Поля:
	//		ФизЛицо
	//		СчетДт
	//		СубконтоДт1
	//		СубконтоДт2
	//		СубконтоДт3
	//		Результат
	//	
	//	Описание:
	//	Данные отражения начислений в бухучете

    БУДоходыПоСчетам = "
    |ВЫБРАТЬ РАЗРЕШЕННЫЕ
    |	БУНачисления.ФизЛицо,
    |	БУНачисления.СчетДт,
	|	БУНачисления.СчетДтНУ КАК СчетДтНУ,
	|	БУНачисления.СтруктурноеПодразделениеДт,
    |	ВЫБОР 
    |		КОГДА ВидыСубконтоДт1.ВидСубконто = &парамВидСубконтоСтатьиЗатрат ТОГДА &парамСтатьяЗатратОПВР
    |		ИНАЧЕ БУНачисления.СубконтоДт1
    |	КОНЕЦ КАК СубконтоДт1,
    |	ВЫБОР 
    |		КОГДА ВидыСубконтоДт2.ВидСубконто = &парамВидСубконтоСтатьиЗатрат ТОГДА &парамСтатьяЗатратОПВР
    |		ИНАЧЕ БУНачисления.СубконтоДт2
    |	КОНЕЦ КАК СубконтоДт2,
    |	ВЫБОР 
    |		КОГДА ВидыСубконтоДт3.ВидСубконто = &парамВидСубконтоСтатьиЗатрат ТОГДА &парамСтатьяЗатратОПВР
    |		ИНАЧЕ БУНачисления.СубконтоДт3
    |	КОНЕЦ КАК СубконтоДт3,
	|	ВЫБОР 
    |		КОГДА ВидыСубконтоДтНУ1.ВидСубконто = &парамВидСубконтоСтатьиЗатрат ТОГДА &парамСтатьяЗатратОПВР
    |		ИНАЧЕ БУНачисления.СубконтоДтНУ1
    |	КОНЕЦ КАК СубконтоДтНУ1,
    |	ВЫБОР 
    |		КОГДА ВидыСубконтоДтНУ2.ВидСубконто = &парамВидСубконтоСтатьиЗатрат ТОГДА &парамСтатьяЗатратОПВР
    |		ИНАЧЕ БУНачисления.СубконтоДтНУ2
    |	КОНЕЦ КАК СубконтоДтНУ2,
    |	ВЫБОР 
    |		КОГДА ВидыСубконтоДтНУ3.ВидСубконто = &парамВидСубконтоСтатьиЗатрат ТОГДА &парамСтатьяЗатратОПВР
    |		ИНАЧЕ БУНачисления.СубконтоДтНУ3
    |	КОНЕЦ КАК СубконтоДтНУ3,
	|	БУНачисления.Сумма КАК Результат
	|ПОМЕСТИТЬ ВТ_БУНачисленияОПВР	
	|ИЗ
	|	ВТ_БУНачисления КАК БУНачисления
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Типовой.ВидыСубконто КАК ВидыСубконтоДт1
	|		ПО БУНачисления.СчетДт = ВидыСубконтоДт1.Ссылка
	|		   И ВидыСубконтоДт1.НомерСтроки = 1
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Типовой.ВидыСубконто КАК ВидыСубконтоДт2
	|		ПО БУНачисления.СчетДт = ВидыСубконтоДт2.Ссылка
	|		   И ВидыСубконтоДт2.НомерСтроки = 2
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Типовой.ВидыСубконто КАК ВидыСубконтоДт3
	|		ПО БУНачисления.СчетДт = ВидыСубконтоДт3.Ссылка
	|		   И ВидыСубконтоДт3.НомерСтроки = 3
	|
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Налоговый.ВидыСубконто КАК ВидыСубконтоДтНУ1
	|		ПО БУНачисления.СчетДтНУ = ВидыСубконтоДтНУ1.Ссылка
	|		   И ВидыСубконтоДтНУ1.НомерСтроки = 1
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Налоговый.ВидыСубконто КАК ВидыСубконтоДтНУ2
	|		ПО БУНачисления.СчетДтНУ = ВидыСубконтоДтНУ2.Ссылка
	|		   И ВидыСубконтоДтНУ2.НомерСтроки = 2
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Налоговый.ВидыСубконто КАК ВидыСубконтоДтНУ3
	|		ПО БУНачисления.СчетДтНУ = ВидыСубконтоДтНУ3.Ссылка
	|		   И ВидыСубконтоДтНУ3.НомерСтроки = 3
	|ГДЕ
	|	БУНачисления.ВидРасчета ССЫЛКА ПланВидовРасчета.ОсновныеНачисленияОрганизаций И
	|	БУНачисления.ВидРасчета <> &парамПустойВидРасчета И
	|	БУНачисления.ВидРасчета <> НЕОПРЕДЕЛЕНО И
	|	БУНачисления.ВидРасчета.ОблагаетсяОПВР <> &парамНеОблагаетсяЦеликом
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ РАЗРЕШЕННЫЕ
	|	БУНачисления.ФизЛицо,
	|	БУНачисления.СтруктурноеПодразделениеДт,
	|	БУНачисления.СчетДт,
	|	БУНачисления.СчетДтНУ,
	|	БУНачисления.СубконтоДт1,
	|	БУНачисления.СубконтоДт2,
	|	БУНачисления.СубконтоДт3,
	|	БУНачисления.СубконтоДтНУ1,
	|	БУНачисления.СубконтоДтНУ2,
	|	БУНачисления.СубконтоДтНУ3,
	|	СУММА(БУНачисления.Результат) КАК Результат
	|
	|ПОМЕСТИТЬ ВТ_БУДоходыПоСчетамОПВР
	|ИЗ
	|	ВТ_БУНачисленияОПВР КАК БУНачисления
	|
	|СГРУППИРОВАТЬ ПО
	|	БУНачисления.ФизЛицо,
	|	БУНачисления.СтруктурноеПодразделениеДт,
	|	БУНачисления.СчетДт,
	|	БУНачисления.СчетДтНУ,
	|	БУНачисления.СубконтоДт1,
	|	БУНачисления.СубконтоДт2,
	|	БУНачисления.СубконтоДт3,
	|	БУНачисления.СубконтоДтНУ1,
	|	БУНачисления.СубконтоДтНУ2,
	|	БУНачисления.СубконтоДтНУ3
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	ФизЛицо
	|";

	Запрос.Текст = БУДоходыПоСчетам;
	Запрос.Выполнить();
	     
	// сначала определим счет, на который будем относить затраты по обязательным пенсионным взносам работодателя и 
	// распределим пропорционально сумме начислений, а потом на основании счета подставим значения некоторых субконто по умолчанию
	РаспределениеОПВРПоСчетамЗатрат = "ВЫБРАТЬ РАЗРЕШЕННЫЕ
	                                  |	ОПВРРасчетыСФондами.ФизЛицо,
	                                  |	ОПВРРасчетыСФондами.ВидПлатежа,
	                                  |	СУММА(ОПВРРасчетыСФондами.Взнос) КАК Взнос,
	                                  |	СУММА(ВЫБОР
	                                  |			КОГДА БУСуммаНачислений.Результат <> 0
	                                  |				ТОГДА ВЫРАЗИТЬ(ОПВРРасчетыСФондами.Взнос * БУНачисления.Результат / БУСуммаНачислений.Результат КАК ЧИСЛО(15, 2))
	                                  |			ИНАЧЕ 0
	                                  |		КОНЕЦ) КАК СуммаПроводки,
	                                  |	ВЫБОР
	                                  |		КОГДА НЕ БУНачисления.СчетДт ЕСТЬ NULL 
	                                  |				И НЕ(БУНачисления.СчетДт В (&парамСчетаРезервовБезОПВР)
	                                  |						И БУНачисления.СубконтоДт1 В (&парамРезервыБезОПВР))
	                                  |			ТОГДА БУНачисления.СчетДт
	                                  |		КОГДА ОсновнойСпособОтражения.СпособОтраженияВБухучете = &парамСпособПоУмолчанию
	                                  |				И НЕ МестаРаботы.СпособОтраженияВБухучете ЕСТЬ NULL 
	                                  |			ТОГДА МестаРаботы.СпособОтраженияВБухучете.СчетДт
	                                  |		ИНАЧЕ ОсновнойСпособОтражения.СпособОтраженияВБухучете.СчетДт
	                                  |	КОНЕЦ КАК СчетДт,
	                                  |	ВЫБОР
	                                  |		КОГДА НЕ БУНачисления.СчетДтНУ ЕСТЬ NULL 
	                                  |				И НЕ(БУНачисления.СчетДт В (&парамСчетаРезервовБезОПВР)
	                                  |						И БУНачисления.СубконтоДт1 В (&парамРезервыБезОПВР))
	                                  |			ТОГДА БУНачисления.СчетДтНУ
	                                  |		КОГДА ОсновнойСпособОтражения.СпособОтраженияВБухучете = &парамСпособПоУмолчанию
	                                  |				И НЕ МестаРаботы.СпособОтраженияВБухучете ЕСТЬ NULL 
	                                  |			ТОГДА МестаРаботы.СпособОтраженияВБухучете.СчетДтНУ
	                                  |		ИНАЧЕ ОсновнойСпособОтражения.СпособОтраженияВБухучете.СчетДтНУ
	                                  |	КОНЕЦ КАК СчетДтНУ,
	                                  |	БУНачисления.СтруктурноеПодразделениеДт,
	                                  |	БУНачисления.СчетДт КАК СчетДтОплатаТруда,
	                                  |	БУНачисления.СубконтоДт1,
	                                  |	БУНачисления.СубконтоДт2,
	                                  |	БУНачисления.СубконтоДт3,
	                                  |	БУНачисления.СубконтоДтНУ1,
	                                  |	БУНачисления.СубконтоДтНУ2,
	                                  |	БУНачисления.СубконтоДтНУ3,
	                                  |	ВЫБОР
	                                  |		КОГДА РасчетПениОПВиСО.СчетЗатратБУ ЕСТЬ NULL 
	                                  |				ИЛИ РасчетПениОПВиСО.СчетЗатратБУ = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
	                                  |			ТОГДА &парамСчетДтДляПени
	                                  |		ИНАЧЕ РасчетПениОПВиСО.СчетЗатратБУ
	                                  |	КОНЕЦ КАК СчетДтДляПени,
	                                  |	ВЫБОР
	                                  |		КОГДА РасчетПениОПВиСО.СчетЗатратБУ ЕСТЬ NULL 
	                                  |				ИЛИ РасчетПениОПВиСО.СчетЗатратБУ = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
	                                  |			ТОГДА НЕОПРЕДЕЛЕНО
	                                  |		ИНАЧЕ ЕСТЬNULL(РасчетПениОПВиСО.СубконтоЗатратБУ1, НЕОПРЕДЕЛЕНО)
	                                  |	КОНЕЦ КАК СубконтоДтДляПени1,
	                                  |	ВЫБОР
	                                  |		КОГДА РасчетПениОПВиСО.СчетЗатратБУ ЕСТЬ NULL 
	                                  |				ИЛИ РасчетПениОПВиСО.СчетЗатратБУ = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
	                                  |			ТОГДА НЕОПРЕДЕЛЕНО
	                                  |		ИНАЧЕ ЕСТЬNULL(РасчетПениОПВиСО.СубконтоЗатратБУ2, НЕОПРЕДЕЛЕНО)
	                                  |	КОНЕЦ КАК СубконтоДтДляПени2,
	                                  |	ВЫБОР
	                                  |		КОГДА РасчетПениОПВиСО.СчетЗатратБУ ЕСТЬ NULL 
	                                  |				ИЛИ РасчетПениОПВиСО.СчетЗатратБУ = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
	                                  |			ТОГДА НЕОПРЕДЕЛЕНО
	                                  |		ИНАЧЕ ЕСТЬNULL(РасчетПениОПВиСО.СубконтоЗатратБУ3, НЕОПРЕДЕЛЕНО)
	                                  |	КОНЕЦ КАК СубконтоДтДляПени3,
	                                  |	ВЫБОР
	                                  |		КОГДА РасчетПениОПВиСО.СчетЗатратНУ ЕСТЬ NULL 
	                                  |				ИЛИ РасчетПениОПВиСО.СчетЗатратНУ = ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
	                                  |			ТОГДА &парамСчетДтДляПениНУ
	                                  |		ИНАЧЕ РасчетПениОПВиСО.СчетЗатратНУ
	                                  |	КОНЕЦ КАК СчетДтДляПениНУ,
	                                  |	ВЫБОР
	                                  |		КОГДА РасчетПениОПВиСО.СчетЗатратНУ ЕСТЬ NULL 
	                                  |				ИЛИ РасчетПениОПВиСО.СчетЗатратНУ = ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
	                                  |			ТОГДА НЕОПРЕДЕЛЕНО
	                                  |		ИНАЧЕ ЕСТЬNULL(РасчетПениОПВиСО.СубконтоЗатратНУ1, НЕОПРЕДЕЛЕНО)
	                                  |	КОНЕЦ КАК СубконтоДтДляПениНУ1,
	                                  |	ВЫБОР
	                                  |		КОГДА РасчетПениОПВиСО.СчетЗатратНУ ЕСТЬ NULL 
	                                  |				ИЛИ РасчетПениОПВиСО.СчетЗатратНУ = ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
	                                  |			ТОГДА НЕОПРЕДЕЛЕНО
	                                  |		ИНАЧЕ ЕСТЬNULL(РасчетПениОПВиСО.СубконтоЗатратНУ2, НЕОПРЕДЕЛЕНО)
	                                  |	КОНЕЦ КАК СубконтоДтДляПениНУ2,
	                                  |	ВЫБОР
	                                  |		КОГДА РасчетПениОПВиСО.СчетЗатратНУ ЕСТЬ NULL 
	                                  |				ИЛИ РасчетПениОПВиСО.СчетЗатратНУ = ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
	                                  |			ТОГДА НЕОПРЕДЕЛЕНО
	                                  |		ИНАЧЕ ЕСТЬNULL(РасчетПениОПВиСО.СубконтоЗатратНУ3, НЕОПРЕДЕЛЕНО)
	                                  |	КОНЕЦ КАК СубконтоДтДляПениНУ3,
	                                  |	МестаРаботы.ПодразделениеОрганизации,
	                                  |	МестаРаботы.СпособОтраженияВБухучете КАК СпособОтраженияВБухучетеДляПодразделения,
	                                  |	ОсновнойСпособОтражения.СпособОтраженияВБухучете КАК ОсновнойСпособОтраженияВБухучете,
	                                  |	ЕСТЬNULL(ВидыСубконтоПодразделенияДляПени.НомерСтроки, 0) КАК НомерСубконтоПодразделенияДляПени,
	                                  |	ЕСТЬNULL(ВидыСубконтоСтатьиЗатратДляПени.НомерСтроки, 0) КАК НомерСубконтоСтатьиЗатратДляПени,
	                                  |	ЕСТЬNULL(ВидСубконтоПодразделенияДляПениНУ.НомерСтроки, 0) КАК НомерСубконтоПодразделенияДляПениНУ,
	                                  |	ЕСТЬNULL(ВидСубконтоСтатьиЗатратДляПениНУ.НомерСтроки, 0) КАК НомерСубконтоСтатьиЗатратДляПениНУ
	                                  |ПОМЕСТИТЬ ВТ_ОПВРПоСчетамЗатрат
	                                  |ИЗ
	                                  |	ВТ_ОПВРИсчисленный КАК ОПВРРасчетыСФондами
	                                  |		ЛЕВОЕ СОЕДИНЕНИЕ Документ.РасчетПениОПВиСО КАК РасчетПениОПВиСО
	                                  |		ПО ОПВРРасчетыСФондами.Регистратор = РасчетПениОПВиСО.Ссылка
	                                  |		ЛЕВОЕ СОЕДИНЕНИЕ ВТ_БУДоходыПоСчетамОПВР КАК БУНачисления
	                                  |		ПО ОПВРРасчетыСФондами.ФизЛицо = БУНачисления.ФизЛицо
	                                  |		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
	                                  |			БУНачисления.ФизЛицо КАК ФизЛицо,
	                                  |			СУММА(БУНачисления.Результат) КАК Результат
	                                  |		ИЗ
	                                  |			ВТ_БУДоходыПоСчетамОПВР КАК БУНачисления
	                                  |		
	                                  |		СГРУППИРОВАТЬ ПО
	                                  |			БУНачисления.ФизЛицо) КАК БУСуммаНачислений
	                                  |		ПО ОПВРРасчетыСФондами.ФизЛицо = БУСуммаНачислений.ФизЛицо
	                                  |		ЛЕВОЕ СОЕДИНЕНИЕ ВТ_ОсновнойСпособОтражения КАК ОсновнойСпособОтражения
	                                  |		ПО ОПВРРасчетыСФондами.ФизЛицо = ОсновнойСпособОтражения.ФизЛицо
	                                  |		ЛЕВОЕ СОЕДИНЕНИЕ ВТ_МестаРаботы КАК МестаРаботы
	                                  |		ПО ОПВРРасчетыСФондами.ФизЛицо = МестаРаботы.ФизЛицо
	                                  |		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Типовой.ВидыСубконто КАК ВидыСубконтоПодразделенияДляПени
	                                  |		ПО (ВидыСубконтоПодразделенияДляПени.Ссылка = ВЫБОР
	                                  |				КОГДА РасчетПениОПВиСО.СчетЗатратБУ ЕСТЬ NULL 
	                                  |						ИЛИ РасчетПениОПВиСО.СчетЗатратБУ = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
	                                  |					ТОГДА &парамСчетДтДляПени
	                                  |				ИНАЧЕ РасчетПениОПВиСО.СчетЗатратБУ
	                                  |			КОНЕЦ)
	                                  |			И (ВидыСубконтоПодразделенияДляПени.ВидСубконто = &парамВидСубконтоПодразделения)
	                                  |		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Типовой.ВидыСубконто КАК ВидыСубконтоСтатьиЗатратДляПени
	                                  |		ПО (ВидыСубконтоСтатьиЗатратДляПени.Ссылка = ВЫБОР
	                                  |				КОГДА РасчетПениОПВиСО.СчетЗатратБУ ЕСТЬ NULL 
	                                  |						ИЛИ РасчетПениОПВиСО.СчетЗатратБУ = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
	                                  |					ТОГДА &парамСчетДтДляПени
	                                  |				ИНАЧЕ РасчетПениОПВиСО.СчетЗатратБУ
	                                  |			КОНЕЦ)
	                                  |			И (ВидыСубконтоСтатьиЗатратДляПени.ВидСубконто = &парамВидСубконтоСтатьиЗатрат)
	                                  |		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Налоговый.ВидыСубконто КАК ВидСубконтоСтатьиЗатратДляПениНУ
	                                  |		ПО (ВидСубконтоСтатьиЗатратДляПениНУ.Ссылка = ВЫБОР
	                                  |				КОГДА РасчетПениОПВиСО.СчетЗатратНУ ЕСТЬ NULL 
	                                  |						ИЛИ РасчетПениОПВиСО.СчетЗатратНУ = ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
	                                  |					ТОГДА &парамСчетДтДляПениНУ
	                                  |				ИНАЧЕ РасчетПениОПВиСО.СчетЗатратНУ
	                                  |			КОНЕЦ)
	                                  |			И (ВидСубконтоСтатьиЗатратДляПениНУ.ВидСубконто = &парамВидСубконтоСтатьиЗатрат)
	                                  |		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Налоговый.ВидыСубконто КАК ВидСубконтоПодразделенияДляПениНУ
	                                  |		ПО (ВидСубконтоПодразделенияДляПениНУ.Ссылка = ВЫБОР
	                                  |				КОГДА РасчетПениОПВиСО.СчетЗатратНУ ЕСТЬ NULL 
	                                  |						ИЛИ РасчетПениОПВиСО.СчетЗатратНУ = ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
	                                  |					ТОГДА &парамСчетДтДляПениНУ
	                                  |				ИНАЧЕ РасчетПениОПВиСО.СчетЗатратНУ
	                                  |			КОНЕЦ)
	                                  |			И (ВидСубконтоПодразделенияДляПениНУ.ВидСубконто = &парамВидСубконтоПодразделения)
	                                  |
	                                  |СГРУППИРОВАТЬ ПО
	                                  |	ОПВРРасчетыСФондами.ФизЛицо,
	                                  |	ОПВРРасчетыСФондами.ВидПлатежа,
	                                  |	БУНачисления.СтруктурноеПодразделениеДт,
	                                  |	БУНачисления.СчетДт,
	                                  |	БУНачисления.СубконтоДт1,
	                                  |	БУНачисления.СубконтоДт2,
	                                  |	БУНачисления.СубконтоДт3,
	                                  |	БУНачисления.СубконтоДтНУ1,
	                                  |	БУНачисления.СубконтоДтНУ2,
	                                  |	БУНачисления.СубконтоДтНУ3,
	                                  |	МестаРаботы.ПодразделениеОрганизации,
	                                  |	МестаРаботы.СпособОтраженияВБухучете,
	                                  |	ОсновнойСпособОтражения.СпособОтраженияВБухучете,
	                                  |	ВЫБОР
	                                  |		КОГДА НЕ БУНачисления.СчетДт ЕСТЬ NULL 
	                                  |				И НЕ(БУНачисления.СчетДт В (&парамСчетаРезервовБезОПВР)
	                                  |						И БУНачисления.СубконтоДт1 В (&парамРезервыБезОПВР))
	                                  |			ТОГДА БУНачисления.СчетДт
	                                  |		КОГДА ОсновнойСпособОтражения.СпособОтраженияВБухучете = &парамСпособПоУмолчанию
	                                  |				И НЕ МестаРаботы.СпособОтраженияВБухучете ЕСТЬ NULL 
	                                  |			ТОГДА МестаРаботы.СпособОтраженияВБухучете.СчетДт
	                                  |		ИНАЧЕ ОсновнойСпособОтражения.СпособОтраженияВБухучете.СчетДт
	                                  |	КОНЕЦ,
	                                  |	ВЫБОР
	                                  |		КОГДА НЕ БУНачисления.СчетДтНУ ЕСТЬ NULL 
	                                  |				И НЕ(БУНачисления.СчетДт В (&парамСчетаРезервовБезОПВР)
	                                  |						И БУНачисления.СубконтоДт1 В (&парамРезервыБезОПВР))
	                                  |			ТОГДА БУНачисления.СчетДтНУ
	                                  |		КОГДА ОсновнойСпособОтражения.СпособОтраженияВБухучете = &парамСпособПоУмолчанию
	                                  |				И НЕ МестаРаботы.СпособОтраженияВБухучете ЕСТЬ NULL 
	                                  |			ТОГДА МестаРаботы.СпособОтраженияВБухучете.СчетДтНУ
	                                  |		ИНАЧЕ ОсновнойСпособОтражения.СпособОтраженияВБухучете.СчетДтНУ
	                                  |	КОНЕЦ,
	                                  |	ВЫБОР
	                                  |		КОГДА РасчетПениОПВиСО.СчетЗатратБУ ЕСТЬ NULL 
	                                  |				ИЛИ РасчетПениОПВиСО.СчетЗатратБУ = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
	                                  |			ТОГДА &парамСчетДтДляПени
	                                  |		ИНАЧЕ РасчетПениОПВиСО.СчетЗатратБУ
	                                  |	КОНЕЦ,
	                                  |	ВЫБОР
	                                  |		КОГДА РасчетПениОПВиСО.СчетЗатратБУ ЕСТЬ NULL 
	                                  |				ИЛИ РасчетПениОПВиСО.СчетЗатратБУ = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
	                                  |			ТОГДА НЕОПРЕДЕЛЕНО
	                                  |		ИНАЧЕ ЕСТЬNULL(РасчетПениОПВиСО.СубконтоЗатратБУ1, НЕОПРЕДЕЛЕНО)
	                                  |	КОНЕЦ,
	                                  |	ВЫБОР
	                                  |		КОГДА РасчетПениОПВиСО.СчетЗатратБУ ЕСТЬ NULL 
	                                  |				ИЛИ РасчетПениОПВиСО.СчетЗатратБУ = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
	                                  |			ТОГДА НЕОПРЕДЕЛЕНО
	                                  |		ИНАЧЕ ЕСТЬNULL(РасчетПениОПВиСО.СубконтоЗатратБУ2, НЕОПРЕДЕЛЕНО)
	                                  |	КОНЕЦ,
	                                  |	ВЫБОР
	                                  |		КОГДА РасчетПениОПВиСО.СчетЗатратБУ ЕСТЬ NULL 
	                                  |				ИЛИ РасчетПениОПВиСО.СчетЗатратБУ = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
	                                  |			ТОГДА НЕОПРЕДЕЛЕНО
	                                  |		ИНАЧЕ ЕСТЬNULL(РасчетПениОПВиСО.СубконтоЗатратБУ3, НЕОПРЕДЕЛЕНО)
	                                  |	КОНЕЦ,
	                                  |	ВЫБОР
	                                  |		КОГДА РасчетПениОПВиСО.СчетЗатратНУ ЕСТЬ NULL 
	                                  |				ИЛИ РасчетПениОПВиСО.СчетЗатратНУ = ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
	                                  |			ТОГДА &парамСчетДтДляПениНУ
	                                  |		ИНАЧЕ РасчетПениОПВиСО.СчетЗатратНУ
	                                  |	КОНЕЦ,
	                                  |	ВЫБОР
	                                  |		КОГДА РасчетПениОПВиСО.СчетЗатратНУ ЕСТЬ NULL 
	                                  |				ИЛИ РасчетПениОПВиСО.СчетЗатратНУ = ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
	                                  |			ТОГДА НЕОПРЕДЕЛЕНО
	                                  |		ИНАЧЕ ЕСТЬNULL(РасчетПениОПВиСО.СубконтоЗатратНУ1, НЕОПРЕДЕЛЕНО)
	                                  |	КОНЕЦ,
	                                  |	ВЫБОР
	                                  |		КОГДА РасчетПениОПВиСО.СчетЗатратНУ ЕСТЬ NULL 
	                                  |				ИЛИ РасчетПениОПВиСО.СчетЗатратНУ = ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
	                                  |			ТОГДА НЕОПРЕДЕЛЕНО
	                                  |		ИНАЧЕ ЕСТЬNULL(РасчетПениОПВиСО.СубконтоЗатратНУ2, НЕОПРЕДЕЛЕНО)
	                                  |	КОНЕЦ,
	                                  |	ВЫБОР
	                                  |		КОГДА РасчетПениОПВиСО.СчетЗатратНУ ЕСТЬ NULL 
	                                  |				ИЛИ РасчетПениОПВиСО.СчетЗатратНУ = ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
	                                  |			ТОГДА НЕОПРЕДЕЛЕНО
	                                  |		ИНАЧЕ ЕСТЬNULL(РасчетПениОПВиСО.СубконтоЗатратНУ3, НЕОПРЕДЕЛЕНО)
	                                  |	КОНЕЦ,
	                                  |	ЕСТЬNULL(ВидыСубконтоПодразделенияДляПени.НомерСтроки, 0),
	                                  |	ЕСТЬNULL(ВидыСубконтоСтатьиЗатратДляПени.НомерСтроки, 0),
	                                  |	ЕСТЬNULL(ВидСубконтоПодразделенияДляПениНУ.НомерСтроки, 0),
	                                  |	ЕСТЬNULL(ВидСубконтоСтатьиЗатратДляПениНУ.НомерСтроки, 0)
	                                  |
	                                  |ИНДЕКСИРОВАТЬ ПО
	                                  |	СчетДт,
	                                  |	СчетДтНУ";
	
	Запрос.Текст = РаспределениеОПВРПоСчетамЗатрат;
	Запрос.Выполнить();
                                		
	// Распределяем обязательные пенсионные взносы работодателя по счетам затрат 
	// пропорционально сумме начислений, с которых брались эти взносы
	РаспределениеОПВРПоСчетамЗатрат = "
	|ВЫБРАТЬ РАЗРЕШЕННЫЕ
	|	ДанныеУчета.ФизЛицо,
	|	ДанныеУчета.СтруктурноеПодразделениеДт,
	|	ДанныеУчета.ВидПлатежа,
	|	ДанныеУчета.Взнос,
	|	ДанныеУчета.СуммаПроводки,
	|	ДанныеУчета.СчетДт,
	|	ДанныеУчета.СчетДтНУ,
	|
	|	ВЫБОР
	|		КОГДА НЕ(ДанныеУчета.СубконтоДт1 ЕСТЬ NULL)
	|				И НЕ(ДанныеУчета.СчетДтОплатаТруда В (&парамСчетаРезервовБезОПВР) И ДанныеУчета.СубконтоДт1 В (&парамРезервыБезОПВР))
	|			ТОГДА ДанныеУчета.СубконтоДт1
	|		КОГДА ВидыСубконтоДт1.ВидСубконто = &парамВидСубконтоСтатьиЗатрат ТОГДА &парамСтатьяЗатратОПВР	
	|		КОГДА ВидыСубконтоДт1.ВидСубконто = &парамВидСубконтоПодразделения ТОГДА ДанныеУчета.ПодразделениеОрганизации
	|		КОГДА ДанныеУчета.ОсновнойСпособОтраженияВБухучете = &парамСпособПоУмолчанию
	|					И НЕ (ДанныеУчета.СпособОтраженияВБухучетеДляПодразделения ЕСТЬ NULL)
	|			ТОГДА ДанныеУчета.СпособОтраженияВБухучетеДляПодразделения.СубконтоДт1
	|		ИНАЧЕ ДанныеУчета.ОсновнойСпособОтраженияВБухучете.СубконтоДт1
	|	КОНЕЦ КАК СубконтоДт1,
	|
	|	ВЫБОР
	|		КОГДА НЕ(ДанныеУчета.СубконтоДт2 ЕСТЬ NULL)
	|				И НЕ(ДанныеУчета.СчетДтОплатаТруда В (&парамСчетаРезервовБезОПВР) И ДанныеУчета.СубконтоДт1 В (&парамРезервыБезОПВР))
	|			ТОГДА ДанныеУчета.СубконтоДт2
	|		КОГДА ВидыСубконтоДт2.ВидСубконто = &парамВидСубконтоСтатьиЗатрат ТОГДА &парамСтатьяЗатратОПВР
	|		КОГДА ВидыСубконтоДт2.ВидСубконто = &парамВидСубконтоПодразделения ТОГДА ДанныеУчета.ПодразделениеОрганизации
	|		КОГДА ДанныеУчета.ОсновнойСпособОтраженияВБухучете = &парамСпособПоУмолчанию
	|					И НЕ (ДанныеУчета.СпособОтраженияВБухучетеДляПодразделения ЕСТЬ NULL)
	|			ТОГДА ДанныеУчета.СпособОтраженияВБухучетеДляПодразделения.СубконтоДт2
	|		ИНАЧЕ ДанныеУчета.ОсновнойСпособОтраженияВБухучете.СубконтоДт2
	|	КОНЕЦ КАК СубконтоДт2,
	|
	|	ВЫБОР
	|		КОГДА НЕ(ДанныеУчета.СубконтоДт3 ЕСТЬ NULL)
	|				И НЕ(ДанныеУчета.СчетДтОплатаТруда В (&парамСчетаРезервовБезОПВР) И ДанныеУчета.СубконтоДт1 В (&парамРезервыБезОПВР))
	|			ТОГДА ДанныеУчета.СубконтоДт3
	|		КОГДА ВидыСубконтоДт3.ВидСубконто = &парамВидСубконтоСтатьиЗатрат ТОГДА &парамСтатьяЗатратОПВР
	|		КОГДА ВидыСубконтоДт3.ВидСубконто = &парамВидСубконтоПодразделения ТОГДА ДанныеУчета.ПодразделениеОрганизации
	|		КОГДА ДанныеУчета.ОсновнойСпособОтраженияВБухучете = &парамСпособПоУмолчанию
	|					И НЕ (ДанныеУчета.СпособОтраженияВБухучетеДляПодразделения ЕСТЬ NULL)
	|			ТОГДА ДанныеУчета.СпособОтраженияВБухучетеДляПодразделения.СубконтоДт3
	|		ИНАЧЕ ДанныеУчета.ОсновнойСпособОтраженияВБухучете.СубконтоДт3
	|	КОНЕЦ КАК СубконтоДт3,
	|
	|	ВЫБОР
	|		КОГДА НЕ(ДанныеУчета.СубконтоДтНУ1 ЕСТЬ NULL)
	|				И НЕ(ДанныеУчета.СчетДтОплатаТруда В (&парамСчетаРезервовБезОПВР) И ДанныеУчета.СубконтоДт1 В (&парамРезервыБезОПВР))
	|			ТОГДА ДанныеУчета.СубконтоДтНУ1
	|		КОГДА ВидыСубконтоДтНУ1.ВидСубконто = &парамВидСубконтоСтатьиЗатрат ТОГДА &парамСтатьяЗатратОПВР
	|		КОГДА ВидыСубконтоДтНУ1.ВидСубконто = &парамВидСубконтоПодразделения ТОГДА ДанныеУчета.ПодразделениеОрганизации
	|		КОГДА ДанныеУчета.ОсновнойСпособОтраженияВБухучете = &парамСпособПоУмолчанию
	|					И НЕ (ДанныеУчета.СпособОтраженияВБухучетеДляПодразделения ЕСТЬ NULL)
	|			ТОГДА ДанныеУчета.СпособОтраженияВБухучетеДляПодразделения.СубконтоДтНУ1
	|		ИНАЧЕ ДанныеУчета.ОсновнойСпособОтраженияВБухучете.СубконтоДтНУ1
	|	КОНЕЦ КАК СубконтоДтНУ1,
	|
	|	ВЫБОР
	|		КОГДА НЕ(ДанныеУчета.СубконтоДтНУ2 ЕСТЬ NULL)
	|				И НЕ(ДанныеУчета.СчетДтОплатаТруда В (&парамСчетаРезервовБезОПВР) И ДанныеУчета.СубконтоДт1 В (&парамРезервыБезОПВР))
	|			ТОГДА ДанныеУчета.СубконтоДтНУ2
	|		КОГДА ВидыСубконтоДтНУ2.ВидСубконто = &парамВидСубконтоСтатьиЗатрат ТОГДА &парамСтатьяЗатратОПВР
	|		КОГДА ВидыСубконтоДтНУ2.ВидСубконто = &парамВидСубконтоПодразделения ТОГДА ДанныеУчета.ПодразделениеОрганизации
	|		КОГДА ДанныеУчета.ОсновнойСпособОтраженияВБухучете = &парамСпособПоУмолчанию
	|					И НЕ (ДанныеУчета.СпособОтраженияВБухучетеДляПодразделения ЕСТЬ NULL)
	|			ТОГДА ДанныеУчета.СпособОтраженияВБухучетеДляПодразделения.СубконтоДтНУ2
	|		ИНАЧЕ ДанныеУчета.ОсновнойСпособОтраженияВБухучете.СубконтоДтНУ2
	|	КОНЕЦ КАК СубконтоДтНУ2,
	|
	|	ВЫБОР
	|		КОГДА НЕ(ДанныеУчета.СубконтоДтНУ3 ЕСТЬ NULL)
	|				И НЕ(ДанныеУчета.СчетДтОплатаТруда В (&парамСчетаРезервовБезОПВР) И ДанныеУчета.СубконтоДт1 В (&парамРезервыБезОПВР))
	|			ТОГДА ДанныеУчета.СубконтоДтНУ3
	|		КОГДА ВидыСубконтоДтНУ3.ВидСубконто = &парамВидСубконтоСтатьиЗатрат ТОГДА &парамСтатьяЗатратОПВР
	|		КОГДА ВидыСубконтоДтНУ3.ВидСубконто = &парамВидСубконтоПодразделения ТОГДА ДанныеУчета.ПодразделениеОрганизации
	|		КОГДА ДанныеУчета.ОсновнойСпособОтраженияВБухучете = &парамСпособПоУмолчанию
	|					И НЕ (ДанныеУчета.СпособОтраженияВБухучетеДляПодразделения ЕСТЬ NULL)
	|			ТОГДА ДанныеУчета.СпособОтраженияВБухучетеДляПодразделения.СубконтоДтНУ3
	|		ИНАЧЕ ДанныеУчета.ОсновнойСпособОтраженияВБухучете.СубконтоДтНУ3
	|	КОНЕЦ КАК СубконтоДтНУ3,
	|	ДанныеУчета.СчетДтДляПени,
	|	ДанныеУчета.СубконтоДтДляПени1,
	|	ДанныеУчета.СубконтоДтДляПени2,
	|	ДанныеУчета.СубконтоДтДляПени3,
	|	ДанныеУчета.СчетДтДляПениНУ,
	|	ДанныеУчета.СубконтоДтДляПениНУ1,
	|	ДанныеУчета.СубконтоДтДляПениНУ2,
	|	ДанныеУчета.СубконтоДтДляПениНУ3,
	|	ДанныеУчета.ПодразделениеОрганизации,
	|	ДанныеУчета.НомерСубконтоПодразделенияДляПени,
	|	ДанныеУчета.НомерСубконтоСтатьиЗатратДляПени,
	|	ДанныеУчета.НомерСубконтоПодразделенияДляПениНУ,
	|	ДанныеУчета.НомерСубконтоСтатьиЗатратДляПениНУ
	|
	|ИЗ
	|	ВТ_ОПВРПоСчетамЗатрат КАК ДанныеУчета
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Типовой.ВидыСубконто КАК ВидыСубконтоДт1
	|		ПО ДанныеУчета.СчетДт = ВидыСубконтоДт1.Ссылка
	|		   И ВидыСубконтоДт1.НомерСтроки = 1 
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Типовой.ВидыСубконто КАК ВидыСубконтоДт2
	|		ПО ДанныеУчета.СчетДт = ВидыСубконтоДт2.Ссылка
	|		   И ВидыСубконтоДт2.НомерСтроки = 2
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Типовой.ВидыСубконто КАК ВидыСубконтоДт3
	|		ПО ДанныеУчета.СчетДт = ВидыСубконтоДт3.Ссылка
	|		   И ВидыСубконтоДт3.НомерСтроки = 3
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Налоговый.ВидыСубконто КАК ВидыСубконтоДтНУ1
	|		ПО ДанныеУчета.СчетДтНУ = ВидыСубконтоДтНУ1.Ссылка
	|		   И ВидыСубконтоДтНУ1.НомерСтроки = 1
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Налоговый.ВидыСубконто КАК ВидыСубконтоДтНУ2
	|		ПО ДанныеУчета.СчетДтНУ = ВидыСубконтоДтНУ2.Ссылка
	|		   И ВидыСубконтоДтНУ2.НомерСтроки = 2
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Налоговый.ВидыСубконто КАК ВидыСубконтоДтНУ3
	|		ПО ДанныеУчета.СчетДтНУ = ВидыСубконтоДтНУ3.Ссылка
	|		   И ВидыСубконтоДтНУ3.НомерСтроки = 3
	|
	|УПОРЯДОЧИТЬ ПО
	|	ДанныеУчета.Физлицо,
	|	ДанныеУчета.ВидПлатежа
	|";
	
	Запрос.Текст = РаспределениеОПВРПоСчетамЗатрат;
	
	СчетКредита = Справочники.НалогиСборыОтчисления.ОбязательныеПенсионныеВзносыРаботодателя.СчетУчетаРасчетовСКонтрагентомБУ;	
	Если НЕ ЗначениеЗаполнено(СчетКредита) Тогда
		СчетКредита	= ПланыСчетов.Типовой.ОбязательстваПоОбязательнымПенсионнымВзносамРаботодателя;
	КонецЕсли;
	
	СчетКредитаНУ = ПроцедурыНалоговогоУчетаВызовСервераПовтИсп.ПолучитьСчетУчетаНУОПВР(СчетКредита, КонецМесяца(Параметры.ПериодРегистрации));
	                      
	СтатьяЗатратПеняПоОПВР = Справочники.СтатьиЗатрат.ПеняПоОПВР;	
	ВидНалогаСбораОтчисленияОПВР = Справочники.НалогиСборыОтчисления.ОбязательныеПенсионныеВзносыРаботодателя;
	
	Выборка = Запрос.Выполнить().Выбрать();

	ЕстьДанные = Выборка.Следующий();
	Пока ЕстьДанные Цикл
		ТекущееФизЛицо = Выборка.ФизЛицо;
		ТекущийВидПлатежа = Выборка.ВидПлатежа;
		СуммаКРаспределению = Выборка.Взнос;
		РаспределеннаяСумма = 0;
		
		Пока ЕстьДанные 
		   И Выборка.ФизЛицо = ТекущееФизЛицо 
		   И Выборка.ВидПлатежа = ТекущийВидПлатежа Цикл
			
			Строка = ПромежуточнаяТаблица.Добавить();			
			
			// В зависимости от вида платежа (Налог/Взнос или пеня) ставим на разные счета затрат
			Если ТекущийВидПлатежа = Перечисления.ВидыПлатежейВБюджетИФонды.Налог
				 Или ТекущийВидПлатежа = Перечисления.ВидыПлатежейВБюджетИФонды.НалогАкт
				 Или ТекущийВидПлатежа = Перечисления.ВидыПлатежейВБюджетИФонды.НалогСам Тогда
				Строка.ВидРасчета	= ВидНалогаСбораОтчисленияОПВР;
				Строка.СчетДт 		= Выборка.СчетДт;
				Строка.СубконтоДт1 	= Выборка.СубконтоДт1;
				Строка.СубконтоДт2 	= Выборка.СубконтоДт2;
				Строка.СубконтоДт3 	= Выборка.СубконтоДт3;
				
				Строка.СчетДтНУ = Выборка.СчетДтНУ;
				Строка.СубконтоДтНУ1 = Выборка.СубконтоДтНУ1;
				Строка.СубконтоДтНУ2 = Выборка.СубконтоДтНУ2;
				Строка.СубконтоДтНУ3 = Выборка.СубконтоДтНУ3;
			Иначе
				Строка.ВидРасчета	= СтатьяЗатратПеняПоОПВР;
				Строка.СчетДт	    = Выборка.СчетДтДляПени;
				Если Выборка.НомерСубконтоСтатьиЗатратДляПени <> 0 Тогда
					Если ЗначениеЗаполнено(Выборка["СубконтоДтДляПени" + Выборка.НомерСубконтоСтатьиЗатратДляПени]) Тогда
						Строка["СубконтоДт" + Выборка.НомерСубконтоСтатьиЗатратДляПени]	= Выборка["СубконтоДтДляПени" + Выборка.НомерСубконтоСтатьиЗатратДляПени];
					Иначе 
						Строка["СубконтоДт" + Выборка.НомерСубконтоСтатьиЗатратДляПени]	= СтатьяЗатратПеняПоОПВР;
					КонецЕсли;
				КонецЕсли;
				Если Выборка.НомерСубконтоСтатьиЗатратДляПениНУ <> 0 Тогда
					Если ЗначениеЗаполнено(Выборка["СубконтоДтДляПениНУ" + Выборка.НомерСубконтоСтатьиЗатратДляПениНУ]) Тогда
						Строка["СубконтоДтНУ" + Выборка.НомерСубконтоСтатьиЗатратДляПениНУ] = Выборка["СубконтоДтДляПениНУ" + Выборка.НомерСубконтоСтатьиЗатратДляПениНУ];
					Иначе
						Строка["СубконтоДтНУ" + Выборка.НомерСубконтоСтатьиЗатратДляПениНУ] = СтатьяЗатратПеняПоОПВР;
					КонецЕсли;
				КонецЕсли;
				Если Выборка.НомерСубконтоПодразделенияДляПени <> 0 Тогда
					Если ЗначениеЗаполнено(Выборка["СубконтоДтДляПени" + Выборка.НомерСубконтоПодразделенияДляПени]) Тогда
						Строка["СубконтоДт" + Выборка.НомерСубконтоПодразделенияДляПени] = Выборка["СубконтоДтДляПени" + Выборка.НомерСубконтоПодразделенияДляПени];
					Иначе 
						Строка["СубконтоДт" + Выборка.НомерСубконтоПодразделенияДляПени] = Выборка.ПодразделениеОрганизации;
					КонецЕсли;
				КонецЕсли;
				Если Выборка.НомерСубконтоПодразделенияДляПениНУ <> 0 Тогда
					Если ЗначениеЗаполнено(Выборка["СубконтоДтДляПениНУ" + Выборка.НомерСубконтоПодразделенияДляПениНУ]) Тогда
						Строка["СубконтоДтНУ" + Выборка.НомерСубконтоПодразделенияДляПениНУ] = Выборка["СубконтоДтДляПениНУ" + Выборка.НомерСубконтоПодразделенияДляПениНУ];
					Иначе 
						Строка["СубконтоДтНУ" + Выборка.НомерСубконтоПодразделенияДляПениНУ] = Выборка.ПодразделениеОрганизации;
					КонецЕсли;
				КонецЕсли;
				
				// Заполним оставшиеся субконто
				Для Ном = 1 По 3 Цикл
					Если НЕ ЗначениеЗаполнено(Строка["СубконтоДт" + Ном]) Тогда
						Строка["СубконтоДт" + Ном] = Выборка["СубконтоДтДляПени" + Ном];
					КонецЕсли;
					Если НЕ ЗначениеЗаполнено(Строка["СубконтоДтНУ" + Ном]) Тогда
						Если ЗначениеЗаполнено(Выборка["СубконтоДтДляПениНУ" + Ном]) Тогда
							Строка["СубконтоДтНУ" + Ном] = Выборка["СубконтоДтДляПениНУ" + Ном];
						Иначе
							ОбщегоНазначенияБККлиентСервер.ЗаменитьСубконтоНУ(Строка, СчетДебетаДляПени, СчетДебетаДляПениНУ, Ном, СтатьяЗатратПеняПоОПВР, "СубконтоДтНУ");
						КонецЕсли;
					КонецЕсли;
				КонецЦикла;
				
				Строка.СчетДтНУ = Выборка.СчетДтДляПениНУ;			
				ОбщегоНазначенияБККлиентСервер.ЗаменитьСубконтоНУ(Строка, Строка.СчетДт, Строка.СчетДтНУ, 1, Строка.СубконтоДт1, "СубконтоДтНУ");
				ОбщегоНазначенияБККлиентСервер.ЗаменитьСубконтоНУ(Строка, Строка.СчетДт, Строка.СчетДтНУ, 2, Строка.СубконтоДт2, "СубконтоДтНУ");
				ОбщегоНазначенияБККлиентСервер.ЗаменитьСубконтоНУ(Строка, Строка.СчетДт, Строка.СчетДтНУ, 3, Строка.СубконтоДт3, "СубконтоДтНУ");
			КонецЕсли;			
			
			Строка.СчетКт 		= СчетКредита;
			Строка.СубконтоКт1 	= Выборка.ВидПлатежа;
			Если ВедетсяУчетПоСотрудникам Тогда
				Строка.СубконтоКт2	= Выборка.Физлицо;
			КонецЕсли;
			
			Строка.СчетКтНУ = СчетКредитаНУ;
			ОбщегоНазначенияБККлиентСервер.ЗаменитьСубконтоНУ(Строка, Строка.СчетКт, Строка.СчетКтНУ, 1, Строка.СубконтоКт1, "СубконтоКтНУ");
			Если ВедетсяУчетПоСотрудникам Тогда
				ОбщегоНазначенияБККлиентСервер.ЗаменитьСубконтоНУ(Строка, Строка.СчетКт, Строка.СчетКтНУ, 2, Строка.СубконтоКт2, "СубконтоКтНУ");
			КонецЕсли;
						
			Строка.Сумма		= Выборка.СуммаПроводки;
			Строка.ФизЛицо					= Выборка.ФизЛицо;
			Строка.СтруктурноеПодразделениеДт = Выборка.СтруктурноеПодразделениеДт;
			Строка.СтруктурноеПодразделениеКт = Параметры.СтруктурноеПодразделение;
			РаспределеннаяСумма = РаспределеннаяСумма + Выборка.СуммаПроводки;
			
			ЕстьДанные = Выборка.Следующий();
		КонецЦикла;
		
		// Остаток на последнюю строку по работнику
		Если СуммаКРаспределению <> РаспределеннаяСумма Тогда
			Строка.Сумма = Строка.Сумма + (СуммаКРаспределению - РаспределеннаяСумма);
		КонецЕсли;
	КонецЦикла;	

#КонецОбласти



#Область ОтчисленияОСМС

   	// ООСМСИсчисленный
	//	Поля:
	//		ФизЛицо
	//		ВидПлатежа
	//		Отчисление
	//	
	//	Описание:
	//	Исчисленные отчисления ОСМС по видам платежа

    ООСМСИсчисленныйТекст = "
    |ВЫБРАТЬ РАЗРЕШЕННЫЕ
	|	ООСМСРасчетыСФондами.Регистратор КАК Регистратор,
    |	ООСМСРасчетыСФондами.ФизЛицо КАК ФизЛицо,
    |	ООСМСРасчетыСФондами.ВидПлатежа КАК ВидПлатежа,
    |	СУММА(ООСМСРасчетыСФондами.Отчисление) КАК Отчисление
    |ПОМЕСТИТЬ ВТ_ООСМСИсчисленный
    |ИЗ
    |	РегистрНакопления.ООСМСРасчетыСФондами КАК ООСМСРасчетыСФондами
	|
    |	ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТСписокФизЛиц КАК СписокФизЛиц
    |		ПО ООСМСРасчетыСФондами.ФизЛицо = СписокФизЛиц.ФизЛицо
    |ГДЕ
	|	ООСМСРасчетыСФондами.Период >= &парамНачалоМесяца И 
	|	ООСМСРасчетыСФондами.Период <= &парамКонецМесяца И 
	|	ООСМСРасчетыСФондами.Организация = &парамОрганизация И 
	|	ООСМСРасчетыСФондами.ВидДвижения = &парамВидДвиженияПриход И
	|	ООСМСРасчетыСФондами.ВидСтроки = &парамВидСтрокиИсчисление И
	|	ООСМСРасчетыСФондами.Отчисление <> 0 И
	|	ООСМСРасчетыСФондами.Активность
	|
	|СГРУППИРОВАТЬ ПО
	|   ООСМСРасчетыСФондами.Регистратор,
	|	ООСМСРасчетыСФондами.ФизЛицо,
	|   ООСМСРасчетыСФондами.ВидПлатежа
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	ФизЛицо
    |";
    
    Запрос.Текст = ООСМСИсчисленныйТекст;
    Запрос.Выполнить();
    
   	// БУДоходыПоСчетам
	//	Поля:
	//		ФизЛицо
	//		ВидРасчета
	//		ПодразделениеОрганизации
	//		СчетДт
	//		СубконтоДт1
	//		СубконтоДт2
	//		СубконтоДт3
	//		Результат
	//	
	//	Описание:
	//	Данные отражения начислений в бухучете

    БУДоходыПоСчетам = 
    	"ВЫБРАТЬ РАЗРЕШЕННЫЕ
    	|	БУНачисления.ФизЛицо,
    	|	БУНачисления.СчетДт КАК СчетДт,
    	|	БУНачисления.СчетДтНУ КАК СчетДтНУ,
    	|	БУНачисления.СтруктурноеПодразделениеДт,
    	|	ВЫБОР
    	|		КОГДА ВидыСубконтоДт1.ВидСубконто = &парамВидСубконтоСтатьиЗатрат
    	|			ТОГДА &парамСтатьяЗатратООСМС
    	|		ИНАЧЕ БУНачисления.СубконтоДт1
    	|	КОНЕЦ КАК СубконтоДт1,
    	|	ВЫБОР
    	|		КОГДА ВидыСубконтоДт2.ВидСубконто = &парамВидСубконтоСтатьиЗатрат
    	|			ТОГДА &парамСтатьяЗатратООСМС
    	|		ИНАЧЕ БУНачисления.СубконтоДт2
    	|	КОНЕЦ КАК СубконтоДт2,
    	|	ВЫБОР
    	|		КОГДА ВидыСубконтоДт3.ВидСубконто = &парамВидСубконтоСтатьиЗатрат
    	|			ТОГДА &парамСтатьяЗатратООСМС
    	|		ИНАЧЕ БУНачисления.СубконтоДт3
    	|	КОНЕЦ КАК СубконтоДт3,
    	|	ВЫБОР
    	|		КОГДА ВидыСубконтоДтНУ1.ВидСубконто = &парамВидСубконтоСтатьиЗатрат
    	|			ТОГДА &парамСтатьяЗатратООСМС
    	|		ИНАЧЕ БУНачисления.СубконтоДтНУ1
    	|	КОНЕЦ КАК СубконтоДтНУ1,
    	|	ВЫБОР
    	|		КОГДА ВидыСубконтоДтНУ2.ВидСубконто = &парамВидСубконтоСтатьиЗатрат
    	|			ТОГДА &парамСтатьяЗатратООСМС
    	|		ИНАЧЕ БУНачисления.СубконтоДтНУ2
    	|	КОНЕЦ КАК СубконтоДтНУ2,
    	|	ВЫБОР
    	|		КОГДА ВидыСубконтоДтНУ3.ВидСубконто = &парамВидСубконтоСтатьиЗатрат
    	|			ТОГДА &парамСтатьяЗатратООСМС
    	|		ИНАЧЕ БУНачисления.СубконтоДтНУ3
    	|	КОНЕЦ КАК СубконтоДтНУ3,
    	|	БУНачисления.Сумма КАК Результат
    	|ПОМЕСТИТЬ ВТ_БУНачисленияООСМС
    	|ИЗ
    	|	ВТ_БУНачисления КАК БУНачисления
    	|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Типовой.ВидыСубконто КАК ВидыСубконтоДт1
    	|		ПО БУНачисления.СчетДт = ВидыСубконтоДт1.Ссылка
    	|			И (ВидыСубконтоДт1.НомерСтроки = 1)
    	|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Типовой.ВидыСубконто КАК ВидыСубконтоДт2
    	|		ПО БУНачисления.СчетДт = ВидыСубконтоДт2.Ссылка
    	|			И (ВидыСубконтоДт2.НомерСтроки = 2)
    	|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Типовой.ВидыСубконто КАК ВидыСубконтоДт3
    	|		ПО БУНачисления.СчетДт = ВидыСубконтоДт3.Ссылка
    	|			И (ВидыСубконтоДт3.НомерСтроки = 3)
    	|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Налоговый.ВидыСубконто КАК ВидыСубконтоДтНУ1
    	|		ПО БУНачисления.СчетДтНУ = ВидыСубконтоДтНУ1.Ссылка
    	|			И (ВидыСубконтоДтНУ1.НомерСтроки = 1)
    	|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Налоговый.ВидыСубконто КАК ВидыСубконтоДтНУ2
    	|		ПО БУНачисления.СчетДтНУ = ВидыСубконтоДтНУ2.Ссылка
    	|			И (ВидыСубконтоДтНУ2.НомерСтроки = 2)
    	|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Налоговый.ВидыСубконто КАК ВидыСубконтоДтНУ3
    	|		ПО БУНачисления.СчетДтНУ = ВидыСубконтоДтНУ3.Ссылка
    	|			И (ВидыСубконтоДтНУ3.НомерСтроки = 3)
    	|ГДЕ
    	|	БУНачисления.ВидРасчета ССЫЛКА ПланВидовРасчета.ОсновныеНачисленияОрганизаций
    	|	И БУНачисления.ВидРасчета <> &парамПустойВидРасчета
    	|	И БУНачисления.ВидРасчета <> НЕОПРЕДЕЛЕНО
    	|	И БУНачисления.ВидРасчета.ОблагаетсяООСМС <> &парамНеОблагаетсяЦеликом
    	|;
    	|
    	|////////////////////////////////////////////////////////////////////////////////
    	|ВЫБРАТЬ РАЗРЕШЕННЫЕ
    	|	БУНачисления.ФизЛицо,
    	|	БУНачисления.СтруктурноеПодразделениеДт,
    	|	БУНачисления.СчетДт,
    	|	БУНачисления.СчетДтНУ,
    	|	БУНачисления.СубконтоДт1,
    	|	БУНачисления.СубконтоДт2,
    	|	БУНачисления.СубконтоДт3,
    	|	БУНачисления.СубконтоДтНУ1,
    	|	БУНачисления.СубконтоДтНУ2,
    	|	БУНачисления.СубконтоДтНУ3,
    	|	СУММА(БУНачисления.Результат) КАК Результат
    	|ПОМЕСТИТЬ ВТ_БУДоходыПоСчетамООСМС
    	|ИЗ
    	|	ВТ_БУНачисленияООСМС КАК БУНачисления
    	|
    	|СГРУППИРОВАТЬ ПО
    	|	БУНачисления.ФизЛицо,
    	|	БУНачисления.СтруктурноеПодразделениеДт,
    	|	БУНачисления.СчетДт,
    	|	БУНачисления.СчетДтНУ,
    	|	БУНачисления.СубконтоДт1,
    	|	БУНачисления.СубконтоДт2,
    	|	БУНачисления.СубконтоДт3,
    	|	БУНачисления.СубконтоДтНУ1,
    	|	БУНачисления.СубконтоДтНУ2,
    	|	БУНачисления.СубконтоДтНУ3
    	|
    	|ИНДЕКСИРОВАТЬ ПО
    	|	БУНачисления.ФизЛицо";

	Запрос.Текст = БУДоходыПоСчетам;
	Запрос.Выполнить();

	// сначала определим счет, на который будем относить затраты по отчислениям ООСМС и распределим пропорционально сумме начислений,
	// а потом на основании счета подставим значения некоторых субконто по умолчанию
	РаспределениеООСМСПоСчетамЗатрат = 
		"ВЫБРАТЬ РАЗРЕШЕННЫЕ
		|	ООСМСРасчетыСФондами.ФизЛицо,
		|	ООСМСРасчетыСФондами.ВидПлатежа,
		|	СУММА(ООСМСРасчетыСФондами.Отчисление) КАК Отчисление,
		|	СУММА(ВЫБОР
		|			КОГДА БУСуммаНачислений.Результат <> 0
		|				ТОГДА ВЫРАЗИТЬ(ООСМСРасчетыСФондами.Отчисление * БУНачисления.Результат / БУСуммаНачислений.Результат КАК ЧИСЛО(15, 2))
		|			ИНАЧЕ 0
		|		КОНЕЦ) КАК СуммаПроводки,
		|	ВЫБОР
		|		КОГДА НЕ БУНачисления.СчетДт ЕСТЬ NULL 
		|				И НЕ(БУНачисления.СчетДт В (&парамСчетаРезервовБезООСМС)
		|						И БУНачисления.СубконтоДт1 В (&парамРезервыБезООСМС))
		|			ТОГДА БУНачисления.СчетДт
		|		КОГДА ОсновнойСпособОтражения.СпособОтраженияВБухучете = &парамСпособПоУмолчанию
		|				И НЕ МестаРаботы.СпособОтраженияВБухучете ЕСТЬ NULL 
		|			ТОГДА МестаРаботы.СпособОтраженияВБухучете.СчетДт
		|		ИНАЧЕ ОсновнойСпособОтражения.СпособОтраженияВБухучете.СчетДт
		|	КОНЕЦ КАК СчетДт,
		|	ВЫБОР
		|		КОГДА НЕ БУНачисления.СчетДтНУ ЕСТЬ NULL 
		|				И НЕ(БУНачисления.СчетДт В (&парамСчетаРезервовБезООСМС)
		|						И БУНачисления.СубконтоДт1 В (&парамРезервыБезООСМС))
		|			ТОГДА БУНачисления.СчетДтНУ
		|		КОГДА ОсновнойСпособОтражения.СпособОтраженияВБухучете = &парамСпособПоУмолчанию
		|				И НЕ МестаРаботы.СпособОтраженияВБухучете ЕСТЬ NULL 
		|			ТОГДА МестаРаботы.СпособОтраженияВБухучете.СчетДтНУ
		|		ИНАЧЕ ОсновнойСпособОтражения.СпособОтраженияВБухучете.СчетДтНУ
		|	КОНЕЦ КАК СчетДтНУ,
		|	БУНачисления.СтруктурноеПодразделениеДт,
		|	БУНачисления.СчетДт КАК СчетДтОплатаТруда,
		|	БУНачисления.СубконтоДт1,
		|	БУНачисления.СубконтоДт2,
		|	БУНачисления.СубконтоДт3,
		|	БУНачисления.СубконтоДтНУ1,
		|	БУНачисления.СубконтоДтНУ2,
		|	БУНачисления.СубконтоДтНУ3,
		|	ВЫБОР
		|		КОГДА РасчетПениОПВиСО.СчетЗатратБУ ЕСТЬ NULL 
		|				ИЛИ РасчетПениОПВиСО.СчетЗатратБУ = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
		|			ТОГДА &парамСчетДтДляПени
		|		ИНАЧЕ РасчетПениОПВиСО.СчетЗатратБУ
		|	КОНЕЦ КАК СчетДтДляПени,
		|	ВЫБОР
		|		КОГДА РасчетПениОПВиСО.СчетЗатратБУ ЕСТЬ NULL 
		|				ИЛИ РасчетПениОПВиСО.СчетЗатратБУ = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
		|			ТОГДА НЕОПРЕДЕЛЕНО
		|		ИНАЧЕ ЕСТЬNULL(РасчетПениОПВиСО.СубконтоЗатратБУ1, НЕОПРЕДЕЛЕНО)
		|	КОНЕЦ КАК СубконтоДтДляПени1,
		|	ВЫБОР
		|		КОГДА РасчетПениОПВиСО.СчетЗатратБУ ЕСТЬ NULL 
		|				ИЛИ РасчетПениОПВиСО.СчетЗатратБУ = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
		|			ТОГДА НЕОПРЕДЕЛЕНО
		|		ИНАЧЕ ЕСТЬNULL(РасчетПениОПВиСО.СубконтоЗатратБУ2, НЕОПРЕДЕЛЕНО)
		|	КОНЕЦ КАК СубконтоДтДляПени2,
		|	ВЫБОР
		|		КОГДА РасчетПениОПВиСО.СчетЗатратБУ ЕСТЬ NULL 
		|				ИЛИ РасчетПениОПВиСО.СчетЗатратБУ = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
		|			ТОГДА НЕОПРЕДЕЛЕНО
		|		ИНАЧЕ ЕСТЬNULL(РасчетПениОПВиСО.СубконтоЗатратБУ3, НЕОПРЕДЕЛЕНО)
		|	КОНЕЦ КАК СубконтоДтДляПени3,
		|	ВЫБОР
		|		КОГДА РасчетПениОПВиСО.СчетЗатратНУ ЕСТЬ NULL 
		|				ИЛИ РасчетПениОПВиСО.СчетЗатратНУ = ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
		|			ТОГДА &парамСчетДтДляПениНУ
		|		ИНАЧЕ РасчетПениОПВиСО.СчетЗатратНУ
		|	КОНЕЦ КАК СчетДтДляПениНУ,
		|	ВЫБОР
		|		КОГДА РасчетПениОПВиСО.СчетЗатратНУ ЕСТЬ NULL 
		|				ИЛИ РасчетПениОПВиСО.СчетЗатратНУ = ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
		|			ТОГДА НЕОПРЕДЕЛЕНО
		|		ИНАЧЕ ЕСТЬNULL(РасчетПениОПВиСО.СубконтоЗатратНУ1, НЕОПРЕДЕЛЕНО)
		|	КОНЕЦ КАК СубконтоДтДляПениНУ1,
		|	ВЫБОР
		|		КОГДА РасчетПениОПВиСО.СчетЗатратНУ ЕСТЬ NULL 
		|				ИЛИ РасчетПениОПВиСО.СчетЗатратНУ = ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
		|			ТОГДА НЕОПРЕДЕЛЕНО
		|		ИНАЧЕ ЕСТЬNULL(РасчетПениОПВиСО.СубконтоЗатратНУ2, НЕОПРЕДЕЛЕНО)
		|	КОНЕЦ КАК СубконтоДтДляПениНУ2,
		|	ВЫБОР
		|		КОГДА РасчетПениОПВиСО.СчетЗатратНУ ЕСТЬ NULL 
		|				ИЛИ РасчетПениОПВиСО.СчетЗатратНУ = ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
		|			ТОГДА НЕОПРЕДЕЛЕНО
		|		ИНАЧЕ ЕСТЬNULL(РасчетПениОПВиСО.СубконтоЗатратНУ3, НЕОПРЕДЕЛЕНО)
		|	КОНЕЦ КАК СубконтоДтДляПениНУ3,
		|	МестаРаботы.ПодразделениеОрганизации,
		|	МестаРаботы.СпособОтраженияВБухучете КАК СпособОтраженияВБухучетеДляПодразделения,
		|	ОсновнойСпособОтражения.СпособОтраженияВБухучете КАК ОсновнойСпособОтраженияВБухучете,
		|	ЕСТЬNULL(ВидыСубконтоПодразделенияДляПени.НомерСтроки, 0) КАК НомерСубконтоПодразделенияДляПени,
		|	ЕСТЬNULL(ВидыСубконтоСтатьиЗатратДляПени.НомерСтроки, 0) КАК НомерСубконтоСтатьиЗатратДляПени,
		|	ЕСТЬNULL(ВидСубконтоСтатьиЗатратДляПениНУ.НомерСтроки, 0) КАК НомерСубконтоСтатьиЗатратДляПениНУ,
		|	ЕСТЬNULL(ВидСубконтоПодразделенияДляПениНУ.НомерСтроки, 0) КАК НомерСубконтоПодразделенияДляПениНУ
		|ПОМЕСТИТЬ ВТ_ООСМСПоСчетамЗатрат
		|ИЗ
		|	ВТ_ООСМСИсчисленный КАК ООСМСРасчетыСФондами
		|		ЛЕВОЕ СОЕДИНЕНИЕ Документ.РасчетПениОПВиСО КАК РасчетПениОПВиСО
		|		ПО ООСМСРасчетыСФондами.Регистратор = РасчетПениОПВиСО.Ссылка
		|		ЛЕВОЕ СОЕДИНЕНИЕ ВТ_БУДоходыПоСчетамООСМС КАК БУНачисления
		|		ПО ООСМСРасчетыСФондами.ФизЛицо = БУНачисления.ФизЛицо
		|		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
		|			БУНачисления.ФизЛицо КАК ФизЛицо,
		|			СУММА(БУНачисления.Результат) КАК Результат
		|		ИЗ
		|			ВТ_БУДоходыПоСчетамООСМС КАК БУНачисления
		|		
		|		СГРУППИРОВАТЬ ПО
		|			БУНачисления.ФизЛицо) КАК БУСуммаНачислений
		|		ПО ООСМСРасчетыСФондами.ФизЛицо = БУСуммаНачислений.ФизЛицо
		|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Типовой.ВидыСубконто КАК ВидыСубконтоПодразделенияДляПени
		|		ПО (ВидыСубконтоПодразделенияДляПени.Ссылка = ВЫБОР
		|				КОГДА РасчетПениОПВиСО.СчетЗатратБУ ЕСТЬ NULL 
		|						ИЛИ РасчетПениОПВиСО.СчетЗатратБУ = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
		|					ТОГДА &парамСчетДтДляПени
		|				ИНАЧЕ РасчетПениОПВиСО.СчетЗатратБУ
		|			КОНЕЦ)
		|			И (ВидыСубконтоПодразделенияДляПени.ВидСубконто = &парамВидСубконтоПодразделения)
		|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Типовой.ВидыСубконто КАК ВидыСубконтоСтатьиЗатратДляПени
		|		ПО (ВидыСубконтоСтатьиЗатратДляПени.Ссылка = ВЫБОР
		|				КОГДА РасчетПениОПВиСО.СчетЗатратБУ ЕСТЬ NULL 
		|						ИЛИ РасчетПениОПВиСО.СчетЗатратБУ = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
		|					ТОГДА &парамСчетДтДляПени
		|				ИНАЧЕ РасчетПениОПВиСО.СчетЗатратБУ
		|			КОНЕЦ)
		|			И (ВидыСубконтоСтатьиЗатратДляПени.ВидСубконто = &парамВидСубконтоСтатьиЗатрат)
		|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Налоговый.ВидыСубконто КАК ВидСубконтоСтатьиЗатратДляПениНУ
		|		ПО (ВидСубконтоСтатьиЗатратДляПениНУ.Ссылка = ВЫБОР
		|				КОГДА РасчетПениОПВиСО.СчетЗатратНУ ЕСТЬ NULL 
		|						ИЛИ РасчетПениОПВиСО.СчетЗатратНУ = ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
		|					ТОГДА &парамСчетДтДляПениНУ
		|				ИНАЧЕ РасчетПениОПВиСО.СчетЗатратНУ
		|			КОНЕЦ)
		|			И (ВидСубконтоСтатьиЗатратДляПениНУ.ВидСубконто = &парамВидСубконтоСтатьиЗатрат)
		|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Налоговый.ВидыСубконто КАК ВидСубконтоПодразделенияДляПениНУ
		|		ПО (ВидСубконтоПодразделенияДляПениНУ.Ссылка = ВЫБОР
		|				КОГДА РасчетПениОПВиСО.СчетЗатратНУ ЕСТЬ NULL 
		|						ИЛИ РасчетПениОПВиСО.СчетЗатратНУ = ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
		|					ТОГДА &парамСчетДтДляПениНУ
		|				ИНАЧЕ РасчетПениОПВиСО.СчетЗатратНУ
		|			КОНЕЦ)
		|			И (ВидСубконтоПодразделенияДляПениНУ.ВидСубконто = &парамВидСубконтоПодразделения)
		|		ЛЕВОЕ СОЕДИНЕНИЕ ВТ_ОсновнойСпособОтражения КАК ОсновнойСпособОтражения
		|		ПО ООСМСРасчетыСФондами.ФизЛицо = ОсновнойСпособОтражения.ФизЛицо
		|		ЛЕВОЕ СОЕДИНЕНИЕ ВТ_МестаРаботы КАК МестаРаботы
		|		ПО ООСМСРасчетыСФондами.ФизЛицо = МестаРаботы.ФизЛицо
		|
		|СГРУППИРОВАТЬ ПО
		|	ООСМСРасчетыСФондами.ФизЛицо,
		|	ООСМСРасчетыСФондами.ВидПлатежа,
		|	БУНачисления.СтруктурноеПодразделениеДт,
		|	БУНачисления.СчетДт,
		|	БУНачисления.СубконтоДт1,
		|	БУНачисления.СубконтоДт2,
		|	БУНачисления.СубконтоДт3,
		|	БУНачисления.СубконтоДтНУ1,
		|	БУНачисления.СубконтоДтНУ2,
		|	БУНачисления.СубконтоДтНУ3,
		|	МестаРаботы.ПодразделениеОрганизации,
		|	МестаРаботы.СпособОтраженияВБухучете,
		|	ОсновнойСпособОтражения.СпособОтраженияВБухучете,
		|	ВЫБОР
		|		КОГДА НЕ БУНачисления.СчетДт ЕСТЬ NULL 
		|				И НЕ(БУНачисления.СчетДт В (&парамСчетаРезервовБезООСМС)
		|						И БУНачисления.СубконтоДт1 В (&парамРезервыБезООСМС))
		|			ТОГДА БУНачисления.СчетДт
		|		КОГДА ОсновнойСпособОтражения.СпособОтраженияВБухучете = &парамСпособПоУмолчанию
		|				И НЕ МестаРаботы.СпособОтраженияВБухучете ЕСТЬ NULL 
		|			ТОГДА МестаРаботы.СпособОтраженияВБухучете.СчетДт
		|		ИНАЧЕ ОсновнойСпособОтражения.СпособОтраженияВБухучете.СчетДт
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА НЕ БУНачисления.СчетДтНУ ЕСТЬ NULL 
		|				И НЕ(БУНачисления.СчетДт В (&парамСчетаРезервовБезООСМС)
		|						И БУНачисления.СубконтоДт1 В (&парамРезервыБезООСМС))
		|			ТОГДА БУНачисления.СчетДтНУ
		|		КОГДА ОсновнойСпособОтражения.СпособОтраженияВБухучете = &парамСпособПоУмолчанию
		|				И НЕ МестаРаботы.СпособОтраженияВБухучете ЕСТЬ NULL 
		|			ТОГДА МестаРаботы.СпособОтраженияВБухучете.СчетДтНУ
		|		ИНАЧЕ ОсновнойСпособОтражения.СпособОтраженияВБухучете.СчетДтНУ
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА РасчетПениОПВиСО.СчетЗатратБУ ЕСТЬ NULL 
		|				ИЛИ РасчетПениОПВиСО.СчетЗатратБУ = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
		|			ТОГДА &парамСчетДтДляПени
		|		ИНАЧЕ РасчетПениОПВиСО.СчетЗатратБУ
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА РасчетПениОПВиСО.СчетЗатратБУ ЕСТЬ NULL 
		|				ИЛИ РасчетПениОПВиСО.СчетЗатратБУ = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
		|			ТОГДА НЕОПРЕДЕЛЕНО
		|		ИНАЧЕ ЕСТЬNULL(РасчетПениОПВиСО.СубконтоЗатратБУ1, НЕОПРЕДЕЛЕНО)
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА РасчетПениОПВиСО.СчетЗатратБУ ЕСТЬ NULL 
		|				ИЛИ РасчетПениОПВиСО.СчетЗатратБУ = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
		|			ТОГДА НЕОПРЕДЕЛЕНО
		|		ИНАЧЕ ЕСТЬNULL(РасчетПениОПВиСО.СубконтоЗатратБУ2, НЕОПРЕДЕЛЕНО)
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА РасчетПениОПВиСО.СчетЗатратБУ ЕСТЬ NULL 
		|				ИЛИ РасчетПениОПВиСО.СчетЗатратБУ = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
		|			ТОГДА НЕОПРЕДЕЛЕНО
		|		ИНАЧЕ ЕСТЬNULL(РасчетПениОПВиСО.СубконтоЗатратБУ3, НЕОПРЕДЕЛЕНО)
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА РасчетПениОПВиСО.СчетЗатратНУ ЕСТЬ NULL 
		|				ИЛИ РасчетПениОПВиСО.СчетЗатратНУ = ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
		|			ТОГДА &парамСчетДтДляПениНУ
		|		ИНАЧЕ РасчетПениОПВиСО.СчетЗатратНУ
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА РасчетПениОПВиСО.СчетЗатратНУ ЕСТЬ NULL 
		|				ИЛИ РасчетПениОПВиСО.СчетЗатратНУ = ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
		|			ТОГДА НЕОПРЕДЕЛЕНО
		|		ИНАЧЕ ЕСТЬNULL(РасчетПениОПВиСО.СубконтоЗатратНУ1, НЕОПРЕДЕЛЕНО)
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА РасчетПениОПВиСО.СчетЗатратНУ ЕСТЬ NULL 
		|				ИЛИ РасчетПениОПВиСО.СчетЗатратНУ = ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
		|			ТОГДА НЕОПРЕДЕЛЕНО
		|		ИНАЧЕ ЕСТЬNULL(РасчетПениОПВиСО.СубконтоЗатратНУ2, НЕОПРЕДЕЛЕНО)
		|	КОНЕЦ,
		|	ВЫБОР
		|		КОГДА РасчетПениОПВиСО.СчетЗатратНУ ЕСТЬ NULL 
		|				ИЛИ РасчетПениОПВиСО.СчетЗатратНУ = ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
		|			ТОГДА НЕОПРЕДЕЛЕНО
		|		ИНАЧЕ ЕСТЬNULL(РасчетПениОПВиСО.СубконтоЗатратНУ3, НЕОПРЕДЕЛЕНО)
		|	КОНЕЦ,
		|	ЕСТЬNULL(ВидыСубконтоПодразделенияДляПени.НомерСтроки, 0),
		|	ЕСТЬNULL(ВидыСубконтоСтатьиЗатратДляПени.НомерСтроки, 0),
		|	ЕСТЬNULL(ВидСубконтоСтатьиЗатратДляПениНУ.НомерСтроки, 0),
		|	ЕСТЬNULL(ВидСубконтоПодразделенияДляПениНУ.НомерСтроки, 0)
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	СчетДт,
		|	СчетДтНУ";
	Запрос.Текст = РаспределениеООСМСПоСчетамЗатрат;
	Запрос.Выполнить();
	
	// Распределяем отчисления ОСМС по счетам затрат пропорционально сумме начислений,
	// с которых брались эти отчисления
	РаспределениеООСМСПоСчетамЗатрат = "
	|ВЫБРАТЬ РАЗРЕШЕННЫЕ
	|	ДанныеУчета.ФизЛицо,
	|	ДанныеУчета.СтруктурноеПодразделениеДт,
	|	ДанныеУчета.ВидПлатежа,
	|	ДанныеУчета.Отчисление,
	|	ДанныеУчета.СуммаПроводки,
	|	ДанныеУчета.СчетДт,
	|	ДанныеУчета.СчетДтНУ,
	|
	|	ВЫБОР
	|		КОГДА НЕ(ДанныеУчета.СубконтоДт1 ЕСТЬ NULL)
	|				И НЕ(ДанныеУчета.СчетДтОплатаТруда В (&парамСчетаРезервовБезООСМС) И ДанныеУчета.СубконтоДт1 В (&парамРезервыБезООСМС))
	|			ТОГДА ДанныеУчета.СубконтоДт1
	|		КОГДА ВидыСубконтоДт1.ВидСубконто = &парамВидСубконтоСтатьиЗатрат ТОГДА &парамСтатьяЗатратООСМС
	|		КОГДА ВидыСубконтоДт1.ВидСубконто = &парамВидСубконтоПодразделения ТОГДА ДанныеУчета.ПодразделениеОрганизации
	|		КОГДА ДанныеУчета.ОсновнойСпособОтраженияВБухучете = &парамСпособПоУмолчанию
	|					И НЕ (ДанныеУчета.СпособОтраженияВБухучетеДляПодразделения ЕСТЬ NULL)
	|			ТОГДА ДанныеУчета.СпособОтраженияВБухучетеДляПодразделения.СубконтоДт1
	|		ИНАЧЕ ДанныеУчета.ОсновнойСпособОтраженияВБухучете.СубконтоДт1
	|	КОНЕЦ КАК СубконтоДт1,
	|
	|	ВЫБОР
	|		КОГДА НЕ(ДанныеУчета.СубконтоДт2 ЕСТЬ NULL)
	|				И НЕ(ДанныеУчета.СчетДтОплатаТруда В (&парамСчетаРезервовБезООСМС) И ДанныеУчета.СубконтоДт1 В (&парамРезервыБезООСМС))
	|			ТОГДА ДанныеУчета.СубконтоДт2
	|		КОГДА ВидыСубконтоДт2.ВидСубконто = &парамВидСубконтоСтатьиЗатрат ТОГДА &парамСтатьяЗатратООСМС
	|		КОГДА ВидыСубконтоДт2.ВидСубконто = &парамВидСубконтоПодразделения ТОГДА ДанныеУчета.ПодразделениеОрганизации
	|		КОГДА ДанныеУчета.ОсновнойСпособОтраженияВБухучете = &парамСпособПоУмолчанию
	|					И НЕ (ДанныеУчета.СпособОтраженияВБухучетеДляПодразделения ЕСТЬ NULL)
	|			ТОГДА ДанныеУчета.СпособОтраженияВБухучетеДляПодразделения.СубконтоДт2
	|		ИНАЧЕ ДанныеУчета.ОсновнойСпособОтраженияВБухучете.СубконтоДт2
	|	КОНЕЦ КАК СубконтоДт2,
	|
	|	ВЫБОР
	|		КОГДА НЕ(ДанныеУчета.СубконтоДт3 ЕСТЬ NULL)
	|				И НЕ(ДанныеУчета.СчетДтОплатаТруда В (&парамСчетаРезервовБезООСМС) И ДанныеУчета.СубконтоДт1 В (&парамРезервыБезООСМС))
	|			ТОГДА ДанныеУчета.СубконтоДт3
	|		КОГДА ВидыСубконтоДт3.ВидСубконто = &парамВидСубконтоСтатьиЗатрат ТОГДА &парамСтатьяЗатратООСМС
	|		КОГДА ВидыСубконтоДт3.ВидСубконто = &парамВидСубконтоПодразделения ТОГДА ДанныеУчета.ПодразделениеОрганизации
	|		КОГДА ДанныеУчета.ОсновнойСпособОтраженияВБухучете = &парамСпособПоУмолчанию
	|					И НЕ (ДанныеУчета.СпособОтраженияВБухучетеДляПодразделения ЕСТЬ NULL)
	|			ТОГДА ДанныеУчета.СпособОтраженияВБухучетеДляПодразделения.СубконтоДт3
	|		ИНАЧЕ ДанныеУчета.ОсновнойСпособОтраженияВБухучете.СубконтоДт3
	|	КОНЕЦ КАК СубконтоДт3,
	|
	|	ВЫБОР
	|		КОГДА НЕ(ДанныеУчета.СубконтоДтНУ1 ЕСТЬ NULL)
	|				И НЕ(ДанныеУчета.СчетДтОплатаТруда В (&парамСчетаРезервовБезООСМС) И ДанныеУчета.СубконтоДт1 В (&парамРезервыБезООСМС))
	|			ТОГДА ДанныеУчета.СубконтоДтНУ1
	|		КОГДА ВидыСубконтоДтНУ1.ВидСубконто = &парамВидСубконтоСтатьиЗатрат ТОГДА &парамСтатьяЗатратООСМС
	|		КОГДА ВидыСубконтоДтНУ1.ВидСубконто = &парамВидСубконтоПодразделения ТОГДА ДанныеУчета.ПодразделениеОрганизации
	|		КОГДА ДанныеУчета.ОсновнойСпособОтраженияВБухучете = &парамСпособПоУмолчанию
	|					И НЕ (ДанныеУчета.СпособОтраженияВБухучетеДляПодразделения ЕСТЬ NULL)
	|			ТОГДА ДанныеУчета.СпособОтраженияВБухучетеДляПодразделения.СубконтоДтНУ1
	|		ИНАЧЕ ДанныеУчета.ОсновнойСпособОтраженияВБухучете.СубконтоДтНУ1
	|	КОНЕЦ КАК СубконтоДтНУ1,
	|
	|	ВЫБОР
	|		КОГДА НЕ(ДанныеУчета.СубконтоДтНУ2 ЕСТЬ NULL)
	|				И НЕ(ДанныеУчета.СчетДтОплатаТруда В (&парамСчетаРезервовБезООСМС) И ДанныеУчета.СубконтоДт1 В (&парамРезервыБезООСМС))
	|			ТОГДА ДанныеУчета.СубконтоДтНУ2
	|		КОГДА ВидыСубконтоДтНУ2.ВидСубконто = &парамВидСубконтоСтатьиЗатрат ТОГДА &парамСтатьяЗатратООСМС
	|		КОГДА ВидыСубконтоДтНУ2.ВидСубконто = &парамВидСубконтоПодразделения ТОГДА ДанныеУчета.ПодразделениеОрганизации
	|		КОГДА ДанныеУчета.ОсновнойСпособОтраженияВБухучете = &парамСпособПоУмолчанию
	|					И НЕ (ДанныеУчета.СпособОтраженияВБухучетеДляПодразделения ЕСТЬ NULL)
	|			ТОГДА ДанныеУчета.СпособОтраженияВБухучетеДляПодразделения.СубконтоДтНУ2
	|		ИНАЧЕ ДанныеУчета.ОсновнойСпособОтраженияВБухучете.СубконтоДтНУ2
	|	КОНЕЦ КАК СубконтоДтНУ2,
	|
	|	ВЫБОР
	|		КОГДА НЕ(ДанныеУчета.СубконтоДтНУ3 ЕСТЬ NULL)
	|				И НЕ(ДанныеУчета.СчетДтОплатаТруда В (&парамСчетаРезервовБезООСМС) И ДанныеУчета.СубконтоДт1 В (&парамРезервыБезООСМС))
	|			ТОГДА ДанныеУчета.СубконтоДтНУ3
	|		КОГДА ВидыСубконтоДтНУ3.ВидСубконто = &парамВидСубконтоСтатьиЗатрат ТОГДА &парамСтатьяЗатратООСМС
	|		КОГДА ВидыСубконтоДтНУ3.ВидСубконто = &парамВидСубконтоПодразделения ТОГДА ДанныеУчета.ПодразделениеОрганизации
	|		КОГДА ДанныеУчета.ОсновнойСпособОтраженияВБухучете = &парамСпособПоУмолчанию
	|					И НЕ (ДанныеУчета.СпособОтраженияВБухучетеДляПодразделения ЕСТЬ NULL)
	|			ТОГДА ДанныеУчета.СпособОтраженияВБухучетеДляПодразделения.СубконтоДтНУ3
	|		ИНАЧЕ ДанныеУчета.ОсновнойСпособОтраженияВБухучете.СубконтоДтНУ3
	|	КОНЕЦ КАК СубконтоДтНУ3,
	|	ДанныеУчета.СчетДтДляПени,
	|	ДанныеУчета.СубконтоДтДляПени1,
	|	ДанныеУчета.СубконтоДтДляПени2,
	|	ДанныеУчета.СубконтоДтДляПени3,
	|	ДанныеУчета.СчетДтДляПениНУ,
	|	ДанныеУчета.СубконтоДтДляПениНУ1,
	|	ДанныеУчета.СубконтоДтДляПениНУ2,
	|	ДанныеУчета.СубконтоДтДляПениНУ3,
	|
	|	ДанныеУчета.ПодразделениеОрганизации,
	|	ДанныеУчета.НомерСубконтоПодразделенияДляПени,
	|	ДанныеУчета.НомерСубконтоСтатьиЗатратДляПени,
	|	ДанныеУчета.НомерСубконтоПодразделенияДляПениНУ,
	|	ДанныеУчета.НомерСубконтоСтатьиЗатратДляПениНУ
	|
	|ИЗ	
	|	ВТ_ООСМСПоСчетамЗатрат КАК ДанныеУчета
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Типовой.ВидыСубконто КАК ВидыСубконтоДт1
	|		ПО ДанныеУчета.СчетДт = ВидыСубконтоДт1.Ссылка
	|		   И ВидыСубконтоДт1.НомерСтроки = 1
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Типовой.ВидыСубконто КАК ВидыСубконтоДт2
	|		ПО ДанныеУчета.СчетДт = ВидыСубконтоДт2.Ссылка
	|		   И ВидыСубконтоДт2.НомерСтроки = 2
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Типовой.ВидыСубконто КАК ВидыСубконтоДт3
	|		ПО ДанныеУчета.СчетДт = ВидыСубконтоДт3.Ссылка
	|		   И ВидыСубконтоДт3.НомерСтроки = 3
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Налоговый.ВидыСубконто КАК ВидыСубконтоДтНУ1
	|		ПО ДанныеУчета.СчетДтНУ = ВидыСубконтоДтНУ1.Ссылка
	|		   И ВидыСубконтоДтНУ1.НомерСтроки = 1
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Налоговый.ВидыСубконто КАК ВидыСубконтоДтНУ2
	|		ПО ДанныеУчета.СчетДтНУ = ВидыСубконтоДтНУ2.Ссылка
	|		   И ВидыСубконтоДтНУ2.НомерСтроки = 2
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Налоговый.ВидыСубконто КАК ВидыСубконтоДтНУ3
	|		ПО ДанныеУчета.СчетДтНУ = ВидыСубконтоДтНУ3.Ссылка
	|		   И ВидыСубконтоДтНУ3.НомерСтроки = 3
	|
	|УПОРЯДОЧИТЬ ПО
	|	ДанныеУчета.ФизЛицо,
	|	ДанныеУчета.ВидПлатежа
	|";

	Запрос.Текст = РаспределениеООСМСПоСчетамЗатрат;
	Запрос.Выполнить();
	
	СчетКредита = Справочники.НалогиСборыОтчисления.ОтчисленияОбязательноеСоциальноеМедицинскоеСтрахование.СчетУчетаРасчетовСКонтрагентомБУ;
	Если НЕ ЗначениеЗаполнено(СчетКредита) Тогда
		СчетКредита = ПланыСчетов.Типовой.ОбязательстваПоОтчислениямОСМС;
	КонецЕсли;  	
	
	СчетКредитаНУ = ПроцедурыНалоговогоУчетаВызовСервераПовтИсп.ПолучитьСчетУчетаНУООСМС(СчетКредита, КонецМесяца(Параметры.ПериодРегистрации));
	
	СтатьяЗатратПеняПоООСМС = Справочники.СтатьиЗатрат.ПеняПоООСМС;	
	ВидНалогаСбораОтчисленияООСМС = Справочники.НалогиСборыОтчисления.ОтчисленияОбязательноеСоциальноеМедицинскоеСтрахование;
	          
	Выборка = Запрос.Выполнить().Выбрать();

	ЕстьДанные = Выборка.Следующий();
	Пока ЕстьДанные Цикл
		ТекущееФизЛицо = Выборка.ФизЛицо;
		ТекущийВидПлатежа = Выборка.ВидПлатежа;
		СуммаКРаспределению = Выборка.Отчисление;
		РаспределеннаяСумма = 0;
		
		Пока ЕстьДанные И Выборка.ФизЛицо = ТекущееФизЛицо 
			 И Выборка.ВидПлатежа = ТекущийВидПлатежа Цикл
			Строка = ПромежуточнаяТаблица.Добавить();
			
			// В зависимости от вида платежа (Налог/Взнос или пеня) ставим на разные счета затрат
			Если ТекущийВидПлатежа = Перечисления.ВидыПлатежейВБюджетИФонды.Налог
				 ИЛИ ТекущийВидПлатежа = Перечисления.ВидыПлатежейВБюджетИФонды.НалогАкт
				 ИЛИ ТекущийВидПлатежа = Перечисления.ВидыПлатежейВБюджетИФонды.НалогСам Тогда
				Строка.ВидРасчета	= ВидНалогаСбораОтчисленияООСМС;
				Строка.СчетДт 		= Выборка.СчетДт;
				Строка.СубконтоДт1 	= Выборка.СубконтоДт1;
				Строка.СубконтоДт2 	= Выборка.СубконтоДт2;
				Строка.СубконтоДт3 	= Выборка.СубконтоДт3;
				
				Строка.СчетДтНУ = Выборка.СчетДтНУ;
				Строка.СубконтоДтНУ1 = Выборка.СубконтоДтНУ1;
				Строка.СубконтоДтНУ2 = Выборка.СубконтоДтНУ2;
				Строка.СубконтоДтНУ3 = Выборка.СубконтоДтНУ3;
			Иначе
				Строка.ВидРасчета	= СтатьяЗатратПеняПоООСМС;
				Строка.СчетДт	    = Выборка.СчетДтДляПени;
				Если Выборка.НомерСубконтоСтатьиЗатратДляПени <> 0 Тогда
					Если ЗначениеЗаполнено(Выборка["СубконтоДтДляПени" + Выборка.НомерСубконтоСтатьиЗатратДляПени]) Тогда
						Строка["СубконтоДт" + Выборка.НомерСубконтоСтатьиЗатратДляПени] = Выборка["СубконтоДтДляПени" + Выборка.НомерСубконтоСтатьиЗатратДляПени];
					Иначе 
						Строка["СубконтоДт" + Выборка.НомерСубконтоСтатьиЗатратДляПени]	= СтатьяЗатратПеняПоООСМС
					КонецЕсли;
				КонецЕсли;
				Если Выборка.НомерСубконтоСтатьиЗатратДляПениНУ <> 0 Тогда
					Если ЗначениеЗаполнено(Выборка["СубконтоДтДляПениНУ" + Выборка.НомерСубконтоСтатьиЗатратДляПениНУ]) Тогда
						Строка["СубконтоДтНУ" + Выборка.НомерСубконтоСтатьиЗатратДляПениНУ] = Выборка["СубконтоДтДляПениНУ" + Выборка.НомерСубконтоСтатьиЗатратДляПениНУ];
					Иначе 
						Строка["СубконтоДтНУ" + Выборка.НомерСубконтоСтатьиЗатратДляПениНУ]	= СтатьяЗатратПеняПоООСМС;
					КонецЕсли;
				КонецЕсли;
				Если Выборка.НомерСубконтоПодразделенияДляПени <> 0 Тогда
					Если ЗначениеЗаполнено(Выборка["СубконтоДтДляПени" + Выборка.НомерСубконтоПодразделенияДляПени]) Тогда
						Строка["СубконтоДт" + Выборка.НомерСубконтоПодразделенияДляПени] = Выборка["СубконтоДтДляПени" + Выборка.НомерСубконтоПодразделенияДляПени];
					Иначе 
						Строка["СубконтоДт" + Выборка.НомерСубконтоПодразделенияДляПени]= Выборка.ПодразделениеОрганизации;
					КонецЕсли;
				КонецЕсли;
				Если Выборка.НомерСубконтоПодразделенияДляПениНУ <> 0 Тогда
					Если ЗначениеЗаполнено(Выборка["СубконтоДтДляПениНУ" + Выборка.НомерСубконтоПодразделенияДляПениНУ]) Тогда
						Строка["СубконтоДтНУ" + Выборка.НомерСубконтоПодразделенияДляПениНУ] = Выборка["СубконтоДтДляПениНУ" + Выборка.НомерСубконтоПодразделенияДляПениНУ];
					Иначе 
						Строка["СубконтоДтНУ" + Выборка.НомерСубконтоПодразделенияДляПениНУ]= Выборка.ПодразделениеОрганизации;
					КонецЕсли;
				КонецЕсли;

				// Заполним оставшиеся субконто
				Для Ном = 1 по 3 Цикл
					Если НЕ ЗначениеЗаполнено(Строка["СубконтоДт" + Ном]) Тогда 
						Строка["СубконтоДт" + Ном] = Выборка["СубконтоДтДляПени" + Ном];
					КонецЕсли;
					Если НЕ ЗначениеЗаполнено(Строка["СубконтоДтНУ" + Ном]) Тогда
						Если ЗначениеЗаполнено(Выборка["СубконтоДтДляПениНУ" + Ном]) Тогда
							Строка["СубконтоДтНУ" + Ном] = Выборка["СубконтоДтДляПениНУ" + Ном];
						Иначе
							ОбщегоНазначенияБККлиентСервер.ЗаменитьСубконтоНУ(Строка, СчетДебетаДляПени, СчетДебетаДляПениНУ, Ном, СтатьяЗатратПеняПоООСМС, "СубконтоДтНУ");
						КонецЕсли;
					КонецЕсли;
				КонецЦикла;

				Строка.СчетДтНУ = Выборка.СчетДтДляПениНУ;			
				ОбщегоНазначенияБККлиентСервер.ЗаменитьСубконтоНУ(Строка, Строка.СчетДт, Строка.СчетДтНУ, 1, Строка.СубконтоДт1, "СубконтоДтНУ");
				ОбщегоНазначенияБККлиентСервер.ЗаменитьСубконтоНУ(Строка, Строка.СчетДт, Строка.СчетДтНУ, 2, Строка.СубконтоДт2, "СубконтоДтНУ");
				ОбщегоНазначенияБККлиентСервер.ЗаменитьСубконтоНУ(Строка, Строка.СчетДт, Строка.СчетДтНУ, 3, Строка.СубконтоДт3, "СубконтоДтНУ");
			КонецЕсли;			
		
			Строка.СчетКт 		= СчетКредита;
			Строка.СубконтоКт1 	= Выборка.ВидПлатежа;
			Если ВедетсяУчетПоСотрудникам Тогда
				Строка.СубконтоКт2	= Выборка.Физлицо;
			КонецЕсли;
			
			Строка.СчетКтНУ = СчетКредитаНУ;
			ОбщегоНазначенияБККлиентСервер.ЗаменитьСубконтоНУ(Строка, Строка.СчетКт, Строка.СчетКтНУ, 1, Строка.СубконтоКт1, "СубконтоКтНУ");
			ОбщегоНазначенияБККлиентСервер.ЗаменитьСубконтоНУ(Строка, Строка.СчетКт, Строка.СчетКтНУ, 2, Строка.СубконтоКт2, "СубконтоКтНУ");
			
			Строка.Сумма					= Выборка.СуммаПроводки;
			Строка.ФизЛицо					= Выборка.ФизЛицо;
			Строка.СтруктурноеПодразделениеДт = Выборка.СтруктурноеПодразделениеДт;
			Строка.СтруктурноеПодразделениеКт = Параметры.СтруктурноеПодразделение;
			РаспределеннаяСумма 			= РаспределеннаяСумма + Выборка.СуммаПроводки;
			
			ЕстьДанные = Выборка.Следующий();
		КонецЦикла;
		
		// Остаток на последнюю строку по работнику
		Если СуммаКРаспределению <> РаспределеннаяСумма Тогда
			Строка.Сумма = Строка.Сумма + (СуммаКРаспределению - РаспределеннаяСумма);
		КонецЕсли;
	КонецЦикла;	

#КонецОбласти


#Область РезервыПоВознаграждениям
	
	Запрос.УстановитьПараметр("парамВедениеУчетаВременныхРазницБалансовымМетодом", ВедениеУчетаВременныхРазницБалансовымМетодом);
	
	БУДоходыПоСчетам = "
	|ВЫБРАТЬ РАЗРЕШЕННЫЕ
	|	БУНачисления.ВидРасчета,
	|	БУНачисления.ФизЛицо,
	|	БУНачисления.СтруктурноеПодразделениеДт,
	|	БУНачисления.СчетДт,
	|	БУНачисления.СубконтоДт1,
	|	БУНачисления.СубконтоДт2,
	|	БУНачисления.СубконтоДт3,
	|	БУНачисления.СчетДтНУ,
	|	БУНачисления.СубконтоДтНУ1,
	|	БУНачисления.СубконтоДтНУ2,
	|	БУНачисления.СубконтоДтНУ3,
	|СУММА(БУНачисления.Сумма) КАК Сумма
	|
	|ПОМЕСТИТЬ ВТ_БУДоходыПоСчетамРезервы
	|ИЗ
	|	ВТ_БУНачисления КАК БУНачисления
	|ГДЕ
	|	БУНачисления.ВидРасчета ССЫЛКА ПланВидовРасчета.ОсновныеНачисленияОрганизаций
	|СГРУППИРОВАТЬ ПО
	|	БУНачисления.ВидРасчета,
	|	БУНачисления.ФизЛицо,
	|	БУНачисления.СтруктурноеПодразделениеДт,
	|	БУНачисления.СчетДт,
	|	БУНачисления.СубконтоДт1,
	|	БУНачисления.СубконтоДт2,
	|	БУНачисления.СубконтоДт3,
	|	БУНачисления.СчетДтНУ,
	|	БУНачисления.СубконтоДтНУ1,
	|	БУНачисления.СубконтоДтНУ2,
	|	БУНачисления.СубконтоДтНУ3
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	ВидРасчета
	|";
	
	Запрос.Текст = БУДоходыПоСчетам;
	Запрос.Выполнить();
	
	Запрос.Текст = 
	"ВЫБРАТЬ РАЗРЕШЕННЫЕ
	|	МАКСИМУМ(РаботникиОрганизаций.Период) КАК Период,
	|	РаботникиОрганизаций.Сотрудник.Физлицо КАК Физлицо,
	|	РаботникиОрганизаций.Сотрудник КАК  Сотрудник
	|ПОМЕСТИТЬ ВТ_ПериодыРаботниковРезервы
	|ИЗ
	|	РегистрСведений.РаботникиОрганизаций КАК РаботникиОрганизаций
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТСписокФизЛиц КАК СписокФизЛиц
	|		ПО РаботникиОрганизаций.Сотрудник.Физлицо = СписокФизЛиц.ФизЛицо
	|ГДЕ
	|	РаботникиОрганизаций.Сотрудник.ВидЗанятости <> ЗНАЧЕНИЕ(Перечисление.ВидыЗанятостиВОрганизации.ВнутреннееСовместительство)
	|	И РаботникиОрганизаций.Организация = &парамГоловнаяОрганизация
	|	И РаботникиОрганизаций.Период <= &парамКонецМесяца
    |	И (РаботникиОрганизаций.Сотрудник.ДатаУвольнения = ДАТАВРЕМЯ(1,1,1)
    |	ИЛИ РаботникиОрганизаций.Сотрудник.ДатаУвольнения >= &парамКонецМесяца)
	|
	|СГРУППИРОВАТЬ ПО
	|	РаботникиОрганизаций.Сотрудник.Физлицо,
	|	РаботникиОрганизаций.Сотрудник
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	Физлицо,
	|	Период
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ РАЗРЕШЕННЫЕ
	|	РаботникиОрганизаций.Сотрудник.Физлицо КАК ФизЛицо,
	|	РаботникиОрганизаций.ИсчислятьОППВ
	|ПОМЕСТИТЬ ВТ_РаботникиОрганизацииРезервы
	|ИЗ
	|	ВТ_ПериодыРаботниковРезервы КАК ПериодыРаботников
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РаботникиОрганизаций КАК РаботникиОрганизаций
	|		ПО ПериодыРаботников.Период = РаботникиОрганизаций.Период
	|			И ПериодыРаботников.Физлицо = РаботникиОрганизаций.Сотрудник.Физлицо
	|			И ПериодыРаботников.Сотрудник = РаботникиОрганизаций.Сотрудник
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	ФизЛицо
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
    |ВЫБРАТЬ РАЗРЕШЕННЫЕ РАЗЛИЧНЫЕ
	|	СведенияОПенсионномОбеспеченииФизЛиц.ФизЛицо
	|ПОМЕСТИТЬ ВТ_ФизлицаПенсионеры
	|ИЗ
	|	РегистрСведений.СведенияОПенсионномОбеспеченииФизЛиц.СрезПоследних(&парамКонецМесяца) КАК СведенияОПенсионномОбеспеченииФизЛиц
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТ_РаботникиОрганизацииРезервы КАК Работники
	|		ПО СведенияОПенсионномОбеспеченииФизЛиц.ФизЛицо = Работники.ФизЛицо
	|
	|ГДЕ
	|	(СведенияОПенсионномОбеспеченииФизЛиц.Пенсионер)
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
    |ВЫБРАТЬ РАЗРЕШЕННЫЕ РАЗЛИЧНЫЕ
	|	СведенияОбИнвалидностиФизлиц.Физлицо КАК ФизЛицо,
	|	СведенияОбИнвалидностиФизлиц.СрокДействияСправки = ДАТАВРЕМЯ(1,1,1) КАК ИнвалидБессрочно
	|ПОМЕСТИТЬ ВТ_ФизлицаИнвалиды
	|ИЗ
	|	РегистрСведений.СведенияОбИнвалидностиФизлиц.СрезПоследних(&парамКонецМесяца) КАК СведенияОбИнвалидностиФизлиц
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТ_РаботникиОрганизацииРезервы КАК Работники
	|		ПО СведенияОбИнвалидностиФизлиц.Физлицо = Работники.ФизЛицо
	|
	|ГДЕ
	|	СведенияОбИнвалидностиФизлиц.ОтношениеКИнвалидности = ЗНАЧЕНИЕ(Перечисление.ОтношениеКИнвалидности.Инвалид)
	|	И (СведенияОбИнвалидностиФизлиц.СрокДействияСправки = ДАТАВРЕМЯ(1,1,1)
	|		ИЛИ КОНЕЦПЕРИОДА(СведенияОбИнвалидностиФизлиц.СрокДействияСправки, МЕСЯЦ) >= &парамКонецМесяца)
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ РАЗРЕШЕННЫЕ
	|	БУНачисления.СчетДт,
	|	БУНачисления.ФизЛицо,
	|	БУНачисления.СтруктурноеПодразделениеДт,
	|	БУНачисления.СубконтоДт1,
	|	БУНачисления.СубконтоДт2,
	|	БУНачисления.СубконтоДт3,
	|	ВЫБОР
	|		КОГДА &парамВедениеУчетаВременныхРазницБалансовымМетодом
	|				И НЕ Резервы.ПринятиеКВычетуПоНалоговомуУчету
	|			ТОГДА &парамСчетПрочиеРасходыНУ
	|		ИНАЧЕ БУНачисления.СчетДтНУ
	|	КОНЕЦ КАК СчетДтНУ,
	|	ВЫБОР
	|		КОГДА &парамВедениеУчетаВременныхРазницБалансовымМетодом
	|				И НЕ Резервы.ПринятиеКВычетуПоНалоговомуУчету
	|			ТОГДА Резервы.СтатьяЗатрат
	|		ИНАЧЕ ВЫБОР
	|				КОГДА ВидыСубконтоБУДт1.ВидСубконто = ВидыСубконтоНУДт1.ВидСубконто
	|					ТОГДА БУНачисления.СубконтоДт1
	|				КОГДА ВидыСубконтоБУДт2.ВидСубконто = ВидыСубконтоНУДт1.ВидСубконто
	|					ТОГДА БУНачисления.СубконтоДт2
	|				КОГДА ВидыСубконтоБУДт3.ВидСубконто = ВидыСубконтоНУДт1.ВидСубконто
	|					ТОГДА БУНачисления.СубконтоДт3
	|			КОНЕЦ
	|	КОНЕЦ КАК СубконтоДтНУ1,
	|	ВЫБОР
	|		КОГДА ВидыСубконтоБУДт1.ВидСубконто = ВидыСубконтоНУДт2.ВидСубконто
	|			ТОГДА БУНачисления.СубконтоДт1
	|		КОГДА ВидыСубконтоБУДт2.ВидСубконто = ВидыСубконтоНУДт2.ВидСубконто
	|			ТОГДА БУНачисления.СубконтоДт2
	|		КОГДА ВидыСубконтоБУДт3.ВидСубконто = ВидыСубконтоНУДт2.ВидСубконто
	|			ТОГДА БУНачисления.СубконтоДт3
	|	КОНЕЦ КАК СубконтоДтНУ2,
	|	ВЫБОР
	|		КОГДА ВидыСубконтоБУДт1.ВидСубконто = ВидыСубконтоНУДт3.ВидСубконто
	|			ТОГДА БУНачисления.СубконтоДт1
	|		КОГДА ВидыСубконтоБУДт2.ВидСубконто = ВидыСубконтоНУДт3.ВидСубконто
	|			ТОГДА БУНачисления.СубконтоДт2
	|		КОГДА ВидыСубконтоБУДт3.ВидСубконто = ВидыСубконтоНУДт3.ВидСубконто
	|			ТОГДА БУНачисления.СубконтоДт3
	|	КОНЕЦ КАК СубконтоДтНУ3,
	|	СУММА(БУНачисления.Сумма) КАК Сумма,
	|	РазмерыОтчисленийВРезервы.Резерв,
	|	РазмерыОтчисленийВРезервы.Размер,
	|	РазмерыОтчисленийВРезервы.РазмерСоциальногоНалога,
	|	РазмерыОтчисленийВРезервы.РазмерСоциальныхОтчислений,
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(РаботникиОрганизации.ИсчислятьОППВ, ЛОЖЬ)
	|			ТОГДА РазмерыОтчисленийВРезервы.РазмерПрофессиональныхПенсионныхВзносов
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК РазмерПрофессиональныхПенсионныхВзносов,
	|	РазмерыОтчисленийВРезервы.РазмерОтчисленийОСМС,
	|	РазмерыОтчисленийВРезервы.РазмерПенсионныхВзносовРаботодателя,
	|	ВЫБОР
	|		КОГДА РазмерыОтчисленийВРезервы.СчетУчета = &парамПустойСчет
	|			ТОГДА &парамСчетКтДляРезервов
	|		ИНАЧЕ РазмерыОтчисленийВРезервы.СчетУчета
	|	КОНЕЦ КАК СчетКт,
	|	ВЫБОР
	|		КОГДА РазмерыОтчисленийВРезервы.СчетУчета = &парамПустойСчет
	|			ТОГДА &парамСчетКтНУДляРезервов
	|		ИНАЧЕ РазмерыОтчисленийВРезервы.СчетУчета.СчетНУ
	|	КОНЕЦ КАК СчетКтНУ,
	|	ЕСТЬNULL(ВидыСубконтоДт.НомерСтроки, 0) КАК НомерСубконтоСтатьиЗатрат,
	|	Резервы.ПринятиеКВычетуПоНалоговомуУчету,
	|	Резервы.СтатьяЗатрат,
	|	ВЫБОР
	|		КОГДА ФизлицаПенсионеры.ФизЛицо ЕСТЬ NULL ТОГДА ЛОЖЬ
	|		ИНАЧЕ ИСТИНА
	|	КОНЕЦ КАК Пенсионер,
	|	ВЫБОР
	|		КОГДА ФизлицаИнвалиды.ФизЛицо ЕСТЬ NULL ТОГДА ЛОЖЬ
	|		ИНАЧЕ ИСТИНА
	|	КОНЕЦ КАК Инвалид,
	|	ЕСТЬNULL(ФизлицаИнвалиды.ИнвалидБессрочно, Ложь) КАК ИнвалидБессрочно,
	|	ЕСТЬNULL(ФизическиеЛица.ДатаРождения, ДАТАВРЕМЯ(1, 1, 1)) КАК ДатаРождения
	|ИЗ
	|	ВТ_БУДоходыПоСчетамРезервы КАК БУНачисления
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Справочник.Резервы.БазовыеВидыРасчета КАК БазовыеВидыРасчета
	|		ПО БУНачисления.ВидРасчета = БазовыеВидыРасчета.ВидРасчета
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.РазмерыОтчисленийВРезервы.СрезПоследних(
	|				&парамНачалоМесяца,
	|				Организация = &парамОрганизация
	|					И Резерв.ВидРезерва = ЗНАЧЕНИЕ(Перечисление.ВидыРезервов.ПоВознаграждениямРаботникам)) КАК РазмерыОтчисленийВРезервы
	|		ПО (БазовыеВидыРасчета.Ссылка = РазмерыОтчисленийВРезервы.Резерв)
	|			И (РазмерыОтчисленийВРезервы.Размер <> 0)
	|		ЛЕВОЕ СОЕДИНЕНИЕ ВТ_РаботникиОрганизацииРезервы КАК РаботникиОрганизации
	|		ПО БУНачисления.ФизЛицо = РаботникиОрганизации.ФизЛицо
	|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Типовой.ВидыСубконто КАК ВидыСубконтоДт
	|		ПО БУНачисления.СчетДт = ВидыСубконтоДт.Ссылка
	|			И (ВидыСубконтоДт.ВидСубконто = &парамВидСубконтоСтатьиЗатрат)
	|		ЛЕВОЕ СОЕДИНЕНИЕ Справочник.Резервы КАК Резервы
	|		ПО (РазмерыОтчисленийВРезервы.Резерв = Резервы.Ссылка)
	|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Типовой.ВидыСубконто КАК ВидыСубконтоБУДт1
	|		ПО БУНачисления.СчетДт = ВидыСубконтоБУДт1.Ссылка
	|			И (ВидыСубконтоБУДт1.НомерСтроки = 1)
	|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Типовой.ВидыСубконто КАК ВидыСубконтоБУДт2
	|		ПО БУНачисления.СчетДт = ВидыСубконтоБУДт2.Ссылка
	|			И (ВидыСубконтоБУДт2.НомерСтроки = 2)
	|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Типовой.ВидыСубконто КАК ВидыСубконтоБУДт3
	|		ПО БУНачисления.СчетДт = ВидыСубконтоБУДт3.Ссылка
	|			И (ВидыСубконтоБУДт3.НомерСтроки = 3)
	|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Налоговый.ВидыСубконто КАК ВидыСубконтоНУДт1
	|		ПО (ВЫБОР
	|				КОГДА Резервы.ПринятиеКВычетуПоНалоговомуУчету
	|					ТОГДА БУНачисления.СчетДтНУ = ВидыСубконтоНУДт1.Ссылка
	|				ИНАЧЕ &парамСчетПрочиеРасходыНУ = ВидыСубконтоНУДт1.Ссылка
	|			КОНЕЦ)
	|			И (ВидыСубконтоНУДт1.НомерСтроки = 1)
	|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Налоговый.ВидыСубконто КАК ВидыСубконтоНУДт2
	|		ПО (ВЫБОР
	|				КОГДА Резервы.ПринятиеКВычетуПоНалоговомуУчету
	|					ТОГДА БУНачисления.СчетДтНУ = ВидыСубконтоНУДт2.Ссылка
	|				ИНАЧЕ &парамСчетПрочиеРасходыНУ = ВидыСубконтоНУДт2.Ссылка
	|			КОНЕЦ)
	|			И (ВидыСубконтоНУДт2.НомерСтроки = 2)
	|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Налоговый.ВидыСубконто КАК ВидыСубконтоНУДт3
	|		ПО (ВЫБОР
	|				КОГДА Резервы.ПринятиеКВычетуПоНалоговомуУчету
	|					ТОГДА БУНачисления.СчетДтНУ = ВидыСубконтоНУДт3.Ссылка
	|				ИНАЧЕ &парамСчетПрочиеРасходыНУ = ВидыСубконтоНУДт3.Ссылка
	|			КОНЕЦ)
	|			И (ВидыСубконтоНУДт3.НомерСтроки = 3)
	|		ЛЕВОЕ СОЕДИНЕНИЕ ВТ_ФизлицаПенсионеры КАК ФизлицаПенсионеры
	|		ПО БУНачисления.ФизЛицо = ФизлицаПенсионеры.ФизЛицо
	|		ЛЕВОЕ СОЕДИНЕНИЕ ВТ_ФизлицаИнвалиды КАК ФизлицаИнвалиды
	|		ПО БУНачисления.ФизЛицо = ФизлицаИнвалиды.ФизЛицо
	|		ЛЕВОЕ СОЕДИНЕНИЕ Справочник.ФизическиеЛица КАК ФизическиеЛица
	|		ПО БУНачисления.ФизЛицо = ФизическиеЛица.Ссылка
	|ГДЕ
	|	БУНачисления.Сумма <> 0
	|
	|СГРУППИРОВАТЬ ПО
	|	БУНачисления.СчетДт,
	|	БУНачисления.ФизЛицо,
	|	БУНачисления.СтруктурноеПодразделениеДт,
	|	БУНачисления.СубконтоДт1,
	|	БУНачисления.СубконтоДт2,
	|	БУНачисления.СубконтоДт3,
	|	РазмерыОтчисленийВРезервы.Резерв,
	|	РазмерыОтчисленийВРезервы.Размер,
	|	РазмерыОтчисленийВРезервы.РазмерСоциальногоНалога,
	|	РазмерыОтчисленийВРезервы.РазмерСоциальныхОтчислений,
	|	РазмерыОтчисленийВРезервы.РазмерПенсионныхВзносовРаботодателя,
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(РаботникиОрганизации.ИсчислятьОППВ, ЛОЖЬ)
	|			ТОГДА РазмерыОтчисленийВРезервы.РазмерПрофессиональныхПенсионныхВзносов
	|		ИНАЧЕ 0
	|	КОНЕЦ,
	|	РазмерыОтчисленийВРезервы.РазмерОтчисленийОСМС,
	|	Резервы.ПринятиеКВычетуПоНалоговомуУчету,
	|	Резервы.СтатьяЗатрат,
	|	ВЫБОР
	|		КОГДА &парамВедениеУчетаВременныхРазницБалансовымМетодом
	|				И НЕ Резервы.ПринятиеКВычетуПоНалоговомуУчету
	|			ТОГДА &парамСчетПрочиеРасходыНУ
	|		ИНАЧЕ БУНачисления.СчетДтНУ
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА &парамВедениеУчетаВременныхРазницБалансовымМетодом
	|				И НЕ Резервы.ПринятиеКВычетуПоНалоговомуУчету
	|			ТОГДА Резервы.СтатьяЗатрат
	|		ИНАЧЕ ВЫБОР
	|				КОГДА ВидыСубконтоБУДт1.ВидСубконто = ВидыСубконтоНУДт1.ВидСубконто
	|					ТОГДА БУНачисления.СубконтоДт1
	|				КОГДА ВидыСубконтоБУДт2.ВидСубконто = ВидыСубконтоНУДт1.ВидСубконто
	|					ТОГДА БУНачисления.СубконтоДт2
	|				КОГДА ВидыСубконтоБУДт3.ВидСубконто = ВидыСубконтоНУДт1.ВидСубконто
	|					ТОГДА БУНачисления.СубконтоДт3
	|			КОНЕЦ
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ВидыСубконтоБУДт1.ВидСубконто = ВидыСубконтоНУДт2.ВидСубконто
	|			ТОГДА БУНачисления.СубконтоДт1
	|		КОГДА ВидыСубконтоБУДт2.ВидСубконто = ВидыСубконтоНУДт2.ВидСубконто
	|			ТОГДА БУНачисления.СубконтоДт2
	|		КОГДА ВидыСубконтоБУДт3.ВидСубконто = ВидыСубконтоНУДт2.ВидСубконто
	|			ТОГДА БУНачисления.СубконтоДт3
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ВидыСубконтоБУДт1.ВидСубконто = ВидыСубконтоНУДт3.ВидСубконто
	|			ТОГДА БУНачисления.СубконтоДт1
	|		КОГДА ВидыСубконтоБУДт2.ВидСубконто = ВидыСубконтоНУДт3.ВидСубконто
	|			ТОГДА БУНачисления.СубконтоДт2
	|		КОГДА ВидыСубконтоБУДт3.ВидСубконто = ВидыСубконтоНУДт3.ВидСубконто
	|			ТОГДА БУНачисления.СубконтоДт3
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА РазмерыОтчисленийВРезервы.СчетУчета = &парамПустойСчет
	|			ТОГДА &парамСчетКтДляРезервов
	|		ИНАЧЕ РазмерыОтчисленийВРезервы.СчетУчета
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА РазмерыОтчисленийВРезервы.СчетУчета = &парамПустойСчет
	|			ТОГДА &парамСчетКтНУДляРезервов
	|		ИНАЧЕ РазмерыОтчисленийВРезервы.СчетУчета.СчетНУ
	|	КОНЕЦ,
	|	ЕСТЬNULL(ВидыСубконтоДт.НомерСтроки, 0),
	|	ВЫБОР
	|		КОГДА ФизлицаПенсионеры.ФизЛицо ЕСТЬ NULL ТОГДА ЛОЖЬ
	|		ИНАЧЕ ИСТИНА
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА ФизлицаИнвалиды.ФизЛицо ЕСТЬ NULL ТОГДА ЛОЖЬ
	|		ИНАЧЕ ИСТИНА
	|	КОНЕЦ,
	|	ЕСТЬNULL(ФизлицаИнвалиды.ИнвалидБессрочно, Ложь),
	|	ЕСТЬNULL(ФизическиеЛица.ДатаРождения, ДАТАВРЕМЯ(1, 1, 1))
	|
	|УПОРЯДОЧИТЬ ПО
	|	БУНачисления.ФизЛицо";

    Выборка = Запрос.Выполнить().Выбрать();
    
    СтатьяЗатратСоциальныйНалог 		= Справочники.СтатьиЗатрат.СоциальныйНалог;
    СтатьяЗатратСоциальныеОтчисления 	= Справочники.СтатьиЗатрат.СоциальныеОтчисления;
	СтатьяЗатратПрофессиональныеПенсионныеВзносы = Справочники.СтатьиЗатрат.ОбязательныеПрофессиональныеПенсионныеВзносы;
	СтатьяЗатратПенсионныеВзносыРаботодателя = Справочники.СтатьиЗатрат.ОбязательныеПенсионныеВзносыРаботодателя;
	СтатьяЗатратОтчисленияОСМС 			= Справочники.СтатьиЗатрат.ОтчисленияОСМС;
    
    Пока Выборка.Следующий() Цикл
    	
    	СуммаРезерва = Выборка.Сумма * Выборка.Размер / 100;
    	
    	// строка самого резерва по вознаграждениям
    	Строка 			= ПромежуточнаяТаблица.Добавить();
		
		//БУ
    	Строка.СчетДт 	= Выборка.СчетДт;
    	Для Н = 1 По 3 Цикл
    		Строка["СубконтоДт" + Н] = Выборка["СубконтоДт" + Н];
    	КонецЦикла;
    	
    	Строка.СчетКт		= Выборка.СчетКт;
    	Строка.СубконтоКт1  = Выборка.Резерв; 
    	Если ВедетсяУчетПоСотрудникам Тогда
    		Строка.СубконтоКт2  = Выборка.ФизЛицо;
		КонецЕсли;
		
		Если ВедениеУчетаВременныхРазницБалансовымМетодом Тогда
			
			//НУ
			Строка.СчетДтНу 	= Выборка.СчетДтНУ;
	    	Для Н = 1 По 3 Цикл
	    		Строка["СубконтоДтНУ" + Н] = Выборка["СубконтоДтНУ" + Н];
	    	КонецЦикла;

			Строка.СчетКтНУ		= Выборка.СчетКтНУ;
	    	Строка.СубконтоКтНУ1  = Выборка.Резерв; 
	    	Если ВедетсяУчетПоСотрудникам Тогда
	    		Строка.СубконтоКтНУ2  = Выборка.ФизЛицо;
			КонецЕсли;
			
		КонецЕсли;
		
		Строка.Сумма 		= СуммаРезерва;
		Строка.ФизЛицо 		= Выборка.ФизЛицо;
		Строка.СтруктурноеПодразделениеДт = Выборка.СтруктурноеПодразделениеДт;
		Строка.СтруктурноеПодразделениеКт = Справочники.ПодразделенияОрганизаций.ПустаяСсылка();
		Строка.ВидРасчета 	= Выборка.Резерв;
			
    	// резерв под социальный налог
    	Если Выборка.РазмерСоциальногоНалога <> 0 Тогда
    		
    		Строка			= ПромежуточнаяТаблица.Добавить();
			
			//БУ
    		Строка.СчетДт 	= Выборка.СчетДт;
    		Для Н = 1 По 3 Цикл
    			Если Выборка.НомерСубконтоСтатьиЗатрат = Н Тогда // меняем зарплатную статью затрат на СН
    				Строка["СубконтоДт" + Н] = СтатьяЗатратСоциальныйНалог;
    			Иначе
    				Строка["СубконтоДт" + Н] = Выборка["СубконтоДт" + Н];
    			КонецЕсли;    		
    		КонецЦикла;
    		
    		Строка.СчетКт		= Выборка.СчетКт;
    		Строка.СубконтоКт1 	= Выборка.Резерв;
    		Если ВедетсяУчетПоСотрудникам Тогда
				Строка.СубконтоКт2 	= Выборка.ФизЛицо;
			КонецЕсли;
			
			Если ВедениеУчетаВременныхРазницБалансовымМетодом Тогда
				
				//НУ
				Строка.СчетДтНУ 	= Выборка.СчетДтНУ;
				Для Н = 1 По 3 Цикл
					Строка["СубконтоДтНУ" + Н] = Выборка["СубконтоДтНУ" + Н];
	    		КонецЦикла;
				
				Строка.СчетКтНУ		= Выборка.СчетКтНУ;
	    		Строка.СубконтоКтНУ1 	= Выборка.Резерв;
	    		Если ВедетсяУчетПоСотрудникам Тогда
					Строка.СубконтоКтНУ2 	= Выборка.ФизЛицо;
				КонецЕсли;

			КонецЕсли;
			
			Строка.Сумма 					= СуммаРезерва * Выборка.РазмерСоциальногоНалога / 100;
			Строка.ФизЛицо 					= Выборка.ФизЛицо;
			Строка.СтруктурноеПодразделениеДт = Выборка.СтруктурноеПодразделениеДт;
			Строка.СтруктурноеПодразделениеКт = Справочники.ПодразделенияОрганизаций.ПустаяСсылка();
			Строка.ВидРасчета 				= Выборка.Резерв;
				
    	КонецЕсли;

    	// резерв под социальные отчисления (СО)
    	Если Выборка.РазмерСоциальныхОтчислений <> 0 И НЕ Выборка.Пенсионер Тогда
    		
    		Строка			= ПромежуточнаяТаблица.Добавить();
    		
    		Строка.СчетДт 	= Выборка.СчетДт;
    		Для Н = 1 По 3 Цикл
    			Если Выборка.НомерСубконтоСтатьиЗатрат = Н Тогда // меняем зарплатную статью затрат на СО
    				Строка["СубконтоДт" + Н] = СтатьяЗатратСоциальныеОтчисления;
    			Иначе
    				Строка["СубконтоДт" + Н] = Выборка["СубконтоДт" + Н];
    			КонецЕсли;    		
    		КонецЦикла;
    		
    		Строка.СчетКт		= Выборка.СчетКт;
    		Строка.СубконтоКт1 	= Выборка.Резерв;
    		Если ВедетсяУчетПоСотрудникам Тогда			
    			Строка.СубконтоКт2 	= Выборка.ФизЛицо;
			КонецЕсли;
			
			Если ВедениеУчетаВременныхРазницБалансовымМетодом Тогда
				
				//НУ
				Строка.СчетДтНУ 	= Выборка.СчетДтНУ;
	    		Для Н = 1 По 3 Цикл
					Строка["СубконтоДтНУ" + Н] = Выборка["СубконтоДтНУ" + Н];
	    		КонецЦикла;
				
				Строка.СчетКтНУ		= Выборка.СчетКтНУ;
	    		Строка.СубконтоКтНУ1 	= Выборка.Резерв;
	    		Если ВедетсяУчетПоСотрудникам Тогда			
	    			Строка.СубконтоКтНУ2 	= Выборка.ФизЛицо;
				КонецЕсли;
			КонецЕсли;
	
			Строка.Сумма 					= СуммаРезерва * Выборка.РазмерСоциальныхОтчислений / 100;
			Строка.ФизЛицо 					= Выборка.ФизЛицо;
			Строка.СтруктурноеПодразделениеДт = Выборка.СтруктурноеПодразделениеДт;
			Строка.СтруктурноеПодразделениеКт = Справочники.ПодразделенияОрганизаций.ПустаяСсылка();
			Строка.ВидРасчета 				= Выборка.Резерв;
			
		КонецЕсли;
		
		// резерв под профессиональные пенсионне взносы
    	Если Выборка.РазмерПрофессиональныхПенсионныхВзносов <> 0 Тогда
    		
    		Строка			= ПромежуточнаяТаблица.Добавить();
    		
    		Строка.СчетДт 	= Выборка.СчетДт;
    		Для Н = 1 По 3 Цикл
    			Если Выборка.НомерСубконтоСтатьиЗатрат = Н Тогда // меняем зарплатную статью затрат на ОППВ
    				Строка["СубконтоДт" + Н] = СтатьяЗатратПрофессиональныеПенсионныеВзносы;
    			Иначе
    				Строка["СубконтоДт" + Н] = Выборка["СубконтоДт" + Н];
    			КонецЕсли;    		
    		КонецЦикла;
    		
    		Строка.СчетКт		= Выборка.СчетКт;
    		Строка.СубконтоКт1 	= Выборка.Резерв;
    		Если ВедетсяУчетПоСотрудникам Тогда			
    			Строка.СубконтоКт2 	= Выборка.ФизЛицо;
			КонецЕсли;
			
			Если ВедениеУчетаВременныхРазницБалансовымМетодом Тогда
				
				//НУ
				Строка.СчетДтНУ 	= Выборка.СчетДтНУ;
	    		Для Н = 1 По 3 Цикл
					Строка["СубконтоДтНУ" + Н] = Выборка["СубконтоДтНУ" + Н];
	    		КонецЦикла;
				
				Строка.СчетКтНУ		= Выборка.СчетКтНУ;
	    		Строка.СубконтоКтНУ1 	= Выборка.Резерв;
	    		Если ВедетсяУчетПоСотрудникам Тогда			
	    			Строка.СубконтоКтНУ2 	= Выборка.ФизЛицо;
				КонецЕсли;
			КонецЕсли;
	
			Строка.Сумма 					= СуммаРезерва * Выборка.РазмерПрофессиональныхПенсионныхВзносов / 100;
			Строка.ФизЛицо 					= Выборка.ФизЛицо;
			Строка.СтруктурноеПодразделениеДт = Выборка.СтруктурноеПодразделениеДт;
			Строка.СтруктурноеПодразделениеКт = Справочники.ПодразделенияОрганизаций.ПустаяСсылка();
			Строка.ВидРасчета 				= Выборка.Резерв;
			
    	КонецЕсли;
    	
		// резерв под пенсионные взносы работодатедя (ОПВР)
    	Если Выборка.РазмерПенсионныхВзносовРаботодателя <> 0 И НЕ Выборка.Пенсионер И НЕ Выборка.ИнвалидБессрочно И Выборка.ДатаРождения >= Дата(1975, 1, 1) Тогда
    		
    		Строка			= ПромежуточнаяТаблица.Добавить();
    		
    		Строка.СчетДт 	= Выборка.СчетДт;
    		Для Н = 1 По 3 Цикл
				Если Выборка.НомерСубконтоСтатьиЗатрат = Н Тогда // меняем зарплатную статью затрат на ОПВР
    				Строка["СубконтоДт" + Н] = СтатьяЗатратПенсионныеВзносыРаботодателя;
    			Иначе
    				Строка["СубконтоДт" + Н] = Выборка["СубконтоДт" + Н];
    			КонецЕсли;    		
    		КонецЦикла;
    		
    		Строка.СчетКт		= Выборка.СчетКт;
    		Строка.СубконтоКт1 	= Выборка.Резерв;
    		Если ВедетсяУчетПоСотрудникам Тогда			
    			Строка.СубконтоКт2 	= Выборка.ФизЛицо;
			КонецЕсли;
			
			Если ВедениеУчетаВременныхРазницБалансовымМетодом Тогда
				
				//НУ
				Строка.СчетДтНУ 	= Выборка.СчетДтНУ;
	    		Для Н = 1 По 3 Цикл
					Строка["СубконтоДтНУ" + Н] = Выборка["СубконтоДтНУ" + Н];
	    		КонецЦикла;
				
				Строка.СчетКтНУ		= Выборка.СчетКтНУ;
	    		Строка.СубконтоКтНУ1 	= Выборка.Резерв;
	    		Если ВедетсяУчетПоСотрудникам Тогда			
	    			Строка.СубконтоКтНУ2 	= Выборка.ФизЛицо;
				КонецЕсли;
			КонецЕсли;
	
			Строка.Сумма 					= СуммаРезерва * Выборка.РазмерПенсионныхВзносовРаботодателя / 100;
			Строка.ФизЛицо 					= Выборка.ФизЛицо;
			Строка.СтруктурноеПодразделениеДт = Выборка.СтруктурноеПодразделениеДт;
			Строка.СтруктурноеПодразделениеКт = Справочники.ПодразделенияОрганизаций.ПустаяСсылка();
			Строка.ВидРасчета 				= Выборка.Резерв;
			
    	КонецЕсли;
		
		// резерв под отчисления (ООСМС)
    	Если Выборка.РазмерОтчисленийОСМС <> 0 И НЕ Выборка.Пенсионер И НЕ Выборка.Инвалид Тогда
    		
    		Строка			= ПромежуточнаяТаблица.Добавить();
    		
    		Строка.СчетДт 	= Выборка.СчетДт;
    		Для Н = 1 По 3 Цикл
    			Если Выборка.НомерСубконтоСтатьиЗатрат = Н Тогда // меняем зарплатную статью затрат на отчисления ОСМС
    				Строка["СубконтоДт" + Н] = СтатьяЗатратОтчисленияОСМС;
    			Иначе
    				Строка["СубконтоДт" + Н] = Выборка["СубконтоДт" + Н];
    			КонецЕсли;    		
    		КонецЦикла;
    		
    		Строка.СчетКт		= Выборка.СчетКт;
    		Строка.СубконтоКт1 	= Выборка.Резерв;
    		Если ВедетсяУчетПоСотрудникам Тогда			
    			Строка.СубконтоКт2 	= Выборка.ФизЛицо;
			КонецЕсли;
			
			Если ВедениеУчетаВременныхРазницБалансовымМетодом Тогда
				
				//НУ
				Строка.СчетДтНУ 	= Выборка.СчетДтНУ;
	    		Для Н = 1 По 3 Цикл
					Строка["СубконтоДтНУ" + Н] = Выборка["СубконтоДтНУ" + Н];
	    		КонецЦикла;
				
				Строка.СчетКтНУ		= Выборка.СчетКтНУ;
	    		Строка.СубконтоКтНУ1 	= Выборка.Резерв;
	    		Если ВедетсяУчетПоСотрудникам Тогда			
	    			Строка.СубконтоКтНУ2 	= Выборка.ФизЛицо;
				КонецЕсли;
			КонецЕсли;
	
			Строка.Сумма 					= СуммаРезерва * Выборка.РазмерОтчисленийОСМС / 100;
			Строка.ФизЛицо 					= Выборка.ФизЛицо;
			Строка.СтруктурноеПодразделениеДт = Выборка.СтруктурноеПодразделениеДт;
			Строка.СтруктурноеПодразделениеКт = Справочники.ПодразделенияОрганизаций.ПустаяСсылка();
			Строка.ВидРасчета 				= Выборка.Резерв;
			
		КонецЕсли;
		
	КонецЦикла;
	
#КонецОбласти


#Область ОтражениеИП
Если ПроцедурыНалоговогоУчета.ПолучитьПризнакЕжемесячногоРасчетаВзносовИОтчисленийЗаИП(Параметры.Организация, Параметры.ПериодРегистрации) Тогда
	
#Область ОПВзаИП	
	// Отражение ОПВ за ИП
	Запрос.Текст =
		"ВЫБРАТЬ
		|	ОтражениеЗарплатыВРеглУчетеОтражениеВУчете.ФизЛицо
		|ПОМЕСТИТЬ ВТ_УжеОтражено
		|ИЗ
		|	Документ.ОтражениеЗарплатыВРеглУчете.ОтражениеВУчете КАК ОтражениеЗарплатыВРеглУчетеОтражениеВУчете
		|ГДЕ
		|	ОтражениеЗарплатыВРеглУчетеОтражениеВУчете.Ссылка.Организация = &парамОрганизация
		|	И ОтражениеЗарплатыВРеглУчетеОтражениеВУчете.Ссылка.ПериодРегистрации = &парамНачалоМесяца
		|	И ОтражениеЗарплатыВРеглУчетеОтражениеВУчете.ФизЛицо = &парамИндивидуальныйПредприниматель
		|	И ОтражениеЗарплатыВРеглУчетеОтражениеВУчете.Ссылка <> &ДокументСсылка
		|	И ОтражениеЗарплатыВРеглУчетеОтражениеВУчете.Ссылка.Проведен
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ РАЗРЕШЕННЫЕ
		|	ОПВРасчетыСФондами.ФизЛицо,
		|	ОПВРасчетыСФондами.Организация,
		|	ОПВРасчетыСФондами.СтруктурнаяЕдиница,
		|	ОПВРасчетыСФондами.ПодразделениеОрганизации,
		|	ОПВРасчетыСФондами.МесяцНалоговогоПериода,
		|	ОПВРасчетыСФондами.ВидПлатежа,
		|	СУММА(ОПВРасчетыСФондами.Взнос) КАК Взнос,
		|	ВЫБОР
		|		КОГДА ОПВРасчетыСФондами.Регистратор ССЫЛКА Документ.РасчетПениОПВиСО
		|			ТОГДА ОПВРасчетыСФондами.Регистратор
		|		ИНАЧЕ НЕОПРЕДЕЛЕНО
		|	КОНЕЦ КАК Регистратор
		|ПОМЕСТИТЬ ВТ_ДанныеОПВЗаИП
		|ИЗ
		|	РегистрНакопления.ОПВРасчетыСФондами КАК ОПВРасчетыСФондами
		|		ЛЕВОЕ СОЕДИНЕНИЕ ВТ_УжеОтражено КАК УжеОтражено
		|		ПО ОПВРасчетыСФондами.ФизЛицо = УжеОтражено.ФизЛицо
		|ГДЕ
		|	ОПВРасчетыСФондами.Период >= &парамНачалоМесяца
		|	И ОПВРасчетыСФондами.Период <= &парамКонецМесяца
		|	И ОПВРасчетыСФондами.Организация = &парамОрганизация
		|	И ОПВРасчетыСФондами.ФизЛицо = &парамИндивидуальныйПредприниматель
		|	И ОПВРасчетыСФондами.ВидДвижения = &парамВидДвиженияПриход
		|	И ОПВРасчетыСФондами.ВидСтроки = &парамВидСтрокиИсчисление
		|	И ОПВРасчетыСФондами.Взнос <> 0
		|	И НЕ ОПВРасчетыСФондами.Регистратор ССЫЛКА Документ.ОтражениеНалоговойОтчетностиВРеглУчете
		|	И ОПВРасчетыСФондами.Активность
		|	И УжеОтражено.ФизЛицо ЕСТЬ NULL 
		|
		|СГРУППИРОВАТЬ ПО
		|	ОПВРасчетыСФондами.ФизЛицо,
		|	ОПВРасчетыСФондами.Организация,
		|	ОПВРасчетыСФондами.СтруктурнаяЕдиница,
		|	ОПВРасчетыСФондами.ПодразделениеОрганизации,
		|	ОПВРасчетыСФондами.МесяцНалоговогоПериода,
		|	ОПВРасчетыСФондами.ВидПлатежа,
		|	ВЫБОР
		|		КОГДА ОПВРасчетыСФондами.Регистратор ССЫЛКА Документ.РасчетПениОПВиСО
		|			ТОГДА ОПВРасчетыСФондами.Регистратор
		|		ИНАЧЕ НЕОПРЕДЕЛЕНО
		|	КОНЕЦ
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ РАЗРЕШЕННЫЕ
		|	РегистрацияПрочихДоходовВЦеляхНалогообложенияСведенияОДоходах.ФизЛицо,
		|	РегистрацияПрочихДоходовВЦеляхНалогообложенияСведенияОДоходах.Ссылка.ПодразделениеОрганизации КАК ПодразделениеОрганизации,
		|	РегистрацияПрочихДоходовВЦеляхНалогообложенияСведенияОДоходах.УчитыватьОПВ,
		|	РегистрацияПрочихДоходовВЦеляхНалогообложенияСведенияОДоходах.УчитыватьОПВР,
		|	РегистрацияПрочихДоходовВЦеляхНалогообложенияСведенияОДоходах.СпособНалогообложенияОПВ,
		|	РегистрацияПрочихДоходовВЦеляхНалогообложенияСведенияОДоходах.УчитыватьВОСМС,
		|	РегистрацияПрочихДоходовВЦеляхНалогообложенияСведенияОДоходах.СпособНалогообложенияВОСМС,
		|	РегистрацияПрочихДоходовВЦеляхНалогообложенияСведенияОДоходах.УчитыватьСО,
		|	РегистрацияПрочихДоходовВЦеляхНалогообложенияСведенияОДоходах.СпособНалогообложенияСО,
		|	РегистрацияПрочихДоходовВЦеляхНалогообложенияСведенияОДоходах.СуммаДохода,
		|	РегистрацияПрочихДоходовВЦеляхНалогообложенияСведенияОДоходах.СпособОтраженияВБухучете КАК СпособОтраженияВБУ
		|ПОМЕСТИТЬ ВТ_ДанныеРегистрацииДоходов
		|ИЗ
		|	Документ.РегистрацияПрочихДоходовВЦеляхНалогообложения.СведенияОДоходах КАК РегистрацияПрочихДоходовВЦеляхНалогообложенияСведенияОДоходах
		|ГДЕ
		|	РегистрацияПрочихДоходовВЦеляхНалогообложенияСведенияОДоходах.Ссылка.ПериодРегистрации МЕЖДУ &парамНачалоМесяца И &парамКонецМесяца
		|	И РегистрацияПрочихДоходовВЦеляхНалогообложенияСведенияОДоходах.Ссылка.ВидОперации = ЗНАЧЕНИЕ(Перечисление.ВидыОперацийРегистрацияПрочихДоходов.ДоходыИП)
		|	И РегистрацияПрочихДоходовВЦеляхНалогообложенияСведенияОДоходах.Ссылка.Организация = &парамОрганизация
		|	И РегистрацияПрочихДоходовВЦеляхНалогообложенияСведенияОДоходах.ФизЛицо = &парамИндивидуальныйПредприниматель
		|	И РегистрацияПрочихДоходовВЦеляхНалогообложенияСведенияОДоходах.Ссылка.Проведен
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ РАЗРЕШЕННЫЕ
		|	ОПВРасчетыСФондами.ФизЛицо,
		|	ВЫБОР
		|		КОГДА ОПВРасчетыСФондами.ПодразделениеОрганизации = ЗНАЧЕНИЕ(Справочник.ПодразделенияОрганизаций.ПустаяСсылка)
		|			ТОГДА РегистрацияДоходов.ПодразделениеОрганизации
		|		ИНАЧЕ ОПВРасчетыСФондами.ПодразделениеОрганизации
		|	КОНЕЦ КАК ПодразделениеОрганизации,
		|	ОПВРасчетыСФондами.ВидПлатежа,
		|	ОПВРасчетыСФондами.Взнос КАК Взнос,
		|	ВЫБОР
		|		КОГДА ОПВРасчетыСФондами.ВидПлатежа В (ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.Налог), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогАкт), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогСам))
		|			ТОГДА ВЫБОР
		|					КОГДА РегистрацияДоходов.СпособОтраженияВБУ ЕСТЬ NULL 
		|							ИЛИ РегистрацияДоходов.СпособОтраженияВБУ = ЗНАЧЕНИЕ(Справочник.СпособыОтраженияЗарплатыВРеглУчете.ПустаяСсылка)
		|							ИЛИ РегистрацияДоходов.СпособОтраженияВБУ.СчетДт = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
		|						ТОГДА &парамСпособПоУмолчаниюСчетДт
		|					ИНАЧЕ РегистрацияДоходов.СпособОтраженияВБУ.СчетДт
		|				КОНЕЦ
		|		ИНАЧЕ ВЫБОР
		|				КОГДА РасчетПениОПВиСО.СчетЗатратБУ ЕСТЬ NULL 
		|						ИЛИ РасчетПениОПВиСО.СчетЗатратБУ = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
		|					ТОГДА &парамСчетДтДляПени
		|				ИНАЧЕ РасчетПениОПВиСО.СчетЗатратБУ
		|			КОНЕЦ
		|	КОНЕЦ КАК СчетДт,
		|	ВЫБОР
		|		КОГДА ОПВРасчетыСФондами.ВидПлатежа В (ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.Налог), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогАкт), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогСам))
		|			ТОГДА ВЫБОР
		|					КОГДА РегистрацияДоходов.СпособОтраженияВБУ ЕСТЬ NULL 
		|							ИЛИ РегистрацияДоходов.СпособОтраженияВБУ = ЗНАЧЕНИЕ(Справочник.СпособыОтраженияЗарплатыВРеглУчете.ПустаяСсылка)
		|							ИЛИ РегистрацияДоходов.СпособОтраженияВБУ.СчетДт = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
		|						ТОГДА &парамСпособПоУмолчаниюСубконтоДт1
		|					ИНАЧЕ РегистрацияДоходов.СпособОтраженияВБУ.СубконтоДт1
		|				КОНЕЦ
		|		ИНАЧЕ ВЫБОР
		|				КОГДА РасчетПениОПВиСО.СчетЗатратБУ ЕСТЬ NULL 
		|						ИЛИ РасчетПениОПВиСО.СчетЗатратБУ = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
		|					ТОГДА НЕОПРЕДЕЛЕНО
		|				ИНАЧЕ ЕСТЬNULL(РасчетПениОПВиСО.СубконтоЗатратБУ1, НЕОПРЕДЕЛЕНО)
		|			КОНЕЦ
		|	КОНЕЦ КАК СубконтоДт1,
		|	ВЫБОР
		|		КОГДА ОПВРасчетыСФондами.ВидПлатежа В (ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.Налог), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогАкт), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогСам))
		|			ТОГДА ВЫБОР
		|					КОГДА РегистрацияДоходов.СпособОтраженияВБУ ЕСТЬ NULL 
		|							ИЛИ РегистрацияДоходов.СпособОтраженияВБУ = ЗНАЧЕНИЕ(Справочник.СпособыОтраженияЗарплатыВРеглУчете.ПустаяСсылка)
		|							ИЛИ РегистрацияДоходов.СпособОтраженияВБУ.СчетДт = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
		|						ТОГДА &парамСпособПоУмолчаниюСубконтоДт2
		|					ИНАЧЕ РегистрацияДоходов.СпособОтраженияВБУ.СубконтоДт2
		|				КОНЕЦ
		|		ИНАЧЕ ВЫБОР
		|				КОГДА РасчетПениОПВиСО.СчетЗатратБУ ЕСТЬ NULL 
		|						ИЛИ РасчетПениОПВиСО.СчетЗатратБУ = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
		|					ТОГДА НЕОПРЕДЕЛЕНО
		|				ИНАЧЕ ЕСТЬNULL(РасчетПениОПВиСО.СубконтоЗатратБУ2, НЕОПРЕДЕЛЕНО)
		|			КОНЕЦ
		|	КОНЕЦ КАК СубконтоДт2,
		|	ВЫБОР
		|		КОГДА ОПВРасчетыСФондами.ВидПлатежа В (ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.Налог), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогАкт), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогСам))
		|			ТОГДА ВЫБОР
		|					КОГДА РегистрацияДоходов.СпособОтраженияВБУ ЕСТЬ NULL 
		|							ИЛИ РегистрацияДоходов.СпособОтраженияВБУ = ЗНАЧЕНИЕ(Справочник.СпособыОтраженияЗарплатыВРеглУчете.ПустаяСсылка)
		|							ИЛИ РегистрацияДоходов.СпособОтраженияВБУ.СчетДт = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
		|						ТОГДА &парамСпособПоУмолчаниюСубконтоДт3
		|					ИНАЧЕ РегистрацияДоходов.СпособОтраженияВБУ.СубконтоДт3
		|				КОНЕЦ
		|		ИНАЧЕ ВЫБОР
		|				КОГДА РасчетПениОПВиСО.СчетЗатратБУ ЕСТЬ NULL 
		|						ИЛИ РасчетПениОПВиСО.СчетЗатратБУ = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
		|					ТОГДА НЕОПРЕДЕЛЕНО
		|				ИНАЧЕ ЕСТЬNULL(РасчетПениОПВиСО.СубконтоЗатратБУ2, НЕОПРЕДЕЛЕНО)
		|			КОНЕЦ
		|	КОНЕЦ КАК СубконтоДт3,
		|	ВЫБОР
		|		КОГДА ОПВРасчетыСФондами.ВидПлатежа В (ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.Налог), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогАкт), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогСам))
		|			ТОГДА ВЫБОР
		|					КОГДА РегистрацияДоходов.СпособОтраженияВБУ ЕСТЬ NULL 
		|							ИЛИ РегистрацияДоходов.СпособОтраженияВБУ = ЗНАЧЕНИЕ(Справочник.СпособыОтраженияЗарплатыВРеглУчете.ПустаяСсылка)
		|							ИЛИ РегистрацияДоходов.СпособОтраженияВБУ.СчетДтНУ = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
		|						ТОГДА &парамСпособПоУмолчаниюСчетДтНУ
		|					ИНАЧЕ РегистрацияДоходов.СпособОтраженияВБУ.СчетДтНУ
		|				КОНЕЦ
		|		ИНАЧЕ ВЫБОР
		|				КОГДА РасчетПениОПВиСО.СчетЗатратНУ ЕСТЬ NULL 
		|						ИЛИ РасчетПениОПВиСО.СчетЗатратНУ = ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
		|					ТОГДА &парамСчетДтДляПениНУ
		|				ИНАЧЕ РасчетПениОПВиСО.СчетЗатратНУ
		|			КОНЕЦ
		|	КОНЕЦ КАК СчетДтНУ,
		|	ВЫБОР
		|		КОГДА ОПВРасчетыСФондами.ВидПлатежа В (ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.Налог), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогАкт), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогСам))
		|			ТОГДА ВЫБОР
		|					КОГДА РегистрацияДоходов.СпособОтраженияВБУ ЕСТЬ NULL 
		|							ИЛИ РегистрацияДоходов.СпособОтраженияВБУ = ЗНАЧЕНИЕ(Справочник.СпособыОтраженияЗарплатыВРеглУчете.ПустаяСсылка)
		|							ИЛИ РегистрацияДоходов.СпособОтраженияВБУ.СчетДтНУ = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
		|						ТОГДА &парамСпособПоУмолчаниюСубконтоДтНУ1
		|					ИНАЧЕ РегистрацияДоходов.СпособОтраженияВБУ.СубконтоДтНУ1
		|				КОНЕЦ
		|		ИНАЧЕ ВЫБОР
		|				КОГДА РасчетПениОПВиСО.СчетЗатратНУ ЕСТЬ NULL 
		|						ИЛИ РасчетПениОПВиСО.СчетЗатратНУ = ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
		|					ТОГДА НЕОПРЕДЕЛЕНО
		|				ИНАЧЕ ЕСТЬNULL(РасчетПениОПВиСО.СубконтоЗатратНУ1, НЕОПРЕДЕЛЕНО)
		|			КОНЕЦ
		|	КОНЕЦ КАК СубконтоДтНУ1,
		|	ВЫБОР
		|		КОГДА ОПВРасчетыСФондами.ВидПлатежа В (ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.Налог), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогАкт), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогСам))
		|			ТОГДА ВЫБОР
		|					КОГДА РегистрацияДоходов.СпособОтраженияВБУ ЕСТЬ NULL 
		|							ИЛИ РегистрацияДоходов.СпособОтраженияВБУ = ЗНАЧЕНИЕ(Справочник.СпособыОтраженияЗарплатыВРеглУчете.ПустаяСсылка)
		|							ИЛИ РегистрацияДоходов.СпособОтраженияВБУ.СчетДтНУ = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
		|						ТОГДА &парамСпособПоУмолчаниюСубконтоДтНУ2
		|					ИНАЧЕ РегистрацияДоходов.СпособОтраженияВБУ.СубконтоДтНУ2
		|				КОНЕЦ
		|		ИНАЧЕ ВЫБОР
		|				КОГДА РасчетПениОПВиСО.СчетЗатратНУ ЕСТЬ NULL 
		|						ИЛИ РасчетПениОПВиСО.СчетЗатратНУ = ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
		|					ТОГДА НЕОПРЕДЕЛЕНО
		|				ИНАЧЕ ЕСТЬNULL(РасчетПениОПВиСО.СубконтоЗатратНУ2, НЕОПРЕДЕЛЕНО)
		|			КОНЕЦ
		|	КОНЕЦ КАК СубконтоДтНУ2,
		|	ВЫБОР
		|		КОГДА ОПВРасчетыСФондами.ВидПлатежа В (ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.Налог), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогАкт), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогСам))
		|			ТОГДА ВЫБОР
		|					КОГДА РегистрацияДоходов.СпособОтраженияВБУ ЕСТЬ NULL 
		|							ИЛИ РегистрацияДоходов.СпособОтраженияВБУ = ЗНАЧЕНИЕ(Справочник.СпособыОтраженияЗарплатыВРеглУчете.ПустаяСсылка)
		|							ИЛИ РегистрацияДоходов.СпособОтраженияВБУ.СчетДтНУ = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
		|						ТОГДА &парамСпособПоУмолчаниюСубконтоДтНУ2
		|					ИНАЧЕ РегистрацияДоходов.СпособОтраженияВБУ.СубконтоДтНУ2
		|				КОНЕЦ
		|		ИНАЧЕ ВЫБОР
		|				КОГДА РасчетПениОПВиСО.СчетЗатратНУ ЕСТЬ NULL 
		|						ИЛИ РасчетПениОПВиСО.СчетЗатратНУ = ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
		|					ТОГДА НЕОПРЕДЕЛЕНО
		|				ИНАЧЕ ЕСТЬNULL(РасчетПениОПВиСО.СубконтоЗатратНУ2, НЕОПРЕДЕЛЕНО)
		|			КОНЕЦ
		|	КОНЕЦ КАК СубконтоДтНУ3,
		|	ВЫБОР
		|		КОГДА ОПВРасчетыСФондами.ВидПлатежа В (ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.Налог), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогАкт), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогСам))
		|			ТОГДА ЕСТЬNULL(РегистрацияДоходов.СпособОтраженияВБУ.СчетКт, НЕОПРЕДЕЛЕНО)
		|		ИНАЧЕ НЕОПРЕДЕЛЕНО
		|	КОНЕЦ КАК СчетКт,
		|	ВЫБОР
		|		КОГДА ОПВРасчетыСФондами.ВидПлатежа В (ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.Налог), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогАкт), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогСам))
		|			ТОГДА ЕСТЬNULL(РегистрацияДоходов.СпособОтраженияВБУ.СубконтоКт1, НЕОПРЕДЕЛЕНО)
		|		ИНАЧЕ НЕОПРЕДЕЛЕНО
		|	КОНЕЦ КАК СубконтоКт1,
		|	ВЫБОР
		|		КОГДА ОПВРасчетыСФондами.ВидПлатежа В (ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.Налог), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогАкт), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогСам))
		|			ТОГДА ЕСТЬNULL(РегистрацияДоходов.СпособОтраженияВБУ.СубконтоКт2, НЕОПРЕДЕЛЕНО)
		|		ИНАЧЕ НЕОПРЕДЕЛЕНО
		|	КОНЕЦ КАК СубконтоКт2,
		|	ВЫБОР
		|		КОГДА ОПВРасчетыСФондами.ВидПлатежа В (ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.Налог), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогАкт), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогСам))
		|			ТОГДА ЕСТЬNULL(РегистрацияДоходов.СпособОтраженияВБУ.СубконтоКт3, НЕОПРЕДЕЛЕНО)
		|		ИНАЧЕ НЕОПРЕДЕЛЕНО
		|	КОНЕЦ КАК СубконтоКт3,
		|	ВЫБОР
		|		КОГДА ОПВРасчетыСФондами.ВидПлатежа В (ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.Налог), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогАкт), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогСам))
		|			ТОГДА ЕСТЬNULL(РегистрацияДоходов.СпособОтраженияВБУ.СчетКтНУ, НЕОПРЕДЕЛЕНО)
		|		ИНАЧЕ НЕОПРЕДЕЛЕНО
		|	КОНЕЦ КАК СчетКтНУ,
		|	ВЫБОР
		|		КОГДА ОПВРасчетыСФондами.ВидПлатежа В (ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.Налог), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогАкт), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогСам))
		|			ТОГДА ЕСТЬNULL(РегистрацияДоходов.СпособОтраженияВБУ.СубконтоКтНУ1, НЕОПРЕДЕЛЕНО)
		|		ИНАЧЕ НЕОПРЕДЕЛЕНО
		|	КОНЕЦ КАК СубконтоКтНУ1,
		|	ВЫБОР
		|		КОГДА ОПВРасчетыСФондами.ВидПлатежа В (ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.Налог), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогАкт), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогСам))
		|			ТОГДА ЕСТЬNULL(РегистрацияДоходов.СпособОтраженияВБУ.СубконтоКтНУ2, НЕОПРЕДЕЛЕНО)
		|		ИНАЧЕ НЕОПРЕДЕЛЕНО
		|	КОНЕЦ КАК СубконтоКтНУ2,
		|	ВЫБОР
		|		КОГДА ОПВРасчетыСФондами.ВидПлатежа В (ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.Налог), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогАкт), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогСам))
		|			ТОГДА ЕСТЬNULL(РегистрацияДоходов.СпособОтраженияВБУ.СубконтоКтНУ3, НЕОПРЕДЕЛЕНО)
		|		ИНАЧЕ НЕОПРЕДЕЛЕНО
		|	КОНЕЦ КАК СубконтоКтНУ3,
		|	ВЫБОР
		|		КОГДА ОПВРасчетыСФондами.ВидПлатежа В (ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.Налог), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогАкт), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогСам))
		|			ТОГДА ЕСТЬNULL(ВидСубконтоСтатьиЗатрат.НомерСтроки, 0)
		|		ИНАЧЕ ЕСТЬNULL(ВидСубконтоСтатьиЗатратДляПени.НомерСтроки, 0)
		|	КОНЕЦ КАК НомерСубконтоСтатьиЗатратДт,
		|	ВЫБОР
		|		КОГДА ОПВРасчетыСФондами.ВидПлатежа В (ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.Налог), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогАкт), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогСам))
		|			ТОГДА ЕСТЬNULL(ВидСубконтоПодразделения.НомерСтроки, 0)
		|		ИНАЧЕ ЕСТЬNULL(ВидСубконтоПодразделенияДляПени.НомерСтроки, 0)
		|	КОНЕЦ КАК НомерСубконтоПодразделенияДт,
		|	ВЫБОР
		|		КОГДА ОПВРасчетыСФондами.ВидПлатежа В (ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.Налог), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогАкт), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогСам))
		|			ТОГДА ЕСТЬNULL(ВидСубконтоСтатьиЗатратНУ.НомерСтроки, 0)
		|		ИНАЧЕ ЕСТЬNULL(ВидСубконтоСтатьиЗатратДляПениНУ.НомерСтроки, 0)
		|	КОНЕЦ КАК НомерСубконтоСтатьиЗатратДтНУ,
		|	ВЫБОР
		|		КОГДА ОПВРасчетыСФондами.ВидПлатежа В (ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.Налог), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогАкт), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогСам))
		|			ТОГДА ЕСТЬNULL(ВидСубконтоПодразделенияНУ.НомерСтроки, 0)
		|		ИНАЧЕ ЕСТЬNULL(ВидСубконтоПодразделенияДляПениНУ.НомерСтроки, 0)
		|	КОНЕЦ КАК НомерСубконтоПодразделенияДтНУ,
		|	ВЫБОР
		|		КОГДА ОПВРасчетыСФондами.ВидПлатежа В (ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.Налог), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогАкт), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогСам))
		|			ТОГДА ЕСТЬNULL(ВидСубконтоРаботникиОрганизаций.НомерСтроки, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ КАК НомерСубконтоРаботникиОрганизацийКт,
		|	ВЫБОР
		|		КОГДА ОПВРасчетыСФондами.ВидПлатежа В (ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.Налог), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогАкт), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогСам))
		|			ТОГДА ЕСТЬNULL(ВидСубконтоРаботникиОрганизацийНУ.НомерСтроки, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ КАК НомерСубконтоРаботникиОрганизацийКтНУ,
		|	ВЫБОР
		|		КОГДА ОПВРасчетыСФондами.ВидПлатежа В (ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.Налог), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогАкт), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогСам))
		|			ТОГДА ЕСТЬNULL(ВидСубконтоВидыПлатежей.НомерСтроки, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ КАК НомерСубконтоВидыПлатежейКт,
		|	ВЫБОР
		|		КОГДА ОПВРасчетыСФондами.ВидПлатежа В (ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.Налог), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогАкт), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогСам))
		|			ТОГДА ЕСТЬNULL(ВидСубконтоВидыПлатежей.НомерСтроки, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ КАК НомерСубконтоВидыПлатежейКтНУ
		|ИЗ
		|	ВТ_ДанныеОПВЗаИП КАК ОПВРасчетыСФондами
		|		ЛЕВОЕ СОЕДИНЕНИЕ ВТ_ДанныеРегистрацииДоходов КАК РегистрацияДоходов
		|		ПО (ЕСТЬNULL(РегистрацияДоходов.УчитыватьОПВ, ЛОЖЬ))
		|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Типовой.ВидыСубконто КАК ВидСубконтоСтатьиЗатрат
		|		ПО (ВидСубконтоСтатьиЗатрат.Ссылка = ВЫБОР
		|				КОГДА РегистрацияДоходов.СпособОтраженияВБУ ЕСТЬ NULL 
		|						ИЛИ РегистрацияДоходов.СпособОтраженияВБУ.СчетДт = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
		|					ТОГДА &парамСпособПоУмолчаниюСчетДт
		|				ИНАЧЕ РегистрацияДоходов.СпособОтраженияВБУ.СчетДт
		|			КОНЕЦ)
		|			И (ВидСубконтоСтатьиЗатрат.ВидСубконто = &парамВидСубконтоСтатьиЗатрат)
		|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Типовой.ВидыСубконто КАК ВидСубконтоПодразделения
		|		ПО (ВидСубконтоПодразделения.Ссылка = ВЫБОР
		|				КОГДА РегистрацияДоходов.СпособОтраженияВБУ ЕСТЬ NULL 
		|						ИЛИ РегистрацияДоходов.СпособОтраженияВБУ.СчетДт = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
		|					ТОГДА &парамСпособПоУмолчаниюСчетДт
		|				ИНАЧЕ РегистрацияДоходов.СпособОтраженияВБУ.СчетДт
		|			КОНЕЦ)
		|			И (ВидСубконтоПодразделения.ВидСубконто = &парамВидСубконтоПодразделения)
		|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Налоговый.ВидыСубконто КАК ВидСубконтоСтатьиЗатратНУ
		|		ПО (ВидСубконтоСтатьиЗатратНУ.Ссылка = ВЫБОР
		|				КОГДА РегистрацияДоходов.СпособОтраженияВБУ.СчетДтНУ ЕСТЬ NULL 
		|						ИЛИ РегистрацияДоходов.СпособОтраженияВБУ.СчетДтНУ = ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
		|					ТОГДА &парамСпособПоУмолчаниюСчетДтНУ
		|				ИНАЧЕ РегистрацияДоходов.СпособОтраженияВБУ.СчетДтНУ
		|			КОНЕЦ)
		|			И (ВидСубконтоСтатьиЗатратНУ.ВидСубконто = &парамВидСубконтоСтатьиЗатрат)
		|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Налоговый.ВидыСубконто КАК ВидСубконтоПодразделенияНУ
		|		ПО (ВидСубконтоПодразделенияНУ.Ссылка = ВЫБОР
		|				КОГДА РегистрацияДоходов.СпособОтраженияВБУ.СчетДтНУ ЕСТЬ NULL 
		|						ИЛИ РегистрацияДоходов.СпособОтраженияВБУ.СчетДтНУ = ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
		|					ТОГДА &парамСпособПоУмолчаниюСчетДтНУ
		|				ИНАЧЕ РегистрацияДоходов.СпособОтраженияВБУ.СчетДтНУ
		|			КОНЕЦ)
		|			И (ВидСубконтоПодразделенияНУ.ВидСубконто = &парамВидСубконтоПодразделения)
		|		ЛЕВОЕ СОЕДИНЕНИЕ Документ.РасчетПениОПВиСО КАК РасчетПениОПВиСО
		|		ПО ОПВРасчетыСФондами.Регистратор = РасчетПениОПВиСО.Ссылка
		|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Типовой.ВидыСубконто КАК ВидСубконтоСтатьиЗатратДляПени
		|		ПО (ВидСубконтоСтатьиЗатратДляПени.Ссылка = ВЫБОР
		|				КОГДА РасчетПениОПВиСО.СчетЗатратБУ ЕСТЬ NULL 
		|						ИЛИ РасчетПениОПВиСО.СчетЗатратБУ = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
		|					ТОГДА &парамСчетДтДляПени
		|				ИНАЧЕ РасчетПениОПВиСО.СчетЗатратБУ
		|			КОНЕЦ)
		|			И (ВидСубконтоСтатьиЗатратДляПени.ВидСубконто = &парамВидСубконтоСтатьиЗатрат)
		|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Типовой.ВидыСубконто КАК ВидСубконтоПодразделенияДляПени
		|		ПО (ВидСубконтоПодразделенияДляПени.Ссылка = ВЫБОР
		|				КОГДА РасчетПениОПВиСО.СчетЗатратБУ ЕСТЬ NULL 
		|						ИЛИ РасчетПениОПВиСО.СчетЗатратБУ = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
		|					ТОГДА &парамСчетДтДляПени
		|				ИНАЧЕ РасчетПениОПВиСО.СчетЗатратБУ
		|			КОНЕЦ)
		|			И (ВидСубконтоПодразделенияДляПени.ВидСубконто = &парамВидСубконтоПодразделения)
		|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Налоговый.ВидыСубконто КАК ВидСубконтоСтатьиЗатратДляПениНУ
		|		ПО (ВидСубконтоСтатьиЗатратДляПениНУ.Ссылка = ВЫБОР
		|				КОГДА РасчетПениОПВиСО.СчетЗатратНУ ЕСТЬ NULL 
		|						ИЛИ РасчетПениОПВиСО.СчетЗатратНУ = ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
		|					ТОГДА &парамСчетДтДляПениНУ
		|				ИНАЧЕ РасчетПениОПВиСО.СчетЗатратНУ
		|			КОНЕЦ)
		|			И (ВидСубконтоСтатьиЗатратДляПениНУ.ВидСубконто = &парамВидСубконтоСтатьиЗатрат)
		|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Налоговый.ВидыСубконто КАК ВидСубконтоПодразделенияДляПениНУ
		|		ПО (ВидСубконтоПодразделенияДляПениНУ.Ссылка = ВЫБОР
		|				КОГДА РасчетПениОПВиСО.СчетЗатратНУ ЕСТЬ NULL 
		|						ИЛИ РасчетПениОПВиСО.СчетЗатратНУ = ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
		|					ТОГДА &парамСчетДтДляПениНУ
		|				ИНАЧЕ РасчетПениОПВиСО.СчетЗатратНУ
		|			КОНЕЦ)
		|			И (ВидСубконтоПодразделенияДляПениНУ.ВидСубконто = &парамВидСубконтоПодразделения)
		|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Типовой.ВидыСубконто КАК ВидСубконтоРаботникиОрганизаций
		|		ПО (ВидСубконтоРаботникиОрганизаций.Ссылка = ВЫБОР
		|				КОГДА РегистрацияДоходов.СпособОтраженияВБУ ЕСТЬ NULL 
		|						ИЛИ РегистрацияДоходов.СпособОтраженияВБУ.СчетКт = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
		|					ТОГДА НЕОПРЕДЕЛЕНО
		|				ИНАЧЕ РегистрацияДоходов.СпособОтраженияВБУ.СчетКт
		|			КОНЕЦ)
		|			И (ВидСубконтоРаботникиОрганизаций.ВидСубконто = &парамВидСубконтоРаботникиОрганизаций)
		|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Типовой.ВидыСубконто КАК ВидСубконтоВидыПлатежей
		|		ПО (ВидСубконтоВидыПлатежей.Ссылка = ВЫБОР
		|				КОГДА РегистрацияДоходов.СпособОтраженияВБУ ЕСТЬ NULL 
		|						ИЛИ РегистрацияДоходов.СпособОтраженияВБУ.СчетКт = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
		|					ТОГДА НЕОПРЕДЕЛЕНО
		|				ИНАЧЕ РегистрацияДоходов.СпособОтраженияВБУ.СчетКт
		|			КОНЕЦ)
		|			И (ВидСубконтоВидыПлатежей.ВидСубконто = &парамВидСубконтоВидыПлатежей)
		|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Налоговый.ВидыСубконто КАК ВидСубконтоРаботникиОрганизацийНУ
		|		ПО (ВидСубконтоРаботникиОрганизацийНУ.Ссылка = ВЫБОР
		|				КОГДА РегистрацияДоходов.СпособОтраженияВБУ ЕСТЬ NULL 
		|						ИЛИ РегистрацияДоходов.СпособОтраженияВБУ.СчетКтНУ = ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
		|					ТОГДА НЕОПРЕДЕЛЕНО
		|				ИНАЧЕ РегистрацияДоходов.СпособОтраженияВБУ.СчетКтНУ
		|			КОНЕЦ)
		|			И (ВидСубконтоРаботникиОрганизацийНУ.ВидСубконто = &парамВидСубконтоРаботникиОрганизаций)
		|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Налоговый.ВидыСубконто КАК ВидСубконтоВидыПлатежейНУ
		|		ПО (ВидСубконтоВидыПлатежейНУ.Ссылка = ВЫБОР
		|				КОГДА РегистрацияДоходов.СпособОтраженияВБУ ЕСТЬ NULL 
		|						ИЛИ РегистрацияДоходов.СпособОтраженияВБУ.СчетКтНУ = ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
		|					ТОГДА НЕОПРЕДЕЛЕНО
		|				ИНАЧЕ РегистрацияДоходов.СпособОтраженияВБУ.СчетКтНУ
		|			КОНЕЦ)
		|			И (ВидСубконтоВидыПлатежейНУ.ВидСубконто = &парамВидСубконтоВидыПлатежей)
		|ГДЕ
		|	ВЫБОР
		|			КОГДА ОПВРасчетыСФондами.ВидПлатежа В (ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.Налог), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогАкт), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогСам))
		|				ТОГДА РегистрацияДоходов.СпособОтраженияВБУ <> ЗНАЧЕНИЕ(Справочник.СпособыОтраженияЗарплатыВРеглУчете.НеОтражатьВБухучете)
		|			ИНАЧЕ ИСТИНА
		|		КОНЕЦ";

	СпособПоУмолчанию = Справочники.СпособыОтраженияЗарплатыВРеглУчете.ОтражениеНачисленийПоУмолчанию;
	Запрос.УстановитьПараметр("парамСпособПоУмолчанию", СпособПоУмолчанию);
	Запрос.УстановитьПараметр("парамСпособПоУмолчаниюСчетДт", СпособПоУмолчанию.СчетДт);
	Запрос.УстановитьПараметр("парамСпособПоУмолчаниюСубконтоДт1", СпособПоУмолчанию.СубконтоДт1);
	Запрос.УстановитьПараметр("парамСпособПоУмолчаниюСубконтоДт2", СпособПоУмолчанию.СубконтоДт2);
	Запрос.УстановитьПараметр("парамСпособПоУмолчаниюСубконтоДт3", СпособПоУмолчанию.СубконтоДт3);
	Запрос.УстановитьПараметр("парамСпособПоУмолчаниюСчетДтНУ",    СпособПоУмолчанию.СчетДтНУ);
	Запрос.УстановитьПараметр("парамСпособПоУмолчаниюСубконтоДтНУ1", СпособПоУмолчанию.СубконтоДтНУ1);
	Запрос.УстановитьПараметр("парамСпособПоУмолчаниюСубконтоДтНУ2", СпособПоУмолчанию.СубконтоДтНУ2);
	Запрос.УстановитьПараметр("парамСпособПоУмолчаниюСубконтоДтНУ3", СпособПоУмолчанию.СубконтоДтНУ3);
	Запрос.УстановитьПараметр("парамВидСубконтоВидыПлатежей", ПланыВидовХарактеристик.ВидыСубконтоТиповые.ВидыПлатежейВБюджетИФонды);
	
	СчетКредита = Справочники.НалогиСборыОтчисления.ОбязательныеПенсионныеВзносы.СчетУчетаРасчетовСКонтрагентомБУ;
	Если НЕ ЗначениеЗаполнено(СчетКредита) Тогда
		СчетКредита = ПланыСчетов.Типовой.ОбязательстваПоПенсионнымОтчислениям;
	КонецЕсли;
	
	СчетКредитаНУ = ПроцедурыНалоговогоУчетаВызовСервераПовтИсп.ПолучитьСчетУчетаНУОПВ(СчетКредита,КонецМесяца(Параметры.ПериодРегистрации));
	
	Выборка = Запрос.Выполнить().Выбрать();
		
	Пока Выборка.Следующий() Цикл
		Строка = Параметры.ТаблицаОтражениеВУчете.Добавить();
		
		// Ставим на разные счета затрат в зависимости от вида платежа
		Если Выборка.ВидПлатежа = Перечисления.ВидыПлатежейВБюджетИФонды.Налог
			 Или Выборка.ВидПлатежа = Перечисления.ВидыПлатежейВБюджетИФонды.НалогАкт 
			 Или Выборка.ВидПлатежа = Перечисления.ВидыПлатежейВБюджетИФонды.НалогСам Тогда
			Строка.ВидРасчета	= ВидНалогаСбораОтчисленияОПВ;
			Строка.СчетДт 		= Выборка.СчетДт;
			Строка.СубконтоДт1 	= Выборка.СубконтоДт1;
			Строка.СубконтоДт2 	= Выборка.СубконтоДт2;
			Строка.СубконтоДт3 	= Выборка.СубконтоДт3;
			
			Строка.СчетДтНУ 		= Выборка.СчетДтНУ;
			Строка.СубконтоДтНУ1 	= Выборка.СубконтоДтНУ1;
			Строка.СубконтоДтНУ2 	= Выборка.СубконтоДтНУ2;
			Строка.СубконтоДтНУ3 	= Выборка.СубконтоДтНУ3;
		Иначе // Пеня по ОПВ
			Строка.ВидРасчета		= СтатьяЗатратПеняПоОПВ;
			Строка.СчетДт			= Выборка.СчетДт;
			Строка.СчетДтНУ 		= Выборка.СчетДтНУ;
			
			Если Выборка.НомерСубконтоСтатьиЗатратДт <> 0 Тогда
				Если ЗначениеЗаполнено(Выборка["СубконтоДт" + Выборка.НомерСубконтоСтатьиЗатратДт]) Тогда
					Строка["СубконтоДт" + Выборка.НомерСубконтоСтатьиЗатратДт] = Выборка["СубконтоДт" + Выборка.НомерСубконтоСтатьиЗатратДт];
				Иначе
					Строка["СубконтоДт" + Выборка.НомерСубконтоСтатьиЗатратДт] = СтатьяЗатратПеняПоОПВ;
				КонецЕсли;
				ОбщегоНазначенияБККлиентСервер.ЗаменитьСубконтоНУ(Строка, Строка.СчетДт, Строка.СчетДтНУ, Выборка.НомерСубконтоСтатьиЗатратДт, СтатьяЗатратПеняПоОПВ, "СубконтоДтНУ");
			КонецЕсли;
			Если Выборка.НомерСубконтоСтатьиЗатратДтНУ <> 0 Тогда
				Если ЗначениеЗаполнено(Выборка["СубконтоДтНУ" + Выборка.НомерСубконтоСтатьиЗатратДтНУ]) Тогда
					Строка["СубконтоДтНУ" + Выборка.НомерСубконтоСтатьиЗатратДтНУ] = Выборка["СубконтоДтНУ" + Выборка.НомерСубконтоСтатьиЗатратДтНУ];
				Иначе
					Строка["СубконтоДтНУ" + Выборка.НомерСубконтоСтатьиЗатратДтНУ] = СтатьяЗатратПеняПоОПВ;
				КонецЕсли;
			КонецЕсли;

			// Заполним оставшиеся субконто
			Для Ном = 1 По 3 Цикл
				Если НЕ ЗначениеЗаполнено(Строка["СубконтоДт" + Ном]) Тогда
					Строка["СубконтоДт" + Ном] = Выборка["СубконтоДт" + Ном];
				КонецЕсли;
				Если НЕ ЗначениеЗаполнено(Строка["СубконтоДтНУ" + Ном]) Тогда
					Если ЗначениеЗаполнено(Выборка["СубконтоДтНУ" + Ном]) Тогда
						Строка["СубконтоДтНУ" + Ном] = Выборка["СубконтоДтНУ" + Ном];
					Иначе
						ОбщегоНазначенияБККлиентСервер.ЗаменитьСубконтоНУ(Строка, СчетДебетаДляПени, СчетДебетаДляПениНУ, Ном, СтатьяЗатратПеняПоОПВ, "СубконтоДтНУ");
					КонецЕсли;
				КонецЕсли;
			КонецЦикла;
			
		КонецЕсли;
		
		Если Выборка.НомерСубконтоПодразделенияДт <> 0 Тогда
			Если ЗначениеЗаполнено(Выборка["СубконтоДт" + Выборка.НомерСубконтоПодразделенияДт]) Тогда
				Строка["СубконтоДт" + Выборка.НомерСубконтоПодразделенияДт] = Выборка["СубконтоДт" + Выборка.НомерСубконтоПодразделенияДт];
			Иначе 
				Строка["СубконтоДт" + Выборка.НомерСубконтоПодразделенияДт]= Выборка.ПодразделениеОрганизации;
			КонецЕсли;
			ОбщегоНазначенияБККлиентСервер.ЗаменитьСубконтоНУ(Строка, Строка.СчетДт, Строка.СчетДтНУ, Выборка.НомерСубконтоПодразделенияДт, Выборка.ПодразделениеОрганизации, "СубконтоДтНУ");
		КонецЕсли;
		Если Выборка.НомерСубконтоПодразделенияДтНУ <> 0 Тогда
			Если ЗначениеЗаполнено(Выборка["СубконтоДтНУ" + Выборка.НомерСубконтоПодразделенияДтНУ]) Тогда
				Строка["СубконтоДтНУ" + Выборка.НомерСубконтоПодразделенияДтНУ] = Выборка["СубконтоДтНУ" + Выборка.НомерСубконтоПодразделенияДтНУ];
			Иначе 
				Строка["СубконтоДтНУ" + Выборка.НомерСубконтоПодразделенияДтНУ]= Выборка.ПодразделениеОрганизации;
			КонецЕсли;
		КонецЕсли;
		
		Если ЗначениеЗаполнено(Выборка.СчетКт) Тогда
			Строка.СчетКт 		= Выборка.СчетКт;
			Строка.СубконтоКт1 	= Выборка.СубконтоКт1;
			Строка.СубконтоКт2 	= Выборка.СубконтоКт2;
			Строка.СубконтоКт3	= Выборка.СубконтоКт3;		
			
			Строка.СчетКтНУ 		= Выборка.СчетКтНУ;
			Строка.СубконтоКтНУ1 	= Выборка.СубконтоКтНУ1;
			Строка.СубконтоКтНУ2 	= Выборка.СубконтоКтНУ2;
			Строка.СубконтоКтНУ3	= Выборка.СубконтоКтНУ3;		
			
			// Проверяем заполнена ли аналитика по видам платежей, если нет, заполняем
			Если Выборка.НомерСубконтоВидыПлатежейКт <> 0 Тогда
				Если ЗначениеЗаполнено(Выборка["СубконтоКт" + Выборка.НомерСубконтоВидыПлатежейКт]) Тогда
					Строка["СубконтоКт" + Выборка.НомерСубконтоВидыПлатежейКт] = Выборка["СубконтоКт" + Выборка.НомерСубконтоВидыПлатежейКт];
				Иначе 
					Строка["СубконтоКт" + Выборка.НомерСубконтоВидыПлатежейКт]= Выборка.ВидПлатежа;
				КонецЕсли;
				ОбщегоНазначенияБККлиентСервер.ЗаменитьСубконтоНУ(Строка, Строка.СчетДт, Строка.СчетДтНУ, Выборка.НомерСубконтоВидыПлатежейКт, Выборка.ВидПлатежа, "СубконтоКтНУ");
			КонецЕсли;
			Если Выборка.НомерСубконтоВидыПлатежейКтНУ <> 0 Тогда
				Если ЗначениеЗаполнено(Выборка["СубконтоКтНУ" + Выборка.НомерСубконтоВидыПлатежейКтНУ]) Тогда
					Строка["СубконтоКтНУ" + Выборка.НомерСубконтоВидыПлатежейКтНУ] = Выборка["СубконтоКтНУ" + Выборка.НомерСубконтоВидыПлатежейКтНУ];
				Иначе 
					Строка["СубконтоКтНУ" + Выборка.НомерСубконтоВидыПлатежейКтНУ]= Выборка.ВидПлатежа;
				КонецЕсли;
			КонецЕсли;

			// Проверяем заполнена ли аналитика по работникам, если нет, заполняем
			Если ВедетсяУчетПоСотрудникам И Выборка.НомерСубконтоРаботникиОрганизацийКт <> 0 Тогда
				Если ЗначениеЗаполнено(Выборка["СубконтоКт" + Выборка.НомерСубконтоРаботникиОрганизацийКт]) Тогда
					Строка["СубконтоКт" + Выборка.НомерСубконтоРаботникиОрганизацийКт] = Выборка["СубконтоКт" + Выборка.НомерСубконтоРаботникиОрганизацийКт];
				Иначе 
					Строка["СубконтоКт" + Выборка.НомерСубконтоРаботникиОрганизацийКт]= Выборка.Физлицо;
				КонецЕсли;
				ОбщегоНазначенияБККлиентСервер.ЗаменитьСубконтоНУ(Строка, Строка.СчетДт, Строка.СчетДтНУ, Выборка.НомерСубконтоРаботникиОрганизацийКт, Выборка.Физлицо, "СубконтоКтНУ");
			КонецЕсли;
			Если ВедетсяУчетПоСотрудникам И Выборка.НомерСубконтоРаботникиОрганизацийКтНУ <> 0 Тогда
				Если ЗначениеЗаполнено(Выборка["СубконтоКтНУ" + Выборка.НомерСубконтоРаботникиОрганизацийКтНУ]) Тогда
					Строка["СубконтоКтНУ" + Выборка.НомерСубконтоРаботникиОрганизацийКтНУ] = Выборка["СубконтоКтНУ" + Выборка.НомерСубконтоРаботникиОрганизацийКтНУ];
				Иначе 
					Строка["СубконтоКтНУ" + Выборка.НомерСубконтоРаботникиОрганизацийКтНУ]= Выборка.Физлицо;
				КонецЕсли;
			КонецЕсли;
			
		Иначе 
			Строка.СчетКт 		= СчетКредита;
			Строка.СубконтоКт1 	= Справочники.НалогиСборыОтчисления.ОбязательныеПенсионныеВзносы;
			Строка.СубконтоКт2 	= Выборка.ВидПлатежа;
			Если ВедетсяУчетПоСотрудникам Тогда
				Строка.СубконтоКт3	= Выборка.Физлицо;		
			КонецЕсли;
			
			Строка.СчетКтНУ 	= СчетКредитаНУ;
			ОбщегоНазначенияБККлиентСервер.ЗаменитьСубконтоНУ(Строка, СчетКредита, СчетКредитаНУ, 1, Справочники.НалогиСборыОтчисления.ОбязательныеПенсионныеВзносы, "СубконтоКтНУ");
			ОбщегоНазначенияБККлиентСервер.ЗаменитьСубконтоНУ(Строка, СчетКредита, СчетКредитаНУ, 2, Выборка.ВидПлатежа, "СубконтоКтНУ");
			Если ВедетсяУчетПоСотрудникам Тогда
				ОбщегоНазначенияБККлиентСервер.ЗаменитьСубконтоНУ(Строка, СчетКредита, СчетКредитаНУ, 3, Выборка.Физлицо, "СубконтоКтНУ");   		
			КонецЕсли;
		КонецЕсли;
		
		Строка.Сумма		= Выборка.Взнос;
		Строка.ФизЛицо 		= Выборка.ФизЛицо;
		Строка.СтруктурноеПодразделениеДт = Параметры.СтруктурноеПодразделение;
		Строка.СтруктурноеПодразделениеКт = Параметры.СтруктурноеПодразделение;
	КонецЦикла;	
	
#КонецОбласти	

#Область ВОСМСзаИП	
	// Отражение ВОСМС за ИП
	Запрос.Текст =
		"ВЫБРАТЬ РАЗРЕШЕННЫЕ
		|	ВОСМСРасчетыСФондами.ФизЛицо,
		|	ВОСМСРасчетыСФондами.Организация,
		|	ВОСМСРасчетыСФондами.СтруктурнаяЕдиница,
		|	ВОСМСРасчетыСФондами.ПодразделениеОрганизации,
		|	ВОСМСРасчетыСФондами.МесяцНалоговогоПериода,
		|	ВОСМСРасчетыСФондами.ВидПлатежа,
		|	СУММА(ВОСМСРасчетыСФондами.Взнос) КАК Взнос,
		|	ВЫБОР
		|		КОГДА ВОСМСРасчетыСФондами.Регистратор ССЫЛКА Документ.РасчетПениОПВиСО
		|			ТОГДА ВОСМСРасчетыСФондами.Регистратор
		|		ИНАЧЕ НЕОПРЕДЕЛЕНО
		|	КОНЕЦ КАК Регистратор
		|ПОМЕСТИТЬ ВТ_ДанныеВОСМСЗаИП
		|ИЗ
		|	РегистрНакопления.ВОСМСРасчетыСФондами КАК ВОСМСРасчетыСФондами
		|		ЛЕВОЕ СОЕДИНЕНИЕ ВТ_УжеОтражено КАК УжеОтражено
		|		ПО ВОСМСРасчетыСФондами.ФизЛицо = УжеОтражено.ФизЛицо
		|ГДЕ
		|	ВОСМСРасчетыСФондами.Период >= &парамНачалоМесяца
		|	И ВОСМСРасчетыСФондами.Период <= &парамКонецМесяца
		|	И ВОСМСРасчетыСФондами.Организация = &парамОрганизация
		|	И ВОСМСРасчетыСФондами.ФизЛицо = &парамИндивидуальныйПредприниматель
		|	И ВОСМСРасчетыСФондами.ВидДвижения = &парамВидДвиженияПриход
		|	И ВОСМСРасчетыСФондами.ВидСтроки = &парамВидСтрокиИсчисление
		|	И ВОСМСРасчетыСФондами.Взнос <> 0
		|	И НЕ ВОСМСРасчетыСФондами.Регистратор ССЫЛКА Документ.ОтражениеНалоговойОтчетностиВРеглУчете
		|	И ВОСМСРасчетыСФондами.Активность
		|	И УжеОтражено.ФизЛицо ЕСТЬ NULL 
		|
		|СГРУППИРОВАТЬ ПО
		|	ВОСМСРасчетыСФондами.ФизЛицо,
		|	ВОСМСРасчетыСФондами.Организация,
		|	ВОСМСРасчетыСФондами.СтруктурнаяЕдиница,
		|	ВОСМСРасчетыСФондами.ПодразделениеОрганизации,
		|	ВОСМСРасчетыСФондами.МесяцНалоговогоПериода,
		|	ВОСМСРасчетыСФондами.ВидПлатежа,
		|	ВЫБОР
		|		КОГДА ВОСМСРасчетыСФондами.Регистратор ССЫЛКА Документ.РасчетПениОПВиСО
		|			ТОГДА ВОСМСРасчетыСФондами.Регистратор
		|		ИНАЧЕ НЕОПРЕДЕЛЕНО
		|	КОНЕЦ
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ РАЗРЕШЕННЫЕ
		|	ВОСМСРасчетыСФондами.ФизЛицо,
		|	ВЫБОР
		|		КОГДА ВОСМСРасчетыСФондами.ПодразделениеОрганизации = ЗНАЧЕНИЕ(Справочник.ПодразделенияОрганизаций.ПустаяСсылка)
		|			ТОГДА РегистрацияДоходов.ПодразделениеОрганизации
		|		ИНАЧЕ ВОСМСРасчетыСФондами.ПодразделениеОрганизации
		|	КОНЕЦ КАК ПодразделениеОрганизации,
		|	ВОСМСРасчетыСФондами.ВидПлатежа,
		|	ВОСМСРасчетыСФондами.Взнос КАК Взнос,
		|	ВЫБОР
		|		КОГДА ВОСМСРасчетыСФондами.ВидПлатежа В (ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.Налог), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогАкт), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогСам))
		|			ТОГДА ВЫБОР
		|					КОГДА РегистрацияДоходов.СпособОтраженияВБУ ЕСТЬ NULL 
		|							ИЛИ РегистрацияДоходов.СпособОтраженияВБУ = ЗНАЧЕНИЕ(Справочник.СпособыОтраженияЗарплатыВРеглУчете.ПустаяСсылка)
		|							ИЛИ РегистрацияДоходов.СпособОтраженияВБУ.СчетДт = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
		|						ТОГДА &парамСпособПоУмолчаниюСчетДт
		|					ИНАЧЕ РегистрацияДоходов.СпособОтраженияВБУ.СчетДт
		|				КОНЕЦ
		|		ИНАЧЕ ВЫБОР
		|				КОГДА РасчетПениОПВиСО.СчетЗатратБУ ЕСТЬ NULL 
		|						ИЛИ РасчетПениОПВиСО.СчетЗатратБУ = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
		|					ТОГДА &парамСчетДтДляПени
		|				ИНАЧЕ РасчетПениОПВиСО.СчетЗатратБУ
		|			КОНЕЦ
		|	КОНЕЦ КАК СчетДт,
		|	ВЫБОР
		|		КОГДА ВОСМСРасчетыСФондами.ВидПлатежа В (ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.Налог), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогАкт), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогСам))
		|			ТОГДА ВЫБОР
		|					КОГДА РегистрацияДоходов.СпособОтраженияВБУ ЕСТЬ NULL 
		|							ИЛИ РегистрацияДоходов.СпособОтраженияВБУ = ЗНАЧЕНИЕ(Справочник.СпособыОтраженияЗарплатыВРеглУчете.ПустаяСсылка)
		|							ИЛИ РегистрацияДоходов.СпособОтраженияВБУ.СчетДт = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
		|						ТОГДА &парамСпособПоУмолчаниюСубконтоДт1
		|					ИНАЧЕ РегистрацияДоходов.СпособОтраженияВБУ.СубконтоДт1
		|				КОНЕЦ
		|		ИНАЧЕ ВЫБОР
		|				КОГДА РасчетПениОПВиСО.СчетЗатратБУ ЕСТЬ NULL 
		|						ИЛИ РасчетПениОПВиСО.СчетЗатратБУ = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
		|					ТОГДА НЕОПРЕДЕЛЕНО
		|				ИНАЧЕ ЕСТЬNULL(РасчетПениОПВиСО.СубконтоЗатратБУ1, НЕОПРЕДЕЛЕНО)
		|			КОНЕЦ
		|	КОНЕЦ КАК СубконтоДт1,
		|	ВЫБОР
		|		КОГДА ВОСМСРасчетыСФондами.ВидПлатежа В (ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.Налог), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогАкт), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогСам))
		|			ТОГДА ВЫБОР
		|					КОГДА РегистрацияДоходов.СпособОтраженияВБУ ЕСТЬ NULL 
		|							ИЛИ РегистрацияДоходов.СпособОтраженияВБУ = ЗНАЧЕНИЕ(Справочник.СпособыОтраженияЗарплатыВРеглУчете.ПустаяСсылка)
		|							ИЛИ РегистрацияДоходов.СпособОтраженияВБУ.СчетДт = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
		|						ТОГДА &парамСпособПоУмолчаниюСубконтоДт2
		|					ИНАЧЕ РегистрацияДоходов.СпособОтраженияВБУ.СубконтоДт2
		|				КОНЕЦ
		|		ИНАЧЕ ВЫБОР
		|				КОГДА РасчетПениОПВиСО.СчетЗатратБУ ЕСТЬ NULL 
		|						ИЛИ РасчетПениОПВиСО.СчетЗатратБУ = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
		|					ТОГДА НЕОПРЕДЕЛЕНО
		|				ИНАЧЕ ЕСТЬNULL(РасчетПениОПВиСО.СубконтоЗатратБУ2, НЕОПРЕДЕЛЕНО)
		|			КОНЕЦ
		|	КОНЕЦ КАК СубконтоДт2,
		|	ВЫБОР
		|		КОГДА ВОСМСРасчетыСФондами.ВидПлатежа В (ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.Налог), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогАкт), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогСам))
		|			ТОГДА ВЫБОР
		|					КОГДА РегистрацияДоходов.СпособОтраженияВБУ ЕСТЬ NULL 
		|							ИЛИ РегистрацияДоходов.СпособОтраженияВБУ = ЗНАЧЕНИЕ(Справочник.СпособыОтраженияЗарплатыВРеглУчете.ПустаяСсылка)
		|							ИЛИ РегистрацияДоходов.СпособОтраженияВБУ.СчетДт = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
		|						ТОГДА &парамСпособПоУмолчаниюСубконтоДт3
		|					ИНАЧЕ РегистрацияДоходов.СпособОтраженияВБУ.СубконтоДт3
		|				КОНЕЦ
		|		ИНАЧЕ ВЫБОР
		|				КОГДА РасчетПениОПВиСО.СчетЗатратБУ ЕСТЬ NULL 
		|						ИЛИ РасчетПениОПВиСО.СчетЗатратБУ = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
		|					ТОГДА НЕОПРЕДЕЛЕНО
		|				ИНАЧЕ ЕСТЬNULL(РасчетПениОПВиСО.СубконтоЗатратБУ2, НЕОПРЕДЕЛЕНО)
		|			КОНЕЦ
		|	КОНЕЦ КАК СубконтоДт3,
		|	ВЫБОР
		|		КОГДА ВОСМСРасчетыСФондами.ВидПлатежа В (ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.Налог), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогАкт), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогСам))
		|			ТОГДА ВЫБОР
		|					КОГДА РегистрацияДоходов.СпособОтраженияВБУ ЕСТЬ NULL 
		|							ИЛИ РегистрацияДоходов.СпособОтраженияВБУ = ЗНАЧЕНИЕ(Справочник.СпособыОтраженияЗарплатыВРеглУчете.ПустаяСсылка)
		|							ИЛИ РегистрацияДоходов.СпособОтраженияВБУ.СчетДтНУ = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
		|						ТОГДА &парамСпособПоУмолчаниюСчетДтНУ
		|					ИНАЧЕ РегистрацияДоходов.СпособОтраженияВБУ.СчетДтНУ
		|				КОНЕЦ
		|		ИНАЧЕ ВЫБОР
		|				КОГДА РасчетПениОПВиСО.СчетЗатратНУ ЕСТЬ NULL 
		|						ИЛИ РасчетПениОПВиСО.СчетЗатратНУ = ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
		|					ТОГДА &парамСчетДтДляПениНУ
		|				ИНАЧЕ РасчетПениОПВиСО.СчетЗатратНУ
		|			КОНЕЦ
		|	КОНЕЦ КАК СчетДтНУ,
		|	ВЫБОР
		|		КОГДА ВОСМСРасчетыСФондами.ВидПлатежа В (ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.Налог), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогАкт), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогСам))
		|			ТОГДА ВЫБОР
		|					КОГДА РегистрацияДоходов.СпособОтраженияВБУ ЕСТЬ NULL 
		|							ИЛИ РегистрацияДоходов.СпособОтраженияВБУ = ЗНАЧЕНИЕ(Справочник.СпособыОтраженияЗарплатыВРеглУчете.ПустаяСсылка)
		|							ИЛИ РегистрацияДоходов.СпособОтраженияВБУ.СчетДтНУ = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
		|						ТОГДА &парамСпособПоУмолчаниюСубконтоДтНУ1
		|					ИНАЧЕ РегистрацияДоходов.СпособОтраженияВБУ.СубконтоДтНУ1
		|				КОНЕЦ
		|		ИНАЧЕ ВЫБОР
		|				КОГДА РасчетПениОПВиСО.СчетЗатратНУ ЕСТЬ NULL 
		|						ИЛИ РасчетПениОПВиСО.СчетЗатратНУ = ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
		|					ТОГДА НЕОПРЕДЕЛЕНО
		|				ИНАЧЕ ЕСТЬNULL(РасчетПениОПВиСО.СубконтоЗатратНУ1, НЕОПРЕДЕЛЕНО)
		|			КОНЕЦ
		|	КОНЕЦ КАК СубконтоДтНУ1,
		|	ВЫБОР
		|		КОГДА ВОСМСРасчетыСФондами.ВидПлатежа В (ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.Налог), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогАкт), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогСам))
		|			ТОГДА ВЫБОР
		|					КОГДА РегистрацияДоходов.СпособОтраженияВБУ ЕСТЬ NULL 
		|							ИЛИ РегистрацияДоходов.СпособОтраженияВБУ = ЗНАЧЕНИЕ(Справочник.СпособыОтраженияЗарплатыВРеглУчете.ПустаяСсылка)
		|							ИЛИ РегистрацияДоходов.СпособОтраженияВБУ.СчетДтНУ = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
		|						ТОГДА &парамСпособПоУмолчаниюСубконтоДтНУ2
		|					ИНАЧЕ РегистрацияДоходов.СпособОтраженияВБУ.СубконтоДтНУ2
		|				КОНЕЦ
		|		ИНАЧЕ ВЫБОР
		|				КОГДА РасчетПениОПВиСО.СчетЗатратНУ ЕСТЬ NULL 
		|						ИЛИ РасчетПениОПВиСО.СчетЗатратНУ = ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
		|					ТОГДА НЕОПРЕДЕЛЕНО
		|				ИНАЧЕ ЕСТЬNULL(РасчетПениОПВиСО.СубконтоЗатратНУ2, НЕОПРЕДЕЛЕНО)
		|			КОНЕЦ
		|	КОНЕЦ КАК СубконтоДтНУ2,
		|	ВЫБОР
		|		КОГДА ВОСМСРасчетыСФондами.ВидПлатежа В (ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.Налог), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогАкт), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогСам))
		|			ТОГДА ВЫБОР
		|					КОГДА РегистрацияДоходов.СпособОтраженияВБУ ЕСТЬ NULL 
		|							ИЛИ РегистрацияДоходов.СпособОтраженияВБУ = ЗНАЧЕНИЕ(Справочник.СпособыОтраженияЗарплатыВРеглУчете.ПустаяСсылка)
		|							ИЛИ РегистрацияДоходов.СпособОтраженияВБУ.СчетДтНУ = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
		|						ТОГДА &парамСпособПоУмолчаниюСубконтоДтНУ2
		|					ИНАЧЕ РегистрацияДоходов.СпособОтраженияВБУ.СубконтоДтНУ2
		|				КОНЕЦ
		|		ИНАЧЕ ВЫБОР
		|				КОГДА РасчетПениОПВиСО.СчетЗатратНУ ЕСТЬ NULL 
		|						ИЛИ РасчетПениОПВиСО.СчетЗатратНУ = ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
		|					ТОГДА НЕОПРЕДЕЛЕНО
		|				ИНАЧЕ ЕСТЬNULL(РасчетПениОПВиСО.СубконтоЗатратНУ2, НЕОПРЕДЕЛЕНО)
		|			КОНЕЦ
		|	КОНЕЦ КАК СубконтоДтНУ3,
		|	ВЫБОР
		|		КОГДА ВОСМСРасчетыСФондами.ВидПлатежа В (ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.Налог), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогАкт), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогСам))
		|			ТОГДА ЕСТЬNULL(РегистрацияДоходов.СпособОтраженияВБУ.СчетКт, НЕОПРЕДЕЛЕНО)
		|		ИНАЧЕ НЕОПРЕДЕЛЕНО
		|	КОНЕЦ КАК СчетКт,
		|	ВЫБОР
		|		КОГДА ВОСМСРасчетыСФондами.ВидПлатежа В (ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.Налог), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогАкт), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогСам))
		|			ТОГДА ЕСТЬNULL(РегистрацияДоходов.СпособОтраженияВБУ.СубконтоКт1, НЕОПРЕДЕЛЕНО)
		|		ИНАЧЕ НЕОПРЕДЕЛЕНО
		|	КОНЕЦ КАК СубконтоКт1,
		|	ВЫБОР
		|		КОГДА ВОСМСРасчетыСФондами.ВидПлатежа В (ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.Налог), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогАкт), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогСам))
		|			ТОГДА ЕСТЬNULL(РегистрацияДоходов.СпособОтраженияВБУ.СубконтоКт2, НЕОПРЕДЕЛЕНО)
		|		ИНАЧЕ НЕОПРЕДЕЛЕНО
		|	КОНЕЦ КАК СубконтоКт2,
		|	ВЫБОР
		|		КОГДА ВОСМСРасчетыСФондами.ВидПлатежа В (ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.Налог), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогАкт), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогСам))
		|			ТОГДА ЕСТЬNULL(РегистрацияДоходов.СпособОтраженияВБУ.СубконтоКт3, НЕОПРЕДЕЛЕНО)
		|		ИНАЧЕ НЕОПРЕДЕЛЕНО
		|	КОНЕЦ КАК СубконтоКт3,
		|	ВЫБОР
		|		КОГДА ВОСМСРасчетыСФондами.ВидПлатежа В (ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.Налог), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогАкт), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогСам))
		|			ТОГДА ЕСТЬNULL(РегистрацияДоходов.СпособОтраженияВБУ.СчетКтНУ, НЕОПРЕДЕЛЕНО)
		|		ИНАЧЕ НЕОПРЕДЕЛЕНО
		|	КОНЕЦ КАК СчетКтНУ,
		|	ВЫБОР
		|		КОГДА ВОСМСРасчетыСФондами.ВидПлатежа В (ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.Налог), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогАкт), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогСам))
		|			ТОГДА ЕСТЬNULL(РегистрацияДоходов.СпособОтраженияВБУ.СубконтоКтНУ1, НЕОПРЕДЕЛЕНО)
		|		ИНАЧЕ НЕОПРЕДЕЛЕНО
		|	КОНЕЦ КАК СубконтоКтНУ1,
		|	ВЫБОР
		|		КОГДА ВОСМСРасчетыСФондами.ВидПлатежа В (ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.Налог), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогАкт), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогСам))
		|			ТОГДА ЕСТЬNULL(РегистрацияДоходов.СпособОтраженияВБУ.СубконтоКтНУ2, НЕОПРЕДЕЛЕНО)
		|		ИНАЧЕ НЕОПРЕДЕЛЕНО
		|	КОНЕЦ КАК СубконтоКтНУ2,
		|	ВЫБОР
		|		КОГДА ВОСМСРасчетыСФондами.ВидПлатежа В (ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.Налог), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогАкт), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогСам))
		|			ТОГДА ЕСТЬNULL(РегистрацияДоходов.СпособОтраженияВБУ.СубконтоКтНУ3, НЕОПРЕДЕЛЕНО)
		|		ИНАЧЕ НЕОПРЕДЕЛЕНО
		|	КОНЕЦ КАК СубконтоКтНУ3,
		|	ВЫБОР
		|		КОГДА ВОСМСРасчетыСФондами.ВидПлатежа В (ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.Налог), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогАкт), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогСам))
		|			ТОГДА ЕСТЬNULL(ВидСубконтоСтатьиЗатрат.НомерСтроки, 0)
		|		ИНАЧЕ ЕСТЬNULL(ВидСубконтоСтатьиЗатратДляПени.НомерСтроки, 0)
		|	КОНЕЦ КАК НомерСубконтоСтатьиЗатратДт,
		|	ВЫБОР
		|		КОГДА ВОСМСРасчетыСФондами.ВидПлатежа В (ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.Налог), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогАкт), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогСам))
		|			ТОГДА ЕСТЬNULL(ВидСубконтоПодразделения.НомерСтроки, 0)
		|		ИНАЧЕ ЕСТЬNULL(ВидСубконтоПодразделенияДляПени.НомерСтроки, 0)
		|	КОНЕЦ КАК НомерСубконтоПодразделенияДт,
		|	ВЫБОР
		|		КОГДА ВОСМСРасчетыСФондами.ВидПлатежа В (ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.Налог), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогАкт), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогСам))
		|			ТОГДА ЕСТЬNULL(ВидСубконтоСтатьиЗатратНУ.НомерСтроки, 0)
		|		ИНАЧЕ ЕСТЬNULL(ВидСубконтоСтатьиЗатратДляПениНУ.НомерСтроки, 0)
		|	КОНЕЦ КАК НомерСубконтоСтатьиЗатратДтНУ,
		|	ВЫБОР
		|		КОГДА ВОСМСРасчетыСФондами.ВидПлатежа В (ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.Налог), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогАкт), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогСам))
		|			ТОГДА ЕСТЬNULL(ВидСубконтоПодразделенияНУ.НомерСтроки, 0)
		|		ИНАЧЕ ЕСТЬNULL(ВидСубконтоПодразделенияДляПениНУ.НомерСтроки, 0)
		|	КОНЕЦ КАК НомерСубконтоПодразделенияДтНУ,
		|	ВЫБОР
		|		КОГДА ВОСМСРасчетыСФондами.ВидПлатежа В (ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.Налог), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогАкт), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогСам))
		|			ТОГДА ЕСТЬNULL(ВидСубконтоРаботникиОрганизаций.НомерСтроки, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ КАК НомерСубконтоРаботникиОрганизацийКт,
		|	ВЫБОР
		|		КОГДА ВОСМСРасчетыСФондами.ВидПлатежа В (ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.Налог), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогАкт), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогСам))
		|			ТОГДА ЕСТЬNULL(ВидСубконтоРаботникиОрганизацийНУ.НомерСтроки, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ КАК НомерСубконтоРаботникиОрганизацийКтНУ,
		|	ВЫБОР
		|		КОГДА ВОСМСРасчетыСФондами.ВидПлатежа В (ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.Налог), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогАкт), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогСам))
		|			ТОГДА ЕСТЬNULL(ВидСубконтоВидыПлатежей.НомерСтроки, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ КАК НомерСубконтоВидыПлатежейКт,
		|	ВЫБОР
		|		КОГДА ВОСМСРасчетыСФондами.ВидПлатежа В (ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.Налог), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогАкт), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогСам))
		|			ТОГДА ЕСТЬNULL(ВидСубконтоВидыПлатежей.НомерСтроки, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ КАК НомерСубконтоВидыПлатежейКтНУ
		|ИЗ
		|	ВТ_ДанныеВОСМСЗаИП КАК ВОСМСРасчетыСФондами
		|		ЛЕВОЕ СОЕДИНЕНИЕ ВТ_ДанныеРегистрацииДоходов КАК РегистрацияДоходов
		|		ПО (ЕСТЬNULL(РегистрацияДоходов.УчитыватьВОСМС, ЛОЖЬ))
		|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Типовой.ВидыСубконто КАК ВидСубконтоСтатьиЗатрат
		|		ПО (ВидСубконтоСтатьиЗатрат.Ссылка = ВЫБОР
		|				КОГДА РегистрацияДоходов.СпособОтраженияВБУ ЕСТЬ NULL 
		|						ИЛИ РегистрацияДоходов.СпособОтраженияВБУ.СчетДт = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
		|					ТОГДА &парамСпособПоУмолчаниюСчетДт
		|				ИНАЧЕ РегистрацияДоходов.СпособОтраженияВБУ.СчетДт
		|			КОНЕЦ)
		|			И (ВидСубконтоСтатьиЗатрат.ВидСубконто = &парамВидСубконтоСтатьиЗатрат)
		|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Типовой.ВидыСубконто КАК ВидСубконтоПодразделения
		|		ПО (ВидСубконтоПодразделения.Ссылка = ВЫБОР
		|				КОГДА РегистрацияДоходов.СпособОтраженияВБУ ЕСТЬ NULL 
		|						ИЛИ РегистрацияДоходов.СпособОтраженияВБУ.СчетДт = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
		|					ТОГДА &парамСпособПоУмолчаниюСчетДт
		|				ИНАЧЕ РегистрацияДоходов.СпособОтраженияВБУ.СчетДт
		|			КОНЕЦ)
		|			И (ВидСубконтоПодразделения.ВидСубконто = &парамВидСубконтоПодразделения)
		|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Налоговый.ВидыСубконто КАК ВидСубконтоСтатьиЗатратНУ
		|		ПО (ВидСубконтоСтатьиЗатратНУ.Ссылка = ВЫБОР
		|				КОГДА РегистрацияДоходов.СпособОтраженияВБУ.СчетДтНУ ЕСТЬ NULL 
		|						ИЛИ РегистрацияДоходов.СпособОтраженияВБУ.СчетДтНУ = ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
		|					ТОГДА &парамСпособПоУмолчаниюСчетДтНУ
		|				ИНАЧЕ РегистрацияДоходов.СпособОтраженияВБУ.СчетДтНУ
		|			КОНЕЦ)
		|			И (ВидСубконтоСтатьиЗатратНУ.ВидСубконто = &парамВидСубконтоСтатьиЗатрат)
		|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Налоговый.ВидыСубконто КАК ВидСубконтоПодразделенияНУ
		|		ПО (ВидСубконтоПодразделенияНУ.Ссылка = ВЫБОР
		|				КОГДА РегистрацияДоходов.СпособОтраженияВБУ.СчетДтНУ ЕСТЬ NULL 
		|						ИЛИ РегистрацияДоходов.СпособОтраженияВБУ.СчетДтНУ = ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
		|					ТОГДА &парамСпособПоУмолчаниюСчетДтНУ
		|				ИНАЧЕ РегистрацияДоходов.СпособОтраженияВБУ.СчетДтНУ
		|			КОНЕЦ)
		|			И (ВидСубконтоПодразделенияНУ.ВидСубконто = &парамВидСубконтоПодразделения)
		|		ЛЕВОЕ СОЕДИНЕНИЕ Документ.РасчетПениОПВиСО КАК РасчетПениОПВиСО
		|		ПО ВОСМСРасчетыСФондами.Регистратор = РасчетПениОПВиСО.Ссылка
		|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Типовой.ВидыСубконто КАК ВидСубконтоСтатьиЗатратДляПени
		|		ПО (ВидСубконтоСтатьиЗатратДляПени.Ссылка = ВЫБОР
		|				КОГДА РасчетПениОПВиСО.СчетЗатратБУ ЕСТЬ NULL 
		|						ИЛИ РасчетПениОПВиСО.СчетЗатратБУ = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
		|					ТОГДА &парамСчетДтДляПени
		|				ИНАЧЕ РасчетПениОПВиСО.СчетЗатратБУ
		|			КОНЕЦ)
		|			И (ВидСубконтоСтатьиЗатратДляПени.ВидСубконто = &парамВидСубконтоСтатьиЗатрат)
		|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Типовой.ВидыСубконто КАК ВидСубконтоПодразделенияДляПени
		|		ПО (ВидСубконтоПодразделенияДляПени.Ссылка = ВЫБОР
		|				КОГДА РасчетПениОПВиСО.СчетЗатратБУ ЕСТЬ NULL 
		|						ИЛИ РасчетПениОПВиСО.СчетЗатратБУ = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
		|					ТОГДА &парамСчетДтДляПени
		|				ИНАЧЕ РасчетПениОПВиСО.СчетЗатратБУ
		|			КОНЕЦ)
		|			И (ВидСубконтоПодразделенияДляПени.ВидСубконто = &парамВидСубконтоПодразделения)
		|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Налоговый.ВидыСубконто КАК ВидСубконтоСтатьиЗатратДляПениНУ
		|		ПО (ВидСубконтоСтатьиЗатратДляПениНУ.Ссылка = ВЫБОР
		|				КОГДА РасчетПениОПВиСО.СчетЗатратНУ ЕСТЬ NULL 
		|						ИЛИ РасчетПениОПВиСО.СчетЗатратНУ = ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
		|					ТОГДА &парамСчетДтДляПениНУ
		|				ИНАЧЕ РасчетПениОПВиСО.СчетЗатратНУ
		|			КОНЕЦ)
		|			И (ВидСубконтоСтатьиЗатратДляПениНУ.ВидСубконто = &парамВидСубконтоСтатьиЗатрат)
		|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Налоговый.ВидыСубконто КАК ВидСубконтоПодразделенияДляПениНУ
		|		ПО (ВидСубконтоПодразделенияДляПениНУ.Ссылка = ВЫБОР
		|				КОГДА РасчетПениОПВиСО.СчетЗатратНУ ЕСТЬ NULL 
		|						ИЛИ РасчетПениОПВиСО.СчетЗатратНУ = ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
		|					ТОГДА &парамСчетДтДляПениНУ
		|				ИНАЧЕ РасчетПениОПВиСО.СчетЗатратНУ
		|			КОНЕЦ)
		|			И (ВидСубконтоПодразделенияДляПениНУ.ВидСубконто = &парамВидСубконтоПодразделения)
		|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Типовой.ВидыСубконто КАК ВидСубконтоРаботникиОрганизаций
		|		ПО (ВидСубконтоРаботникиОрганизаций.Ссылка = ВЫБОР
		|				КОГДА РегистрацияДоходов.СпособОтраженияВБУ ЕСТЬ NULL 
		|						ИЛИ РегистрацияДоходов.СпособОтраженияВБУ.СчетКт = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
		|					ТОГДА НЕОПРЕДЕЛЕНО
		|				ИНАЧЕ РегистрацияДоходов.СпособОтраженияВБУ.СчетКт
		|			КОНЕЦ)
		|			И (ВидСубконтоРаботникиОрганизаций.ВидСубконто = &парамВидСубконтоРаботникиОрганизаций)
		|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Типовой.ВидыСубконто КАК ВидСубконтоВидыПлатежей
		|		ПО (ВидСубконтоВидыПлатежей.Ссылка = ВЫБОР
		|				КОГДА РегистрацияДоходов.СпособОтраженияВБУ ЕСТЬ NULL 
		|						ИЛИ РегистрацияДоходов.СпособОтраженияВБУ.СчетКт = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
		|					ТОГДА НЕОПРЕДЕЛЕНО
		|				ИНАЧЕ РегистрацияДоходов.СпособОтраженияВБУ.СчетКт
		|			КОНЕЦ)
		|			И (ВидСубконтоВидыПлатежей.ВидСубконто = &парамВидСубконтоВидыПлатежей)
		|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Налоговый.ВидыСубконто КАК ВидСубконтоРаботникиОрганизацийНУ
		|		ПО (ВидСубконтоРаботникиОрганизацийНУ.Ссылка = ВЫБОР
		|				КОГДА РегистрацияДоходов.СпособОтраженияВБУ ЕСТЬ NULL 
		|						ИЛИ РегистрацияДоходов.СпособОтраженияВБУ.СчетКтНУ = ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
		|					ТОГДА НЕОПРЕДЕЛЕНО
		|				ИНАЧЕ РегистрацияДоходов.СпособОтраженияВБУ.СчетКтНУ
		|			КОНЕЦ)
		|			И (ВидСубконтоРаботникиОрганизацийНУ.ВидСубконто = &парамВидСубконтоРаботникиОрганизаций)
		|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Налоговый.ВидыСубконто КАК ВидСубконтоВидыПлатежейНУ
		|		ПО (ВидСубконтоВидыПлатежейНУ.Ссылка = ВЫБОР
		|				КОГДА РегистрацияДоходов.СпособОтраженияВБУ ЕСТЬ NULL 
		|						ИЛИ РегистрацияДоходов.СпособОтраженияВБУ.СчетКтНУ = ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
		|					ТОГДА НЕОПРЕДЕЛЕНО
		|				ИНАЧЕ РегистрацияДоходов.СпособОтраженияВБУ.СчетКтНУ
		|			КОНЕЦ)
		|			И (ВидСубконтоВидыПлатежейНУ.ВидСубконто = &парамВидСубконтоВидыПлатежей)
		|ГДЕ
		|	ВЫБОР
		|			КОГДА ВОСМСРасчетыСФондами.ВидПлатежа В (ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.Налог), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогАкт), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогСам))
		|				ТОГДА РегистрацияДоходов.СпособОтраженияВБУ <> ЗНАЧЕНИЕ(Справочник.СпособыОтраженияЗарплатыВРеглУчете.НеОтражатьВБухучете)
		|			ИНАЧЕ ИСТИНА
		|		КОНЕЦ";

	СпособПоУмолчанию = Справочники.СпособыОтраженияЗарплатыВРеглУчете.ОтражениеНачисленийПоУмолчанию;
	Запрос.УстановитьПараметр("парамСпособПоУмолчанию", СпособПоУмолчанию);
	Запрос.УстановитьПараметр("парамСпособПоУмолчаниюСчетДт", СпособПоУмолчанию.СчетДт);
	Запрос.УстановитьПараметр("парамСпособПоУмолчаниюСубконтоДт1", СпособПоУмолчанию.СубконтоДт1);
	Запрос.УстановитьПараметр("парамСпособПоУмолчаниюСубконтоДт2", СпособПоУмолчанию.СубконтоДт2);
	Запрос.УстановитьПараметр("парамСпособПоУмолчаниюСубконтоДт3", СпособПоУмолчанию.СубконтоДт3);
	Запрос.УстановитьПараметр("парамСпособПоУмолчаниюСчетДтНУ",    СпособПоУмолчанию.СчетДтНУ);
	Запрос.УстановитьПараметр("парамСпособПоУмолчаниюСубконтоДтНУ1", СпособПоУмолчанию.СубконтоДтНУ1);
	Запрос.УстановитьПараметр("парамСпособПоУмолчаниюСубконтоДтНУ2", СпособПоУмолчанию.СубконтоДтНУ2);
	Запрос.УстановитьПараметр("парамСпособПоУмолчаниюСубконтоДтНУ3", СпособПоУмолчанию.СубконтоДтНУ3);
	Запрос.УстановитьПараметр("парамВидСубконтоВидыПлатежей", ПланыВидовХарактеристик.ВидыСубконтоТиповые.ВидыПлатежейВБюджетИФонды);
	
	СчетКредита = Справочники.НалогиСборыОтчисления.ВзносыОбязательноеСоциальноеМедицинскоеСтрахование.СчетУчетаРасчетовСКонтрагентомБУ;
	Если НЕ ЗначениеЗаполнено(СчетКредита) Тогда
		СчетКредита = ПланыСчетов.Типовой.ОбязательстваПоВзносамОСМС;
	КонецЕсли;
	
	СчетКредитаНУ = ПроцедурыНалоговогоУчетаВызовСервераПовтИсп.ПолучитьСчетУчетаНУВОСМС(СчетКредита,КонецМесяца(Параметры.ПериодРегистрации));
	
	Выборка = Запрос.Выполнить().Выбрать();
		
	Пока Выборка.Следующий() Цикл
		Строка = Параметры.ТаблицаОтражениеВУчете.Добавить();
		
		// Ставим на разные счета затрат в зависимости от вида платежа
		Если Выборка.ВидПлатежа = Перечисления.ВидыПлатежейВБюджетИФонды.Налог
			 Или Выборка.ВидПлатежа = Перечисления.ВидыПлатежейВБюджетИФонды.НалогАкт 
			 Или Выборка.ВидПлатежа = Перечисления.ВидыПлатежейВБюджетИФонды.НалогСам Тогда
			Строка.ВидРасчета	= ВидНалогаСбораОтчисленияВОСМС;
			Строка.СчетДт 		= Выборка.СчетДт;
			Строка.СубконтоДт1 	= Выборка.СубконтоДт1;
			Строка.СубконтоДт2 	= Выборка.СубконтоДт2;
			Строка.СубконтоДт3 	= Выборка.СубконтоДт3;
			
			Строка.СчетДтНУ 		= Выборка.СчетДтНУ;
			Строка.СубконтоДтНУ1 	= Выборка.СубконтоДтНУ1;
			Строка.СубконтоДтНУ2 	= Выборка.СубконтоДтНУ2;
			Строка.СубконтоДтНУ3 	= Выборка.СубконтоДтНУ3;
		Иначе // Пеня по ВОСМС
			Строка.ВидРасчета		= СтатьяЗатратПеняПоВОСМС;
			Строка.СчетДт			= Выборка.СчетДт;
			Строка.СчетДтНУ 		= Выборка.СчетДтНУ;
			
			Если Выборка.НомерСубконтоСтатьиЗатратДт <> 0 Тогда
				Если ЗначениеЗаполнено(Выборка["СубконтоДт" + Выборка.НомерСубконтоСтатьиЗатратДт]) Тогда
					Строка["СубконтоДт" + Выборка.НомерСубконтоСтатьиЗатратДт] = Выборка["СубконтоДт" + Выборка.НомерСубконтоСтатьиЗатратДт];
				Иначе
					Строка["СубконтоДт" + Выборка.НомерСубконтоСтатьиЗатратДт] = СтатьяЗатратПеняПоВОСМС;
				КонецЕсли;
				ОбщегоНазначенияБККлиентСервер.ЗаменитьСубконтоНУ(Строка, Строка.СчетДт, Строка.СчетДтНУ, Выборка.НомерСубконтоСтатьиЗатратДт, СтатьяЗатратПеняПоВОСМС, "СубконтоДтНУ");
			КонецЕсли;
			Если Выборка.НомерСубконтоСтатьиЗатратДтНУ <> 0 Тогда
				Если ЗначениеЗаполнено(Выборка["СубконтоДтНУ" + Выборка.НомерСубконтоСтатьиЗатратДтНУ]) Тогда
					Строка["СубконтоДтНУ" + Выборка.НомерСубконтоСтатьиЗатратДтНУ] = Выборка["СубконтоДтНУ" + Выборка.НомерСубконтоСтатьиЗатратДтНУ];
				Иначе
					Строка["СубконтоДтНУ" + Выборка.НомерСубконтоСтатьиЗатратДтНУ] = СтатьяЗатратПеняПоВОСМС;
				КонецЕсли;
			КонецЕсли;

			// Заполним оставшиеся субконто
			Для Ном = 1 По 3 Цикл
				Если НЕ ЗначениеЗаполнено(Строка["СубконтоДт" + Ном]) Тогда
					Строка["СубконтоДт" + Ном] = Выборка["СубконтоДт" + Ном];
				КонецЕсли;
				Если НЕ ЗначениеЗаполнено(Строка["СубконтоДтНУ" + Ном]) Тогда
					Если ЗначениеЗаполнено(Выборка["СубконтоДтНУ" + Ном]) Тогда
						Строка["СубконтоДтНУ" + Ном] = Выборка["СубконтоДтНУ" + Ном];
					Иначе
						ОбщегоНазначенияБККлиентСервер.ЗаменитьСубконтоНУ(Строка, СчетДебетаДляПени, СчетДебетаДляПениНУ, Ном, СтатьяЗатратПеняПоВОСМС, "СубконтоДтНУ");
					КонецЕсли;
				КонецЕсли;
			КонецЦикла;
			
		КонецЕсли;
		
		Если Выборка.НомерСубконтоПодразделенияДт <> 0 Тогда
			Если ЗначениеЗаполнено(Выборка["СубконтоДт" + Выборка.НомерСубконтоПодразделенияДт]) Тогда
				Строка["СубконтоДт" + Выборка.НомерСубконтоПодразделенияДт] = Выборка["СубконтоДт" + Выборка.НомерСубконтоПодразделенияДт];
			Иначе 
				Строка["СубконтоДт" + Выборка.НомерСубконтоПодразделенияДт]= Выборка.ПодразделениеОрганизации;
			КонецЕсли;
			ОбщегоНазначенияБККлиентСервер.ЗаменитьСубконтоНУ(Строка, Строка.СчетДт, Строка.СчетДтНУ, Выборка.НомерСубконтоПодразделенияДт, Выборка.ПодразделениеОрганизации, "СубконтоДтНУ");
		КонецЕсли;
		Если Выборка.НомерСубконтоПодразделенияДтНУ <> 0 Тогда
			Если ЗначениеЗаполнено(Выборка["СубконтоДтНУ" + Выборка.НомерСубконтоПодразделенияДтНУ]) Тогда
				Строка["СубконтоДтНУ" + Выборка.НомерСубконтоПодразделенияДтНУ] = Выборка["СубконтоДтНУ" + Выборка.НомерСубконтоПодразделенияДтНУ];
			Иначе 
				Строка["СубконтоДтНУ" + Выборка.НомерСубконтоПодразделенияДтНУ]= Выборка.ПодразделениеОрганизации;
			КонецЕсли;
		КонецЕсли;
		
		Если ЗначениеЗаполнено(Выборка.СчетКт) Тогда
			Строка.СчетКт 		= Выборка.СчетКт;
			Строка.СубконтоКт1 	= Выборка.СубконтоКт1;
			Строка.СубконтоКт2 	= Выборка.СубконтоКт2;
			Строка.СубконтоКт3	= Выборка.СубконтоКт3;		
			
			Строка.СчетКтНУ 		= Выборка.СчетКтНУ;
			Строка.СубконтоКтНУ1 	= Выборка.СубконтоКтНУ1;
			Строка.СубконтоКтНУ2 	= Выборка.СубконтоКтНУ2;
			Строка.СубконтоКтНУ3	= Выборка.СубконтоКтНУ3;		
			
			// Проверяем заполнена ли аналитика по видам платежей, если нет, заполняем
			Если Выборка.НомерСубконтоВидыПлатежейКт <> 0 Тогда
				Если ЗначениеЗаполнено(Выборка["СубконтоКт" + Выборка.НомерСубконтоВидыПлатежейКт]) Тогда
					Строка["СубконтоКт" + Выборка.НомерСубконтоВидыПлатежейКт] = Выборка["СубконтоКт" + Выборка.НомерСубконтоВидыПлатежейКт];
				Иначе 
					Строка["СубконтоКт" + Выборка.НомерСубконтоВидыПлатежейКт]= Выборка.ВидПлатежа;
				КонецЕсли;
				ОбщегоНазначенияБККлиентСервер.ЗаменитьСубконтоНУ(Строка, Строка.СчетДт, Строка.СчетДтНУ, Выборка.НомерСубконтоВидыПлатежейКт, Выборка.ВидПлатежа, "СубконтоКтНУ");
			КонецЕсли;
			Если Выборка.НомерСубконтоВидыПлатежейКтНУ <> 0 Тогда
				Если ЗначениеЗаполнено(Выборка["СубконтоКтНУ" + Выборка.НомерСубконтоВидыПлатежейКтНУ]) Тогда
					Строка["СубконтоКтНУ" + Выборка.НомерСубконтоВидыПлатежейКтНУ] = Выборка["СубконтоКтНУ" + Выборка.НомерСубконтоВидыПлатежейКтНУ];
				Иначе 
					Строка["СубконтоКтНУ" + Выборка.НомерСубконтоВидыПлатежейКтНУ]= Выборка.ВидПлатежа;
				КонецЕсли;
			КонецЕсли;

			// Проверяем заполнена ли аналитика по работникам, если нет, заполняем
			Если ВедетсяУчетПоСотрудникам И Выборка.НомерСубконтоРаботникиОрганизацийКт <> 0 Тогда
				Если ЗначениеЗаполнено(Выборка["СубконтоКт" + Выборка.НомерСубконтоРаботникиОрганизацийКт]) Тогда
					Строка["СубконтоКт" + Выборка.НомерСубконтоРаботникиОрганизацийКт] = Выборка["СубконтоКт" + Выборка.НомерСубконтоРаботникиОрганизацийКт];
				Иначе 
					Строка["СубконтоКт" + Выборка.НомерСубконтоРаботникиОрганизацийКт]= Выборка.Физлицо;
				КонецЕсли;
				ОбщегоНазначенияБККлиентСервер.ЗаменитьСубконтоНУ(Строка, Строка.СчетДт, Строка.СчетДтНУ, Выборка.НомерСубконтоРаботникиОрганизацийКт, Выборка.Физлицо, "СубконтоКтНУ");
			КонецЕсли;
			Если ВедетсяУчетПоСотрудникам И Выборка.НомерСубконтоРаботникиОрганизацийКтНУ <> 0 Тогда
				Если ЗначениеЗаполнено(Выборка["СубконтоКтНУ" + Выборка.НомерСубконтоРаботникиОрганизацийКтНУ]) Тогда
					Строка["СубконтоКтНУ" + Выборка.НомерСубконтоРаботникиОрганизацийКтНУ] = Выборка["СубконтоКтНУ" + Выборка.НомерСубконтоРаботникиОрганизацийКтНУ];
				Иначе 
					Строка["СубконтоКтНУ" + Выборка.НомерСубконтоРаботникиОрганизацийКтНУ]= Выборка.Физлицо;
				КонецЕсли;
			КонецЕсли;
			
		Иначе 
			Строка.СчетКт 		= СчетКредита;
			Строка.СубконтоКт1 	= Выборка.ВидПлатежа;
			Если ВедетсяУчетПоСотрудникам Тогда
				Строка.СубконтоКт2	= Выборка.Физлицо;		
			КонецЕсли;
			
			Строка.СчетКтНУ 	= СчетКредитаНУ;
			ОбщегоНазначенияБККлиентСервер.ЗаменитьСубконтоНУ(Строка, СчетКредита, СчетКредитаНУ, 1, Выборка.ВидПлатежа, "СубконтоКтНУ");
			
			Если ВедетсяУчетПоСотрудникам Тогда
				ОбщегоНазначенияБККлиентСервер.ЗаменитьСубконтоНУ(Строка, СчетКредита, СчетКредитаНУ, 2, Выборка.Физлицо, "СубконтоКтНУ");   		
			КонецЕсли;
		КонецЕсли;
		
		Строка.Сумма		= Выборка.Взнос;
		Строка.ФизЛицо 		= Выборка.ФизЛицо;
		Строка.СтруктурноеПодразделениеДт = Параметры.СтруктурноеПодразделение;
		Строка.СтруктурноеПодразделениеКт = Параметры.СтруктурноеПодразделение;
	КонецЦикла;	
	
#КонецОбласти	

#Область СОзаИП

	// Отражение СО за ИП
	Запрос.Текст =
		"ВЫБРАТЬ РАЗРЕШЕННЫЕ
		|	СОРасчетыСФондами.ФизЛицо,
		|	СОРасчетыСФондами.Организация,
		|	СОРасчетыСФондами.СтруктурнаяЕдиница,
		|	СОРасчетыСФондами.ПодразделениеОрганизации,
		|	СОРасчетыСФондами.МесяцНалоговогоПериода,
		|	СОРасчетыСФондами.ВидПлатежа,
		|	СУММА(СОРасчетыСФондами.Отчисление) КАК Отчисление,
		|	ВЫБОР
		|		КОГДА СОРасчетыСФондами.Регистратор ССЫЛКА Документ.РасчетПениОПВиСО
		|			ТОГДА СОРасчетыСФондами.Регистратор
		|		ИНАЧЕ НЕОПРЕДЕЛЕНО
		|	КОНЕЦ КАК Регистратор
		|ПОМЕСТИТЬ ВТ_ДанныеСОЗаИП
		|ИЗ
		|	РегистрНакопления.СОРасчетыСФондами КАК СОРасчетыСФондами
		|		ЛЕВОЕ СОЕДИНЕНИЕ ВТ_УжеОтражено КАК УжеОтражено
		|		ПО СОРасчетыСФондами.ФизЛицо = УжеОтражено.ФизЛицо
		|ГДЕ
		|	СОРасчетыСФондами.Период >= &парамНачалоМесяца
		|	И СОРасчетыСФондами.Период <= &парамКонецМесяца
		|	И СОРасчетыСФондами.Организация = &парамОрганизация
		|	И СОРасчетыСФондами.ФизЛицо = &парамИндивидуальныйПредприниматель
		|	И СОРасчетыСФондами.ВидДвижения = &парамВидДвиженияПриход
		|	И СОРасчетыСФондами.ВидСтроки = &парамВидСтрокиИсчисление
		|	И СОРасчетыСФондами.Отчисление <> 0
		|	И НЕ СОРасчетыСФондами.Регистратор ССЫЛКА Документ.ОтражениеНалоговойОтчетностиВРеглУчете
		|	И УжеОтражено.ФизЛицо ЕСТЬ NULL
		|	И СОРасчетыСФондами.Активность
		|
		|СГРУППИРОВАТЬ ПО
		|	СОРасчетыСФондами.ФизЛицо,
		|	СОРасчетыСФондами.Организация,
		|	СОРасчетыСФондами.СтруктурнаяЕдиница,
		|	СОРасчетыСФондами.ПодразделениеОрганизации,
		|	СОРасчетыСФондами.МесяцНалоговогоПериода,
		|	СОРасчетыСФондами.ВидПлатежа,
		|	ВЫБОР
		|		КОГДА СОРасчетыСФондами.Регистратор ССЫЛКА Документ.РасчетПениОПВиСО
		|			ТОГДА СОРасчетыСФондами.Регистратор
		|		ИНАЧЕ НЕОПРЕДЕЛЕНО
		|	КОНЕЦ
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ РАЗРЕШЕННЫЕ
		|	СОРасчетыСФондами.ФизЛицо,
		|	ВЫБОР
		|		КОГДА СОРасчетыСФондами.ПодразделениеОрганизации = ЗНАЧЕНИЕ(Справочник.ПодразделенияОрганизаций.ПустаяСсылка)
		|			ТОГДА РегистрацияДоходов.ПодразделениеОрганизации
		|		ИНАЧЕ СОРасчетыСФондами.ПодразделениеОрганизации
		|	КОНЕЦ КАК ПодразделениеОрганизации,
		|	СОРасчетыСФондами.ВидПлатежа,
		|	СОРасчетыСФондами.Отчисление КАК Отчисление,
		|	ВЫБОР
		|		КОГДА СОРасчетыСФондами.ВидПлатежа В (ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.Налог), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогАкт), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогСам))
		|			ТОГДА ВЫБОР
		|					КОГДА РегистрацияДоходов.СпособОтраженияВБУ ЕСТЬ NULL 
		|							ИЛИ РегистрацияДоходов.СпособОтраженияВБУ = ЗНАЧЕНИЕ(Справочник.СпособыОтраженияЗарплатыВРеглУчете.ПустаяСсылка)
		|							ИЛИ РегистрацияДоходов.СпособОтраженияВБУ.СчетДт = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
		|						ТОГДА &парамСпособПоУмолчаниюСчетДт
		|					ИНАЧЕ РегистрацияДоходов.СпособОтраженияВБУ.СчетДт
		|				КОНЕЦ
		|		ИНАЧЕ ВЫБОР
		|				КОГДА РасчетПениОПВиСО.СчетЗатратБУ ЕСТЬ NULL 
		|						ИЛИ РасчетПениОПВиСО.СчетЗатратБУ = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
		|					ТОГДА &парамСчетДтДляПени
		|				ИНАЧЕ РасчетПениОПВиСО.СчетЗатратБУ
		|			КОНЕЦ
		|	КОНЕЦ КАК СчетДт,
		|	ВЫБОР
		|		КОГДА СОРасчетыСФондами.ВидПлатежа В (ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.Налог), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогАкт), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогСам))
		|			ТОГДА ВЫБОР
		|					КОГДА РегистрацияДоходов.СпособОтраженияВБУ ЕСТЬ NULL 
		|							ИЛИ РегистрацияДоходов.СпособОтраженияВБУ = ЗНАЧЕНИЕ(Справочник.СпособыОтраженияЗарплатыВРеглУчете.ПустаяСсылка)
		|							ИЛИ РегистрацияДоходов.СпособОтраженияВБУ.СчетДт = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
		|						ТОГДА &парамСпособПоУмолчаниюСубконтоДт1
		|					ИНАЧЕ РегистрацияДоходов.СпособОтраженияВБУ.СубконтоДт1
		|				КОНЕЦ
		|		ИНАЧЕ ВЫБОР
		|				КОГДА РасчетПениОПВиСО.СчетЗатратБУ ЕСТЬ NULL 
		|						ИЛИ РасчетПениОПВиСО.СчетЗатратБУ = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
		|					ТОГДА НЕОПРЕДЕЛЕНО
		|				ИНАЧЕ ЕСТЬNULL(РасчетПениОПВиСО.СубконтоЗатратБУ1, НЕОПРЕДЕЛЕНО)
		|			КОНЕЦ
		|	КОНЕЦ КАК СубконтоДт1,
		|	ВЫБОР
		|		КОГДА СОРасчетыСФондами.ВидПлатежа В (ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.Налог), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогАкт), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогСам))
		|			ТОГДА ВЫБОР
		|					КОГДА РегистрацияДоходов.СпособОтраженияВБУ ЕСТЬ NULL 
		|							ИЛИ РегистрацияДоходов.СпособОтраженияВБУ = ЗНАЧЕНИЕ(Справочник.СпособыОтраженияЗарплатыВРеглУчете.ПустаяСсылка)
		|							ИЛИ РегистрацияДоходов.СпособОтраженияВБУ.СчетДт = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
		|						ТОГДА &парамСпособПоУмолчаниюСубконтоДт2
		|					ИНАЧЕ РегистрацияДоходов.СпособОтраженияВБУ.СубконтоДт2
		|				КОНЕЦ
		|		ИНАЧЕ ВЫБОР
		|				КОГДА РасчетПениОПВиСО.СчетЗатратБУ ЕСТЬ NULL 
		|						ИЛИ РасчетПениОПВиСО.СчетЗатратБУ = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
		|					ТОГДА НЕОПРЕДЕЛЕНО
		|				ИНАЧЕ ЕСТЬNULL(РасчетПениОПВиСО.СубконтоЗатратБУ2, НЕОПРЕДЕЛЕНО)
		|			КОНЕЦ
		|	КОНЕЦ КАК СубконтоДт2,
		|	ВЫБОР
		|		КОГДА СОРасчетыСФондами.ВидПлатежа В (ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.Налог), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогАкт), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогСам))
		|			ТОГДА ВЫБОР
		|					КОГДА РегистрацияДоходов.СпособОтраженияВБУ ЕСТЬ NULL 
		|							ИЛИ РегистрацияДоходов.СпособОтраженияВБУ = ЗНАЧЕНИЕ(Справочник.СпособыОтраженияЗарплатыВРеглУчете.ПустаяСсылка)
		|							ИЛИ РегистрацияДоходов.СпособОтраженияВБУ.СчетДт = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
		|						ТОГДА &парамСпособПоУмолчаниюСубконтоДт3
		|					ИНАЧЕ РегистрацияДоходов.СпособОтраженияВБУ.СубконтоДт3
		|				КОНЕЦ
		|		ИНАЧЕ ВЫБОР
		|				КОГДА РасчетПениОПВиСО.СчетЗатратБУ ЕСТЬ NULL 
		|						ИЛИ РасчетПениОПВиСО.СчетЗатратБУ = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
		|					ТОГДА НЕОПРЕДЕЛЕНО
		|				ИНАЧЕ ЕСТЬNULL(РасчетПениОПВиСО.СубконтоЗатратБУ2, НЕОПРЕДЕЛЕНО)
		|			КОНЕЦ
		|	КОНЕЦ КАК СубконтоДт3,
		|	ВЫБОР
		|		КОГДА СОРасчетыСФондами.ВидПлатежа В (ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.Налог), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогАкт), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогСам))
		|			ТОГДА ВЫБОР
		|					КОГДА РегистрацияДоходов.СпособОтраженияВБУ ЕСТЬ NULL 
		|							ИЛИ РегистрацияДоходов.СпособОтраженияВБУ = ЗНАЧЕНИЕ(Справочник.СпособыОтраженияЗарплатыВРеглУчете.ПустаяСсылка)
		|							ИЛИ РегистрацияДоходов.СпособОтраженияВБУ.СчетДтНУ = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
		|						ТОГДА &парамСпособПоУмолчаниюСчетДтНУ
		|					ИНАЧЕ РегистрацияДоходов.СпособОтраженияВБУ.СчетДтНУ
		|				КОНЕЦ
		|		ИНАЧЕ ВЫБОР
		|				КОГДА РасчетПениОПВиСО.СчетЗатратНУ ЕСТЬ NULL 
		|						ИЛИ РасчетПениОПВиСО.СчетЗатратНУ = ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
		|					ТОГДА &парамСчетДтДляПениНУ
		|				ИНАЧЕ РасчетПениОПВиСО.СчетЗатратНУ
		|			КОНЕЦ
		|	КОНЕЦ КАК СчетДтНУ,
		|	ВЫБОР
		|		КОГДА СОРасчетыСФондами.ВидПлатежа В (ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.Налог), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогАкт), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогСам))
		|			ТОГДА ВЫБОР
		|					КОГДА РегистрацияДоходов.СпособОтраженияВБУ ЕСТЬ NULL 
		|							ИЛИ РегистрацияДоходов.СпособОтраженияВБУ = ЗНАЧЕНИЕ(Справочник.СпособыОтраженияЗарплатыВРеглУчете.ПустаяСсылка)
		|							ИЛИ РегистрацияДоходов.СпособОтраженияВБУ.СчетДтНУ = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
		|						ТОГДА &парамСпособПоУмолчаниюСубконтоДтНУ1
		|					ИНАЧЕ РегистрацияДоходов.СпособОтраженияВБУ.СубконтоДтНУ1
		|				КОНЕЦ
		|		ИНАЧЕ ВЫБОР
		|				КОГДА РасчетПениОПВиСО.СчетЗатратНУ ЕСТЬ NULL 
		|						ИЛИ РасчетПениОПВиСО.СчетЗатратНУ = ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
		|					ТОГДА НЕОПРЕДЕЛЕНО
		|				ИНАЧЕ ЕСТЬNULL(РасчетПениОПВиСО.СубконтоЗатратНУ1, НЕОПРЕДЕЛЕНО)
		|			КОНЕЦ
		|	КОНЕЦ КАК СубконтоДтНУ1,
		|	ВЫБОР
		|		КОГДА СОРасчетыСФондами.ВидПлатежа В (ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.Налог), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогАкт), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогСам))
		|			ТОГДА ВЫБОР
		|					КОГДА РегистрацияДоходов.СпособОтраженияВБУ ЕСТЬ NULL 
		|							ИЛИ РегистрацияДоходов.СпособОтраженияВБУ = ЗНАЧЕНИЕ(Справочник.СпособыОтраженияЗарплатыВРеглУчете.ПустаяСсылка)
		|							ИЛИ РегистрацияДоходов.СпособОтраженияВБУ.СчетДтНУ = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
		|						ТОГДА &парамСпособПоУмолчаниюСубконтоДтНУ2
		|					ИНАЧЕ РегистрацияДоходов.СпособОтраженияВБУ.СубконтоДтНУ2
		|				КОНЕЦ
		|		ИНАЧЕ ВЫБОР
		|				КОГДА РасчетПениОПВиСО.СчетЗатратНУ ЕСТЬ NULL 
		|						ИЛИ РасчетПениОПВиСО.СчетЗатратНУ = ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
		|					ТОГДА НЕОПРЕДЕЛЕНО
		|				ИНАЧЕ ЕСТЬNULL(РасчетПениОПВиСО.СубконтоЗатратНУ2, НЕОПРЕДЕЛЕНО)
		|			КОНЕЦ
		|	КОНЕЦ КАК СубконтоДтНУ2,
		|	ВЫБОР
		|		КОГДА СОРасчетыСФондами.ВидПлатежа В (ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.Налог), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогАкт), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогСам))
		|			ТОГДА ВЫБОР
		|					КОГДА РегистрацияДоходов.СпособОтраженияВБУ ЕСТЬ NULL 
		|							ИЛИ РегистрацияДоходов.СпособОтраженияВБУ = ЗНАЧЕНИЕ(Справочник.СпособыОтраженияЗарплатыВРеглУчете.ПустаяСсылка)
		|							ИЛИ РегистрацияДоходов.СпособОтраженияВБУ.СчетДтНУ = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
		|						ТОГДА &парамСпособПоУмолчаниюСубконтоДтНУ2
		|					ИНАЧЕ РегистрацияДоходов.СпособОтраженияВБУ.СубконтоДтНУ2
		|				КОНЕЦ
		|		ИНАЧЕ ВЫБОР
		|				КОГДА РасчетПениОПВиСО.СчетЗатратНУ ЕСТЬ NULL 
		|						ИЛИ РасчетПениОПВиСО.СчетЗатратНУ = ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
		|					ТОГДА НЕОПРЕДЕЛЕНО
		|				ИНАЧЕ ЕСТЬNULL(РасчетПениОПВиСО.СубконтоЗатратНУ2, НЕОПРЕДЕЛЕНО)
		|			КОНЕЦ
		|	КОНЕЦ КАК СубконтоДтНУ3,
		|	ВЫБОР
		|		КОГДА СОРасчетыСФондами.ВидПлатежа В (ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.Налог), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогАкт), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогСам))
		|			ТОГДА ЕСТЬNULL(РегистрацияДоходов.СпособОтраженияВБУ.СчетКт, НЕОПРЕДЕЛЕНО)
		|		ИНАЧЕ НЕОПРЕДЕЛЕНО
		|	КОНЕЦ КАК СчетКт,
		|	ВЫБОР
		|		КОГДА СОРасчетыСФондами.ВидПлатежа В (ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.Налог), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогАкт), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогСам))
		|			ТОГДА ЕСТЬNULL(РегистрацияДоходов.СпособОтраженияВБУ.СубконтоКт1, НЕОПРЕДЕЛЕНО)
		|		ИНАЧЕ НЕОПРЕДЕЛЕНО
		|	КОНЕЦ КАК СубконтоКт1,
		|	ВЫБОР
		|		КОГДА СОРасчетыСФондами.ВидПлатежа В (ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.Налог), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогАкт), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогСам))
		|			ТОГДА ЕСТЬNULL(РегистрацияДоходов.СпособОтраженияВБУ.СубконтоКт2, НЕОПРЕДЕЛЕНО)
		|		ИНАЧЕ НЕОПРЕДЕЛЕНО
		|	КОНЕЦ КАК СубконтоКт2,
		|	ВЫБОР
		|		КОГДА СОРасчетыСФондами.ВидПлатежа В (ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.Налог), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогАкт), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогСам))
		|			ТОГДА ЕСТЬNULL(РегистрацияДоходов.СпособОтраженияВБУ.СубконтоКт3, НЕОПРЕДЕЛЕНО)
		|		ИНАЧЕ НЕОПРЕДЕЛЕНО
		|	КОНЕЦ КАК СубконтоКт3,
		|	ВЫБОР
		|		КОГДА СОРасчетыСФондами.ВидПлатежа В (ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.Налог), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогАкт), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогСам))
		|			ТОГДА ЕСТЬNULL(РегистрацияДоходов.СпособОтраженияВБУ.СчетКтНУ, НЕОПРЕДЕЛЕНО)
		|		ИНАЧЕ НЕОПРЕДЕЛЕНО
		|	КОНЕЦ КАК СчетКтНУ,
		|	ВЫБОР
		|		КОГДА СОРасчетыСФондами.ВидПлатежа В (ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.Налог), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогАкт), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогСам))
		|			ТОГДА ЕСТЬNULL(РегистрацияДоходов.СпособОтраженияВБУ.СубконтоКтНУ1, НЕОПРЕДЕЛЕНО)
		|		ИНАЧЕ НЕОПРЕДЕЛЕНО
		|	КОНЕЦ КАК СубконтоКтНУ1,
		|	ВЫБОР
		|		КОГДА СОРасчетыСФондами.ВидПлатежа В (ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.Налог), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогАкт), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогСам))
		|			ТОГДА ЕСТЬNULL(РегистрацияДоходов.СпособОтраженияВБУ.СубконтоКтНУ2, НЕОПРЕДЕЛЕНО)
		|		ИНАЧЕ НЕОПРЕДЕЛЕНО
		|	КОНЕЦ КАК СубконтоКтНУ2,
		|	ВЫБОР
		|		КОГДА СОРасчетыСФондами.ВидПлатежа В (ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.Налог), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогАкт), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогСам))
		|			ТОГДА ЕСТЬNULL(РегистрацияДоходов.СпособОтраженияВБУ.СубконтоКтНУ3, НЕОПРЕДЕЛЕНО)
		|		ИНАЧЕ НЕОПРЕДЕЛЕНО
		|	КОНЕЦ КАК СубконтоКтНУ3,
		|	ВЫБОР
		|		КОГДА СОРасчетыСФондами.ВидПлатежа В (ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.Налог), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогАкт), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогСам))
		|			ТОГДА ЕСТЬNULL(ВидСубконтоСтатьиЗатрат.НомерСтроки, 0)
		|		ИНАЧЕ ЕСТЬNULL(ВидСубконтоСтатьиЗатратДляПени.НомерСтроки, 0)
		|	КОНЕЦ КАК НомерСубконтоСтатьиЗатратДт,
		|	ВЫБОР
		|		КОГДА СОРасчетыСФондами.ВидПлатежа В (ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.Налог), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогАкт), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогСам))
		|			ТОГДА ЕСТЬNULL(ВидСубконтоПодразделения.НомерСтроки, 0)
		|		ИНАЧЕ ЕСТЬNULL(ВидСубконтоПодразделенияДляПени.НомерСтроки, 0)
		|	КОНЕЦ КАК НомерСубконтоПодразделенияДт,
		|	ВЫБОР
		|		КОГДА СОРасчетыСФондами.ВидПлатежа В (ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.Налог), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогАкт), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогСам))
		|			ТОГДА ЕСТЬNULL(ВидСубконтоСтатьиЗатратНУ.НомерСтроки, 0)
		|		ИНАЧЕ ЕСТЬNULL(ВидСубконтоСтатьиЗатратДляПениНУ.НомерСтроки, 0)
		|	КОНЕЦ КАК НомерСубконтоСтатьиЗатратДтНУ,
		|	ВЫБОР
		|		КОГДА СОРасчетыСФондами.ВидПлатежа В (ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.Налог), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогАкт), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогСам))
		|			ТОГДА ЕСТЬNULL(ВидСубконтоПодразделенияНУ.НомерСтроки, 0)
		|		ИНАЧЕ ЕСТЬNULL(ВидСубконтоПодразделенияДляПениНУ.НомерСтроки, 0)
		|	КОНЕЦ КАК НомерСубконтоПодразделенияДтНУ,
		|	ВЫБОР
		|		КОГДА СОРасчетыСФондами.ВидПлатежа В (ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.Налог), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогАкт), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогСам))
		|			ТОГДА ЕСТЬNULL(ВидСубконтоРаботникиОрганизаций.НомерСтроки, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ КАК НомерСубконтоРаботникиОрганизацийКт,
		|	ВЫБОР
		|		КОГДА СОРасчетыСФондами.ВидПлатежа В (ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.Налог), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогАкт), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогСам))
		|			ТОГДА ЕСТЬNULL(ВидСубконтоРаботникиОрганизацийНУ.НомерСтроки, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ КАК НомерСубконтоРаботникиОрганизацийКтНУ,
		|	ВЫБОР
		|		КОГДА СОРасчетыСФондами.ВидПлатежа В (ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.Налог), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогАкт), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогСам))
		|			ТОГДА ЕСТЬNULL(ВидСубконтоВидыПлатежей.НомерСтроки, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ КАК НомерСубконтоВидыПлатежейКт,
		|	ВЫБОР
		|		КОГДА СОРасчетыСФондами.ВидПлатежа В (ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.Налог), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогАкт), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогСам))
		|			ТОГДА ЕСТЬNULL(ВидСубконтоВидыПлатежей.НомерСтроки, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ КАК НомерСубконтоВидыПлатежейКтНУ
		|ИЗ
		|	ВТ_ДанныеСОЗаИП КАК СОРасчетыСФондами
		|		ЛЕВОЕ СОЕДИНЕНИЕ ВТ_ДанныеРегистрацииДоходов КАК РегистрацияДоходов
		|		ПО (ЕСТЬNULL(РегистрацияДоходов.УчитыватьСО, ЛОЖЬ))
		|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Типовой.ВидыСубконто КАК ВидСубконтоСтатьиЗатрат
		|		ПО (ВидСубконтоСтатьиЗатрат.Ссылка = ВЫБОР
		|				КОГДА РегистрацияДоходов.СпособОтраженияВБУ ЕСТЬ NULL 
		|						ИЛИ РегистрацияДоходов.СпособОтраженияВБУ.СчетДт = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
		|					ТОГДА &парамСпособПоУмолчаниюСчетДт
		|				ИНАЧЕ РегистрацияДоходов.СпособОтраженияВБУ.СчетДт
		|			КОНЕЦ)
		|			И (ВидСубконтоСтатьиЗатрат.ВидСубконто = &парамВидСубконтоСтатьиЗатрат)
		|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Типовой.ВидыСубконто КАК ВидСубконтоПодразделения
		|		ПО (ВидСубконтоПодразделения.Ссылка = ВЫБОР
		|				КОГДА РегистрацияДоходов.СпособОтраженияВБУ ЕСТЬ NULL 
		|						ИЛИ РегистрацияДоходов.СпособОтраженияВБУ.СчетДт = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
		|					ТОГДА &парамСпособПоУмолчаниюСчетДт
		|				ИНАЧЕ РегистрацияДоходов.СпособОтраженияВБУ.СчетДт
		|			КОНЕЦ)
		|			И (ВидСубконтоПодразделения.ВидСубконто = &парамВидСубконтоПодразделения)
		|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Налоговый.ВидыСубконто КАК ВидСубконтоСтатьиЗатратНУ
		|		ПО (ВидСубконтоСтатьиЗатратНУ.Ссылка = ВЫБОР
		|				КОГДА РегистрацияДоходов.СпособОтраженияВБУ.СчетДтНУ ЕСТЬ NULL 
		|						ИЛИ РегистрацияДоходов.СпособОтраженияВБУ.СчетДтНУ = ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
		|					ТОГДА &парамСпособПоУмолчаниюСчетДтНУ
		|				ИНАЧЕ РегистрацияДоходов.СпособОтраженияВБУ.СчетДтНУ
		|			КОНЕЦ)
		|			И (ВидСубконтоСтатьиЗатратНУ.ВидСубконто = &парамВидСубконтоСтатьиЗатрат)
		|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Налоговый.ВидыСубконто КАК ВидСубконтоПодразделенияНУ
		|		ПО (ВидСубконтоПодразделенияНУ.Ссылка = ВЫБОР
		|				КОГДА РегистрацияДоходов.СпособОтраженияВБУ.СчетДтНУ ЕСТЬ NULL 
		|						ИЛИ РегистрацияДоходов.СпособОтраженияВБУ.СчетДтНУ = ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
		|					ТОГДА &парамСпособПоУмолчаниюСчетДтНУ
		|				ИНАЧЕ РегистрацияДоходов.СпособОтраженияВБУ.СчетДтНУ
		|			КОНЕЦ)
		|			И (ВидСубконтоПодразделенияНУ.ВидСубконто = &парамВидСубконтоПодразделения)
		|		ЛЕВОЕ СОЕДИНЕНИЕ Документ.РасчетПениОПВиСО КАК РасчетПениОПВиСО
		|		ПО СОРасчетыСФондами.Регистратор = РасчетПениОПВиСО.Ссылка
		|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Типовой.ВидыСубконто КАК ВидСубконтоСтатьиЗатратДляПени
		|		ПО (ВидСубконтоСтатьиЗатратДляПени.Ссылка = ВЫБОР
		|				КОГДА РасчетПениОПВиСО.СчетЗатратБУ ЕСТЬ NULL 
		|						ИЛИ РасчетПениОПВиСО.СчетЗатратБУ = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
		|					ТОГДА &парамСчетДтДляПени
		|				ИНАЧЕ РасчетПениОПВиСО.СчетЗатратБУ
		|			КОНЕЦ)
		|			И (ВидСубконтоСтатьиЗатратДляПени.ВидСубконто = &парамВидСубконтоСтатьиЗатрат)
		|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Типовой.ВидыСубконто КАК ВидСубконтоПодразделенияДляПени
		|		ПО (ВидСубконтоПодразделенияДляПени.Ссылка = ВЫБОР
		|				КОГДА РасчетПениОПВиСО.СчетЗатратБУ ЕСТЬ NULL 
		|						ИЛИ РасчетПениОПВиСО.СчетЗатратБУ = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
		|					ТОГДА &парамСчетДтДляПени
		|				ИНАЧЕ РасчетПениОПВиСО.СчетЗатратБУ
		|			КОНЕЦ)
		|			И (ВидСубконтоПодразделенияДляПени.ВидСубконто = &парамВидСубконтоПодразделения)
		|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Налоговый.ВидыСубконто КАК ВидСубконтоСтатьиЗатратДляПениНУ
		|		ПО (ВидСубконтоСтатьиЗатратДляПениНУ.Ссылка = ВЫБОР
		|				КОГДА РасчетПениОПВиСО.СчетЗатратНУ ЕСТЬ NULL 
		|						ИЛИ РасчетПениОПВиСО.СчетЗатратНУ = ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
		|					ТОГДА &парамСчетДтДляПениНУ
		|				ИНАЧЕ РасчетПениОПВиСО.СчетЗатратНУ
		|			КОНЕЦ)
		|			И (ВидСубконтоСтатьиЗатратДляПениНУ.ВидСубконто = &парамВидСубконтоСтатьиЗатрат)
		|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Налоговый.ВидыСубконто КАК ВидСубконтоПодразделенияДляПениНУ
		|		ПО (ВидСубконтоПодразделенияДляПениНУ.Ссылка = ВЫБОР
		|				КОГДА РасчетПениОПВиСО.СчетЗатратНУ ЕСТЬ NULL 
		|						ИЛИ РасчетПениОПВиСО.СчетЗатратНУ = ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
		|					ТОГДА &парамСчетДтДляПениНУ
		|				ИНАЧЕ РасчетПениОПВиСО.СчетЗатратНУ
		|			КОНЕЦ)
		|			И (ВидСубконтоПодразделенияДляПениНУ.ВидСубконто = &парамВидСубконтоПодразделения)
		|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Типовой.ВидыСубконто КАК ВидСубконтоРаботникиОрганизаций
		|		ПО (ВидСубконтоРаботникиОрганизаций.Ссылка = ВЫБОР
		|				КОГДА РегистрацияДоходов.СпособОтраженияВБУ ЕСТЬ NULL 
		|						ИЛИ РегистрацияДоходов.СпособОтраженияВБУ.СчетКт = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
		|					ТОГДА НЕОПРЕДЕЛЕНО
		|				ИНАЧЕ РегистрацияДоходов.СпособОтраженияВБУ.СчетКт
		|			КОНЕЦ)
		|			И (ВидСубконтоРаботникиОрганизаций.ВидСубконто = &парамВидСубконтоРаботникиОрганизаций)
		|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Типовой.ВидыСубконто КАК ВидСубконтоВидыПлатежей
		|		ПО (ВидСубконтоВидыПлатежей.Ссылка = ВЫБОР
		|				КОГДА РегистрацияДоходов.СпособОтраженияВБУ ЕСТЬ NULL 
		|						ИЛИ РегистрацияДоходов.СпособОтраженияВБУ.СчетКт = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
		|					ТОГДА НЕОПРЕДЕЛЕНО
		|				ИНАЧЕ РегистрацияДоходов.СпособОтраженияВБУ.СчетКт
		|			КОНЕЦ)
		|			И (ВидСубконтоВидыПлатежей.ВидСубконто = &парамВидСубконтоВидыПлатежей)
		|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Налоговый.ВидыСубконто КАК ВидСубконтоРаботникиОрганизацийНУ
		|		ПО (ВидСубконтоРаботникиОрганизацийНУ.Ссылка = ВЫБОР
		|				КОГДА РегистрацияДоходов.СпособОтраженияВБУ ЕСТЬ NULL 
		|						ИЛИ РегистрацияДоходов.СпособОтраженияВБУ.СчетКтНУ = ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
		|					ТОГДА НЕОПРЕДЕЛЕНО
		|				ИНАЧЕ РегистрацияДоходов.СпособОтраженияВБУ.СчетКтНУ
		|			КОНЕЦ)
		|			И (ВидСубконтоРаботникиОрганизацийНУ.ВидСубконто = &парамВидСубконтоРаботникиОрганизаций)
		|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Налоговый.ВидыСубконто КАК ВидСубконтоВидыПлатежейНУ
		|		ПО (ВидСубконтоВидыПлатежейНУ.Ссылка = ВЫБОР
		|				КОГДА РегистрацияДоходов.СпособОтраженияВБУ ЕСТЬ NULL 
		|						ИЛИ РегистрацияДоходов.СпособОтраженияВБУ.СчетКтНУ = ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
		|					ТОГДА НЕОПРЕДЕЛЕНО
		|				ИНАЧЕ РегистрацияДоходов.СпособОтраженияВБУ.СчетКтНУ
		|			КОНЕЦ)
		|			И (ВидСубконтоВидыПлатежейНУ.ВидСубконто = &парамВидСубконтоВидыПлатежей)
		|ГДЕ
		|	ВЫБОР
		|		КОГДА СОРасчетыСФондами.ВидПлатежа В (ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.Налог), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогАкт), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогСам))
		|			ТОГДА РегистрацияДоходов.СпособОтраженияВБУ <> ЗНАЧЕНИЕ(Справочник.СпособыОтраженияЗарплатыВРеглУчете.НеОтражатьВБухучете)
		|		ИНАЧЕ ИСТИНА
		|	КОНЕЦ";


	СчетКредита = Справочники.НалогиСборыОтчисления.ОбязательныеСоциальныеОтчисления.СчетУчетаРасчетовСКонтрагентомБУ;
	Если НЕ ЗначениеЗаполнено(СчетКредита) Тогда
		СчетКредита = ПланыСчетов.Типовой.ОбязательстваПоСоциальномуСтрахованию;
	КонецЕсли;
	
	СчетКредитаНУ = ПроцедурыНалоговогоУчетаВызовСервераПовтИсп.ПолучитьСчетУчетаНУСО(СчетКредита,КонецМесяца(Параметры.ПериодРегистрации));
	
	Выборка = Запрос.Выполнить().Выбрать();
		
	Пока Выборка.Следующий() Цикл
		Строка = Параметры.ТаблицаОтражениеВУчете.Добавить();
		
		// Ставим на разные счета затрат в зависимости от вида платежа
		Если Выборка.ВидПлатежа = Перечисления.ВидыПлатежейВБюджетИФонды.Налог
			 Или Выборка.ВидПлатежа = Перечисления.ВидыПлатежейВБюджетИФонды.НалогАкт 
			 Или Выборка.ВидПлатежа = Перечисления.ВидыПлатежейВБюджетИФонды.НалогСам Тогда
			Строка.ВидРасчета	= ВидНалогаСбораОтчисленияСО;
			Строка.СчетДт 		= Выборка.СчетДт;
			Строка.СубконтоДт1 	= Выборка.СубконтоДт1;
			Строка.СубконтоДт2 	= Выборка.СубконтоДт2;
			Строка.СубконтоДт3 	= Выборка.СубконтоДт3;
			
			Строка.СчетДтНУ 	= Выборка.СчетДтНУ;
			Строка.СубконтоДтНУ1 	= Выборка.СубконтоДтНУ1;
			Строка.СубконтоДтНУ2 	= Выборка.СубконтоДтНУ2;
			Строка.СубконтоДтНУ3 	= Выборка.СубконтоДтНУ3;
		Иначе // Пеня по СО
			Строка.ВидРасчета		= СтатьяЗатратПеняПоСО;
			Строка.СчетДт			= Выборка.СчетДт;
			Строка.СчетДтНУ 		= Выборка.СчетДтНУ;
			
			Если Выборка.НомерСубконтоСтатьиЗатратДт <> 0 Тогда
				Если ЗначениеЗаполнено(Выборка["СубконтоДт" + Выборка.НомерСубконтоСтатьиЗатратДт]) Тогда
					Строка["СубконтоДт" + Выборка.НомерСубконтоСтатьиЗатратДт] = Выборка["СубконтоДт" + Выборка.НомерСубконтоСтатьиЗатратДт];
				Иначе
					Строка["СубконтоДт" + Выборка.НомерСубконтоСтатьиЗатратДт] = СтатьяЗатратПеняПоСО;
				КонецЕсли;
				ОбщегоНазначенияБККлиентСервер.ЗаменитьСубконтоНУ(Строка, Строка.СчетДт, Строка.СчетДтНУ, Выборка.НомерСубконтоСтатьиЗатратДт, СтатьяЗатратПеняПоСО, "СубконтоДтНУ");
			КонецЕсли;
			Если Выборка.НомерСубконтоСтатьиЗатратДтНУ <> 0 Тогда
				Если ЗначениеЗаполнено(Выборка["СубконтоДтНУ" + Выборка.НомерСубконтоСтатьиЗатратДтНУ]) Тогда
					Строка["СубконтоДтНУ" + Выборка.НомерСубконтоСтатьиЗатратДтНУ] = Выборка["СубконтоДтНУ" + Выборка.НомерСубконтоСтатьиЗатратДтНУ];
				Иначе
					Строка["СубконтоДтНУ" + Выборка.НомерСубконтоСтатьиЗатратДтНУ] = СтатьяЗатратПеняПоСО;
				КонецЕсли;
			КонецЕсли;
			
			// Заполним оставшиеся субконто
			Для Ном = 1 По 3 Цикл
				Если НЕ ЗначениеЗаполнено(Строка["СубконтоДт" + Ном]) Тогда
					Строка["СубконтоДт" + Ном] = Выборка["СубконтоДт" + Ном];
				КонецЕсли;
				Если НЕ ЗначениеЗаполнено(Строка["СубконтоДтНУ" + Ном]) Тогда
					Если ЗначениеЗаполнено(Выборка["СубконтоДтНУ" + Ном]) Тогда
						Строка["СубконтоДтНУ" + Ном] = Выборка["СубконтоДтНУ" + Ном];
					Иначе
						ОбщегоНазначенияБККлиентСервер.ЗаменитьСубконтоНУ(Строка, СчетДебетаДляПени, СчетДебетаДляПениНУ, Ном, СтатьяЗатратПеняПоСО, "СубконтоДтНУ");
					КонецЕсли;
				КонецЕсли;
			КонецЦикла;

		КонецЕсли;
		
		Если Выборка.НомерСубконтоПодразделенияДт <> 0 Тогда
			Если ЗначениеЗаполнено(Выборка["СубконтоДт" + Выборка.НомерСубконтоПодразделенияДт]) Тогда
				Строка["СубконтоДт" + Выборка.НомерСубконтоПодразделенияДт] = Выборка["СубконтоДт" + Выборка.НомерСубконтоПодразделенияДт];
			Иначе 
				Строка["СубконтоДт" + Выборка.НомерСубконтоПодразделенияДт]= Выборка.ПодразделениеОрганизации;
			КонецЕсли;
			ОбщегоНазначенияБККлиентСервер.ЗаменитьСубконтоНУ(Строка, Строка.СчетДт, Строка.СчетДтНУ, Выборка.НомерСубконтоПодразделенияДт, Выборка.ПодразделениеОрганизации, "СубконтоДтНУ");
		КонецЕсли;
		Если Выборка.НомерСубконтоПодразделенияДтНУ <> 0 Тогда
			Если ЗначениеЗаполнено(Выборка["СубконтоДтНУ" + Выборка.НомерСубконтоПодразделенияДтНУ]) Тогда
				Строка["СубконтоДтНУ" + Выборка.НомерСубконтоПодразделенияДтНУ] = Выборка["СубконтоДтНУ" + Выборка.НомерСубконтоПодразделенияДтНУ];
			Иначе 
				Строка["СубконтоДтНУ" + Выборка.НомерСубконтоПодразделенияДтНУ]= Выборка.ПодразделениеОрганизации;
			КонецЕсли;
		КонецЕсли;
		
		Если ЗначениеЗаполнено(Выборка.СчетКт) Тогда
			Строка.СчетКт 		= Выборка.СчетКт;
			Строка.СубконтоКт1 	= Выборка.СубконтоКт1;
			Строка.СубконтоКт2 	= Выборка.СубконтоКт2;
			Строка.СубконтоКт3	= Выборка.СубконтоКт3;		
			
			Строка.СчетКтНУ 		= Выборка.СчетКтНУ;
			Строка.СубконтоКтНУ1 	= Выборка.СубконтоКтНУ1;
			Строка.СубконтоКтНУ2 	= Выборка.СубконтоКтНУ2;
			Строка.СубконтоКтНУ3	= Выборка.СубконтоКтНУ3;		
			
			// Проверяем заполнена ли аналитика по видам платежей, если нет, заполняем
			Если Выборка.НомерСубконтоВидыПлатежейКт <> 0 Тогда
				Если ЗначениеЗаполнено(Выборка["СубконтоКт" + Выборка.НомерСубконтоВидыПлатежейКт]) Тогда
					Строка["СубконтоКт" + Выборка.НомерСубконтоВидыПлатежейКт] = Выборка["СубконтоКт" + Выборка.НомерСубконтоВидыПлатежейКт];
				Иначе 
					Строка["СубконтоКт" + Выборка.НомерСубконтоВидыПлатежейКт]= Выборка.ВидПлатежа;
				КонецЕсли;
				ОбщегоНазначенияБККлиентСервер.ЗаменитьСубконтоНУ(Строка, Строка.СчетДт, Строка.СчетДтНУ, Выборка.НомерСубконтоВидыПлатежейКт, Выборка.ВидПлатежа, "СубконтоКтНУ");
			КонецЕсли;
			Если Выборка.НомерСубконтоВидыПлатежейКтНУ <> 0 Тогда
				Если ЗначениеЗаполнено(Выборка["СубконтоКтНУ" + Выборка.НомерСубконтоВидыПлатежейКтНУ]) Тогда
					Строка["СубконтоКтНУ" + Выборка.НомерСубконтоВидыПлатежейКтНУ] = Выборка["СубконтоКтНУ" + Выборка.НомерСубконтоВидыПлатежейКтНУ];
				Иначе 
					Строка["СубконтоКтНУ" + Выборка.НомерСубконтоВидыПлатежейКтНУ]= Выборка.ВидПлатежа;
				КонецЕсли;
			КонецЕсли;

			// Проверяем заполнена ли аналитика по работникам, если нет, заполняем
			Если ВедетсяУчетПоСотрудникам И Выборка.НомерСубконтоРаботникиОрганизацийКт <> 0 Тогда
				Если ЗначениеЗаполнено(Выборка["СубконтоКт" + Выборка.НомерСубконтоРаботникиОрганизацийКт]) Тогда
					Строка["СубконтоКт" + Выборка.НомерСубконтоРаботникиОрганизацийКт] = Выборка["СубконтоКт" + Выборка.НомерСубконтоРаботникиОрганизацийКт];
				Иначе 
					Строка["СубконтоКт" + Выборка.НомерСубконтоРаботникиОрганизацийКт]= Выборка.Физлицо;
				КонецЕсли;
				ОбщегоНазначенияБККлиентСервер.ЗаменитьСубконтоНУ(Строка, Строка.СчетДт, Строка.СчетДтНУ, Выборка.НомерСубконтоРаботникиОрганизацийКт, Выборка.Физлицо, "СубконтоКтНУ");
			КонецЕсли;
			Если ВедетсяУчетПоСотрудникам И Выборка.НомерСубконтоРаботникиОрганизацийКтНУ <> 0 Тогда
				Если ЗначениеЗаполнено(Выборка["СубконтоКтНУ" + Выборка.НомерСубконтоРаботникиОрганизацийКтНУ]) Тогда
					Строка["СубконтоКтНУ" + Выборка.НомерСубконтоРаботникиОрганизацийКтНУ] = Выборка["СубконтоКтНУ" + Выборка.НомерСубконтоРаботникиОрганизацийКтНУ];
				Иначе 
					Строка["СубконтоКтНУ" + Выборка.НомерСубконтоРаботникиОрганизацийКтНУ]= Выборка.Физлицо;
				КонецЕсли;
			КонецЕсли;
			
		Иначе 
			Строка.СчетКт 		= СчетКредита;
			Строка.СубконтоКт1 	= Выборка.ВидПлатежа;
			Если ВедетсяУчетПоСотрудникам Тогда
				Строка.СубконтоКт2	= Выборка.Физлицо;		
			КонецЕсли;
			
			Строка.СчетКтНУ 	= СчетКредитаНУ;
			ОбщегоНазначенияБККлиентСервер.ЗаменитьСубконтоНУ(Строка, СчетКредита, СчетКредитаНУ, 1, Выборка.ВидПлатежа, "СубконтоКтНУ");
			Если ВедетсяУчетПоСотрудникам Тогда
				ОбщегоНазначенияБККлиентСервер.ЗаменитьСубконтоНУ(Строка, СчетКредита, СчетКредитаНУ, 2, Выборка.Физлицо, "СубконтоКтНУ");   		
			КонецЕсли;
		КонецЕсли;
		
		Строка.Сумма		= Выборка.Отчисление;
		Строка.ФизЛицо 		= Выборка.ФизЛицо;
		Строка.СтруктурноеПодразделениеДт = Параметры.СтруктурноеПодразделение;
		Строка.СтруктурноеПодразделениеКт = Параметры.СтруктурноеПодразделение;
	КонецЦикла;
	
#КонецОбласти
	
#Область СНзаИП	
	// Отражение СН за ИП

	Запрос.Текст = 
		"ВЫБРАТЬ РАЗРЕШЕННЫЕ
		|	СНИсчисленный.ФизЛицо КАК ФизЛицо,
		|	СНИсчисленный.Организация,
		|	СНИсчисленный.СтруктурнаяЕдиница,
		|	СНИсчисленный.ПодразделениеОрганизации,
		|	СУММА(СНИсчисленный.Налог) КАК Налог
		|ПОМЕСТИТЬ ВТ_СНИсчисленныйЗаИП
		|ИЗ
		|	РегистрНакопления.СНИсчисленный КАК СНИсчисленный
		|		ЛЕВОЕ СОЕДИНЕНИЕ ВТ_УжеОтражено КАК УжеОтражено
		|		ПО СНИсчисленный.ФизЛицо = УжеОтражено.ФизЛицо
		|ГДЕ
		|	СНИсчисленный.Период >= &парамНачалоМесяца
		|	И СНИсчисленный.Период <= &парамКонецМесяца
		|	И СНИсчисленный.Организация = &парамОрганизация
		|	И СНИсчисленный.Налог <> 0
		|	И СНИсчисленный.НеОтражатьВРеглУчете = ЛОЖЬ
		|	И НЕ СНИсчисленный.Регистратор ССЫЛКА Документ.ОтражениеНалоговойОтчетностиВРеглУчете
		|	И СНИсчисленный.Активность
		|	И СНИсчисленный.ФизЛицо = &парамИндивидуальныйПредприниматель
		|	И УжеОтражено.ФизЛицо ЕСТЬ NULL
		|
		|СГРУППИРОВАТЬ ПО
		|	СНИсчисленный.ФизЛицо,
		|	СНИсчисленный.СтруктурнаяЕдиница,
		|	СНИсчисленный.Организация,
		|	СНИсчисленный.ПодразделениеОрганизации
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	ФизЛицо
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	СНИсчисленный.ФизЛицо,
		|	СНИсчисленный.Организация,
		|	СНИсчисленный.СтруктурнаяЕдиница,
		|	СНИсчисленный.ПодразделениеОрганизации,
		|	СНИсчисленный.Налог,
		|	ЕСТЬNULL(ВидСубконтоПодразделения.НомерСтроки, 0) КАК НомерСубконтоПодразделенияДт,
		|	ЕСТЬNULL(ВидСубконтоПодразделенияНУ.НомерСтроки, 0) КАК НомерСубконтоПодразделенияДтНУ,
		|	ЕСТЬNULL(ВидСубконтоСтатьиЗатрат.НомерСтроки, 0) КАК НомерСубконтоСтатьиЗатратДт,
		|	ЕСТЬNULL(ВидСубконтоСтатьиЗатратНУ.НомерСтроки, 0) КАК НомерСубконтоСтатьиЗатратДтНУ
		|ИЗ
		|	ВТ_СНИсчисленныйЗаИП КАК СНИсчисленный
		|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Типовой.ВидыСубконто КАК ВидСубконтоПодразделения
		|		ПО (ВидСубконтоПодразделения.Ссылка = &парамСпособПоУмолчаниюСчетДт)
		|			И (ВидСубконтоПодразделения.ВидСубконто = &парамВидСубконтоПодразделения)
		|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Налоговый.ВидыСубконто КАК ВидСубконтоПодразделенияНУ
		|		ПО (ВидСубконтоПодразделенияНУ.Ссылка = &парамСпособПоУмолчаниюСчетДтНУ)
		|			И (ВидСубконтоПодразделенияНУ.ВидСубконто = &парамВидСубконтоПодразделения)
		|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Типовой.ВидыСубконто КАК ВидСубконтоСтатьиЗатрат
		|		ПО (ВидСубконтоСтатьиЗатрат.Ссылка = &парамСпособПоУмолчаниюСчетДт)
		|			И (ВидСубконтоСтатьиЗатрат.ВидСубконто = &парамВидСубконтоСтатьиЗатрат)
		|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Налоговый.ВидыСубконто КАК ВидСубконтоСтатьиЗатратНУ
		|		ПО (ВидСубконтоСтатьиЗатратНУ.Ссылка = &парамСпособПоУмолчаниюСчетДтНУ)
		|			И (ВидСубконтоСтатьиЗатратНУ.ВидСубконто = &парамВидСубконтоСтатьиЗатрат)";
		
	Выборка = Запрос.Выполнить().Выбрать();
	СчетКредита = Справочники.НалогиСборыОтчисления.СоциальныйНалог.СчетУчетаРасчетовСКонтрагентомБУ;
	Если НЕ ЗначениеЗаполнено(СчетКредита) Тогда
		СчетКредита = ПланыСчетов.Типовой.СоциальныйНалог;
	КонецЕсли;
	СчетКредитаНУ = ПроцедурыНалоговогоУчетаВызовСервераПовтИсп.ПолучитьСчетУчетаНУСН(СчетКредита, КонецМесяца(Параметры.ПериодРегистрации));
	СубконтоКт1 = Справочники.НалогиСборыОтчисления.СоциальныйНалог;
	СубконтоКт2 = Перечисления.ВидыПлатежейВБюджетИФонды.Налог;
	СтатьяЗатратСН = Справочники.СтатьиЗатрат.СоциальныйНалог;
	Пока Выборка.Следующий() Цикл 
		
		Строка = Параметры.ТаблицаОтражениеВУчете.Добавить();
		Строка.СчетДт 		= СпособПоУмолчанию.СчетДт;
		Строка.СубконтоДт1 	= СпособПоУмолчанию.СубконтоДт1;
		Строка.СубконтоДт2 	= СпособПоУмолчанию.СубконтоДт2;
		Строка.СубконтоДт3 	= СпособПоУмолчанию.СубконтоДт3;

		Строка.СчетДтНУ		= СпособПоУмолчанию.СчетДтНУ;
		Строка.СубконтоДтНУ1= СпособПоУмолчанию.СубконтоДтНУ1;
		Строка.СубконтоДтНУ2= СпособПоУмолчанию.СубконтоДтНУ2;
		Строка.СубконтоДтНУ3= СпособПоУмолчанию.СубконтоДтНУ3;
		
		// Проверим заполнена ли аналитика по подразделению
		Если Выборка.НомерСубконтоПодразделенияДт <> 0 Тогда
			Если НЕ ЗначениеЗаполнено(Строка["СубконтоДт" + Выборка.НомерСубконтоПодразделенияДт]) Тогда
				Строка["СубконтоДт" + Выборка.НомерСубконтоПодразделенияДт]= Выборка.ПодразделениеОрганизации;
			КонецЕсли;
			ОбщегоНазначенияБККлиентСервер.ЗаменитьСубконтоНУ(Строка, Строка.СчетДт, Строка.СчетДтНУ, Выборка.НомерСубконтоПодразделенияДт, Выборка.ПодразделениеОрганизации, "СубконтоДтНУ");
		КонецЕсли;
		Если Выборка.НомерСубконтоПодразделенияДтНУ <> 0 Тогда
			Если НЕ ЗначениеЗаполнено(Строка["СубконтоДтНУ" + Выборка.НомерСубконтоПодразделенияДтНУ]) Тогда
				Строка["СубконтоДтНУ" + Выборка.НомерСубконтоПодразделенияДтНУ]= Выборка.ПодразделениеОрганизации;
			КонецЕсли;
		КонецЕсли;
		
		// Проверим заполнена ли аналитика по статье затрат
		Если Выборка.НомерСубконтоСтатьиЗатратДт <> 0 Тогда
			Если НЕ ЗначениеЗаполнено(Строка["СубконтоДт" + Выборка.НомерСубконтоСтатьиЗатратДт]) Тогда
				Строка["СубконтоДт" + Выборка.НомерСубконтоСтатьиЗатратДт] = СтатьяЗатратСН;
			КонецЕсли;
			ОбщегоНазначенияБККлиентСервер.ЗаменитьСубконтоНУ(Строка, Строка.СчетДт, Строка.СчетДтНУ, Выборка.НомерСубконтоСтатьиЗатратДт, СтатьяЗатратСН, "СубконтоДтНУ");
		КонецЕсли;
		Если Выборка.НомерСубконтоСтатьиЗатратДтНУ <> 0 Тогда
			Если НЕ ЗначениеЗаполнено(Строка["СубконтоДтНУ" + Выборка.НомерСубконтоСтатьиЗатратДтНУ]) Тогда
				Строка["СубконтоДтНУ" + Выборка.НомерСубконтоСтатьиЗатратДтНУ] = СтатьяЗатратСН;
			КонецЕсли;
		КонецЕсли;

		Строка.СчетКт 		= СчетКредита;
		Строка.СубконтоКт1	= СубконтоКт1;
		Строка.СубконтоКт2 	= СубконтоКт2;
		НалоговыйКомитетВСтроке = Неопределено;
		Если ЗаполнятьНКпоСН  ИЛИ ЗаполнятьНКпоСНВНУ Тогда
			НалоговыйКомитетВСтроке = ПроцедурыНалоговогоУчета.ПолучитьНалоговыйКомитетСтруктурнойЕдиницы(Выборка.СтруктурнаяЕдиница,
																										Параметры.Организация,
																										ИсчислениеНалоговСтруктурныхЕдиниц,
																										Перечисления.РазделыНалоговогоУчета.НалогиСЗаработнойПлаты);
			Строка.СубконтоКт3 = НалоговыйКомитетВСтроке;
		КонецЕсли;
					
		Строка.СчетКтНУ = СчетКредитаНУ;			
		ОбщегоНазначенияБККлиентСервер.ЗаменитьСубконтоНУ(Строка, Строка.СчетКт, Строка.СчетКтНУ, 1, Строка.СубконтоКт1, "СубконтоКтНУ");
		ОбщегоНазначенияБККлиентСервер.ЗаменитьСубконтоНУ(Строка, Строка.СчетКт, Строка.СчетКтНУ, 2, Строка.СубконтоКт2, "СубконтоКтНУ");
		Если ЗаполнятьНКпоСНВНУ Тогда
			Строка.СубконтоКтНУ3 = НалоговыйКомитетВСтроке;
		КонецЕсли;
		
		Строка.Сумма					= Выборка.Налог;
		Строка.ФизЛицо					= Выборка.ФизЛицо;
		Строка.СтруктурноеПодразделениеДт = Параметры.СтруктурноеПодразделение;
		Строка.СтруктурноеПодразделениеКт = Параметры.СтруктурноеПодразделение;
		Строка.ВидРасчета				= СубконтоКт1;
	КонецЦикла;

#КонецОбласти

#Область ОПВРзаИП	
	// Отражение ОПВР за ИП
	Запрос.Текст =
		"ВЫБРАТЬ РАЗРЕШЕННЫЕ
		|	ОПВРРасчетыСФондами.ФизЛицо,
		|	ОПВРРасчетыСФондами.Организация,
		|	ОПВРРасчетыСФондами.СтруктурнаяЕдиница,
		|	ОПВРРасчетыСФондами.ПодразделениеОрганизации,
		|	ОПВРРасчетыСФондами.МесяцНалоговогоПериода,
		|	ОПВРРасчетыСФондами.ВидПлатежа,
		|	СУММА(ОПВРРасчетыСФондами.Взнос) КАК Взнос,
		|	ВЫБОР
		|		КОГДА ОПВРРасчетыСФондами.Регистратор ССЫЛКА Документ.РасчетПениОПВиСО
		|			ТОГДА ОПВРРасчетыСФондами.Регистратор
		|		ИНАЧЕ НЕОПРЕДЕЛЕНО
		|	КОНЕЦ КАК Регистратор
		|ПОМЕСТИТЬ ВТ_ДанныеОПВРЗаИП
		|ИЗ
		|	РегистрНакопления.ОПВРРасчетыСФондами КАК ОПВРРасчетыСФондами
		|		ЛЕВОЕ СОЕДИНЕНИЕ ВТ_УжеОтражено КАК УжеОтражено
		|		ПО ОПВРРасчетыСФондами.ФизЛицо = УжеОтражено.ФизЛицо
		|ГДЕ
		|	ОПВРРасчетыСФондами.Период >= &парамНачалоМесяца
		|	И ОПВРРасчетыСФондами.Период <= &парамКонецМесяца
		|	И ОПВРРасчетыСФондами.Организация = &парамОрганизация
		|	И ОПВРРасчетыСФондами.ФизЛицо = &парамИндивидуальныйПредприниматель
		|	И ОПВРРасчетыСФондами.ВидДвижения = &парамВидДвиженияПриход
		|	И ОПВРРасчетыСФондами.ВидСтроки = &парамВидСтрокиИсчисление
		|	И ОПВРРасчетыСФондами.Взнос <> 0
		|	И ОПВРРасчетыСФондами.Активность
		|	И УжеОтражено.ФизЛицо ЕСТЬ NULL 
		|
		|СГРУППИРОВАТЬ ПО
		|	ОПВРРасчетыСФондами.ФизЛицо,
		|	ОПВРРасчетыСФондами.Организация,
		|	ОПВРРасчетыСФондами.СтруктурнаяЕдиница,
		|	ОПВРРасчетыСФондами.ПодразделениеОрганизации,
		|	ОПВРРасчетыСФондами.МесяцНалоговогоПериода,
		|	ОПВРРасчетыСФондами.ВидПлатежа,
		|	ВЫБОР
		|		КОГДА ОПВРРасчетыСФондами.Регистратор ССЫЛКА Документ.РасчетПениОПВиСО
		|			ТОГДА ОПВРРасчетыСФондами.Регистратор
		|		ИНАЧЕ НЕОПРЕДЕЛЕНО
		|	КОНЕЦ
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ РАЗРЕШЕННЫЕ
		|	ОПВРРасчетыСФондами.ФизЛицо,
		|	ВЫБОР
		|		КОГДА ОПВРРасчетыСФондами.ПодразделениеОрганизации = ЗНАЧЕНИЕ(Справочник.ПодразделенияОрганизаций.ПустаяСсылка)
		|			ТОГДА РегистрацияДоходов.ПодразделениеОрганизации
		|		ИНАЧЕ ОПВРРасчетыСФондами.ПодразделениеОрганизации
		|	КОНЕЦ КАК ПодразделениеОрганизации,
		|	ОПВРРасчетыСФондами.ВидПлатежа,
		|	ОПВРРасчетыСФондами.Взнос КАК Взнос,
		|	ВЫБОР
		|		КОГДА ОПВРРасчетыСФондами.ВидПлатежа В (ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.Налог), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогАкт), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогСам))
		|			ТОГДА ВЫБОР
		|					КОГДА РегистрацияДоходов.СпособОтраженияВБУ ЕСТЬ NULL 
		|							ИЛИ РегистрацияДоходов.СпособОтраженияВБУ = ЗНАЧЕНИЕ(Справочник.СпособыОтраженияЗарплатыВРеглУчете.ПустаяСсылка)
		|							ИЛИ РегистрацияДоходов.СпособОтраженияВБУ.СчетДт = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
		|						ТОГДА &парамСпособПоУмолчаниюСчетДт
		|					ИНАЧЕ РегистрацияДоходов.СпособОтраженияВБУ.СчетДт
		|				КОНЕЦ
		|		ИНАЧЕ ВЫБОР
		|				КОГДА РасчетПениОПВиСО.СчетЗатратБУ ЕСТЬ NULL 
		|						ИЛИ РасчетПениОПВиСО.СчетЗатратБУ = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
		|					ТОГДА &парамСчетДтДляПени
		|				ИНАЧЕ РасчетПениОПВиСО.СчетЗатратБУ
		|			КОНЕЦ
		|	КОНЕЦ КАК СчетДт,
		|	ВЫБОР
		|		КОГДА ОПВРРасчетыСФондами.ВидПлатежа В (ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.Налог), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогАкт), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогСам))
		|			ТОГДА ВЫБОР
		|					КОГДА РегистрацияДоходов.СпособОтраженияВБУ ЕСТЬ NULL 
		|							ИЛИ РегистрацияДоходов.СпособОтраженияВБУ = ЗНАЧЕНИЕ(Справочник.СпособыОтраженияЗарплатыВРеглУчете.ПустаяСсылка)
		|							ИЛИ РегистрацияДоходов.СпособОтраженияВБУ.СчетДт = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
		|						ТОГДА &парамСпособПоУмолчаниюСубконтоДт1
		|					ИНАЧЕ РегистрацияДоходов.СпособОтраженияВБУ.СубконтоДт1
		|				КОНЕЦ
		|		ИНАЧЕ ВЫБОР
		|				КОГДА РасчетПениОПВиСО.СчетЗатратБУ ЕСТЬ NULL 
		|						ИЛИ РасчетПениОПВиСО.СчетЗатратБУ = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
		|					ТОГДА НЕОПРЕДЕЛЕНО
		|				ИНАЧЕ ЕСТЬNULL(РасчетПениОПВиСО.СубконтоЗатратБУ1, НЕОПРЕДЕЛЕНО)
		|			КОНЕЦ
		|	КОНЕЦ КАК СубконтоДт1,
		|	ВЫБОР
		|		КОГДА ОПВРРасчетыСФондами.ВидПлатежа В (ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.Налог), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогАкт), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогСам))
		|			ТОГДА ВЫБОР
		|					КОГДА РегистрацияДоходов.СпособОтраженияВБУ ЕСТЬ NULL 
		|							ИЛИ РегистрацияДоходов.СпособОтраженияВБУ = ЗНАЧЕНИЕ(Справочник.СпособыОтраженияЗарплатыВРеглУчете.ПустаяСсылка)
		|							ИЛИ РегистрацияДоходов.СпособОтраженияВБУ.СчетДт = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
		|						ТОГДА &парамСпособПоУмолчаниюСубконтоДт2
		|					ИНАЧЕ РегистрацияДоходов.СпособОтраженияВБУ.СубконтоДт2
		|				КОНЕЦ
		|		ИНАЧЕ ВЫБОР
		|				КОГДА РасчетПениОПВиСО.СчетЗатратБУ ЕСТЬ NULL 
		|						ИЛИ РасчетПениОПВиСО.СчетЗатратБУ = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
		|					ТОГДА НЕОПРЕДЕЛЕНО
		|				ИНАЧЕ ЕСТЬNULL(РасчетПениОПВиСО.СубконтоЗатратБУ2, НЕОПРЕДЕЛЕНО)
		|			КОНЕЦ
		|	КОНЕЦ КАК СубконтоДт2,
		|	ВЫБОР
		|		КОГДА ОПВРРасчетыСФондами.ВидПлатежа В (ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.Налог), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогАкт), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогСам))
		|			ТОГДА ВЫБОР
		|					КОГДА РегистрацияДоходов.СпособОтраженияВБУ ЕСТЬ NULL 
		|							ИЛИ РегистрацияДоходов.СпособОтраженияВБУ = ЗНАЧЕНИЕ(Справочник.СпособыОтраженияЗарплатыВРеглУчете.ПустаяСсылка)
		|							ИЛИ РегистрацияДоходов.СпособОтраженияВБУ.СчетДт = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
		|						ТОГДА &парамСпособПоУмолчаниюСубконтоДт3
		|					ИНАЧЕ РегистрацияДоходов.СпособОтраженияВБУ.СубконтоДт3
		|				КОНЕЦ
		|		ИНАЧЕ ВЫБОР
		|				КОГДА РасчетПениОПВиСО.СчетЗатратБУ ЕСТЬ NULL 
		|						ИЛИ РасчетПениОПВиСО.СчетЗатратБУ = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
		|					ТОГДА НЕОПРЕДЕЛЕНО
		|				ИНАЧЕ ЕСТЬNULL(РасчетПениОПВиСО.СубконтоЗатратБУ2, НЕОПРЕДЕЛЕНО)
		|			КОНЕЦ
		|	КОНЕЦ КАК СубконтоДт3,
		|	ВЫБОР
		|		КОГДА ОПВРРасчетыСФондами.ВидПлатежа В (ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.Налог), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогАкт), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогСам))
		|			ТОГДА ВЫБОР
		|					КОГДА РегистрацияДоходов.СпособОтраженияВБУ ЕСТЬ NULL 
		|							ИЛИ РегистрацияДоходов.СпособОтраженияВБУ = ЗНАЧЕНИЕ(Справочник.СпособыОтраженияЗарплатыВРеглУчете.ПустаяСсылка)
		|							ИЛИ РегистрацияДоходов.СпособОтраженияВБУ.СчетДтНУ = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
		|						ТОГДА &парамСпособПоУмолчаниюСчетДтНУ
		|					ИНАЧЕ РегистрацияДоходов.СпособОтраженияВБУ.СчетДтНУ
		|				КОНЕЦ
		|		ИНАЧЕ ВЫБОР
		|				КОГДА РасчетПениОПВиСО.СчетЗатратНУ ЕСТЬ NULL 
		|						ИЛИ РасчетПениОПВиСО.СчетЗатратНУ = ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
		|					ТОГДА &парамСчетДтДляПениНУ
		|				ИНАЧЕ РасчетПениОПВиСО.СчетЗатратНУ
		|			КОНЕЦ
		|	КОНЕЦ КАК СчетДтНУ,
		|	ВЫБОР
		|		КОГДА ОПВРРасчетыСФондами.ВидПлатежа В (ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.Налог), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогАкт), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогСам))
		|			ТОГДА ВЫБОР
		|					КОГДА РегистрацияДоходов.СпособОтраженияВБУ ЕСТЬ NULL 
		|							ИЛИ РегистрацияДоходов.СпособОтраженияВБУ = ЗНАЧЕНИЕ(Справочник.СпособыОтраженияЗарплатыВРеглУчете.ПустаяСсылка)
		|							ИЛИ РегистрацияДоходов.СпособОтраженияВБУ.СчетДтНУ = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
		|						ТОГДА &парамСпособПоУмолчаниюСубконтоДтНУ1
		|					ИНАЧЕ РегистрацияДоходов.СпособОтраженияВБУ.СубконтоДтНУ1
		|				КОНЕЦ
		|		ИНАЧЕ ВЫБОР
		|				КОГДА РасчетПениОПВиСО.СчетЗатратНУ ЕСТЬ NULL 
		|						ИЛИ РасчетПениОПВиСО.СчетЗатратНУ = ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
		|					ТОГДА НЕОПРЕДЕЛЕНО
		|				ИНАЧЕ ЕСТЬNULL(РасчетПениОПВиСО.СубконтоЗатратНУ1, НЕОПРЕДЕЛЕНО)
		|			КОНЕЦ
		|	КОНЕЦ КАК СубконтоДтНУ1,
		|	ВЫБОР
		|		КОГДА ОПВРРасчетыСФондами.ВидПлатежа В (ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.Налог), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогАкт), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогСам))
		|			ТОГДА ВЫБОР
		|					КОГДА РегистрацияДоходов.СпособОтраженияВБУ ЕСТЬ NULL 
		|							ИЛИ РегистрацияДоходов.СпособОтраженияВБУ = ЗНАЧЕНИЕ(Справочник.СпособыОтраженияЗарплатыВРеглУчете.ПустаяСсылка)
		|							ИЛИ РегистрацияДоходов.СпособОтраженияВБУ.СчетДтНУ = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
		|						ТОГДА &парамСпособПоУмолчаниюСубконтоДтНУ2
		|					ИНАЧЕ РегистрацияДоходов.СпособОтраженияВБУ.СубконтоДтНУ2
		|				КОНЕЦ
		|		ИНАЧЕ ВЫБОР
		|				КОГДА РасчетПениОПВиСО.СчетЗатратНУ ЕСТЬ NULL 
		|						ИЛИ РасчетПениОПВиСО.СчетЗатратНУ = ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
		|					ТОГДА НЕОПРЕДЕЛЕНО
		|				ИНАЧЕ ЕСТЬNULL(РасчетПениОПВиСО.СубконтоЗатратНУ2, НЕОПРЕДЕЛЕНО)
		|			КОНЕЦ
		|	КОНЕЦ КАК СубконтоДтНУ2,
		|	ВЫБОР
		|		КОГДА ОПВРРасчетыСФондами.ВидПлатежа В (ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.Налог), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогАкт), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогСам))
		|			ТОГДА ВЫБОР
		|					КОГДА РегистрацияДоходов.СпособОтраженияВБУ ЕСТЬ NULL 
		|							ИЛИ РегистрацияДоходов.СпособОтраженияВБУ = ЗНАЧЕНИЕ(Справочник.СпособыОтраженияЗарплатыВРеглУчете.ПустаяСсылка)
		|							ИЛИ РегистрацияДоходов.СпособОтраженияВБУ.СчетДтНУ = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
		|						ТОГДА &парамСпособПоУмолчаниюСубконтоДтНУ2
		|					ИНАЧЕ РегистрацияДоходов.СпособОтраженияВБУ.СубконтоДтНУ2
		|				КОНЕЦ
		|		ИНАЧЕ ВЫБОР
		|				КОГДА РасчетПениОПВиСО.СчетЗатратНУ ЕСТЬ NULL 
		|						ИЛИ РасчетПениОПВиСО.СчетЗатратНУ = ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
		|					ТОГДА НЕОПРЕДЕЛЕНО
		|				ИНАЧЕ ЕСТЬNULL(РасчетПениОПВиСО.СубконтоЗатратНУ2, НЕОПРЕДЕЛЕНО)
		|			КОНЕЦ
		|	КОНЕЦ КАК СубконтоДтНУ3,
		|	ВЫБОР
		|		КОГДА ОПВРРасчетыСФондами.ВидПлатежа В (ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.Налог), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогАкт), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогСам))
		|			ТОГДА ЕСТЬNULL(РегистрацияДоходов.СпособОтраженияВБУ.СчетКт, НЕОПРЕДЕЛЕНО)
		|		ИНАЧЕ НЕОПРЕДЕЛЕНО
		|	КОНЕЦ КАК СчетКт,
		|	ВЫБОР
		|		КОГДА ОПВРРасчетыСФондами.ВидПлатежа В (ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.Налог), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогАкт), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогСам))
		|			ТОГДА ЕСТЬNULL(РегистрацияДоходов.СпособОтраженияВБУ.СубконтоКт1, НЕОПРЕДЕЛЕНО)
		|		ИНАЧЕ НЕОПРЕДЕЛЕНО
		|	КОНЕЦ КАК СубконтоКт1,
		|	ВЫБОР
		|		КОГДА ОПВРРасчетыСФондами.ВидПлатежа В (ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.Налог), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогАкт), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогСам))
		|			ТОГДА ЕСТЬNULL(РегистрацияДоходов.СпособОтраженияВБУ.СубконтоКт2, НЕОПРЕДЕЛЕНО)
		|		ИНАЧЕ НЕОПРЕДЕЛЕНО
		|	КОНЕЦ КАК СубконтоКт2,
		|	ВЫБОР
		|		КОГДА ОПВРРасчетыСФондами.ВидПлатежа В (ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.Налог), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогАкт), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогСам))
		|			ТОГДА ЕСТЬNULL(РегистрацияДоходов.СпособОтраженияВБУ.СубконтоКт3, НЕОПРЕДЕЛЕНО)
		|		ИНАЧЕ НЕОПРЕДЕЛЕНО
		|	КОНЕЦ КАК СубконтоКт3,
		|	ВЫБОР
		|		КОГДА ОПВРРасчетыСФондами.ВидПлатежа В (ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.Налог), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогАкт), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогСам))
		|			ТОГДА ЕСТЬNULL(РегистрацияДоходов.СпособОтраженияВБУ.СчетКтНУ, НЕОПРЕДЕЛЕНО)
		|		ИНАЧЕ НЕОПРЕДЕЛЕНО
		|	КОНЕЦ КАК СчетКтНУ,
		|	ВЫБОР
		|		КОГДА ОПВРРасчетыСФондами.ВидПлатежа В (ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.Налог), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогАкт), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогСам))
		|			ТОГДА ЕСТЬNULL(РегистрацияДоходов.СпособОтраженияВБУ.СубконтоКтНУ1, НЕОПРЕДЕЛЕНО)
		|		ИНАЧЕ НЕОПРЕДЕЛЕНО
		|	КОНЕЦ КАК СубконтоКтНУ1,
		|	ВЫБОР
		|		КОГДА ОПВРРасчетыСФондами.ВидПлатежа В (ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.Налог), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогАкт), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогСам))
		|			ТОГДА ЕСТЬNULL(РегистрацияДоходов.СпособОтраженияВБУ.СубконтоКтНУ2, НЕОПРЕДЕЛЕНО)
		|		ИНАЧЕ НЕОПРЕДЕЛЕНО
		|	КОНЕЦ КАК СубконтоКтНУ2,
		|	ВЫБОР
		|		КОГДА ОПВРРасчетыСФондами.ВидПлатежа В (ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.Налог), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогАкт), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогСам))
		|			ТОГДА ЕСТЬNULL(РегистрацияДоходов.СпособОтраженияВБУ.СубконтоКтНУ3, НЕОПРЕДЕЛЕНО)
		|		ИНАЧЕ НЕОПРЕДЕЛЕНО
		|	КОНЕЦ КАК СубконтоКтНУ3,
		|	ВЫБОР
		|		КОГДА ОПВРРасчетыСФондами.ВидПлатежа В (ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.Налог), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогАкт), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогСам))
		|			ТОГДА ЕСТЬNULL(ВидСубконтоСтатьиЗатрат.НомерСтроки, 0)
		|		ИНАЧЕ ЕСТЬNULL(ВидСубконтоСтатьиЗатратДляПени.НомерСтроки, 0)
		|	КОНЕЦ КАК НомерСубконтоСтатьиЗатратДт,
		|	ВЫБОР
		|		КОГДА ОПВРРасчетыСФондами.ВидПлатежа В (ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.Налог), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогАкт), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогСам))
		|			ТОГДА ЕСТЬNULL(ВидСубконтоПодразделения.НомерСтроки, 0)
		|		ИНАЧЕ ЕСТЬNULL(ВидСубконтоПодразделенияДляПени.НомерСтроки, 0)
		|	КОНЕЦ КАК НомерСубконтоПодразделенияДт,
		|	ВЫБОР
		|		КОГДА ОПВРРасчетыСФондами.ВидПлатежа В (ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.Налог), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогАкт), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогСам))
		|			ТОГДА ЕСТЬNULL(ВидСубконтоСтатьиЗатратНУ.НомерСтроки, 0)
		|		ИНАЧЕ ЕСТЬNULL(ВидСубконтоСтатьиЗатратДляПениНУ.НомерСтроки, 0)
		|	КОНЕЦ КАК НомерСубконтоСтатьиЗатратДтНУ,
		|	ВЫБОР
		|		КОГДА ОПВРРасчетыСФондами.ВидПлатежа В (ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.Налог), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогАкт), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогСам))
		|			ТОГДА ЕСТЬNULL(ВидСубконтоПодразделенияНУ.НомерСтроки, 0)
		|		ИНАЧЕ ЕСТЬNULL(ВидСубконтоПодразделенияДляПениНУ.НомерСтроки, 0)
		|	КОНЕЦ КАК НомерСубконтоПодразделенияДтНУ,
		|	ВЫБОР
		|		КОГДА ОПВРРасчетыСФондами.ВидПлатежа В (ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.Налог), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогАкт), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогСам))
		|			ТОГДА ЕСТЬNULL(ВидСубконтоРаботникиОрганизаций.НомерСтроки, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ КАК НомерСубконтоРаботникиОрганизацийКт,
		|	ВЫБОР
		|		КОГДА ОПВРРасчетыСФондами.ВидПлатежа В (ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.Налог), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогАкт), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогСам))
		|			ТОГДА ЕСТЬNULL(ВидСубконтоРаботникиОрганизацийНУ.НомерСтроки, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ КАК НомерСубконтоРаботникиОрганизацийКтНУ,
		|	ВЫБОР
		|		КОГДА ОПВРРасчетыСФондами.ВидПлатежа В (ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.Налог), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогАкт), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогСам))
		|			ТОГДА ЕСТЬNULL(ВидСубконтоВидыПлатежей.НомерСтроки, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ КАК НомерСубконтоВидыПлатежейКт,
		|	ВЫБОР
		|		КОГДА ОПВРРасчетыСФондами.ВидПлатежа В (ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.Налог), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогАкт), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогСам))
		|			ТОГДА ЕСТЬNULL(ВидСубконтоВидыПлатежей.НомерСтроки, 0)
		|		ИНАЧЕ 0
		|	КОНЕЦ КАК НомерСубконтоВидыПлатежейКтНУ
		|ИЗ
		|	ВТ_ДанныеОПВРЗаИП КАК ОПВРРасчетыСФондами
		|		ЛЕВОЕ СОЕДИНЕНИЕ ВТ_ДанныеРегистрацииДоходов КАК РегистрацияДоходов
		|		ПО (ЕСТЬNULL(РегистрацияДоходов.УчитыватьОПВР, ЛОЖЬ))
		|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Типовой.ВидыСубконто КАК ВидСубконтоСтатьиЗатрат
		|		ПО (ВидСубконтоСтатьиЗатрат.Ссылка = ВЫБОР
		|				КОГДА РегистрацияДоходов.СпособОтраженияВБУ ЕСТЬ NULL 
		|						ИЛИ РегистрацияДоходов.СпособОтраженияВБУ.СчетДт = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
		|					ТОГДА &парамСпособПоУмолчаниюСчетДт
		|				ИНАЧЕ РегистрацияДоходов.СпособОтраженияВБУ.СчетДт
		|			КОНЕЦ)
		|			И (ВидСубконтоСтатьиЗатрат.ВидСубконто = &парамВидСубконтоСтатьиЗатрат)
		|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Типовой.ВидыСубконто КАК ВидСубконтоПодразделения
		|		ПО (ВидСубконтоПодразделения.Ссылка = ВЫБОР
		|				КОГДА РегистрацияДоходов.СпособОтраженияВБУ ЕСТЬ NULL 
		|						ИЛИ РегистрацияДоходов.СпособОтраженияВБУ.СчетДт = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
		|					ТОГДА &парамСпособПоУмолчаниюСчетДт
		|				ИНАЧЕ РегистрацияДоходов.СпособОтраженияВБУ.СчетДт
		|			КОНЕЦ)
		|			И (ВидСубконтоПодразделения.ВидСубконто = &парамВидСубконтоПодразделения)
		|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Налоговый.ВидыСубконто КАК ВидСубконтоСтатьиЗатратНУ
		|		ПО (ВидСубконтоСтатьиЗатратНУ.Ссылка = ВЫБОР
		|				КОГДА РегистрацияДоходов.СпособОтраженияВБУ.СчетДтНУ ЕСТЬ NULL 
		|						ИЛИ РегистрацияДоходов.СпособОтраженияВБУ.СчетДтНУ = ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
		|					ТОГДА &парамСпособПоУмолчаниюСчетДтНУ
		|				ИНАЧЕ РегистрацияДоходов.СпособОтраженияВБУ.СчетДтНУ
		|			КОНЕЦ)
		|			И (ВидСубконтоСтатьиЗатратНУ.ВидСубконто = &парамВидСубконтоСтатьиЗатрат)
		|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Налоговый.ВидыСубконто КАК ВидСубконтоПодразделенияНУ
		|		ПО (ВидСубконтоПодразделенияНУ.Ссылка = ВЫБОР
		|				КОГДА РегистрацияДоходов.СпособОтраженияВБУ.СчетДтНУ ЕСТЬ NULL 
		|						ИЛИ РегистрацияДоходов.СпособОтраженияВБУ.СчетДтНУ = ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
		|					ТОГДА &парамСпособПоУмолчаниюСчетДтНУ
		|				ИНАЧЕ РегистрацияДоходов.СпособОтраженияВБУ.СчетДтНУ
		|			КОНЕЦ)
		|			И (ВидСубконтоПодразделенияНУ.ВидСубконто = &парамВидСубконтоПодразделения)
		|		ЛЕВОЕ СОЕДИНЕНИЕ Документ.РасчетПениОПВиСО КАК РасчетПениОПВиСО
		|		ПО ОПВРРасчетыСФондами.Регистратор = РасчетПениОПВиСО.Ссылка
		|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Типовой.ВидыСубконто КАК ВидСубконтоСтатьиЗатратДляПени
		|		ПО (ВидСубконтоСтатьиЗатратДляПени.Ссылка = ВЫБОР
		|				КОГДА РасчетПениОПВиСО.СчетЗатратБУ ЕСТЬ NULL 
		|						ИЛИ РасчетПениОПВиСО.СчетЗатратБУ = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
		|					ТОГДА &парамСчетДтДляПени
		|				ИНАЧЕ РасчетПениОПВиСО.СчетЗатратБУ
		|			КОНЕЦ)
		|			И (ВидСубконтоСтатьиЗатратДляПени.ВидСубконто = &парамВидСубконтоСтатьиЗатрат)
		|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Типовой.ВидыСубконто КАК ВидСубконтоПодразделенияДляПени
		|		ПО (ВидСубконтоПодразделенияДляПени.Ссылка = ВЫБОР
		|				КОГДА РасчетПениОПВиСО.СчетЗатратБУ ЕСТЬ NULL 
		|						ИЛИ РасчетПениОПВиСО.СчетЗатратБУ = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
		|					ТОГДА &парамСчетДтДляПени
		|				ИНАЧЕ РасчетПениОПВиСО.СчетЗатратБУ
		|			КОНЕЦ)
		|			И (ВидСубконтоПодразделенияДляПени.ВидСубконто = &парамВидСубконтоПодразделения)
		|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Налоговый.ВидыСубконто КАК ВидСубконтоСтатьиЗатратДляПениНУ
		|		ПО (ВидСубконтоСтатьиЗатратДляПениНУ.Ссылка = ВЫБОР
		|				КОГДА РасчетПениОПВиСО.СчетЗатратНУ ЕСТЬ NULL 
		|						ИЛИ РасчетПениОПВиСО.СчетЗатратНУ = ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
		|					ТОГДА &парамСчетДтДляПениНУ
		|				ИНАЧЕ РасчетПениОПВиСО.СчетЗатратНУ
		|			КОНЕЦ)
		|			И (ВидСубконтоСтатьиЗатратДляПениНУ.ВидСубконто = &парамВидСубконтоСтатьиЗатрат)
		|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Налоговый.ВидыСубконто КАК ВидСубконтоПодразделенияДляПениНУ
		|		ПО (ВидСубконтоПодразделенияДляПениНУ.Ссылка = ВЫБОР
		|				КОГДА РасчетПениОПВиСО.СчетЗатратНУ ЕСТЬ NULL 
		|						ИЛИ РасчетПениОПВиСО.СчетЗатратНУ = ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
		|					ТОГДА &парамСчетДтДляПениНУ
		|				ИНАЧЕ РасчетПениОПВиСО.СчетЗатратНУ
		|			КОНЕЦ)
		|			И (ВидСубконтоПодразделенияДляПениНУ.ВидСубконто = &парамВидСубконтоПодразделения)
		|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Типовой.ВидыСубконто КАК ВидСубконтоРаботникиОрганизаций
		|		ПО (ВидСубконтоРаботникиОрганизаций.Ссылка = ВЫБОР
		|				КОГДА РегистрацияДоходов.СпособОтраженияВБУ ЕСТЬ NULL 
		|						ИЛИ РегистрацияДоходов.СпособОтраженияВБУ.СчетКт = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
		|					ТОГДА НЕОПРЕДЕЛЕНО
		|				ИНАЧЕ РегистрацияДоходов.СпособОтраженияВБУ.СчетКт
		|			КОНЕЦ)
		|			И (ВидСубконтоРаботникиОрганизаций.ВидСубконто = &парамВидСубконтоРаботникиОрганизаций)
		|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Типовой.ВидыСубконто КАК ВидСубконтоВидыПлатежей
		|		ПО (ВидСубконтоВидыПлатежей.Ссылка = ВЫБОР
		|				КОГДА РегистрацияДоходов.СпособОтраженияВБУ ЕСТЬ NULL 
		|						ИЛИ РегистрацияДоходов.СпособОтраженияВБУ.СчетКт = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
		|					ТОГДА НЕОПРЕДЕЛЕНО
		|				ИНАЧЕ РегистрацияДоходов.СпособОтраженияВБУ.СчетКт
		|			КОНЕЦ)
		|			И (ВидСубконтоВидыПлатежей.ВидСубконто = &парамВидСубконтоВидыПлатежей)
		|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Налоговый.ВидыСубконто КАК ВидСубконтоРаботникиОрганизацийНУ
		|		ПО (ВидСубконтоРаботникиОрганизацийНУ.Ссылка = ВЫБОР
		|				КОГДА РегистрацияДоходов.СпособОтраженияВБУ ЕСТЬ NULL 
		|						ИЛИ РегистрацияДоходов.СпособОтраженияВБУ.СчетКтНУ = ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
		|					ТОГДА НЕОПРЕДЕЛЕНО
		|				ИНАЧЕ РегистрацияДоходов.СпособОтраженияВБУ.СчетКтНУ
		|			КОНЕЦ)
		|			И (ВидСубконтоРаботникиОрганизацийНУ.ВидСубконто = &парамВидСубконтоРаботникиОрганизаций)
		|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Налоговый.ВидыСубконто КАК ВидСубконтоВидыПлатежейНУ
		|		ПО (ВидСубконтоВидыПлатежейНУ.Ссылка = ВЫБОР
		|				КОГДА РегистрацияДоходов.СпособОтраженияВБУ ЕСТЬ NULL 
		|						ИЛИ РегистрацияДоходов.СпособОтраженияВБУ.СчетКтНУ = ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
		|					ТОГДА НЕОПРЕДЕЛЕНО
		|				ИНАЧЕ РегистрацияДоходов.СпособОтраженияВБУ.СчетКтНУ
		|			КОНЕЦ)
		|			И (ВидСубконтоВидыПлатежейНУ.ВидСубконто = &парамВидСубконтоВидыПлатежей)
		|ГДЕ
		|	ВЫБОР
		|			КОГДА ОПВРРасчетыСФондами.ВидПлатежа В (ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.Налог), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогАкт), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогСам))
		|				ТОГДА РегистрацияДоходов.СпособОтраженияВБУ <> ЗНАЧЕНИЕ(Справочник.СпособыОтраженияЗарплатыВРеглУчете.НеОтражатьВБухучете)
		|			ИНАЧЕ ИСТИНА
		|		КОНЕЦ";

	СпособПоУмолчанию = Справочники.СпособыОтраженияЗарплатыВРеглУчете.ОтражениеНачисленийПоУмолчанию;
	Запрос.УстановитьПараметр("парамСпособПоУмолчанию", СпособПоУмолчанию);
	Запрос.УстановитьПараметр("парамСпособПоУмолчаниюСчетДт", СпособПоУмолчанию.СчетДт);
	Запрос.УстановитьПараметр("парамСпособПоУмолчаниюСубконтоДт1", СпособПоУмолчанию.СубконтоДт1);
	Запрос.УстановитьПараметр("парамСпособПоУмолчаниюСубконтоДт2", СпособПоУмолчанию.СубконтоДт2);
	Запрос.УстановитьПараметр("парамСпособПоУмолчаниюСубконтоДт3", СпособПоУмолчанию.СубконтоДт3);
	Запрос.УстановитьПараметр("парамСпособПоУмолчаниюСчетДтНУ",    СпособПоУмолчанию.СчетДтНУ);
	Запрос.УстановитьПараметр("парамСпособПоУмолчаниюСубконтоДтНУ1", СпособПоУмолчанию.СубконтоДтНУ1);
	Запрос.УстановитьПараметр("парамСпособПоУмолчаниюСубконтоДтНУ2", СпособПоУмолчанию.СубконтоДтНУ2);
	Запрос.УстановитьПараметр("парамСпособПоУмолчаниюСубконтоДтНУ3", СпособПоУмолчанию.СубконтоДтНУ3);
	Запрос.УстановитьПараметр("парамВидСубконтоВидыПлатежей", ПланыВидовХарактеристик.ВидыСубконтоТиповые.ВидыПлатежейВБюджетИФонды);
	
	СчетКредита = Справочники.НалогиСборыОтчисления.ОбязательныеПенсионныеВзносыРаботодателя.СчетУчетаРасчетовСКонтрагентомБУ;
	Если НЕ ЗначениеЗаполнено(СчетКредита) Тогда
		СчетКредита = ПланыСчетов.Типовой.ОбязательстваПоОбязательнымПенсионнымВзносамРаботодателя;
	КонецЕсли;
	
	СчетКредитаНУ = ПроцедурыНалоговогоУчетаВызовСервераПовтИсп.ПолучитьСчетУчетаНУОПВР(СчетКредита,КонецМесяца(Параметры.ПериодРегистрации));
	
	Выборка = Запрос.Выполнить().Выбрать();
		
	Пока Выборка.Следующий() Цикл
		Строка = Параметры.ТаблицаОтражениеВУчете.Добавить();
		
		// Ставим на разные счета затрат в зависимости от вида платежа
		Если Выборка.ВидПлатежа = Перечисления.ВидыПлатежейВБюджетИФонды.Налог
			 Или Выборка.ВидПлатежа = Перечисления.ВидыПлатежейВБюджетИФонды.НалогАкт 
			 Или Выборка.ВидПлатежа = Перечисления.ВидыПлатежейВБюджетИФонды.НалогСам Тогда
			Строка.ВидРасчета	= ВидНалогаСбораОтчисленияОПВР;
			Строка.СчетДт 		= Выборка.СчетДт;
			Строка.СубконтоДт1 	= Выборка.СубконтоДт1;
			Строка.СубконтоДт2 	= Выборка.СубконтоДт2;
			Строка.СубконтоДт3 	= Выборка.СубконтоДт3;
			
			Строка.СчетДтНУ 		= Выборка.СчетДтНУ;
			Строка.СубконтоДтНУ1 	= Выборка.СубконтоДтНУ1;
			Строка.СубконтоДтНУ2 	= Выборка.СубконтоДтНУ2;
			Строка.СубконтоДтНУ3 	= Выборка.СубконтоДтНУ3;
		Иначе // Пеня по ОПВ
			Строка.ВидРасчета		= СтатьяЗатратПеняПоОПВР;
			Строка.СчетДт			= Выборка.СчетДт;
			Строка.СчетДтНУ 		= Выборка.СчетДтНУ;
			
			Если Выборка.НомерСубконтоСтатьиЗатратДт <> 0 Тогда
				Если ЗначениеЗаполнено(Выборка["СубконтоДт" + Выборка.НомерСубконтоСтатьиЗатратДт]) Тогда
					Строка["СубконтоДт" + Выборка.НомерСубконтоСтатьиЗатратДт] = Выборка["СубконтоДт" + Выборка.НомерСубконтоСтатьиЗатратДт];
				Иначе
					Строка["СубконтоДт" + Выборка.НомерСубконтоСтатьиЗатратДт] = СтатьяЗатратПеняПоОПВР;
				КонецЕсли;
				ОбщегоНазначенияБККлиентСервер.ЗаменитьСубконтоНУ(Строка, Строка.СчетДт, Строка.СчетДтНУ, Выборка.НомерСубконтоСтатьиЗатратДт, СтатьяЗатратПеняПоОПВР, "СубконтоДтНУ");
			КонецЕсли;
			Если Выборка.НомерСубконтоСтатьиЗатратДтНУ <> 0 Тогда
				Если ЗначениеЗаполнено(Выборка["СубконтоДтНУ" + Выборка.НомерСубконтоСтатьиЗатратДтНУ]) Тогда
					Строка["СубконтоДтНУ" + Выборка.НомерСубконтоСтатьиЗатратДтНУ] = Выборка["СубконтоДтНУ" + Выборка.НомерСубконтоСтатьиЗатратДтНУ];
				Иначе
					Строка["СубконтоДтНУ" + Выборка.НомерСубконтоСтатьиЗатратДтНУ] = СтатьяЗатратПеняПоОПВР;
				КонецЕсли;
			КонецЕсли;

			// Заполним оставшиеся субконто
			Для Ном = 1 По 3 Цикл
				Если НЕ ЗначениеЗаполнено(Строка["СубконтоДт" + Ном]) Тогда
					Строка["СубконтоДт" + Ном] = Выборка["СубконтоДт" + Ном];
				КонецЕсли;
				Если НЕ ЗначениеЗаполнено(Строка["СубконтоДтНУ" + Ном]) Тогда
					Если ЗначениеЗаполнено(Выборка["СубконтоДтНУ" + Ном]) Тогда
						Строка["СубконтоДтНУ" + Ном] = Выборка["СубконтоДтНУ" + Ном];
					Иначе
						ОбщегоНазначенияБККлиентСервер.ЗаменитьСубконтоНУ(Строка, СчетДебетаДляПени, СчетДебетаДляПениНУ, Ном, СтатьяЗатратПеняПоОПВР, "СубконтоДтНУ");
					КонецЕсли;
				КонецЕсли;
			КонецЦикла;
			
		КонецЕсли;
		
		Если Выборка.НомерСубконтоПодразделенияДт <> 0 Тогда
			Если ЗначениеЗаполнено(Выборка["СубконтоДт" + Выборка.НомерСубконтоПодразделенияДт]) Тогда
				Строка["СубконтоДт" + Выборка.НомерСубконтоПодразделенияДт] = Выборка["СубконтоДт" + Выборка.НомерСубконтоПодразделенияДт];
			Иначе 
				Строка["СубконтоДт" + Выборка.НомерСубконтоПодразделенияДт]= Выборка.ПодразделениеОрганизации;
			КонецЕсли;
			ОбщегоНазначенияБККлиентСервер.ЗаменитьСубконтоНУ(Строка, Строка.СчетДт, Строка.СчетДтНУ, Выборка.НомерСубконтоПодразделенияДт, Выборка.ПодразделениеОрганизации, "СубконтоДтНУ");
		КонецЕсли;
		Если Выборка.НомерСубконтоПодразделенияДтНУ <> 0 Тогда
			Если ЗначениеЗаполнено(Выборка["СубконтоДтНУ" + Выборка.НомерСубконтоПодразделенияДтНУ]) Тогда
				Строка["СубконтоДтНУ" + Выборка.НомерСубконтоПодразделенияДтНУ] = Выборка["СубконтоДтНУ" + Выборка.НомерСубконтоПодразделенияДтНУ];
			Иначе 
				Строка["СубконтоДтНУ" + Выборка.НомерСубконтоПодразделенияДтНУ]= Выборка.ПодразделениеОрганизации;
			КонецЕсли;
		КонецЕсли;
		
		Если ЗначениеЗаполнено(Выборка.СчетКт) Тогда
			Строка.СчетКт 		= Выборка.СчетКт;
			Строка.СубконтоКт1 	= Выборка.СубконтоКт1;
			Строка.СубконтоКт2 	= Выборка.СубконтоКт2;
			Строка.СубконтоКт3	= Выборка.СубконтоКт3;		
			
			Строка.СчетКтНУ 		= Выборка.СчетКтНУ;
			Строка.СубконтоКтНУ1 	= Выборка.СубконтоКтНУ1;
			Строка.СубконтоКтНУ2 	= Выборка.СубконтоКтНУ2;
			Строка.СубконтоКтНУ3	= Выборка.СубконтоКтНУ3;		
			
			// Проверяем заполнена ли аналитика по видам платежей, если нет, заполняем
			Если Выборка.НомерСубконтоВидыПлатежейКт <> 0 Тогда
				Если ЗначениеЗаполнено(Выборка["СубконтоКт" + Выборка.НомерСубконтоВидыПлатежейКт]) Тогда
					Строка["СубконтоКт" + Выборка.НомерСубконтоВидыПлатежейКт] = Выборка["СубконтоКт" + Выборка.НомерСубконтоВидыПлатежейКт];
				Иначе 
					Строка["СубконтоКт" + Выборка.НомерСубконтоВидыПлатежейКт]= Выборка.ВидПлатежа;
				КонецЕсли;
				ОбщегоНазначенияБККлиентСервер.ЗаменитьСубконтоНУ(Строка, Строка.СчетДт, Строка.СчетДтНУ, Выборка.НомерСубконтоВидыПлатежейКт, Выборка.ВидПлатежа, "СубконтоКтНУ");
			КонецЕсли;
			Если Выборка.НомерСубконтоВидыПлатежейКтНУ <> 0 Тогда
				Если ЗначениеЗаполнено(Выборка["СубконтоКтНУ" + Выборка.НомерСубконтоВидыПлатежейКтНУ]) Тогда
					Строка["СубконтоКтНУ" + Выборка.НомерСубконтоВидыПлатежейКтНУ] = Выборка["СубконтоКтНУ" + Выборка.НомерСубконтоВидыПлатежейКтНУ];
				Иначе 
					Строка["СубконтоКтНУ" + Выборка.НомерСубконтоВидыПлатежейКтНУ]= Выборка.ВидПлатежа;
				КонецЕсли;
			КонецЕсли;

			// Проверяем заполнена ли аналитика по работникам, если нет, заполняем
			Если ВедетсяУчетПоСотрудникам И Выборка.НомерСубконтоРаботникиОрганизацийКт <> 0 Тогда
				Если ЗначениеЗаполнено(Выборка["СубконтоКт" + Выборка.НомерСубконтоРаботникиОрганизацийКт]) Тогда
					Строка["СубконтоКт" + Выборка.НомерСубконтоРаботникиОрганизацийКт] = Выборка["СубконтоКт" + Выборка.НомерСубконтоРаботникиОрганизацийКт];
				Иначе 
					Строка["СубконтоКт" + Выборка.НомерСубконтоРаботникиОрганизацийКт]= Выборка.Физлицо;
				КонецЕсли;
				ОбщегоНазначенияБККлиентСервер.ЗаменитьСубконтоНУ(Строка, Строка.СчетДт, Строка.СчетДтНУ, Выборка.НомерСубконтоРаботникиОрганизацийКт, Выборка.Физлицо, "СубконтоКтНУ");
			КонецЕсли;
			Если ВедетсяУчетПоСотрудникам И Выборка.НомерСубконтоРаботникиОрганизацийКтНУ <> 0 Тогда
				Если ЗначениеЗаполнено(Выборка["СубконтоКтНУ" + Выборка.НомерСубконтоРаботникиОрганизацийКтНУ]) Тогда
					Строка["СубконтоКтНУ" + Выборка.НомерСубконтоРаботникиОрганизацийКтНУ] = Выборка["СубконтоКтНУ" + Выборка.НомерСубконтоРаботникиОрганизацийКтНУ];
				Иначе 
					Строка["СубконтоКтНУ" + Выборка.НомерСубконтоРаботникиОрганизацийКтНУ]= Выборка.Физлицо;
				КонецЕсли;
			КонецЕсли;
			
		Иначе 
			Строка.СчетКт 		= СчетКредита;
			Строка.СубконтоКт1 	= Выборка.ВидПлатежа;
			Если ВедетсяУчетПоСотрудникам Тогда
				Строка.СубконтоКт2	= Выборка.Физлицо;		
			КонецЕсли;
			
			Строка.СчетКтНУ 	= СчетКредитаНУ;
			ОбщегоНазначенияБККлиентСервер.ЗаменитьСубконтоНУ(Строка, СчетКредита, СчетКредитаНУ, 1, Выборка.ВидПлатежа, "СубконтоКтНУ");
			Если ВедетсяУчетПоСотрудникам Тогда
				ОбщегоНазначенияБККлиентСервер.ЗаменитьСубконтоНУ(Строка, СчетКредита, СчетКредитаНУ, 2, Выборка.Физлицо, "СубконтоКтНУ");   		
			КонецЕсли;
		КонецЕсли;
		
		Строка.Сумма		= Выборка.Взнос;
		Строка.ФизЛицо 		= Выборка.ФизЛицо;
		Строка.СтруктурноеПодразделениеДт = Параметры.СтруктурноеПодразделение;
		Строка.СтруктурноеПодразделениеКт = Параметры.СтруктурноеПодразделение;
	КонецЦикла;	
	
#КонецОбласти	

КонецЕсли;
#КонецОбласти

#Область ЕПЗатратыРаботника
	
	ЕПИсчисленныйТекст = 
	"ВЫБРАТЬ РАЗРЕШЕННЫЕ
	|	ЕПРасчетыСФондами.ФизЛицо,
	|	ВЫБОР
	|		КОГДА ЕПРасчетыСФондами.ПодразделениеОрганизации <> ЗНАЧЕНИЕ(Справочник.ПодразделенияОрганизаций.ПустаяСсылка)
	|			ТОГДА ЕПРасчетыСФондами.ПодразделениеОрганизации
	|		ИНАЧЕ РаботникиОрганизации.ПодразделениеОрганизации
	|	КОНЕЦ КАК ПодразделениеОрганизации,	
	|	ЕПРасчетыСФондами.ВидПлатежа,
	|	СУММА(ЕПРасчетыСФондами.СуммаПлатежа) КАК СуммаПлатежа,
	|	СУММА(ЕСТЬNULL(ЕПКомпоненты.СуммаОПВ, 0) + ЕСТЬNULL(ЕПКомпоненты.СуммаВОСМС, 0) + ЕСТЬNULL(ЕПКомпоненты.СуммаИПН, 0)) КАК СуммаЗаСчетРаботника,
	|	ВЫБОР
	|		КОГДА РасчетПениОПВиСО.СчетЗатратБУ ЕСТЬ NULL ИЛИ РасчетПениОПВиСО.СчетЗатратБУ = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
	|			ТОГДА &парамСчетДтДляПени
	|		ИНАЧЕ РасчетПениОПВиСО.СчетЗатратБУ
	|	КОНЕЦ КАК СчетДтДляПени,
	|	ВЫБОР
	|		КОГДА РасчетПениОПВиСО.СчетЗатратБУ ЕСТЬ NULL ИЛИ РасчетПениОПВиСО.СчетЗатратБУ = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
	|			ТОГДА НЕОПРЕДЕЛЕНО
	|		ИНАЧЕ ЕСТЬNULL(РасчетПениОПВиСО.СубконтоЗатратБУ1, НЕОПРЕДЕЛЕНО)  
	|	КОНЕЦ КАК СубконтоДтДляПени1,
	|	ВЫБОР
	|		КОГДА РасчетПениОПВиСО.СчетЗатратБУ ЕСТЬ NULL ИЛИ РасчетПениОПВиСО.СчетЗатратБУ = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
	|			ТОГДА НЕОПРЕДЕЛЕНО
	|		ИНАЧЕ ЕСТЬNULL(РасчетПениОПВиСО.СубконтоЗатратБУ2, НЕОПРЕДЕЛЕНО)  
	|	КОНЕЦ КАК СубконтоДтДляПени2,
	|	ВЫБОР
	|		КОГДА РасчетПениОПВиСО.СчетЗатратБУ ЕСТЬ NULL ИЛИ РасчетПениОПВиСО.СчетЗатратБУ = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
	|			ТОГДА НЕОПРЕДЕЛЕНО
	|		ИНАЧЕ ЕСТЬNULL(РасчетПениОПВиСО.СубконтоЗатратБУ3, НЕОПРЕДЕЛЕНО)  
	|	КОНЕЦ КАК СубконтоДтДляПени3,
	|	ВЫБОР
	|		КОГДА РасчетПениОПВиСО.СчетЗатратНУ ЕСТЬ NULL ИЛИ РасчетПениОПВиСО.СчетЗатратНУ = ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
	|			ТОГДА &парамСчетДтДляПениНУ
	|		ИНАЧЕ РасчетПениОПВиСО.СчетЗатратНУ
	|	КОНЕЦ КАК СчетДтДляПениНУ,
	|	ВЫБОР
	|		КОГДА РасчетПениОПВиСО.СчетЗатратНУ ЕСТЬ NULL ИЛИ РасчетПениОПВиСО.СчетЗатратНУ = ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
	|			ТОГДА НЕОПРЕДЕЛЕНО
	|		ИНАЧЕ ЕСТЬNULL(РасчетПениОПВиСО.СубконтоЗатратНУ1, НЕОПРЕДЕЛЕНО) 
	|	КОНЕЦ КАК СубконтоДтДляПениНУ1,
	|	ВЫБОР
	|		КОГДА РасчетПениОПВиСО.СчетЗатратНУ ЕСТЬ NULL ИЛИ РасчетПениОПВиСО.СчетЗатратНУ = ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
	|			ТОГДА НЕОПРЕДЕЛЕНО
	|		ИНАЧЕ ЕСТЬNULL(РасчетПениОПВиСО.СубконтоЗатратНУ2, НЕОПРЕДЕЛЕНО) 
	|	КОНЕЦ КАК СубконтоДтДляПениНУ2,
	|	ВЫБОР
	|		КОГДА РасчетПениОПВиСО.СчетЗатратНУ ЕСТЬ NULL ИЛИ РасчетПениОПВиСО.СчетЗатратНУ = ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
	|			ТОГДА НЕОПРЕДЕЛЕНО
	|		ИНАЧЕ ЕСТЬNULL(РасчетПениОПВиСО.СубконтоЗатратНУ3, НЕОПРЕДЕЛЕНО)  
	|	КОНЕЦ КАК СубконтоДтДляПениНУ3,
	|	ЕСТЬNULL(ВидСубконтоСтатьиЗатратДляПени.НомерСтроки, 0) КАК НомерСубконтоСтатьиЗатратДляПени,
	|	ЕСТЬNULL(ВидСубконтоПодразделенияДляПени.НомерСтроки, 0) КАК НомерСубконтоПодразделенияДляПени,
	|	ЕСТЬNULL(ВидСубконтоСтатьиЗатратДляПениНУ.НомерСтроки, 0) КАК НомерСубконтоСтатьиЗатратДляПениНУ,
	|	ЕСТЬNULL(ВидСубконтоПодразделенияДляПениНУ.НомерСтроки, 0) КАК НомерСубконтоПодразделенияДляПениНУ
	|ИЗ
	|	РегистрНакопления.ЕПРасчетыСФондами КАК ЕПРасчетыСФондами
	|	ЛЕВОЕ СОЕДИНЕНИЕ РегистрНакопления.ЕПКомпоненты КАК ЕПКомпоненты
	|		ПО ЕПРасчетыСФондами.ФизЛицо = ЕПКомпоненты.ФизЛицо
	|			И ЕПРасчетыСФондами.МесяцНалоговогоПериода = ЕПКомпоненты.МесяцНалоговогоПериода
	|			И ЕПРасчетыСФондами.Организация = ЕПКомпоненты.Организация
	|			И ЕПРасчетыСФондами.Налогоплательщик = ЕПКомпоненты.Налогоплательщик
	|			И ЕПРасчетыСФондами.ПодразделениеОрганизации = ЕПКомпоненты.ПодразделениеОрганизации
	|			И ЕПРасчетыСФондами.ВидПлатежа = ЕПКомпоненты.ВидПлатежа
    |			И ЕПРасчетыСФондами.Регистратор = ЕПКомпоненты.Регистратор 
	|
	|	ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТСписокФизЛиц КАК СписокФизЛиц
	|		ПО ЕПРасчетыСФондами.ФизЛицо = СписокФизЛиц.ФизЛицо
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ ВТ_МестаРаботы КАК РаботникиОрганизации
	|		ПО ЕПРасчетыСФондами.ФизЛицо = РаботникиОрганизации.ФизЛицо
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ Документ.РасчетПениОПВиСО КАК РасчетПениОПВиСО
	|		ПО ЕПРасчетыСФондами.Регистратор = РасчетПениОПВиСО.Ссылка
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Типовой.ВидыСубконто КАК ВидСубконтоСтатьиЗатратДляПени
	|		ПО ВидСубконтоСтатьиЗатратДляПени.Ссылка = (ВЫБОР
	|														КОГДА РасчетПениОПВиСО.СчетЗатратБУ ЕСТЬ NULL ИЛИ РасчетПениОПВиСО.СчетЗатратБУ = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
	|															ТОГДА &парамСчетДтДляПени
	|														ИНАЧЕ РасчетПениОПВиСО.СчетЗатратБУ
	|													КОНЕЦ)
	|		   И ВидСубконтоСтатьиЗатратДляПени.ВидСубконто = &парамВидСубконтоСтатьиЗатрат
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Типовой.ВидыСубконто КАК ВидСубконтоПодразделенияДляПени
	|		ПО ВидСубконтоПодразделенияДляПени.Ссылка = (ВЫБОР
	|														КОГДА РасчетПениОПВиСО.СчетЗатратБУ ЕСТЬ NULL ИЛИ РасчетПениОПВиСО.СчетЗатратБУ = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
	|															ТОГДА &парамСчетДтДляПени
	|														ИНАЧЕ РасчетПениОПВиСО.СчетЗатратБУ
	|													КОНЕЦ)
	|		   И ВидСубконтоПодразделенияДляПени.ВидСубконто = &парамВидСубконтоПодразделения
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Налоговый.ВидыСубконто КАК ВидСубконтоСтатьиЗатратДляПениНУ
	|		ПО ВидСубконтоСтатьиЗатратДляПениНУ.Ссылка = (ВЫБОР
	|															КОГДА РасчетПениОПВиСО.СчетЗатратНУ ЕСТЬ NULL ИЛИ РасчетПениОПВиСО.СчетЗатратНУ = ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
	|																ТОГДА &парамСчетДтДляПениНУ
	|															ИНАЧЕ РасчетПениОПВиСО.СчетЗатратНУ
	|														КОНЕЦ)
	|		   И ВидСубконтоСтатьиЗатратДляПениНУ.ВидСубконто = &парамВидСубконтоСтатьиЗатрат
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Налоговый.ВидыСубконто КАК ВидСубконтоПодразделенияДляПениНУ
	|		ПО ВидСубконтоПодразделенияДляПениНУ.Ссылка = (ВЫБОР
	|															КОГДА РасчетПениОПВиСО.СчетЗатратНУ ЕСТЬ NULL ИЛИ РасчетПениОПВиСО.СчетЗатратНУ = ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
	|																ТОГДА &парамСчетДтДляПениНУ
	|															ИНАЧЕ РасчетПениОПВиСО.СчетЗатратНУ
	|														КОНЕЦ)
	|		   И ВидСубконтоПодразделенияДляПениНУ.ВидСубконто = &парамВидСубконтоПодразделения
	|
	|
	|ГДЕ
	|	ЕПРасчетыСФондами.Период >= &парамНачалоМесяца И 
	|	ЕПРасчетыСФондами.Период <= &парамКонецМесяца И 
	|	ЕПРасчетыСФондами.Организация = &парамОрганизация И 
	|	ЕПРасчетыСФондами.ВидДвижения = &парамВидДвиженияПриход И
	|	ЕПРасчетыСФондами.ВидСтроки = &парамВидСтрокиИсчисление И
	|	ЕПРасчетыСФондами.СуммаПлатежа <> 0 
	|
	|СГРУППИРОВАТЬ ПО
	|	ЕПРасчетыСФондами.ФизЛицо,
	|	ВЫБОР
	|		КОГДА ЕПРасчетыСФондами.ПодразделениеОрганизации <> ЗНАЧЕНИЕ(Справочник.ПодразделенияОрганизаций.ПустаяСсылка)
	|			ТОГДА ЕПРасчетыСФондами.ПодразделениеОрганизации
	|		ИНАЧЕ РаботникиОрганизации.ПодразделениеОрганизации
	|	КОНЕЦ,
	|	ЕПРасчетыСФондами.ВидПлатежа,
	|	ВЫБОР
	|		КОГДА РасчетПениОПВиСО.СчетЗатратБУ ЕСТЬ NULL ИЛИ РасчетПениОПВиСО.СчетЗатратБУ = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
	|			ТОГДА &парамСчетДтДляПени
	|		ИНАЧЕ РасчетПениОПВиСО.СчетЗатратБУ
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА РасчетПениОПВиСО.СчетЗатратБУ ЕСТЬ NULL ИЛИ РасчетПениОПВиСО.СчетЗатратБУ = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
	|			ТОГДА НЕОПРЕДЕЛЕНО
	|		ИНАЧЕ ЕСТЬNULL(РасчетПениОПВиСО.СубконтоЗатратБУ1, НЕОПРЕДЕЛЕНО)  
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА РасчетПениОПВиСО.СчетЗатратБУ ЕСТЬ NULL ИЛИ РасчетПениОПВиСО.СчетЗатратБУ = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
	|			ТОГДА НЕОПРЕДЕЛЕНО
	|		ИНАЧЕ ЕСТЬNULL(РасчетПениОПВиСО.СубконтоЗатратБУ2, НЕОПРЕДЕЛЕНО)  
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА РасчетПениОПВиСО.СчетЗатратБУ ЕСТЬ NULL ИЛИ РасчетПениОПВиСО.СчетЗатратБУ = ЗНАЧЕНИЕ(ПланСчетов.Типовой.ПустаяСсылка)
	|			ТОГДА НЕОПРЕДЕЛЕНО
	|		ИНАЧЕ ЕСТЬNULL(РасчетПениОПВиСО.СубконтоЗатратБУ3, НЕОПРЕДЕЛЕНО)  
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА РасчетПениОПВиСО.СчетЗатратНУ ЕСТЬ NULL ИЛИ РасчетПениОПВиСО.СчетЗатратНУ = ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
	|			ТОГДА &парамСчетДтДляПениНУ
	|		ИНАЧЕ РасчетПениОПВиСО.СчетЗатратНУ
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА РасчетПениОПВиСО.СчетЗатратНУ ЕСТЬ NULL ИЛИ РасчетПениОПВиСО.СчетЗатратНУ = ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
	|			ТОГДА НЕОПРЕДЕЛЕНО
	|		ИНАЧЕ ЕСТЬNULL(РасчетПениОПВиСО.СубконтоЗатратНУ1, НЕОПРЕДЕЛЕНО) 
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА РасчетПениОПВиСО.СчетЗатратНУ ЕСТЬ NULL ИЛИ РасчетПениОПВиСО.СчетЗатратНУ = ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
	|			ТОГДА НЕОПРЕДЕЛЕНО
	|		ИНАЧЕ ЕСТЬNULL(РасчетПениОПВиСО.СубконтоЗатратНУ2, НЕОПРЕДЕЛЕНО) 
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА РасчетПениОПВиСО.СчетЗатратНУ ЕСТЬ NULL ИЛИ РасчетПениОПВиСО.СчетЗатратНУ = ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
	|			ТОГДА НЕОПРЕДЕЛЕНО
	|		ИНАЧЕ ЕСТЬNULL(РасчетПениОПВиСО.СубконтоЗатратНУ3, НЕОПРЕДЕЛЕНО)  
	|	КОНЕЦ,
	|	ЕСТЬNULL(ВидСубконтоСтатьиЗатратДляПени.НомерСтроки, 0),
	|	ЕСТЬNULL(ВидСубконтоПодразделенияДляПени.НомерСтроки, 0),
	|	ЕСТЬNULL(ВидСубконтоСтатьиЗатратДляПениНУ.НомерСтроки, 0),
	|	ЕСТЬNULL(ВидСубконтоПодразделенияДляПениНУ.НомерСтроки, 0)
	|";

	Запрос.Текст = ЕПИсчисленныйТекст;

	СчетДебета = ПланыСчетов.Типовой.КраткосрочнаяЗадолженностьПоОплатеТруда;
	
	СчетДебетаНУПоУмолчанию = ПланыСчетов.Налоговый.ВзаиморасчетыСРаботниками;	
	СчетДебетаНУ = ПроцедурыБухгалтерскогоУчета.ЗаполнитьСчетНалоговогоУчетаПоУмолчанию(СчетДебета, КонецМесяца(Параметры.ПериодРегистрации), СчетДебетаНУПоУмолчанию);
	
	СчетКредита = Справочники.НалогиСборыОтчисления.ЕдиныйПлатеж.СчетУчетаРасчетовСКонтрагентомБУ;
	Если НЕ ЗначениеЗаполнено(СчетКредита) Тогда
		СчетКредита = ПланыСчетов.Типовой.ПрочиеНалоги;
	КонецЕсли;
	
	СчетКредитаНУ = ПроцедурыНалоговогоУчетаВызовСервераПовтИсп.ПолучитьСчетУчетаНУЕП(СчетКредита,КонецМесяца(Параметры.ПериодРегистрации));
	СчетКредитаНУ = ПроцедурыБухгалтерскогоУчета.ЗаполнитьСчетНалоговогоУчетаПоУмолчанию(СчетКредита, КонецМесяца(Параметры.ПериодРегистрации), ПланыСчетов.Налоговый.ПрочиеНалоги);
	
	СтатьяЗатратПеняПоЕП = Справочники.СтатьиЗатрат.ПеняПоЕП;
	ВидНалогаСбораЕдиныйПлатеж = Справочники.НалогиСборыОтчисления.ЕдиныйПлатеж;
	
	Выборка = Запрос.Выполнить().Выбрать();
	
	Пока Выборка.Следующий() Цикл
		Строка = Параметры.ТаблицаОтражениеВУчете.Добавить();
		
		// Ставим на разные счета затрат в зависимости от вида платежа
		Если Выборка.ВидПлатежа = Перечисления.ВидыПлатежейВБюджетИФонды.Налог
			 Или Выборка.ВидПлатежа = Перечисления.ВидыПлатежейВБюджетИФонды.НалогАкт 
			 Или Выборка.ВидПлатежа = Перечисления.ВидыПлатежейВБюджетИФонды.НалогСам Тогда
			Строка.ВидРасчета	= ВидНалогаСбораЕдиныйПлатеж;
			Строка.СчетДт 		= СчетДебета;
			Если ВедетсяУчетПоСотрудникам Тогда
				Строка.СубконтоДт1 	= Выборка.Физлицо;
			КонецЕсли;
			Строка.СчетДтНУ 		= СчетДебетаНУ;
			Если ВедетсяУчетПоСотрудникам Тогда
				ОбщегоНазначенияБККлиентСервер.ЗаменитьСубконтоНУ(Строка, СчетДебета, СчетДебетаНУ, 1, Выборка.ФизЛицо, "СубконтоДтНУ");
				Строка.СубконтоДтНУ1 	= Выборка.Физлицо;
			КонецЕсли;
			
			Строка.Сумма 	= Выборка.СуммаЗаСчетРаботника;
			
		Иначе // Пеня по ЕП
			Строка.ВидРасчета		= СтатьяЗатратПеняПоЕП;
			Строка.СчетДт			= Выборка.СчетДтДляПени;
			Строка.СчетДтНУ 		= Выборка.СчетДтДляПениНУ;
			
			Если Выборка.НомерСубконтоСтатьиЗатратДляПени <> 0 Тогда
				Если ЗначениеЗаполнено(Выборка["СубконтоДтДляПени" + Выборка.НомерСубконтоСтатьиЗатратДляПени]) Тогда
					Строка["СубконтоДт" + Выборка.НомерСубконтоСтатьиЗатратДляПени] = Выборка["СубконтоДтДляПени" + Выборка.НомерСубконтоСтатьиЗатратДляПени];
				Иначе
					Строка["СубконтоДт" + Выборка.НомерСубконтоСтатьиЗатратДляПени] = СтатьяЗатратПеняПоЕП;
				КонецЕсли;
				ОбщегоНазначенияБККлиентСервер.ЗаменитьСубконтоНУ(Строка, СчетДебетаДляПени, СчетДебетаДляПениНУ, Выборка.НомерСубконтоСтатьиЗатратДляПени, СтатьяЗатратПеняПоЕП, "СубконтоДтНУ");
			КонецЕсли;
			Если Выборка.НомерСубконтоСтатьиЗатратДляПениНУ <> 0 Тогда
				Если ЗначениеЗаполнено(Выборка["СубконтоДтДляПениНУ" + Выборка.НомерСубконтоСтатьиЗатратДляПениНУ]) Тогда
					Строка["СубконтоДтНУ" + Выборка.НомерСубконтоСтатьиЗатратДляПениНУ] = Выборка["СубконтоДтДляПениНУ" + Выборка.НомерСубконтоСтатьиЗатратДляПениНУ];
				Иначе
					Строка["СубконтоДтНУ" + Выборка.НомерСубконтоСтатьиЗатратДляПениНУ] = СтатьяЗатратПеняПоЕП;
				КонецЕсли;
			КонецЕсли;
			Если Выборка.НомерСубконтоПодразделенияДляПени <> 0 Тогда
				Если ЗначениеЗаполнено(Выборка["СубконтоДтДляПени" + Выборка.НомерСубконтоПодразделенияДляПени]) Тогда
					Строка["СубконтоДт" + Выборка.НомерСубконтоПодразделенияДляПени] = Выборка["СубконтоДтДляПени" + Выборка.НомерСубконтоПодразделенияДляПени];
				Иначе 
					Строка["СубконтоДт" + Выборка.НомерСубконтоПодразделенияДляПени]= Выборка.ПодразделениеОрганизации;
				КонецЕсли;
				ОбщегоНазначенияБККлиентСервер.ЗаменитьСубконтоНУ(Строка, СчетДебетаДляПени, СчетДебетаДляПениНУ, Выборка.НомерСубконтоПодразделенияДляПени, Выборка.ПодразделениеОрганизации, "СубконтоДтНУ");
			КонецЕсли;
			Если Выборка.НомерСубконтоПодразделенияДляПениНУ <> 0 Тогда
				Если ЗначениеЗаполнено(Выборка["СубконтоДтДляПениНУ" + Выборка.НомерСубконтоПодразделенияДляПениНУ]) Тогда
					Строка["СубконтоДтНУ" + Выборка.НомерСубконтоПодразделенияДляПениНУ] = Выборка["СубконтоДтДляПениНУ" + Выборка.НомерСубконтоПодразделенияДляПениНУ];
				Иначе 
					Строка["СубконтоДтНУ" + Выборка.НомерСубконтоПодразделенияДляПениНУ]= Выборка.ПодразделениеОрганизации;
				КонецЕсли;
			КонецЕсли;
			
			// Заполним оставшиеся субконто
			Для Ном = 1 По 3 Цикл
				Если НЕ ЗначениеЗаполнено(Строка["СубконтоДт" + Ном]) Тогда
					Строка["СубконтоДт" + Ном] = Выборка["СубконтоДтДляПени" + Ном];
				КонецЕсли;
				Если НЕ ЗначениеЗаполнено(Строка["СубконтоДтНУ" + Ном]) Тогда
					Если ЗначениеЗаполнено(Выборка["СубконтоДтДляПениНУ" + Ном]) Тогда
						Строка["СубконтоДтНУ" + Ном] = Выборка["СубконтоДтДляПениНУ" + Ном];
					Иначе
						ОбщегоНазначенияБККлиентСервер.ЗаменитьСубконтоНУ(Строка, СчетДебетаДляПени, СчетДебетаДляПениНУ, Ном, СтатьяЗатратПеняПоЕП, "СубконтоДтНУ");
					КонецЕсли;
				КонецЕсли;
			КонецЦикла;
			
			Строка.Сумма 	= Выборка.СуммаПлатежа;

		КонецЕсли;
		
		Строка.СчетКт 		= СчетКредита;
		Строка.СубконтоКт1 	= Справочники.НалогиСборыОтчисления.ЕдиныйПлатеж;
		Строка.СубконтоКт2 	= Выборка.ВидПлатежа;
		Если ВедетсяУчетПоСотрудникам Тогда
			Строка.СубконтоКт3	= Выборка.Физлицо;		
		КонецЕсли;
		
		Строка.СчетКтНУ 	= СчетКредитаНУ;
		ОбщегоНазначенияБККлиентСервер.ЗаменитьСубконтоНУ(Строка, СчетКредита, СчетКредитаНУ, 1, Справочники.НалогиСборыОтчисления.ЕдиныйПлатеж, "СубконтоКтНУ");
		ОбщегоНазначенияБККлиентСервер.ЗаменитьСубконтоНУ(Строка, СчетКредита, СчетКредитаНУ, 2, Выборка.ВидПлатежа, "СубконтоКтНУ");
		Если ВедетсяУчетПоСотрудникам Тогда
			ОбщегоНазначенияБККлиентСервер.ЗаменитьСубконтоНУ(Строка, СчетКредита, СчетКредитаНУ, 3, Выборка.Физлицо, "СубконтоКтНУ");   		
		КонецЕсли;
		
		Строка.ФизЛицо 	= Выборка.ФизЛицо;
		Строка.СтруктурноеПодразделениеДт = Параметры.СтруктурноеПодразделение;
		Строка.СтруктурноеПодразделениеКт = Параметры.СтруктурноеПодразделение;
	КонецЦикла;	

#КонецОбласти

#Область ЕПЗатратыРаботодателя

   	// ОППВИсчисленный
	//	Поля:
	//		ФизЛицо
	//		ВидПлатежа
	//		Взнос
	//	
	//	Описание:
	//	Исчисленный единый платеэ по видам платежа

    ЕПИсчисленныйТекст = "
    |ВЫБРАТЬ РАЗРЕШЕННЫЕ
    |	ЕПРасчетыСФондами.Регистратор КАК Регистратор,
	|	ЕПРасчетыСФондами.ФизЛицо КАК ФизЛицо,
    |	ЕПРасчетыСФондами.ВидПлатежа КАК ВидПлатежа,
    |	СУММА(ЕПРасчетыСФондами.СуммаПлатежа) КАК СуммаПлатежа,
	|	СУММА(ЕСТЬNULL(ЕПКомпоненты.СуммаООСМС, 0) + ЕСТЬNULL(ЕПКомпоненты.СуммаСО, 0) + ЕСТЬNULL(ЕПКомпоненты.СуммаОПВР, 0)) КАК СуммаЗаСчетРаботодателя
    |
    |ПОМЕСТИТЬ ВТ_ЕПИсчисленный
    |ИЗ
    |	РегистрНакопления.ЕПРасчетыСФондами КАК ЕПРасчетыСФондами
	|	ЛЕВОЕ СОЕДИНЕНИЕ РегистрНакопления.ЕПКомпоненты КАК ЕПКомпоненты
	|		ПО ЕПРасчетыСФондами.ФизЛицо = ЕПКомпоненты.ФизЛицо
	|			И ЕПРасчетыСФондами.МесяцНалоговогоПериода = ЕПКомпоненты.МесяцНалоговогоПериода
	|			И ЕПРасчетыСФондами.Организация = ЕПКомпоненты.Организация
	|			И ЕПРасчетыСФондами.Налогоплательщик = ЕПКомпоненты.Налогоплательщик
	|			И ЕПРасчетыСФондами.ПодразделениеОрганизации = ЕПКомпоненты.ПодразделениеОрганизации
	|			И ЕПРасчетыСФондами.ВидПлатежа = ЕПКомпоненты.ВидПлатежа
    |			И ЕПРасчетыСФондами.Регистратор = ЕПКомпоненты.Регистратор 
	|
    |	ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТСписокФизЛиц КАК СписокФизЛиц
    |		ПО ЕПРасчетыСФондами.ФизЛицо = СписокФизЛиц.ФизЛицо
	|
    |ГДЕ
	|	ЕПРасчетыСФондами.Период >= &парамНачалоМесяца И 
	|	ЕПРасчетыСФондами.Период <= &парамКонецМесяца И 
	|	ЕПРасчетыСФондами.Организация = &парамОрганизация И 
	|	ЕПРасчетыСФондами.ВидДвижения = &парамВидДвиженияПриход И
	// пеня по ЕП отражается в ЕП за работника
	|	ЕПРасчетыСФондами.ВидПлатежа В (ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.Налог), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогСам), ЗНАЧЕНИЕ(Перечисление.ВидыПлатежейВБюджетИФонды.НалогАкт)) И
	|	ЕПРасчетыСФондами.Период >= &парамНачалоМесяца И 
	|	ЕПРасчетыСФондами.СуммаПлатежа <> 0 И
	|		(ЕПКомпоненты.СуммаООСМС <> 0 ИЛИ
	|		ЕПКомпоненты.СуммаСО <> 0 ИЛИ
	|		ЕПКомпоненты.СуммаОПВР <> 0) И
	|	ЕПРасчетыСФондами.Активность
	|
	|СГРУППИРОВАТЬ ПО
	|   ЕПРасчетыСФондами.Регистратор,
	|	ЕПРасчетыСФондами.ФизЛицо,
	|   ЕПРасчетыСФондами.ВидПлатежа
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	ФизЛицо
    |";
    
    Запрос.Текст = ЕПИсчисленныйТекст;
    Запрос.Выполнить();
    
   	// БУДоходыПоСчетам
	//	Поля:
	//		ФизЛицо
	//		СчетДт
	//		СубконтоДт1
	//		СубконтоДт2
	//		СубконтоДт3
	//		Результат
	//	
	//	Описание:
	//	Данные отражения начислений в бухучете

    БУДоходыПоСчетам = "
    |ВЫБРАТЬ РАЗРЕШЕННЫЕ
    |	БУНачисления.ФизЛицо,
    |	БУНачисления.СчетДт,
	|	БУНачисления.СчетДтНУ КАК СчетДтНУ,
	|	БУНачисления.СтруктурноеПодразделениеДт,
    |	ВЫБОР 
    |		КОГДА ВидыСубконтоДт1.ВидСубконто = &парамВидСубконтоСтатьиЗатрат ТОГДА &парамСтатьяЗатратЕП
    |		ИНАЧЕ БУНачисления.СубконтоДт1
    |	КОНЕЦ КАК СубконтоДт1,
    |	ВЫБОР 
    |		КОГДА ВидыСубконтоДт2.ВидСубконто = &парамВидСубконтоСтатьиЗатрат ТОГДА &парамСтатьяЗатратЕП
    |		ИНАЧЕ БУНачисления.СубконтоДт2
    |	КОНЕЦ КАК СубконтоДт2,
    |	ВЫБОР 
    |		КОГДА ВидыСубконтоДт3.ВидСубконто = &парамВидСубконтоСтатьиЗатрат ТОГДА &парамСтатьяЗатратЕП
    |		ИНАЧЕ БУНачисления.СубконтоДт3
    |	КОНЕЦ КАК СубконтоДт3,
	|	ВЫБОР 
    |		КОГДА ВидыСубконтоДтНУ1.ВидСубконто = &парамВидСубконтоСтатьиЗатрат ТОГДА &парамСтатьяЗатратЕП
    |		ИНАЧЕ БУНачисления.СубконтоДтНУ1
    |	КОНЕЦ КАК СубконтоДтНУ1,
    |	ВЫБОР 
    |		КОГДА ВидыСубконтоДтНУ2.ВидСубконто = &парамВидСубконтоСтатьиЗатрат ТОГДА &парамСтатьяЗатратЕП
    |		ИНАЧЕ БУНачисления.СубконтоДтНУ2
    |	КОНЕЦ КАК СубконтоДтНУ2,
    |	ВЫБОР 
    |		КОГДА ВидыСубконтоДтНУ3.ВидСубконто = &парамВидСубконтоСтатьиЗатрат ТОГДА &парамСтатьяЗатратЕП
    |		ИНАЧЕ БУНачисления.СубконтоДтНУ3
    |	КОНЕЦ КАК СубконтоДтНУ3,
	|	БУНачисления.Сумма КАК Результат
	|ПОМЕСТИТЬ ВТ_БУНачисленияЕП	
	|ИЗ
	|	ВТ_БУНачисления КАК БУНачисления
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Типовой.ВидыСубконто КАК ВидыСубконтоДт1
	|		ПО БУНачисления.СчетДт = ВидыСубконтоДт1.Ссылка
	|		   И ВидыСубконтоДт1.НомерСтроки = 1
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Типовой.ВидыСубконто КАК ВидыСубконтоДт2
	|		ПО БУНачисления.СчетДт = ВидыСубконтоДт2.Ссылка
	|		   И ВидыСубконтоДт2.НомерСтроки = 2
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Типовой.ВидыСубконто КАК ВидыСубконтоДт3
	|		ПО БУНачисления.СчетДт = ВидыСубконтоДт3.Ссылка
	|		   И ВидыСубконтоДт3.НомерСтроки = 3
	|
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Налоговый.ВидыСубконто КАК ВидыСубконтоДтНУ1
	|		ПО БУНачисления.СчетДтНУ = ВидыСубконтоДтНУ1.Ссылка
	|		   И ВидыСубконтоДтНУ1.НомерСтроки = 1
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Налоговый.ВидыСубконто КАК ВидыСубконтоДтНУ2
	|		ПО БУНачисления.СчетДтНУ = ВидыСубконтоДтНУ2.Ссылка
	|		   И ВидыСубконтоДтНУ2.НомерСтроки = 2
	|	
	|	ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Налоговый.ВидыСубконто КАК ВидыСубконтоДтНУ3
	|		ПО БУНачисления.СчетДтНУ = ВидыСубконтоДтНУ3.Ссылка
	|		   И ВидыСубконтоДтНУ3.НомерСтроки = 3
	|ГДЕ
	|	БУНачисления.ВидРасчета ССЫЛКА ПланВидовРасчета.ОсновныеНачисленияОрганизаций И
	|	БУНачисления.ВидРасчета <> &парамПустойВидРасчета И
	|	БУНачисления.ВидРасчета <> НЕОПРЕДЕЛЕНО И
	|	БУНачисления.ВидРасчета.ОблагаетсяЕП <> &парамНеОблагаетсяЦеликом
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ РАЗРЕШЕННЫЕ
	|	БУНачисления.ФизЛицо,
	|	БУНачисления.СтруктурноеПодразделениеДт,
	|	БУНачисления.СчетДт,
	|	БУНачисления.СчетДтНУ,
	|	БУНачисления.СубконтоДт1,
	|	БУНачисления.СубконтоДт2,
	|	БУНачисления.СубконтоДт3,
	|	БУНачисления.СубконтоДтНУ1,
	|	БУНачисления.СубконтоДтНУ2,
	|	БУНачисления.СубконтоДтНУ3,
	|	СУММА(БУНачисления.Результат) КАК Результат
	|
	|ПОМЕСТИТЬ ВТ_БУДоходыПоСчетамЕП
	|ИЗ
	|	ВТ_БУНачисленияЕП КАК БУНачисления
	|
	|СГРУППИРОВАТЬ ПО
	|	БУНачисления.ФизЛицо,
	|	БУНачисления.СтруктурноеПодразделениеДт,
	|	БУНачисления.СчетДт,
	|	БУНачисления.СчетДтНУ,
	|	БУНачисления.СубконтоДт1,
	|	БУНачисления.СубконтоДт2,
	|	БУНачисления.СубконтоДт3,
	|	БУНачисления.СубконтоДтНУ1,
	|	БУНачисления.СубконтоДтНУ2,
	|	БУНачисления.СубконтоДтНУ3
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	ФизЛицо
	|";

	Запрос.Текст = БУДоходыПоСчетам;
	Запрос.Выполнить();
	     
	// сначала определим счет, на который будем относить затраты по единому платежу за счет работодателя и 
	// распределим пропорционально сумме начислений, а потом на основании счета подставим значения некоторых субконто по умолчанию
	РаспределениеЕППоСчетамЗатрат = "ВЫБРАТЬ РАЗРЕШЕННЫЕ
	                                  |	ЕПРасчетыСФондами.ФизЛицо,
	                                  |	ЕПРасчетыСФондами.ВидПлатежа,
	                                  |	СУММА(ЕПРасчетыСФондами.СуммаПлатежа) КАК СуммаПлатежа,
	                                  |	СУММА(ЕПРасчетыСФондами.СуммаЗаСчетРаботодателя) КАК СуммаЗаСчетРаботодателя,
	                                  |	СУММА(ВЫБОР
	                                  |			КОГДА БУСуммаНачислений.Результат <> 0
	                                  |				ТОГДА ВЫРАЗИТЬ(ЕПРасчетыСФондами.СуммаЗаСчетРаботодателя * БУНачисления.Результат / БУСуммаНачислений.Результат КАК ЧИСЛО(15, 2))
	                                  |			ИНАЧЕ 0
	                                  |		КОНЕЦ) КАК СуммаПроводки,
	                                  |	ВЫБОР
	                                  |		КОГДА НЕ БУНачисления.СчетДт ЕСТЬ NULL 
									  //|				И НЕ(БУНачисления.СчетДт В (&парамСчетаРезервовБезОППВ)
									  //|						И БУНачисления.СубконтоДт1 В (&парамРезервыБезОППВ))
	                                  |			ТОГДА БУНачисления.СчетДт
	                                  |		КОГДА ОсновнойСпособОтражения.СпособОтраженияВБухучете = &парамСпособПоУмолчанию
	                                  |				И НЕ МестаРаботы.СпособОтраженияВБухучете ЕСТЬ NULL 
	                                  |			ТОГДА МестаРаботы.СпособОтраженияВБухучете.СчетДт
	                                  |		ИНАЧЕ ОсновнойСпособОтражения.СпособОтраженияВБухучете.СчетДт
	                                  |	КОНЕЦ КАК СчетДт,
	                                  |	ВЫБОР
	                                  |		КОГДА НЕ БУНачисления.СчетДтНУ ЕСТЬ NULL 
									  //|				И НЕ(БУНачисления.СчетДт В (&парамСчетаРезервовБезОППВ)
									  //|						И БУНачисления.СубконтоДт1 В (&парамРезервыБезОППВ))
	                                  |			ТОГДА БУНачисления.СчетДтНУ
	                                  |		КОГДА ОсновнойСпособОтражения.СпособОтраженияВБухучете = &парамСпособПоУмолчанию
	                                  |				И НЕ МестаРаботы.СпособОтраженияВБухучете ЕСТЬ NULL 
	                                  |			ТОГДА МестаРаботы.СпособОтраженияВБухучете.СчетДтНУ
	                                  |		ИНАЧЕ ОсновнойСпособОтражения.СпособОтраженияВБухучете.СчетДтНУ
	                                  |	КОНЕЦ КАК СчетДтНУ,
	                                  |	БУНачисления.СтруктурноеПодразделениеДт,
	                                  |	БУНачисления.СчетДт КАК СчетДтОплатаТруда,
	                                  |	БУНачисления.СубконтоДт1,
	                                  |	БУНачисления.СубконтоДт2,
	                                  |	БУНачисления.СубконтоДт3,
	                                  |	БУНачисления.СубконтоДтНУ1,
	                                  |	БУНачисления.СубконтоДтНУ2,
	                                  |	БУНачисления.СубконтоДтНУ3,
	                                  |	МестаРаботы.ПодразделениеОрганизации,
	                                  |	МестаРаботы.СпособОтраженияВБухучете КАК СпособОтраженияВБухучетеДляПодразделения,
	                                  |	ОсновнойСпособОтражения.СпособОтраженияВБухучете КАК ОсновнойСпособОтраженияВБухучете
	                                  |ПОМЕСТИТЬ ВТ_ЕППоСчетамЗатрат
	                                  |ИЗ
	                                  |	ВТ_ЕПИсчисленный КАК ЕПРасчетыСФондами
	                                  |		ЛЕВОЕ СОЕДИНЕНИЕ ВТ_БУДоходыПоСчетамЕП КАК БУНачисления
	                                  |		ПО ЕПРасчетыСФондами.ФизЛицо = БУНачисления.ФизЛицо
	                                  |		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
	                                  |			БУНачисления.ФизЛицо КАК ФизЛицо,
	                                  |			СУММА(БУНачисления.Результат) КАК Результат
	                                  |		ИЗ
	                                  |			ВТ_БУДоходыПоСчетамЕП КАК БУНачисления
	                                  |		
	                                  |		СГРУППИРОВАТЬ ПО
	                                  |			БУНачисления.ФизЛицо) КАК БУСуммаНачислений
	                                  |		ПО ЕПРасчетыСФондами.ФизЛицо = БУСуммаНачислений.ФизЛицо
	                                  |		ЛЕВОЕ СОЕДИНЕНИЕ ВТ_ОсновнойСпособОтражения КАК ОсновнойСпособОтражения
	                                  |		ПО ЕПРасчетыСФондами.ФизЛицо = ОсновнойСпособОтражения.ФизЛицо
	                                  |		ЛЕВОЕ СОЕДИНЕНИЕ ВТ_МестаРаботы КАК МестаРаботы
	                                  |		ПО ЕПРасчетыСФондами.ФизЛицо = МестаРаботы.ФизЛицо
	                                  |
	                                  |СГРУППИРОВАТЬ ПО
	                                  |	ЕПРасчетыСФондами.ФизЛицо,
	                                  |	ЕПРасчетыСФондами.ВидПлатежа,
	                                  |	БУНачисления.СтруктурноеПодразделениеДт,
	                                  |	БУНачисления.СчетДт,
	                                  |	БУНачисления.СубконтоДт1,
	                                  |	БУНачисления.СубконтоДт2,
	                                  |	БУНачисления.СубконтоДт3,
	                                  |	БУНачисления.СубконтоДтНУ1,
	                                  |	БУНачисления.СубконтоДтНУ2,
	                                  |	БУНачисления.СубконтоДтНУ3,
	                                  |	МестаРаботы.ПодразделениеОрганизации,
	                                  |	МестаРаботы.СпособОтраженияВБухучете,
	                                  |	ОсновнойСпособОтражения.СпособОтраженияВБухучете,
	                                  |	ВЫБОР
	                                  |		КОГДА НЕ БУНачисления.СчетДт ЕСТЬ NULL 
									  //|				И НЕ(БУНачисления.СчетДт В (&парамСчетаРезервовБезОППВ)
									  //|						И БУНачисления.СубконтоДт1 В (&парамРезервыБезОППВ))
	                                  |			ТОГДА БУНачисления.СчетДт
	                                  |		КОГДА ОсновнойСпособОтражения.СпособОтраженияВБухучете = &парамСпособПоУмолчанию
	                                  |				И НЕ МестаРаботы.СпособОтраженияВБухучете ЕСТЬ NULL 
	                                  |			ТОГДА МестаРаботы.СпособОтраженияВБухучете.СчетДт
	                                  |		ИНАЧЕ ОсновнойСпособОтражения.СпособОтраженияВБухучете.СчетДт
	                                  |	КОНЕЦ,
	                                  |	ВЫБОР
	                                  |		КОГДА НЕ БУНачисления.СчетДтНУ ЕСТЬ NULL 
									  //|				И НЕ(БУНачисления.СчетДт В (&парамСчетаРезервовБезОППВ)
									  //|						И БУНачисления.СубконтоДт1 В (&парамРезервыБезОППВ))
	                                  |			ТОГДА БУНачисления.СчетДтНУ
	                                  |		КОГДА ОсновнойСпособОтражения.СпособОтраженияВБухучете = &парамСпособПоУмолчанию
	                                  |				И НЕ МестаРаботы.СпособОтраженияВБухучете ЕСТЬ NULL 
	                                  |			ТОГДА МестаРаботы.СпособОтраженияВБухучете.СчетДтНУ
	                                  |		ИНАЧЕ ОсновнойСпособОтражения.СпособОтраженияВБухучете.СчетДтНУ
	                                  |	КОНЕЦ
	                                  |
	                                  |ИНДЕКСИРОВАТЬ ПО
	                                  |	СчетДт,
	                                  |	СчетДтНУ";
	
	Запрос.Текст = РаспределениеЕППоСчетамЗатрат;
	Запрос.Выполнить();
                                		
	// Распределяем единый платеж за счет работодателя по счетам затрат 
	// пропорционально сумме начислений, с которых брались эти взносы
	РаспределениеЕППоСчетамЗатрат = "
	|ВЫБРАТЬ РАЗРЕШЕННЫЕ
	|	ДанныеУчета.ФизЛицо,
	|	ДанныеУчета.СтруктурноеПодразделениеДт,
	|	ДанныеУчета.ВидПлатежа,
	|	ДанныеУчета.СуммаПлатежа,
    |	ДанныеУчета.СуммаЗаСчетРаботодателя,
	|	ДанныеУчета.СуммаПроводки,
	|	ДанныеУчета.СчетДт,
	|	ДанныеУчета.СчетДтНУ,
	|                               
	|	ВЫБОР
	|		КОГДА НЕ(ДанныеУчета.СубконтоДт1 ЕСТЬ NULL)
	//|				И НЕ(ДанныеУчета.СчетДтОплатаТруда В (&парамСчетаРезервовБезОППВ) И ДанныеУчета.СубконтоДт1 В (&парамРезервыБезОППВ))
	|			ТОГДА ДанныеУчета.СубконтоДт1
	|		КОГДА ВидыСубконтоДт1.ВидСубконто = &парамВидСубконтоСтатьиЗатрат ТОГДА &парамСтатьяЗатратЕП	
	|		КОГДА ВидыСубконтоДт1.ВидСубконто = &парамВидСубконтоПодразделения ТОГДА ДанныеУчета.ПодразделениеОрганизации
	|		КОГДА ДанныеУчета.ОсновнойСпособОтраженияВБухучете = &парамСпособПоУмолчанию
	|					И НЕ (ДанныеУчета.СпособОтраженияВБухучетеДляПодразделения ЕСТЬ NULL)
	|			ТОГДА ДанныеУчета.СпособОтраженияВБухучетеДляПодразделения.СубконтоДт1
	|		ИНАЧЕ ДанныеУчета.ОсновнойСпособОтраженияВБухучете.СубконтоДт1
	|	КОНЕЦ КАК СубконтоДт1,
	|
	|	ВЫБОР
	|		КОГДА НЕ(ДанныеУчета.СубконтоДт2 ЕСТЬ NULL)
	//|				И НЕ(ДанныеУчета.СчетДтОплатаТруда В (&парамСчетаРезервовБезОППВ) И ДанныеУчета.СубконтоДт1 В (&парамРезервыБезОППВ))
	|			ТОГДА ДанныеУчета.СубконтоДт2
	|		КОГДА ВидыСубконтоДт2.ВидСубконто = &парамВидСубконтоСтатьиЗатрат ТОГДА &парамСтатьяЗатратЕП
	|		КОГДА ВидыСубконтоДт2.ВидСубконто = &парамВидСубконтоПодразделения ТОГДА ДанныеУчета.ПодразделениеОрганизации
	|		КОГДА ДанныеУчета.ОсновнойСпособОтраженияВБухучете = &парамСпособПоУмолчанию
	|					И НЕ (ДанныеУчета.СпособОтраженияВБухучетеДляПодразделения ЕСТЬ NULL)
	|			ТОГДА ДанныеУчета.СпособОтраженияВБухучетеДляПодразделения.СубконтоДт2
	|		ИНАЧЕ ДанныеУчета.ОсновнойСпособОтраженияВБухучете.СубконтоДт2
	|	КОНЕЦ КАК СубконтоДт2,
	|
	|	ВЫБОР
	|		КОГДА НЕ(ДанныеУчета.СубконтоДт3 ЕСТЬ NULL)
	//|				И НЕ(ДанныеУчета.СчетДтОплатаТруда В (&парамСчетаРезервовБезОППВ) И ДанныеУчета.СубконтоДт1 В (&парамРезервыБезОППВ))
	|			ТОГДА ДанныеУчета.СубконтоДт3
	|		КОГДА ВидыСубконтоДт3.ВидСубконто = &парамВидСубконтоСтатьиЗатрат ТОГДА &парамСтатьяЗатратЕП
	|		КОГДА ВидыСубконтоДт3.ВидСубконто = &парамВидСубконтоПодразделения ТОГДА ДанныеУчета.ПодразделениеОрганизации
	|		КОГДА ДанныеУчета.ОсновнойСпособОтраженияВБухучете = &парамСпособПоУмолчанию
	|					И НЕ (ДанныеУчета.СпособОтраженияВБухучетеДляПодразделения ЕСТЬ NULL)
	|			ТОГДА ДанныеУчета.СпособОтраженияВБухучетеДляПодразделения.СубконтоДт3
	|		ИНАЧЕ ДанныеУчета.ОсновнойСпособОтраженияВБухучете.СубконтоДт3
	|	КОНЕЦ КАК СубконтоДт3,
	|
	|	ВЫБОР
	|		КОГДА НЕ(ДанныеУчета.СубконтоДтНУ1 ЕСТЬ NULL)
	//|				И НЕ(ДанныеУчета.СчетДтОплатаТруда В (&парамСчетаРезервовБезОППВ) И ДанныеУчета.СубконтоДт1 В (&парамРезервыБезОППВ))
	|			ТОГДА ДанныеУчета.СубконтоДтНУ1
	|		КОГДА ВидыСубконтоДтНУ1.ВидСубконто = &парамВидСубконтоСтатьиЗатрат ТОГДА &парамСтатьяЗатратЕП
	|		КОГДА ВидыСубконтоДтНУ1.ВидСубконто = &парамВидСубконтоПодразделения ТОГДА ДанныеУчета.ПодразделениеОрганизации
	|		КОГДА ДанныеУчета.ОсновнойСпособОтраженияВБухучете = &парамСпособПоУмолчанию
	|					И НЕ (ДанныеУчета.СпособОтраженияВБухучетеДляПодразделения ЕСТЬ NULL)
	|			ТОГДА ДанныеУчета.СпособОтраженияВБухучетеДляПодразделения.СубконтоДтНУ1
	|		ИНАЧЕ ДанныеУчета.ОсновнойСпособОтраженияВБухучете.СубконтоДтНУ1
	|	КОНЕЦ КАК СубконтоДтНУ1,
	|
	|	ВЫБОР
	|		КОГДА НЕ(ДанныеУчета.СубконтоДтНУ2 ЕСТЬ NULL)
	//|				И НЕ(ДанныеУчета.СчетДтОплатаТруда В (&парамСчетаРезервовБезОППВ) И ДанныеУчета.СубконтоДт1 В (&парамРезервыБезОППВ))
	|			ТОГДА ДанныеУчета.СубконтоДтНУ2
	|		КОГДА ВидыСубконтоДтНУ2.ВидСубконто = &парамВидСубконтоСтатьиЗатрат ТОГДА &парамСтатьяЗатратЕП
	|		КОГДА ВидыСубконтоДтНУ2.ВидСубконто = &парамВидСубконтоПодразделения ТОГДА ДанныеУчета.ПодразделениеОрганизации
	|		КОГДА ДанныеУчета.ОсновнойСпособОтраженияВБухучете = &парамСпособПоУмолчанию
	|					И НЕ (ДанныеУчета.СпособОтраженияВБухучетеДляПодразделения ЕСТЬ NULL)
	|			ТОГДА ДанныеУчета.СпособОтраженияВБухучетеДляПодразделения.СубконтоДтНУ2
	|		ИНАЧЕ ДанныеУчета.ОсновнойСпособОтраженияВБухучете.СубконтоДтНУ2
	|	КОНЕЦ КАК СубконтоДтНУ2,
	|
	|	ВЫБОР
	|		КОГДА НЕ(ДанныеУчета.СубконтоДтНУ3 ЕСТЬ NULL)
	//|				И НЕ(ДанныеУчета.СчетДтОплатаТруда В (&парамСчетаРезервовБезОППВ) И ДанныеУчета.СубконтоДт1 В (&парамРезервыБезОППВ))
	|			ТОГДА ДанныеУчета.СубконтоДтНУ3
	|		КОГДА ВидыСубконтоДтНУ3.ВидСубконто = &парамВидСубконтоСтатьиЗатрат ТОГДА &парамСтатьяЗатратЕП
	|		КОГДА ВидыСубконтоДтНУ3.ВидСубконто = &парамВидСубконтоПодразделения ТОГДА ДанныеУчета.ПодразделениеОрганизации
	|		КОГДА ДанныеУчета.ОсновнойСпособОтраженияВБухучете = &парамСпособПоУмолчанию
	|					И НЕ (ДанныеУчета.СпособОтраженияВБухучетеДляПодразделения ЕСТЬ NULL)
	|			ТОГДА ДанныеУчета.СпособОтраженияВБухучетеДляПодразделения.СубконтоДтНУ3
	|		ИНАЧЕ ДанныеУчета.ОсновнойСпособОтраженияВБухучете.СубконтоДтНУ3
	|	КОНЕЦ КАК СубконтоДтНУ3
	|
	|ИЗ
	|	ВТ_ЕППоСчетамЗатрат КАК ДанныеУчета
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Типовой.ВидыСубконто КАК ВидыСубконтоДт1
	|		ПО ДанныеУчета.СчетДт = ВидыСубконтоДт1.Ссылка
	|		   И ВидыСубконтоДт1.НомерСтроки = 1 
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Типовой.ВидыСубконто КАК ВидыСубконтоДт2
	|		ПО ДанныеУчета.СчетДт = ВидыСубконтоДт2.Ссылка
	|		   И ВидыСубконтоДт2.НомерСтроки = 2
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Типовой.ВидыСубконто КАК ВидыСубконтоДт3
	|		ПО ДанныеУчета.СчетДт = ВидыСубконтоДт3.Ссылка
	|		   И ВидыСубконтоДт3.НомерСтроки = 3
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Налоговый.ВидыСубконто КАК ВидыСубконтоДтНУ1
	|		ПО ДанныеУчета.СчетДтНУ = ВидыСубконтоДтНУ1.Ссылка
	|		   И ВидыСубконтоДтНУ1.НомерСтроки = 1
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Налоговый.ВидыСубконто КАК ВидыСубконтоДтНУ2
	|		ПО ДанныеУчета.СчетДтНУ = ВидыСубконтоДтНУ2.Ссылка
	|		   И ВидыСубконтоДтНУ2.НомерСтроки = 2
	|
	|	ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Налоговый.ВидыСубконто КАК ВидыСубконтоДтНУ3
	|		ПО ДанныеУчета.СчетДтНУ = ВидыСубконтоДтНУ3.Ссылка
	|		   И ВидыСубконтоДтНУ3.НомерСтроки = 3
	|
	|УПОРЯДОЧИТЬ ПО
	|	ДанныеУчета.Физлицо,
	|	ДанныеУчета.ВидПлатежа
	|";
	
	Запрос.Текст = РаспределениеЕППоСчетамЗатрат;
	
	СчетКредита = Справочники.НалогиСборыОтчисления.ЕдиныйПлатеж.СчетУчетаРасчетовСКонтрагентомБУ;	
	Если НЕ ЗначениеЗаполнено(СчетКредита) Тогда
		СчетКредита	= ПланыСчетов.Типовой.ПрочиеНалоги;
	КонецЕсли;
	
	СчетКредитаНУ = ПроцедурыНалоговогоУчетаВызовСервераПовтИсп.ПолучитьСчетУчетаНУЕП(СчетКредита, КонецМесяца(Параметры.ПериодРегистрации));
	СчетКредитаНУ = ПроцедурыБухгалтерскогоУчета.ЗаполнитьСчетНалоговогоУчетаПоУмолчанию(СчетКредита, КонецМесяца(Параметры.ПериодРегистрации), ПланыСчетов.Налоговый.ПрочиеНалоги);
	                      
	СтатьяЗатратПеняПоЕП = Справочники.СтатьиЗатрат.ПеняПоЕП;	
	ВидНалогаСбораОтчисленияЕП = Справочники.НалогиСборыОтчисления.ЕдиныйПлатеж;
	
	Выборка = Запрос.Выполнить().Выбрать();

	ЕстьДанные = Выборка.Следующий();
	Пока ЕстьДанные Цикл
		ТекущееФизЛицо = Выборка.ФизЛицо;
		ТекущийВидПлатежа = Выборка.ВидПлатежа;
		СуммаКРаспределению = Выборка.СуммаЗаСчетРаботодателя;
		РаспределеннаяСумма = 0;
		
		Пока ЕстьДанные 
		   И Выборка.ФизЛицо = ТекущееФизЛицо 
		   И Выборка.ВидПлатежа = ТекущийВидПлатежа Цикл
			
			Строка = ПромежуточнаяТаблица.Добавить();			
			
			// В зависимости от вида платежа (Налог/Взнос или пеня) ставим на разные счета затрат
			Строка.ВидРасчета	= ВидНалогаСбораОтчисленияЕП;
			Строка.СчетДт 		= Выборка.СчетДт;
			Строка.СубконтоДт1 	= Выборка.СубконтоДт1;
			Строка.СубконтоДт2 	= Выборка.СубконтоДт2;
			Строка.СубконтоДт3 	= Выборка.СубконтоДт3;
			
			Строка.СчетДтНУ = Выборка.СчетДтНУ;
			Строка.СубконтоДтНУ1 = Выборка.СубконтоДтНУ1;
			Строка.СубконтоДтНУ2 = Выборка.СубконтоДтНУ2;
			Строка.СубконтоДтНУ3 = Выборка.СубконтоДтНУ3;
			
			Строка.СчетКт 		= СчетКредита;
			Строка.СубконтоКт1 	= Справочники.НалогиСборыОтчисления.ЕдиныйПлатеж;
			Строка.СубконтоКт2 	= Выборка.ВидПлатежа;
			Если ВедетсяУчетПоСотрудникам Тогда
				Строка.СубконтоКт3	= Выборка.Физлицо;
			КонецЕсли;
			
			Строка.СчетКтНУ = СчетКредитаНУ;
			ОбщегоНазначенияБККлиентСервер.ЗаменитьСубконтоНУ(Строка, Строка.СчетКт, Строка.СчетКтНУ, 1, Строка.СубконтоКт1, "СубконтоКтНУ");
			ОбщегоНазначенияБККлиентСервер.ЗаменитьСубконтоНУ(Строка, Строка.СчетКт, Строка.СчетКтНУ, 2, Строка.СубконтоКт2, "СубконтоКтНУ");
			Если ВедетсяУчетПоСотрудникам Тогда
				ОбщегоНазначенияБККлиентСервер.ЗаменитьСубконтоНУ(Строка, Строка.СчетКт, Строка.СчетКтНУ, 3, Строка.СубконтоКт3, "СубконтоКтНУ");
			КонецЕсли;
						
			Строка.Сумма	= Выборка.СуммаПроводки;
			Строка.ФизЛицо	= Выборка.ФизЛицо;
			Строка.СтруктурноеПодразделениеДт = Выборка.СтруктурноеПодразделениеДт;
			Строка.СтруктурноеПодразделениеКт = Параметры.СтруктурноеПодразделение;
			РаспределеннаяСумма = РаспределеннаяСумма + Выборка.СуммаПроводки;
			
			ЕстьДанные = Выборка.Следующий();
		КонецЦикла;
		
		// Остаток на последнюю строку по работнику
		Если СуммаКРаспределению <> РаспределеннаяСумма Тогда
			Строка.Сумма = Строка.Сумма + (СуммаКРаспределению - РаспределеннаяСумма);
		КонецЕсли;
	КонецЦикла;	

#КонецОбласти

	// переносим в табличную часть документа
	ПеренестиОтражениеВУчетеИзПромежуточнойТаблицы(Параметры, ПромежуточнаяТаблица, СтрокаРеквизитовГруппировки);
	
	
	ЗафиксироватьТранзакцию();
	
	СтруктураДанных = Новый Структура();
	СтруктураДанных.Вставить("ТаблицаОтражениеВУчете", Параметры.ТаблицаОтражениеВУчете); 
	 
	ПоместитьВоВременноеХранилище(СтруктураДанных, АдресХранилища); 
	
КонецПроцедуры

// Функция подготавливает менеджер временных таблиц со списком физлиц-работников,
// числящихся в указанном подразделении на начало месяц либо принятых в подразделение в течение месяца.
//
Функция ПодготовитьМенеджерВременныхТаблицСоСпискомФизЛиц(Параметры)
	
	УсловиеНаПодразделение = "";
		
	Если ЗначениеЗаполнено(Параметры.ПодразделениеОрганизации) Тогда
		УсловиеНаПодразделение = "РаботникиОрганизации.ПодразделениеОрганизации В ИЕРАРХИИ (&парамПодразделение)";
	КонецЕсли;
	
	Если ЗначениеЗаполнено(Параметры.СтруктурноеПодразделение) ИЛИ Параметры.ПоддержкаРаботыСоСтруктурнымиПодразделениями Тогда
		Если УсловиеНаПодразделение <> "" Тогда	
			УсловиеНаПодразделение = УсловиеНаПодразделение + " И ";
		КонецЕсли;
		УсловиеНаПодразделение = УсловиеНаПодразделение + "РаботникиОрганизации.СтруктурноеПодразделение = &парамСтруктурноеПодразделение";
	КонецЕсли;
	
	Запрос = Новый Запрос;
	МенеджерВТ = Новый МенеджерВременныхТаблиц;
	
	Запрос.МенеджерВременныхТаблиц = МенеджерВТ;
	
	Запрос.УстановитьПараметр("парамНачалоМесяца", 				НачалоМесяца(Параметры.ПериодРегистрации));
	Запрос.УстановитьПараметр("парамКонецМесяца", 				КонецМесяца(Параметры.ПериодРегистрации));
	Запрос.УстановитьПараметр("парамОрганизация", 				Параметры.Организация);
	Запрос.УстановитьПараметр("парамСтруктурноеПодразделение", 	Параметры.СтруктурноеПодразделение);
	Запрос.УстановитьПараметр("парамГоловнаяОрганизация", 		ОбщегоНазначенияБКВызовСервера.ГоловнаяОрганизацияДляУчетаЗарплаты(Параметры.Организация));
	Запрос.УстановитьПараметр("парамПодразделение", 			Параметры.ПодразделениеОрганизации);
	Запрос.УстановитьПараметр("ДокументСсылка", 				Параметры.ДокументСсылка);
	Запрос.УстановитьПараметр("парамПоддержкаРаботыСоСтруктурнымиПодразделениями", Параметры.ПоддержкаРаботыСоСтруктурнымиПодразделениями );
	
	//СписокРаботниковТекст
	//Описание:
	//	Выбирает список работников, отвечающих условиям отбора, числящихся на начало месяца и принятых за месяц,
	//  а также переведенных в середине месяца из других обособленных подразделений
	Запрос.Текст = 
		"ВЫБРАТЬ РАЗРЕШЕННЫЕ
		|	ИПНРасчетыСБюджетом.ФизЛицо
		|ПОМЕСТИТЬ ВТ_ДанныеОНалогах
		|ИЗ
		|	РегистрНакопления.ИПНРасчетыСБюджетом КАК ИПНРасчетыСБюджетом
		|ГДЕ
		|	&парамПодразделение = ЗНАЧЕНИЕ(Справочник.ПодразделенияОрганизаций.ПустаяСсылка)
		|	И ИПНРасчетыСБюджетом.Организация = &парамОрганизация
		|	И ВЫБОР
		|			КОГДА &парамПоддержкаРаботыСоСтруктурнымиПодразделениями
		|					ИЛИ &парамСтруктурноеПодразделение <> ЗНАЧЕНИЕ(Справочник.ПодразделенияОрганизаций.ПустаяСсылка)
		|				ТОГДА ИПНРасчетыСБюджетом.Регистратор.СтруктурноеПодразделение = &парамСтруктурноеПодразделение
		|			ИНАЧЕ ИСТИНА
		|		КОНЕЦ
		|	И ИПНРасчетыСБюджетом.Период МЕЖДУ &парамНачалоМесяца И &парамКонецМесяца
		|	И ИПНРасчетыСБюджетом.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход)
		|	И ИПНРасчетыСБюджетом.ВидСтроки = ЗНАЧЕНИЕ(Перечисление.РасчетыСБюджетомФондамиВидСтроки.Исчисление)
		|	И НЕ ИПНРасчетыСБюджетом.НеОтражатьВРеглУчете
		|	И ИПНРасчетыСБюджетом.Налог <> 0
		|	И ИПНРасчетыСБюджетом.Активность
		|
		|ОБЪЕДИНИТЬ
		|
		|ВЫБРАТЬ
		|	ОПВРасчетыСФондами.ФизЛицо
		|ИЗ
		|	РегистрНакопления.ОПВРасчетыСФондами КАК ОПВРасчетыСФондами
		|ГДЕ
		|	&парамПодразделение = ЗНАЧЕНИЕ(Справочник.ПодразделенияОрганизаций.ПустаяСсылка)
		|	И ОПВРасчетыСФондами.Организация = &парамОрганизация
		|	И ВЫБОР
		|			КОГДА &парамПоддержкаРаботыСоСтруктурнымиПодразделениями
		|					ИЛИ &парамСтруктурноеПодразделение <> ЗНАЧЕНИЕ(Справочник.ПодразделенияОрганизаций.ПустаяСсылка)
		|				ТОГДА ОПВРасчетыСФондами.Регистратор.СтруктурноеПодразделение = &парамСтруктурноеПодразделение
		|			ИНАЧЕ ИСТИНА
		|		КОНЕЦ
		|	И ОПВРасчетыСФондами.Период МЕЖДУ &парамНачалоМесяца И &парамКонецМесяца
		|	И ОПВРасчетыСФондами.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход)
		|	И ОПВРасчетыСФондами.ВидСтроки = ЗНАЧЕНИЕ(Перечисление.РасчетыСБюджетомФондамиВидСтроки.Исчисление)
		|	И ОПВРасчетыСФондами.Взнос <> 0
		|	И ОПВРасчетыСФондами.Активность
		|
		|ОБЪЕДИНИТЬ
		|
		|ВЫБРАТЬ
		|	СОРасчетыСФондами.ФизЛицо
		|ИЗ
		|	РегистрНакопления.СОРасчетыСФондами КАК СОРасчетыСФондами
		|ГДЕ
		|	&парамПодразделение = ЗНАЧЕНИЕ(Справочник.ПодразделенияОрганизаций.ПустаяСсылка)
		|	И СОРасчетыСФондами.Организация = &парамОрганизация
		|	И ВЫБОР
		|			КОГДА &парамПоддержкаРаботыСоСтруктурнымиПодразделениями
		|					ИЛИ &парамСтруктурноеПодразделение <> ЗНАЧЕНИЕ(Справочник.ПодразделенияОрганизаций.ПустаяСсылка)
		|				ТОГДА СОРасчетыСФондами.Регистратор.СтруктурноеПодразделение = &парамСтруктурноеПодразделение
		|			ИНАЧЕ ИСТИНА
		|		КОНЕЦ
		|	И СОРасчетыСФондами.Период МЕЖДУ &парамНачалоМесяца И &парамКонецМесяца
		|	И СОРасчетыСФондами.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход)
		|	И СОРасчетыСФондами.ВидСтроки = ЗНАЧЕНИЕ(Перечисление.РасчетыСБюджетомФондамиВидСтроки.Исчисление)
		|	И СОРасчетыСФондами.Отчисление <> 0
		|	И СОРасчетыСФондами.Активность
		|
		|ОБЪЕДИНИТЬ
		|
		|ВЫБРАТЬ
		|	СНИсчисленный.ФизЛицо
		|ИЗ
		|	РегистрНакопления.СНИсчисленный КАК СНИсчисленный
		|ГДЕ
		|	&парамПодразделение = ЗНАЧЕНИЕ(Справочник.ПодразделенияОрганизаций.ПустаяСсылка)
		|	И СНИсчисленный.Организация = &парамОрганизация
		|	И ВЫБОР
		|			КОГДА &парамПоддержкаРаботыСоСтруктурнымиПодразделениями
		|					ИЛИ &парамСтруктурноеПодразделение <> ЗНАЧЕНИЕ(Справочник.ПодразделенияОрганизаций.ПустаяСсылка)
		|				ТОГДА СНИсчисленный.Регистратор.СтруктурноеПодразделение = &парамСтруктурноеПодразделение
		|			ИНАЧЕ ИСТИНА
		|		КОНЕЦ
		|	И СНИсчисленный.Период МЕЖДУ &парамНачалоМесяца И &парамКонецМесяца
		|	И НЕ СНИсчисленный.НеОтражатьВРеглУчете
		|	И СНИсчисленный.Налог <> 0
		|	И СНИсчисленный.Активность
		|
		|ОБЪЕДИНИТЬ
		|
		|ВЫБРАТЬ
		|	ОППВРасчетыСФондами.ФизЛицо
		|ИЗ
		|	РегистрНакопления.ОППВРасчетыСФондами КАК ОППВРасчетыСФондами
		|ГДЕ
		|	&парамПодразделение = ЗНАЧЕНИЕ(Справочник.ПодразделенияОрганизаций.ПустаяСсылка)
		|	И ОППВРасчетыСФондами.Организация = &парамОрганизация
		|	И ВЫБОР
		|			КОГДА &парамПоддержкаРаботыСоСтруктурнымиПодразделениями
		|					ИЛИ &парамСтруктурноеПодразделение <> ЗНАЧЕНИЕ(Справочник.ПодразделенияОрганизаций.ПустаяСсылка)
		|				ТОГДА ОППВРасчетыСФондами.Регистратор.СтруктурноеПодразделение = &парамСтруктурноеПодразделение
		|			ИНАЧЕ ИСТИНА
		|		КОНЕЦ
		|	И ОППВРасчетыСФондами.Период МЕЖДУ &парамНачалоМесяца И &парамКонецМесяца
		|	И ОППВРасчетыСФондами.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход)
		|	И ОППВРасчетыСФондами.ВидСтроки = ЗНАЧЕНИЕ(Перечисление.РасчетыСБюджетомФондамиВидСтроки.Исчисление)
		|	И ОППВРасчетыСФондами.Взнос <> 0
		|	И ОППВРасчетыСФондами.Активность
		|
		|
		|ОБЪЕДИНИТЬ
		|
		|ВЫБРАТЬ
		|	ОПВРРасчетыСФондами.ФизЛицо
		|ИЗ
		|	РегистрНакопления.ОПВРРасчетыСФондами КАК ОПВРРасчетыСФондами
		|ГДЕ
		|	&парамПодразделение = ЗНАЧЕНИЕ(Справочник.ПодразделенияОрганизаций.ПустаяСсылка)
		|	И ОПВРРасчетыСФондами.Организация = &парамОрганизация
		|	И ВЫБОР
		|			КОГДА &парамПоддержкаРаботыСоСтруктурнымиПодразделениями
		|					ИЛИ &парамСтруктурноеПодразделение <> ЗНАЧЕНИЕ(Справочник.ПодразделенияОрганизаций.ПустаяСсылка)
		|				ТОГДА ОПВРРасчетыСФондами.Регистратор.СтруктурноеПодразделение = &парамСтруктурноеПодразделение
		|			ИНАЧЕ ИСТИНА
		|		КОНЕЦ
		|	И ОПВРРасчетыСФондами.Период МЕЖДУ &парамНачалоМесяца И &парамКонецМесяца
		|	И ОПВРРасчетыСФондами.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход)
		|	И ОПВРРасчетыСФондами.ВидСтроки = ЗНАЧЕНИЕ(Перечисление.РасчетыСБюджетомФондамиВидСтроки.Исчисление)
		|	И ОПВРРасчетыСФондами.Взнос <> 0
		|	И ОПВРРасчетыСФондами.Активность
		|
		|ОБЪЕДИНИТЬ
		|
		|ВЫБРАТЬ
		|	ВОСМСРасчетыСФондами.ФизЛицо
		|ИЗ
		|	РегистрНакопления.ВОСМСРасчетыСФондами КАК ВОСМСРасчетыСФондами
		|ГДЕ
		|	&парамПодразделение = ЗНАЧЕНИЕ(Справочник.ПодразделенияОрганизаций.ПустаяСсылка)
		|	И ВОСМСРасчетыСФондами.Организация = &парамОрганизация
		|	И ВЫБОР
		|			КОГДА &парамПоддержкаРаботыСоСтруктурнымиПодразделениями
		|					ИЛИ &парамСтруктурноеПодразделение <> ЗНАЧЕНИЕ(Справочник.ПодразделенияОрганизаций.ПустаяСсылка)
		|				ТОГДА ВОСМСРасчетыСФондами.Регистратор.СтруктурноеПодразделение = &парамСтруктурноеПодразделение
		|			ИНАЧЕ ИСТИНА
		|		КОНЕЦ
		|	И ВОСМСРасчетыСФондами.Период МЕЖДУ &парамНачалоМесяца И &парамКонецМесяца
		|	И ВОСМСРасчетыСФондами.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход)
		|	И ВОСМСРасчетыСФондами.ВидСтроки = ЗНАЧЕНИЕ(Перечисление.РасчетыСБюджетомФондамиВидСтроки.Исчисление)
		|	И ВОСМСРасчетыСФондами.Взнос <> 0
		|	И ВОСМСРасчетыСФондами.Активность
		|
		|ОБЪЕДИНИТЬ
		|
		|ВЫБРАТЬ
		|	ООСМСРасчетыСФондами.ФизЛицо
		|ИЗ
		|	РегистрНакопления.ООСМСРасчетыСФондами КАК ООСМСРасчетыСФондами
		|ГДЕ
		|	&парамПодразделение = ЗНАЧЕНИЕ(Справочник.ПодразделенияОрганизаций.ПустаяСсылка)
		|	И ООСМСРасчетыСФондами.Организация = &парамОрганизация
		|	И ВЫБОР
		|			КОГДА &парамПоддержкаРаботыСоСтруктурнымиПодразделениями
		|					ИЛИ &парамСтруктурноеПодразделение <> ЗНАЧЕНИЕ(Справочник.ПодразделенияОрганизаций.ПустаяСсылка)
		|				ТОГДА ООСМСРасчетыСФондами.Регистратор.СтруктурноеПодразделение = &парамСтруктурноеПодразделение
		|			ИНАЧЕ ИСТИНА
		|		КОНЕЦ
		|	И ООСМСРасчетыСФондами.Период МЕЖДУ &парамНачалоМесяца И &парамКонецМесяца
		|	И ООСМСРасчетыСФондами.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход)
		|	И ООСМСРасчетыСФондами.ВидСтроки = ЗНАЧЕНИЕ(Перечисление.РасчетыСБюджетомФондамиВидСтроки.Исчисление)
		|	И ООСМСРасчетыСФондами.Отчисление <> 0
		|	И ООСМСРасчетыСФондами.Активность
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	ФизЛицо
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ РАЗРЕШЕННЫЕ
		|	РаботникиОрганизации.Сотрудник.Физлицо КАК ФизЛицо,
		|	МАКСИМУМ(ВЫБОР
		|			КОГДА РаботникиОрганизации.ПричинаИзмененияСостояния = ЗНАЧЕНИЕ(Перечисление.ПричиныИзмененияСостояния.Увольнение)
		|				ТОГДА ДОБАВИТЬКДАТЕ(РаботникиОрганизации.Период, ДЕНЬ, -1)
		|			ИНАЧЕ РаботникиОрганизации.Период
		|		КОНЕЦ) КАК Период
		|ПОМЕСТИТЬ ВТ_ДатыПоследнихНазначений
		|ИЗ
		|	РегистрСведений.РаботникиОрганизаций.СрезПоследних(&парамНачалоМесяца, Организация = &парамГоловнаяОрганизация И Сотрудник.ВидЗанятости <> ЗНАЧЕНИЕ(Перечисление.ВидыЗанятостиВОрганизации.ВнутреннееСовместительство)) КАК РаботникиОрганизации
		|ГДЕ
		|	РаботникиОрганизации.ОбособленноеПодразделение = &парамОрганизация
		|
		|СГРУППИРОВАТЬ ПО
		|	РаботникиОрганизации.Сотрудник.Физлицо
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	ФизЛицо
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ РАЗРЕШЕННЫЕ
		|	ТекущееНазначение.Регистратор КАК Регистратор,
		|	ТекущееНазначение.НомерСтроки КАК НомерСтроки,
		|	МАКСИМУМ(ПредыдущееНазначение.Период) КАК ДатаПредыдущегоНазначения
		|ПОМЕСТИТЬ ВТ_ДатыПредыдущихНазначений
		|ИЗ
		|	РегистрСведений.РаботникиОрганизаций КАК ТекущееНазначение
		|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РаботникиОрганизаций КАК ПредыдущееНазначение
		|		ПО ТекущееНазначение.Сотрудник = ПредыдущееНазначение.Сотрудник
		|			И (ПредыдущееНазначение.Организация = &парамГоловнаяОрганизация)
		|			И (ПредыдущееНазначение.Период < ТекущееНазначение.Период)
		|			И (ПредыдущееНазначение.Активность)
		|ГДЕ
		|	ТекущееНазначение.Период > &парамНачалоМесяца
		|	И ТекущееНазначение.Период <= &парамКонецМесяца
		|	И ТекущееНазначение.Организация = &парамГоловнаяОрганизация
		|	И ТекущееНазначение.ОбособленноеПодразделение = &парамОрганизация
		|	И ТекущееНазначение.Активность
		|
		|СГРУППИРОВАТЬ ПО
		|	ТекущееНазначение.Регистратор,
		|	ТекущееНазначение.НомерСтроки
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	Регистратор,
		|	НомерСтроки
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ РАЗРЕШЕННЫЕ
		|	РаботникиОрганизации.Сотрудник.Физлицо КАК Физлицо
		|ПОМЕСТИТЬ ВТ_СписокРаботников
		|ИЗ
		|	ВТ_ДатыПоследнихНазначений КАК ДатыПоследнихНазначений
		|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РаботникиОрганизаций КАК РаботникиОрганизации
		|		ПО ДатыПоследнихНазначений.ФизЛицо = РаботникиОрганизации.Сотрудник.Физлицо
		|			И (ДатыПоследнихНазначений.Период = ВЫБОР
		|				КОГДА РаботникиОрганизации.ПричинаИзмененияСостояния = ЗНАЧЕНИЕ(Перечисление.ПричиныИзмененияСостояния.Увольнение)
		|					ТОГДА ДОБАВИТЬКДАТЕ(РаботникиОрганизации.Период, ДЕНЬ, -1)
		|				ИНАЧЕ РаботникиОрганизации.Период
		|			КОНЕЦ)
		|			И (РаботникиОрганизации.Организация = &парамГоловнаяОрганизация)
		|			И (РаботникиОрганизации.ОбособленноеПодразделение = &парамОрганизация)
		|			И (РаботникиОрганизации.Активность)
		|			И (ВЫБОР
		|				КОГДА &парамПодразделение <> ЗНАЧЕНИЕ(Справочник.ПодразделенияОрганизаций.ПустаяСсылка)
		|					ТОГДА РаботникиОрганизации.ПодразделениеОрганизации В ИЕРАРХИИ (&парамПодразделение)
		|				ИНАЧЕ ИСТИНА
		|			КОНЕЦ)
		|			И (ВЫБОР
		|				КОГДА &парамПоддержкаРаботыСоСтруктурнымиПодразделениями
		|						ИЛИ &парамСтруктурноеПодразделение <> ЗНАЧЕНИЕ(Справочник.ПодразделенияОрганизаций.ПустаяСсылка)
		|					ТОГДА РаботникиОрганизации.СтруктурноеПодразделение = &парамСтруктурноеПодразделение
		|				ИНАЧЕ ИСТИНА
		|			КОНЕЦ)
		|ГДЕ
		|	ВЫБОР
		|			КОГДА &парамПодразделение <> ЗНАЧЕНИЕ(Справочник.ПодразделенияОрганизаций.ПустаяСсылка)
		|				ТОГДА РаботникиОрганизации.ПодразделениеОрганизации В ИЕРАРХИИ (&парамПодразделение)
		|			ИНАЧЕ ИСТИНА
		|		КОНЕЦ
		|	И ВЫБОР
		|			КОГДА &парамПоддержкаРаботыСоСтруктурнымиПодразделениями
		|					ИЛИ &парамСтруктурноеПодразделение <> ЗНАЧЕНИЕ(Справочник.ПодразделенияОрганизаций.ПустаяСсылка)
		|				ТОГДА РаботникиОрганизации.СтруктурноеПодразделение = &парамСтруктурноеПодразделение
		|			ИНАЧЕ ИСТИНА
		|		КОНЕЦ
		|
		|ОБЪЕДИНИТЬ
		|
		|ВЫБРАТЬ
		|	РаботникиОрганизации.Сотрудник.Физлицо
		|ИЗ
		|	РегистрСведений.РаботникиОрганизаций КАК РаботникиОрганизации
		|		ЛЕВОЕ СОЕДИНЕНИЕ ВТ_ДатыПредыдущихНазначений КАК ДатыПредыдущихНазначений
		|		ПО РаботникиОрганизации.Регистратор = ДатыПредыдущихНазначений.Регистратор
		|			И РаботникиОрганизации.НомерСтроки = ДатыПредыдущихНазначений.НомерСтроки
		|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РаботникиОрганизаций КАК ПредыдущиеНазначения
		|		ПО РаботникиОрганизации.Сотрудник = ПредыдущиеНазначения.Сотрудник
		|			И (ПредыдущиеНазначения.Организация = &парамГоловнаяОрганизация)
		|			И (ДатыПредыдущихНазначений.ДатаПредыдущегоНазначения = ПредыдущиеНазначения.Период)
		|			И (ПредыдущиеНазначения.Активность)
		|ГДЕ
		|	РаботникиОрганизации.Период > &парамНачалоМесяца
		|	И РаботникиОрганизации.Период <= &парамКонецМесяца
		|	И РаботникиОрганизации.Организация = &парамГоловнаяОрганизация
		|	И (РаботникиОрганизации.ПричинаИзмененияСостояния = ЗНАЧЕНИЕ(Перечисление.ПричиныИзмененияСостояния.ПриемНаРаботу)
		|			ИЛИ РаботникиОрганизации.ОбособленноеПодразделение <> ПредыдущиеНазначения.ОбособленноеПодразделение
		|			ИЛИ РаботникиОрганизации.СтруктурноеПодразделение <> ПредыдущиеНазначения.СтруктурноеПодразделение)
		|	И РаботникиОрганизации.ОбособленноеПодразделение = &парамОрганизация
		|	И РаботникиОрганизации.Активность
		|	И ВЫБОР
		|			КОГДА &парамПодразделение <> ЗНАЧЕНИЕ(Справочник.ПодразделенияОрганизаций.ПустаяСсылка)
		|				ТОГДА РаботникиОрганизации.ПодразделениеОрганизации В ИЕРАРХИИ (&парамПодразделение)
		|			ИНАЧЕ ИСТИНА
		|		КОНЕЦ
		|	И ВЫБОР
		|			КОГДА &парамПоддержкаРаботыСоСтруктурнымиПодразделениями
		|					ИЛИ &парамСтруктурноеПодразделение <> ЗНАЧЕНИЕ(Справочник.ПодразделенияОрганизаций.ПустаяСсылка)
		|				ТОГДА РаботникиОрганизации.СтруктурноеПодразделение = &парамСтруктурноеПодразделение
		|			ИНАЧЕ ИСТИНА
		|		КОНЕЦ
		|
		|ОБЪЕДИНИТЬ
		|
		|ВЫБРАТЬ
		|	ДанныеОНалогах.ФизЛицо
		|ИЗ
		|	ВТ_ДанныеОНалогах КАК ДанныеОНалогах
		|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РаботникиОрганизаций.СрезПоследних(
		|				&парамКонецМесяца,
		|				Организация = &парамГоловнаяОрганизация
		|					И ВЫБОР
		|						КОГДА ОбособленноеПодразделение = Организация
		|							ТОГДА Сотрудник.ВидЗанятости <> ЗНАЧЕНИЕ(Перечисление.ВидыЗанятостиВОрганизации.ВнутреннееСовместительство)
		|						ИНАЧЕ ИСТИНА
		|					КОНЕЦ) КАК РаботникиОрганизации
		|		ПО ДанныеОНалогах.ФизЛицо = РаботникиОрганизации.Сотрудник.Физлицо
		|			И (РаботникиОрганизации.ОбособленноеПодразделение = &парамОрганизация)
		|ГДЕ
		|	РаботникиОрганизации.Сотрудник ЕСТЬ NULL 
		|
		|ОБЪЕДИНИТЬ
		|
		|ВЫБРАТЬ
		|	ИПНСведенияОДоходах.ФизЛицо
		|ИЗ
		|	РегистрНакопления.ИПНСведенияОДоходах КАК ИПНСведенияОДоходах
		|ГДЕ
		|	ИПНСведенияОДоходах.Организация = &парамОрганизация
		|	И ИПНСведенияОДоходах.ФизЛицо ССЫЛКА Справочник.Контрагенты
		|	И ИПНСведенияОДоходах.Регистратор ССЫЛКА Документ.РегистрацияПрочихДоходовВЦеляхНалогообложения
		|	И ИПНСведенияОДоходах.ПериодРегистрации = &парамНачалоМесяца
		|	И ИПНСведенияОДоходах.СуммаДохода <> 0
		|	И ИПНСведенияОДоходах.Активность
		|	И ВЫБОР
		|			КОГДА &парамПодразделение <> ЗНАЧЕНИЕ(Справочник.ПодразделенияОрганизаций.ПустаяСсылка)
		|				ТОГДА ИПНСведенияОДоходах.Регистратор.ПодразделениеОрганизации В ИЕРАРХИИ (&парамПодразделение)
		|			ИНАЧЕ ИСТИНА
		|		КОНЕЦ
		|	И ВЫБОР
		|			КОГДА &парамПоддержкаРаботыСоСтруктурнымиПодразделениями
		|					ИЛИ &парамСтруктурноеПодразделение <> ЗНАЧЕНИЕ(Справочник.ПодразделенияОрганизаций.ПустаяСсылка)
		|				ТОГДА ИПНСведенияОДоходах.Регистратор.СтруктурноеПодразделение = &парамСтруктурноеПодразделение
		|			ИНАЧЕ ИСТИНА
		|		КОНЕЦ
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	ФизЛицо
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ РАЗРЕШЕННЫЕ РАЗЛИЧНЫЕ
		|	СписокФизЛиц.Физлицо
		|ПОМЕСТИТЬ ВТСписокФизЛиц
		|ИЗ
		|	ВТ_СписокРаботников КАК СписокФизЛиц
		|		ЛЕВОЕ СОЕДИНЕНИЕ Документ.ОтражениеЗарплатыВРеглУчете.ОтражениеВУчете КАК УжеРанееОтражено
		|		ПО СписокФизЛиц.Физлицо = УжеРанееОтражено.ФизЛицо
		|			И (УжеРанееОтражено.Ссылка.Организация = &парамОрганизация)
		|			И (УжеРанееОтражено.Ссылка.ПериодРегистрации = &парамНачалоМесяца)
		|			И (УжеРанееОтражено.Ссылка.Проведен)
		|			И (УжеРанееОтражено.Ссылка <> &ДокументСсылка)
		|ГДЕ
		|	УжеРанееОтражено.ФизЛицо ЕСТЬ NULL 
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	СписокФизЛиц.Физлицо";

	Запрос.Выполнить();

	Возврат МенеджерВТ;

КонецФункции

// Создает строку отражения начислений в ТЧ ОтражениеВУчете.
// 
// Параметры:
//	ДанныеУчета - спозиционированная выборка по результату запроса
//  ПустойСчет - пустая ссылка на счет
//  ПустойСчетНУ - пустая ссылка на счет НУ
//
Процедура СоздатьСтрокуОтраженияНачислений(ДанныеУчета, СтрокаДанных, ПустойСчет, ПустойСчетНУ)
	
	СтрокаДанных.СчетДт = ДанныеУчета.СчетДт;
	СтрокаДанных.СчетКт = ДанныеУчета.СчетКт;
	СтрокаДанных.СубконтоДт1 = ДанныеУчета.СубконтоДт1;
	СтрокаДанных.СубконтоДт2 = ДанныеУчета.СубконтоДт2;
	СтрокаДанных.СубконтоДт3 = ДанныеУчета.СубконтоДт3;
	СтрокаДанных.СубконтоКт1 = ДанныеУчета.СубконтоКт1;
	СтрокаДанных.СубконтоКт2 = ДанныеУчета.СубконтоКт2;
	СтрокаДанных.СубконтоКт3 = ДанныеУчета.СубконтоКт3;
	СтрокаДанных.СчетДтНУ 	 = ДанныеУчета.СчетДтНУ;
	СтрокаДанных.СчетКтНУ 	 = ДанныеУчета.СчетКтНУ;
	СтрокаДанных.СубконтоДтНУ1 = ДанныеУчета.СубконтоДтНУ1;
	СтрокаДанных.СубконтоДтНУ2 = ДанныеУчета.СубконтоДтНУ2;
	СтрокаДанных.СубконтоДтНУ3 = ДанныеУчета.СубконтоДтНУ3;
	СтрокаДанных.СубконтоКтНУ1 = ДанныеУчета.СубконтоКтНУ1;
	СтрокаДанных.СубконтоКтНУ2 = ДанныеУчета.СубконтоКтНУ2;
	СтрокаДанных.СубконтоКтНУ3 = ДанныеУчета.СубконтоКтНУ3;
	СтрокаДанных.Сумма 					  = ДанныеУчета.Результат;
	СтрокаДанных.ВидРасчета				  = ДанныеУчета.ВидРасчета;
	СтрокаДанных.ФизЛицо 				  = ДанныеУчета.ФизЛицо;
	СтрокаДанных.СтруктурноеПодразделениеДт = ДанныеУчета.СтруктурноеПодразделениеДт;
	СтрокаДанных.СтруктурноеПодразделениеКт = ДанныеУчета.СтруктурноеПодразделениеКт;

	АвтозаполнениеСубконто(ДанныеУчета, СтрокаДанных, ПустойСчет, ПустойСчетНУ);
	
КонецПроцедуры

// Создает строку отражения начислений в ТЧ ОтражениеВУчете.
// 
// Параметры:
//	ДанныеУчета - спозиционированная выборка по результату запроса
//  ПустойСчет - пустая ссылка на счет
//  ПустойСчетНУ - пустая ссылка на счет НУ
//
Процедура СоздатьСтрокуОтраженияНачисленийКонтрагентов(ДанныеУчета, СтрокаДанных, ПустойСчет, ПустойСчетНУ)
	
	СтрокаДанных.СчетДт = ДанныеУчета.СчетДт;
	СтрокаДанных.СчетКт = ДанныеУчета.СчетКт;
	СтрокаДанных.СубконтоДт1 = ДанныеУчета.СубконтоДт1;
	СтрокаДанных.СубконтоДт2 = ДанныеУчета.СубконтоДт2;
	СтрокаДанных.СубконтоДт3 = ДанныеУчета.СубконтоДт3;
	СтрокаДанных.СубконтоКт1 = ДанныеУчета.СубконтоКт1;
	СтрокаДанных.СубконтоКт2 = ДанныеУчета.СубконтоКт2;
	СтрокаДанных.СубконтоКт3 = ДанныеУчета.СубконтоКт3;
	СтрокаДанных.СчетДтНУ 	 = ДанныеУчета.СчетДтНУ;
	СтрокаДанных.СчетКтНУ 	 = ДанныеУчета.СчетКтНУ;
	СтрокаДанных.СубконтоДтНУ1 = ДанныеУчета.СубконтоДтНУ1;
	СтрокаДанных.СубконтоДтНУ2 = ДанныеУчета.СубконтоДтНУ2;
	СтрокаДанных.СубконтоДтНУ3 = ДанныеУчета.СубконтоДтНУ3;
	СтрокаДанных.СубконтоКтНУ1 = ДанныеУчета.СубконтоКтНУ1;
	СтрокаДанных.СубконтоКтНУ2 = ДанныеУчета.СубконтоКтНУ2;
	СтрокаДанных.СубконтоКтНУ3 = ДанныеУчета.СубконтоКтНУ3;
	СтрокаДанных.Сумма 					  = ДанныеУчета.Результат;
	СтрокаДанных.ВидРасчета				  = ДанныеУчета.ВидРасчета;
	СтрокаДанных.ФизЛицо 				  = ДанныеУчета.ФизЛицо;
	СтрокаДанных.СтруктурноеПодразделениеДт = ДанныеУчета.СтруктурноеПодразделениеДт;
	СтрокаДанных.СтруктурноеПодразделениеКт = ДанныеУчета.СтруктурноеПодразделениеКт;
	
	СтрокаДанных.Контрагент = ДанныеУчета.Контрагент;
	СтрокаДанных.ДоговорКонтрагента = ДанныеУчета.ДоговорКонтрагента;

	АвтозаполнениеСубконто(ДанныеУчета, СтрокаДанных, ПустойСчет, ПустойСчетНУ);
	
КонецПроцедуры

// Переносит данные из переменной ПромежуточнаяТаблица в табличную часть документа
//
Процедура ПеренестиОтражениеВУчетеИзПромежуточнойТаблицы(Параметры, ПромежуточнаяТаблица, СтрокаРеквизитовГруппировки)

	// переносим в табличную часть
	ПромежуточнаяТаблица.Свернуть(СтрокаРеквизитовГруппировки, "Сумма");
	
	Для Каждого Проводка Из ПромежуточнаяТаблица Цикл
		НоваяСтрока = Параметры.ТаблицаОтражениеВУчете.Добавить();
		ЗаполнитьЗначенияСвойств(НоваяСтрока, Проводка);
	КонецЦикла;

КонецПроцедуры

// Получение данных для бухучета.
// 
// Параметры:
//  Основные - булево, если Истина, то получаем данные по основным начислениям иначе - по доп.
//
// Возвращаемое значение:
//  Результат запроса
// 
Функция ПолучитьДанныеУчета(Параметры, МенеджерВТ)

	Запрос = Новый Запрос;
	
	Если МенеджерВТ <> Неопределено Тогда // установим менеджера врем. таблиц
		Запрос.МенеджерВременныхТаблиц = МенеджерВТ;
	Иначе
		Возврат Неопределено;
	КонецЕсли;

	Запрос.УстановитьПараметр("парамПериодРегистрации", Параметры.ПериодРегистрации);
	Запрос.УстановитьПараметр("парамОрганизация", Параметры.Организация);
	Запрос.УстановитьПараметр("парамСтруктурноеПодразделениеРаботников", Параметры.СтруктурноеПодразделение);
	
	Запрос.УстановитьПараметр("парамПустойСпособБУ", Справочники.СпособыОтраженияЗарплатыВРеглУчете.ПустаяСсылка());
	Запрос.УстановитьПараметр("парамПустойСчет", ПланыСчетов.Типовой.ПустаяСсылка());
	Запрос.УстановитьПараметр("парамПустойСчетНУ", ПланыСчетов.Налоговый.ПустаяСсылка());
 	
 	Запрос.УстановитьПараметр("парамВидСубконтоРаботникиОрганизаций", ПланыВидовХарактеристик.ВидыСубконтоТиповые.РаботникиОрганизаций);
	Запрос.УстановитьПараметр("парамВидСубконтоПодразделения", ПланыВидовХарактеристик.ВидыСубконтоТиповые.Подразделения);
	Запрос.УстановитьПараметр("парамВидСубконтоКонтрагенты", ПланыВидовХарактеристик.ВидыСубконтоТиповые.Контрагенты);
	Запрос.УстановитьПараметр("парамВидСубконтоДебиторыКредиторыОрганизации", ПланыВидовХарактеристик.ВидыСубконтоТиповые.ДебиторыКредиторыОрганизации);
	Запрос.УстановитьПараметр("парамВидСубконтоДоговорыКонтрагентов", ПланыВидовХарактеристик.ВидыСубконтоТиповые.Договоры);
	                                              
	СпособПоУмолчанию = Справочники.СпособыОтраженияЗарплатыВРеглУчете.ОтражениеНачисленийПоУмолчанию;
	
	Запрос.УстановитьПараметр("парамСпособПоУмолчанию", СпособПоУмолчанию);
	Запрос.УстановитьПараметр("парамСпособНеОтражать", Справочники.СпособыОтраженияЗарплатыВРеглУчете.НеОтражатьВБухучете);
	Запрос.УстановитьПараметр("парамСпособПоУмолчаниюСчетДт", СпособПоУмолчанию.СчетДт);
	Запрос.УстановитьПараметр("парамСпособПоУмолчаниюСчетКт", СпособПоУмолчанию.СчетКт);
	Запрос.УстановитьПараметр("парамСпособПоУмолчаниюСубконтоДт1", СпособПоУмолчанию.СубконтоДт1);
	Запрос.УстановитьПараметр("парамСпособПоУмолчаниюСубконтоДт2", СпособПоУмолчанию.СубконтоДт2);
	Запрос.УстановитьПараметр("парамСпособПоУмолчаниюСубконтоДт3", СпособПоУмолчанию.СубконтоДт3);
	Запрос.УстановитьПараметр("парамСпособПоУмолчаниюСубконтоКт1", СпособПоУмолчанию.СубконтоКт1);
	Запрос.УстановитьПараметр("парамСпособПоУмолчаниюСубконтоКт2", СпособПоУмолчанию.СубконтоКт2);
	Запрос.УстановитьПараметр("парамСпособПоУмолчаниюСубконтоКт3", СпособПоУмолчанию.СубконтоКт3);
	Запрос.УстановитьПараметр("парамСпособПоУмолчаниюСчетДтНУ",    СпособПоУмолчанию.СчетДтНУ);
	Запрос.УстановитьПараметр("парамСпособПоУмолчаниюСчетКтНУ",    СпособПоУмолчанию.СчетКтНУ);
	Запрос.УстановитьПараметр("парамСпособПоУмолчаниюСубконтоДтНУ1", СпособПоУмолчанию.СубконтоДтНУ1);
	Запрос.УстановитьПараметр("парамСпособПоУмолчаниюСубконтоДтНУ2", СпособПоУмолчанию.СубконтоДтНУ2);
	Запрос.УстановитьПараметр("парамСпособПоУмолчаниюСубконтоДтНУ3", СпособПоУмолчанию.СубконтоДтНУ3);
	Запрос.УстановитьПараметр("парамСпособПоУмолчаниюСубконтоКтНУ1", СпособПоУмолчанию.СубконтоКтНУ1);
	Запрос.УстановитьПараметр("парамСпособПоУмолчаниюСубконтоКтНУ2", СпособПоУмолчанию.СубконтоКтНУ2);
	Запрос.УстановитьПараметр("парамСпособПоУмолчаниюСубконтоКтНУ3", СпособПоУмолчанию.СубконтоКтНУ3);
	
	// значения по умолчанию для контрагентов
	СчетКтПоУмолчаниюКонтрагенты = ПланыСчетов.Типовой.ПрочаяКраткосрочнаяКредиторскаяЗадолженность;
	СчетКтНУПоУмолчаниюКонтрагенты = СчетКтПоУмолчаниюКонтрагенты.СчетНУ;
    Запрос.УстановитьПараметр("парамСчетКтПоУмолчаниюКонтрагенты", 	 СчетКтПоУмолчаниюКонтрагенты);
	Запрос.УстановитьПараметр("парамСчетКтНУПоУмолчаниюКонтрагенты", СчетКтНУПоУмолчаниюКонтрагенты);
			
	ТекстЗапроса = 
	"ВЫБРАТЬ РАЗРЕШЕННЫЕ
	|	УчетнаяПолитика.Организация,
	|	УчетнаяПолитика.ВестиУчетПоГоловнойОрганизации КАК ВедениеУчетаПоГоловнойОрганизации
	|ПОМЕСТИТЬ ВТ_УчетнаяПолитикаПоПерсоналуОрганизации
	|ИЗ
	|	РегистрСведений.УчетнаяПолитикаПоПерсоналуОрганизаций КАК УчетнаяПолитика
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	УчетнаяПолитика.Организация
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ РАЗРЕШЕННЫЕ
	|	ОсновныеНачисления.НомерСтроки КАК НомерСтроки,
	|	ОсновныеНачисления.Физлицо КАК ФизЛицо,
	|	ВЫБОР
	|		КОГДА ВТ_УчетнаяПолитикаПоПерсоналуОрганизации.ВедениеУчетаПоГоловнойОрганизации = ИСТИНА
	|			ТОГДА ВЫБОР
	|					КОГДА ОсновныеНачисления.Ссылка.Организация.ГоловнаяОрганизация = ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)
	|						ТОГДА ОсновныеНачисления.Ссылка.Организация
	|					ИНАЧЕ ОсновныеНачисления.Ссылка.Организация.ГоловнаяОрганизация
	|				КОНЕЦ
	|		ИНАЧЕ ОсновныеНачисления.Ссылка.Организация
	|	КОНЕЦ КАК Организация,
	|	ОсновныеНачисления.Ссылка КАК Ссылка,
	|	ОсновныеНачисления.Сотрудник КАК Сотрудник,
	|	ОсновныеНачисления.Ссылка.СтруктурноеПодразделение,
	|	ОсновныеНачисления.ПодразделениеОрганизации КАК ПодразделениеОрганизации,
	|	ОсновныеНачисления.ВидРасчета КАК ВидРасчета,
	|	ОсновныеНачисления.СпособОтраженияВБухучете КАК СпособОтраженияВБухучете,
	|	ОсновныеНачисления.ДатаНачала КАК ДатаНачала,
	|	ОсновныеНачисления.Результат КАК Результат
	|ПОМЕСТИТЬ ВТ_НачисленияРаботников
	|ИЗ
	|	Документ.НачислениеЗарплатыРаботникамОрганизаций.Начисления КАК ОсновныеНачисления
	|		ЛЕВОЕ СОЕДИНЕНИЕ ВТ_УчетнаяПолитикаПоПерсоналуОрганизации КАК ВТ_УчетнаяПолитикаПоПерсоналуОрганизации
	|		ПО ОсновныеНачисления.Ссылка.Организация = ВТ_УчетнаяПолитикаПоПерсоналуОрганизации.Организация
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТСписокФизЛиц КАК СписокФизЛиц
	|		ПО ОсновныеНачисления.Физлицо = СписокФизЛиц.ФизЛицо
	|ГДЕ
	|	ОсновныеНачисления.ПодразделениеОрганизации.Владелец = &парамОрганизация
	|	И ОсновныеНачисления.Ссылка.ПериодРегистрации = &парамПериодРегистрации
	|	И ОсновныеНачисления.Ссылка.Проведен
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	Организация,
	|	Сотрудник,
	|	ФизЛицо,
	|	ВидРасчета
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ РАЗРЕШЕННЫЕ
	|	СведенияОДоходах.НомерСтроки,
	|	СведенияОДоходах.Ссылка,
	|	СведенияОДоходах.Ссылка.СтруктурноеПодразделение КАК СтруктурноеПодразделение,
	|	СведенияОДоходах.Ссылка.ПодразделениеОрганизации КАК ПодразделениеОрганизации,
	|	СведенияОДоходах.ФизЛицо КАК Контрагент,
	|	СведенияОДоходах.ФизЛицо.ФизЛицо КАК ФизЛицо,
	|	СведенияОДоходах.ДоговорКонтрагента,
	|	СведенияОДоходах.ДатаДохода,
	|	СведенияОДоходах.МесяцНалоговогоПериода,
	|	СведенияОДоходах.ВидРасчета,
	|	СведенияОДоходах.СуммаДохода,
	|	СведенияОДоходах.СпособОтраженияВБухучете
	|ПОМЕСТИТЬ ВТ_НачисленияКонтрагентов
	|ИЗ
	|	Документ.РегистрацияПрочихДоходовВЦеляхНалогообложения.СведенияОДоходах КАК СведенияОДоходах
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТСписокФизЛиц КАК СписокФизЛиц
	|		ПО СведенияОДоходах.ФизЛицо = СписокФизЛиц.ФизЛицо
	|ГДЕ
	|	СведенияОДоходах.Ссылка.ВидОперации = ЗНАЧЕНИЕ(Перечисление.ВидыОперацийРегистрацияПрочихДоходов.ДоходыКонтрагентов)
	|	И СведенияОДоходах.Ссылка.Организация = &парамОрганизация
	|	И СведенияОДоходах.Ссылка.ПериодРегистрации = &парамПериодРегистрации
	|	И СведенияОДоходах.Ссылка.Проведен
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	ПодразделениеОрганизации
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ РАЗРЕШЕННЫЕ
	|	НачисленияКонтрагентов.Контрагент КАК Контрагент,
	|	НачисленияКонтрагентов.ФизЛицо КАК ФизЛицо,
	|	НачисленияКонтрагентов.ДатаДохода КАК ДатаДохода,
	|	НачисленияКонтрагентов.ПодразделениеОрганизации КАК ПодразделениеОрганизации,
	|	МАКСИМУМ(УчетОсновногоЗаработкаРаботниковПодразделенияОрганизации.Период) КАК Период
	|ПОМЕСТИТЬ ВТ_СведенияОПодразделенияхПоКонтрагентамСрез
	|ИЗ
	|	ВТ_НачисленияКонтрагентов КАК НачисленияКонтрагентов
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.УчетОсновногоЗаработкаРаботниковПодразделенияОрганизации КАК УчетОсновногоЗаработкаРаботниковПодразделенияОрганизации
	|		ПО НачисленияКонтрагентов.ПодразделениеОрганизации = УчетОсновногоЗаработкаРаботниковПодразделенияОрганизации.ПодразделениеОрганизации
	|			И (УчетОсновногоЗаработкаРаботниковПодразделенияОрганизации.Организация = &парамОрганизация)
	|			И (УчетОсновногоЗаработкаРаботниковПодразделенияОрганизации.Период <= НачисленияКонтрагентов.ДатаДохода)
	|
	|СГРУППИРОВАТЬ ПО
	|	НачисленияКонтрагентов.Контрагент,
	|	НачисленияКонтрагентов.ФизЛицо,
	|	НачисленияКонтрагентов.ДатаДохода,
	|	НачисленияКонтрагентов.ПодразделениеОрганизации
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	ПодразделениеОрганизации,
	|	Период
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ РАЗРЕШЕННЫЕ
	|	СведенияОПодразделенияхСрез.Контрагент КАК Контрагент,
	|	СведенияОПодразделенияхСрез.ФизЛицо КАК ФизЛицо,
	|	СведенияОПодразделенияхСрез.ДатаДохода КАК ДатаДохода,
	|	СведенияОПодразделенияхСрез.ПодразделениеОрганизации КАК ПодразделениеОрганизации,
	|	УчетОсновногоЗаработкаРаботниковПодразделенияОрганизации.СпособОтраженияВБухучете
	|ПОМЕСТИТЬ ВТ_УчетЗаработкаПодразделенияОрганизации
	|ИЗ
	|	ВТ_СведенияОПодразделенияхПоКонтрагентамСрез КАК СведенияОПодразделенияхСрез
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.УчетОсновногоЗаработкаРаботниковПодразделенияОрганизации КАК УчетОсновногоЗаработкаРаботниковПодразделенияОрганизации
	|		ПО СведенияОПодразделенияхСрез.ПодразделениеОрганизации = УчетОсновногоЗаработкаРаботниковПодразделенияОрганизации.ПодразделениеОрганизации
	|			И СведенияОПодразделенияхСрез.Период = УчетОсновногоЗаработкаРаботниковПодразделенияОрганизации.Период
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	Контрагент,
	|	ФизЛицо,
	|	ДатаДохода
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ РАЗРЕШЕННЫЕ
	|	ОсновныеНачисления.ФизЛицо КАК ФизЛицо,
	|	ОсновныеНачисления.Организация КАК Организация,
	|	ОсновныеНачисления.Сотрудник КАК Сотрудник,
	|	ОсновныеНачисления.ВидРасчета КАК ВидРасчета,
	|	ОсновныеНачисления.ДатаНачала КАК ДатаНачала,
	|	МАКСИМУМ(РеглУчетПлановыхНачисленийРаботниковОрганизаций.Период) КАК Период
	|ПОМЕСТИТЬ ВТ_СведенияОНачисленияхСрез
	|ИЗ
	|	ВТ_НачисленияРаботников КАК ОсновныеНачисления
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РеглУчетПлановыхНачисленийРаботниковОрганизаций КАК РеглУчетПлановыхНачисленийРаботниковОрганизаций
	|		ПО ОсновныеНачисления.Сотрудник = РеглУчетПлановыхНачисленийРаботниковОрганизаций.Сотрудник
	|			И ОсновныеНачисления.Организация = РеглУчетПлановыхНачисленийРаботниковОрганизаций.Организация
	|			И ОсновныеНачисления.ВидРасчета = РеглУчетПлановыхНачисленийРаботниковОрганизаций.ВидРасчета
	|			И (РеглУчетПлановыхНачисленийРаботниковОрганизаций.Период <= ОсновныеНачисления.ДатаНачала)
	|			И (РеглУчетПлановыхНачисленийРаботниковОрганизаций.Активность)
	|ГДЕ
	|	ОсновныеНачисления.ПодразделениеОрганизации.Владелец = &парамОрганизация
	|	И ОсновныеНачисления.Ссылка.ПериодРегистрации = &парамПериодРегистрации
	|	И ОсновныеНачисления.Ссылка.Проведен
	|
	|СГРУППИРОВАТЬ ПО
	|	ОсновныеНачисления.ФизЛицо,
	|	ОсновныеНачисления.Организация,
	|	ОсновныеНачисления.Сотрудник,
	|	ОсновныеНачисления.ВидРасчета,
	|	ОсновныеНачисления.ДатаНачала
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	Организация,
	|	Сотрудник,
	|	ВидРасчета,
	|	Период
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ РАЗРЕШЕННЫЕ
	|	ОсновныеНачисления.Ссылка,
	|	ОсновныеНачисления.НомерСтроки,
	|	ОсновныеНачисления.ПодразделениеОрганизации,
	|	МАКСИМУМ(УчетОсновногоЗаработкаРаботниковПодразделенияОрганизации.Период) КАК Период
	|ПОМЕСТИТЬ ВТ_СведенияОПодразделенияхСрез
	|ИЗ
	|	ВТ_НачисленияРаботников КАК ОсновныеНачисления
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.УчетОсновногоЗаработкаРаботниковПодразделенияОрганизации КАК УчетОсновногоЗаработкаРаботниковПодразделенияОрганизации
	|		ПО ОсновныеНачисления.ПодразделениеОрганизации = УчетОсновногоЗаработкаРаботниковПодразделенияОрганизации.ПодразделениеОрганизации
	|ГДЕ
	|	ОсновныеНачисления.ПодразделениеОрганизации.Владелец = &парамОрганизация
	|	И ОсновныеНачисления.Ссылка.ПериодРегистрации = &парамПериодРегистрации
	|	И ОсновныеНачисления.Ссылка.Проведен
	|
	|СГРУППИРОВАТЬ ПО
	|	ОсновныеНачисления.Ссылка,
	|	ОсновныеНачисления.НомерСтроки,
	|	ОсновныеНачисления.ПодразделениеОрганизации
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	ОсновныеНачисления.Ссылка,
	|	ОсновныеНачисления.НомерСтроки,
	|	ОсновныеНачисления.ПодразделениеОрганизации,
	|	Период
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ РАЗРЕШЕННЫЕ
	|	ОсновныеНачисления.ФизЛицо КАК ФизЛицо,
	|	ВЫБОР
	|		КОГДА ОсновныеНачисления.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА ОсновныеНачисления.СпособОтраженияВБухучете.СчетДт
	|		КОГДА ОсновныеНачисления.Ссылка.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА ОсновныеНачисления.Ссылка.СпособОтраженияВБухучете.СчетДт
	|		КОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете.СчетДт
	|		КОГДА ОсновныеНачисления.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА ОсновныеНачисления.ВидРасчета.СпособОтраженияВБухучете.СчетДт
	|		КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизации.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизации.СпособОтраженияВБухучете.СчетДт
	|		ИНАЧЕ &парамСпособПоУмолчаниюСчетДт
	|	КОНЕЦ КАК СчетДт,
	|	ВЫБОР
	|		КОГДА ОсновныеНачисления.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА ОсновныеНачисления.СпособОтраженияВБухучете.СчетКт
	|		КОГДА ОсновныеНачисления.Ссылка.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА ОсновныеНачисления.Ссылка.СпособОтраженияВБухучете.СчетКт
	|		КОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете.СчетКт
	|		КОГДА ОсновныеНачисления.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА ОсновныеНачисления.ВидРасчета.СпособОтраженияВБухучете.СчетКт
	|		КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизации.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизации.СпособОтраженияВБухучете.СчетКт
	|		ИНАЧЕ &парамСпособПоУмолчаниюСчетКт
	|	КОНЕЦ КАК СчетКт,
	|	ВЫБОР
	|		КОГДА ОсновныеНачисления.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА ОсновныеНачисления.СпособОтраженияВБухучете.СчетДтНУ
	|		КОГДА ОсновныеНачисления.Ссылка.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА ОсновныеНачисления.Ссылка.СпособОтраженияВБухучете.СчетДтНУ
	|		КОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете.СчетДтНУ
	|		КОГДА ОсновныеНачисления.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА ОсновныеНачисления.ВидРасчета.СпособОтраженияВБухучете.СчетДтНУ
	|		КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизации.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизации.СпособОтраженияВБухучете.СчетДтНУ
	|		ИНАЧЕ &парамСпособПоУмолчаниюСчетДтНУ
	|	КОНЕЦ КАК СчетДтНУ,
	|	ВЫБОР
	|		КОГДА ОсновныеНачисления.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА ОсновныеНачисления.СпособОтраженияВБухучете.СчетКтНУ
	|		КОГДА ОсновныеНачисления.Ссылка.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА ОсновныеНачисления.Ссылка.СпособОтраженияВБухучете.СчетКтНУ
	|		КОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете.СчетКтНУ
	|		КОГДА ОсновныеНачисления.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА ОсновныеНачисления.ВидРасчета.СпособОтраженияВБухучете.СчетКтНУ
	|		КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизации.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизации.СпособОтраженияВБухучете.СчетКтНУ
	|		ИНАЧЕ &парамСпособПоУмолчаниюСчетКтНУ
	|	КОНЕЦ КАК СчетКтНУ,
	|	ВЫБОР
	|		КОГДА ОсновныеНачисления.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА ОсновныеНачисления.СпособОтраженияВБухучете.СубконтоДт1
	|		КОГДА ОсновныеНачисления.Ссылка.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА ОсновныеНачисления.Ссылка.СпособОтраженияВБухучете.СубконтоДт1
	|		КОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДт1
	|		КОГДА ОсновныеНачисления.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА ОсновныеНачисления.ВидРасчета.СпособОтраженияВБухучете.СубконтоДт1
	|		КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизации.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизации.СпособОтраженияВБухучете.СубконтоДт1
	|		ИНАЧЕ &парамСпособПоУмолчаниюСубконтоДт1
	|	КОНЕЦ КАК СубконтоДт1,
	|	ВЫБОР
	|		КОГДА ОсновныеНачисления.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА ОсновныеНачисления.СпособОтраженияВБухучете.СубконтоДт2
	|		КОГДА ОсновныеНачисления.Ссылка.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА ОсновныеНачисления.Ссылка.СпособОтраженияВБухучете.СубконтоДт2
	|		КОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДт2
	|		КОГДА ОсновныеНачисления.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА ОсновныеНачисления.ВидРасчета.СпособОтраженияВБухучете.СубконтоДт2
	|		КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизации.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизации.СпособОтраженияВБухучете.СубконтоДт2
	|		ИНАЧЕ &парамСпособПоУмолчаниюСубконтоДт2
	|	КОНЕЦ КАК СубконтоДт2,
	|	ВЫБОР
	|		КОГДА ОсновныеНачисления.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА ОсновныеНачисления.СпособОтраженияВБухучете.СубконтоДт3
	|		КОГДА ОсновныеНачисления.Ссылка.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА ОсновныеНачисления.Ссылка.СпособОтраженияВБухучете.СубконтоДт3
	|		КОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДт3
	|		КОГДА ОсновныеНачисления.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА ОсновныеНачисления.ВидРасчета.СпособОтраженияВБухучете.СубконтоДт3
	|		КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизации.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизации.СпособОтраженияВБухучете.СубконтоДт3
	|		ИНАЧЕ &парамСпособПоУмолчаниюСубконтоДт3
	|	КОНЕЦ КАК СубконтоДт3,
	|	ВЫБОР
	|		КОГДА ОсновныеНачисления.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА ОсновныеНачисления.СпособОтраженияВБухучете.СубконтоДтНУ1
	|		КОГДА ОсновныеНачисления.Ссылка.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА ОсновныеНачисления.Ссылка.СпособОтраженияВБухучете.СубконтоДтНУ1
	|		КОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДтНУ1
	|		КОГДА ОсновныеНачисления.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА ОсновныеНачисления.ВидРасчета.СпособОтраженияВБухучете.СубконтоДтНУ1
	|		КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизации.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизации.СпособОтраженияВБухучете.СубконтоДтНУ1
	|		ИНАЧЕ &парамСпособПоУмолчаниюСубконтоДтНУ1
	|	КОНЕЦ КАК СубконтоДтНУ1,
	|	ВЫБОР
	|		КОГДА ОсновныеНачисления.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА ОсновныеНачисления.СпособОтраженияВБухучете.СубконтоДтНУ2
	|		КОГДА ОсновныеНачисления.Ссылка.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА ОсновныеНачисления.Ссылка.СпособОтраженияВБухучете.СубконтоДтНУ2
	|		КОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДтНУ2
	|		КОГДА ОсновныеНачисления.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА ОсновныеНачисления.ВидРасчета.СпособОтраженияВБухучете.СубконтоДтНУ2
	|		КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизации.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизации.СпособОтраженияВБухучете.СубконтоДтНУ2
	|		ИНАЧЕ &парамСпособПоУмолчаниюСубконтоДтНУ2
	|	КОНЕЦ КАК СубконтоДтНУ2,
	|	ВЫБОР
	|		КОГДА ОсновныеНачисления.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА ОсновныеНачисления.СпособОтраженияВБухучете.СубконтоДтНУ3
	|		КОГДА ОсновныеНачисления.Ссылка.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА ОсновныеНачисления.Ссылка.СпособОтраженияВБухучете.СубконтоДтНУ3
	|		КОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоДтНУ3
	|		КОГДА ОсновныеНачисления.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА ОсновныеНачисления.ВидРасчета.СпособОтраженияВБухучете.СубконтоДтНУ3
	|		КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизации.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизации.СпособОтраженияВБухучете.СубконтоДтНУ3
	|		ИНАЧЕ &парамСпособПоУмолчаниюСубконтоДтНУ3
	|	КОНЕЦ КАК СубконтоДтНУ3,
	|	ВЫБОР
	|		КОГДА ОсновныеНачисления.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА ОсновныеНачисления.СпособОтраженияВБухучете.СубконтоКт1
	|		КОГДА ОсновныеНачисления.Ссылка.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА ОсновныеНачисления.Ссылка.СпособОтраженияВБухучете.СубконтоКт1
	|		КОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоКт1
	|		КОГДА ОсновныеНачисления.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА ОсновныеНачисления.ВидРасчета.СпособОтраженияВБухучете.СубконтоКт1
	|		КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизации.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизации.СпособОтраженияВБухучете.СубконтоКт1
	|		ИНАЧЕ &парамСпособПоУмолчаниюСубконтоКт1
	|	КОНЕЦ КАК СубконтоКт1,
	|	ВЫБОР
	|		КОГДА ОсновныеНачисления.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА ОсновныеНачисления.СпособОтраженияВБухучете.СубконтоКт2
	|		КОГДА ОсновныеНачисления.Ссылка.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА ОсновныеНачисления.Ссылка.СпособОтраженияВБухучете.СубконтоКт2
	|		КОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоКт2
	|		КОГДА ОсновныеНачисления.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА ОсновныеНачисления.ВидРасчета.СпособОтраженияВБухучете.СубконтоКт2
	|		КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизации.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизации.СпособОтраженияВБухучете.СубконтоКт2
	|		ИНАЧЕ &парамСпособПоУмолчаниюСубконтоКт2
	|	КОНЕЦ КАК СубконтоКт2,
	|	ВЫБОР
	|		КОГДА ОсновныеНачисления.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА ОсновныеНачисления.СпособОтраженияВБухучете.СубконтоКт3
	|		КОГДА ОсновныеНачисления.Ссылка.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА ОсновныеНачисления.Ссылка.СпособОтраженияВБухучете.СубконтоКт3
	|		КОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоКт3
	|		КОГДА ОсновныеНачисления.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА ОсновныеНачисления.ВидРасчета.СпособОтраженияВБухучете.СубконтоКт3
	|		КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизации.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизации.СпособОтраженияВБухучете.СубконтоКт3
	|		ИНАЧЕ &парамСпособПоУмолчаниюСубконтоКт3
	|	КОНЕЦ КАК СубконтоКт3,
	|	ВЫБОР
	|		КОГДА ОсновныеНачисления.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА ОсновныеНачисления.СпособОтраженияВБухучете.СубконтоКтНУ1
	|		КОГДА ОсновныеНачисления.Ссылка.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА ОсновныеНачисления.Ссылка.СпособОтраженияВБухучете.СубконтоКтНУ1
	|		КОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоКтНУ1
	|		КОГДА ОсновныеНачисления.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА ОсновныеНачисления.ВидРасчета.СпособОтраженияВБухучете.СубконтоКтНУ1
	|		КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизации.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизации.СпособОтраженияВБухучете.СубконтоКтНУ1
	|		ИНАЧЕ &парамСпособПоУмолчаниюСубконтоКтНУ1
	|	КОНЕЦ КАК СубконтоКтНУ1,
	|	ВЫБОР
	|		КОГДА ОсновныеНачисления.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА ОсновныеНачисления.СпособОтраженияВБухучете.СубконтоКтНУ2
	|		КОГДА ОсновныеНачисления.Ссылка.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА ОсновныеНачисления.Ссылка.СпособОтраженияВБухучете.СубконтоКтНУ2
	|		КОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоКтНУ2
	|		КОГДА ОсновныеНачисления.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА ОсновныеНачисления.ВидРасчета.СпособОтраженияВБухучете.СубконтоКтНУ2
	|		КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизации.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизации.СпособОтраженияВБухучете.СубконтоКтНУ2
	|		ИНАЧЕ &парамСпособПоУмолчаниюСубконтоКтНУ2
	|	КОНЕЦ КАК СубконтоКтНУ2,
	|	ВЫБОР
	|		КОГДА ОсновныеНачисления.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА ОсновныеНачисления.СпособОтраженияВБухучете.СубконтоКтНУ3
	|		КОГДА ОсновныеНачисления.Ссылка.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА ОсновныеНачисления.Ссылка.СпособОтраженияВБухучете.СубконтоКтНУ3
	|		КОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете.СубконтоКтНУ3
	|		КОГДА ОсновныеНачисления.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА ОсновныеНачисления.ВидРасчета.СпособОтраженияВБухучете.СубконтоКтНУ3
	|		КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизации.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|			ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизации.СпособОтраженияВБухучете.СубконтоКтНУ3
	|		ИНАЧЕ &парамСпособПоУмолчаниюСубконтоКтНУ3
	|	КОНЕЦ КАК СубконтоКтНУ3,
	|	ОсновныеНачисления.ВидРасчета КАК ВидРасчета,
	|	ОсновныеНачисления.СтруктурноеПодразделение КАК СтруктурноеПодразделениеДт,
	|	&парамСтруктурноеПодразделениеРаботников КАК СтруктурноеПодразделениеКт,
	|	ОсновныеНачисления.ПодразделениеОрганизации КАК ПодразделениеОрганизации,
	|	ОсновныеНачисления.Результат КАК Результат,
	|	NULL КАК Контрагент,
	|	NULL КАК ДоговорКонтрагента
	|ПОМЕСТИТЬ ВТ_ДанныеУчета
	|ИЗ
	|	ВТ_НачисленияРаботников КАК ОсновныеНачисления
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РеглУчетПлановыхНачисленийРаботниковОрганизаций КАК РеглУчетПлановыхНачисленийРаботниковОрганизаций
	|			ЛЕВОЕ СОЕДИНЕНИЕ ВТ_СведенияОНачисленияхСрез КАК СведенияОНачисленияхСрез
	|			ПО (СведенияОНачисленияхСрез.Сотрудник = РеглУчетПлановыхНачисленийРаботниковОрганизаций.Сотрудник)
	|				И (СведенияОНачисленияхСрез.Организация = РеглУчетПлановыхНачисленийРаботниковОрганизаций.Организация)
	|				И (СведенияОНачисленияхСрез.ВидРасчета = РеглУчетПлановыхНачисленийРаботниковОрганизаций.ВидРасчета)
	|				И (СведенияОНачисленияхСрез.Период = РеглУчетПлановыхНачисленийРаботниковОрганизаций.Период)
	|		ПО (РеглУчетПлановыхНачисленийРаботниковОрганизаций.Сотрудник = ОсновныеНачисления.Сотрудник)
	|			И (РеглУчетПлановыхНачисленийРаботниковОрганизаций.Организация = ОсновныеНачисления.Организация)
	|			И (РеглУчетПлановыхНачисленийРаботниковОрганизаций.ВидРасчета = ОсновныеНачисления.ВидРасчета)
	|			И (ОсновныеНачисления.ДатаНачала = СведенияОНачисленияхСрез.ДатаНачала)
	|			И (РеглУчетПлановыхНачисленийРаботниковОрганизаций.Активность)
	|		ЛЕВОЕ СОЕДИНЕНИЕ ВТ_СведенияОПодразделенияхСрез КАК СведенияОПодразделенияхСрез
	|		ПО ОсновныеНачисления.Ссылка = СведенияОПодразделенияхСрез.Ссылка
	|			И ОсновныеНачисления.НомерСтроки = СведенияОПодразделенияхСрез.НомерСтроки
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.УчетОсновногоЗаработкаРаботниковПодразделенияОрганизации КАК УчетОсновногоЗаработкаРаботниковПодразделенияОрганизации
	|		ПО (СведенияОПодразделенияхСрез.ПодразделениеОрганизации = УчетОсновногоЗаработкаРаботниковПодразделенияОрганизации.ПодразделениеОрганизации)
	|			И (СведенияОПодразделенияхСрез.Период = УчетОсновногоЗаработкаРаботниковПодразделенияОрганизации.Период)
	|ГДЕ
	|	ОсновныеНачисления.ПодразделениеОрганизации.Владелец = &парамОрганизация
	|	И ОсновныеНачисления.Ссылка.ПериодРегистрации = &парамПериодРегистрации
	|	И ОсновныеНачисления.Ссылка.Проведен
	|	И ВЫБОР
	|			КОГДА ОсновныеНачисления.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|				ТОГДА ОсновныеНачисления.СпособОтраженияВБухучете
	|			КОГДА ОсновныеНачисления.Ссылка.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|				ТОГДА ОсновныеНачисления.Ссылка.СпособОтраженияВБухучете
	|			КОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|				ТОГДА РеглУчетПлановыхНачисленийРаботниковОрганизаций.СпособОтраженияВБухучете
	|			КОГДА ОсновныеНачисления.ВидРасчета.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|				ТОГДА ОсновныеНачисления.ВидРасчета.СпособОтраженияВБухучете
	|			КОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизации.СпособОтраженияВБухучете <> &парамПустойСпособБУ
	|				ТОГДА УчетОсновногоЗаработкаРаботниковПодразделенияОрганизации.СпособОтраженияВБухучете
	|			ИНАЧЕ &парамСпособПоУмолчанию
	|		КОНЕЦ <> &парамСпособНеОтражать
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	СведенияОДоходах.ФизЛицо,
	|	ВЫБОР
	|		КОГДА СведенияОДоходах.СпособОтраженияВБухучете <> ЗНАЧЕНИЕ(Справочник.СпособыОтраженияЗарплатыВРеглУчете.ПустаяСсылка)
	|			ТОГДА СведенияОДоходах.СпособОтраженияВБухучете.СчетДт
	|		КОГДА СведенияОДоходах.Ссылка.СпособОтраженияВБухучете <> ЗНАЧЕНИЕ(Справочник.СпособыОтраженияЗарплатыВРеглУчете.ПустаяСсылка)
	|			ТОГДА СведенияОДоходах.Ссылка.СпособОтраженияВБухучете.СчетДт
	|		КОГДА СведенияОДоходах.ВидРасчета.СпособОтраженияВБухучете <> ЗНАЧЕНИЕ(Справочник.СпособыОтраженияЗарплатыВРеглУчете.ПустаяСсылка)
	|			ТОГДА СведенияОДоходах.ВидРасчета.СпособОтраженияВБухучете.СчетДт
	|		КОГДА НЕ УчетЗаработкаПодразделенияОрганизации.СпособОтраженияВБухучете ЕСТЬ NULL 
	|				И УчетЗаработкаПодразделенияОрганизации.СпособОтраженияВБухучете <> ЗНАЧЕНИЕ(Справочник.СпособыОтраженияЗарплатыВРеглУчете.ПустаяСсылка)
	|			ТОГДА УчетЗаработкаПодразделенияОрганизации.СпособОтраженияВБухучете.СчетДт
	|		ИНАЧЕ &парамСпособПоУмолчаниюСчетДт
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА СведенияОДоходах.СпособОтраженияВБухучете <> ЗНАЧЕНИЕ(Справочник.СпособыОтраженияЗарплатыВРеглУчете.ПустаяСсылка)
	|			ТОГДА СведенияОДоходах.СпособОтраженияВБухучете.СчетКт
	|		КОГДА СведенияОДоходах.Ссылка.СпособОтраженияВБухучете <> ЗНАЧЕНИЕ(Справочник.СпособыОтраженияЗарплатыВРеглУчете.ПустаяСсылка)
	|			ТОГДА СведенияОДоходах.Ссылка.СпособОтраженияВБухучете.СчетКт
	|		ИНАЧЕ &парамСчетКтПоУмолчаниюКонтрагенты
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА СведенияОДоходах.СпособОтраженияВБухучете <> ЗНАЧЕНИЕ(Справочник.СпособыОтраженияЗарплатыВРеглУчете.ПустаяСсылка)
	|			ТОГДА СведенияОДоходах.СпособОтраженияВБухучете.СчетДтНУ
	|		КОГДА СведенияОДоходах.Ссылка.СпособОтраженияВБухучете <> ЗНАЧЕНИЕ(Справочник.СпособыОтраженияЗарплатыВРеглУчете.ПустаяСсылка)
	|			ТОГДА СведенияОДоходах.Ссылка.СпособОтраженияВБухучете.СчетДтНУ
	|		КОГДА СведенияОДоходах.ВидРасчета.СпособОтраженияВБухучете <> ЗНАЧЕНИЕ(Справочник.СпособыОтраженияЗарплатыВРеглУчете.ПустаяСсылка)
	|			ТОГДА СведенияОДоходах.ВидРасчета.СпособОтраженияВБухучете.СчетДтНУ
	|		КОГДА НЕ УчетЗаработкаПодразделенияОрганизации.СпособОтраженияВБухучете ЕСТЬ NULL 
	|				И УчетЗаработкаПодразделенияОрганизации.СпособОтраженияВБухучете <> ЗНАЧЕНИЕ(Справочник.СпособыОтраженияЗарплатыВРеглУчете.ПустаяСсылка)
	|			ТОГДА УчетЗаработкаПодразделенияОрганизации.СпособОтраженияВБухучете.СчетДтНУ
	|		ИНАЧЕ &парамСпособПоУмолчаниюСчетДтНУ
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА СведенияОДоходах.СпособОтраженияВБухучете <> ЗНАЧЕНИЕ(Справочник.СпособыОтраженияЗарплатыВРеглУчете.ПустаяСсылка)
	|			ТОГДА СведенияОДоходах.СпособОтраженияВБухучете.СчетКтНУ
	|		КОГДА СведенияОДоходах.Ссылка.СпособОтраженияВБухучете <> ЗНАЧЕНИЕ(Справочник.СпособыОтраженияЗарплатыВРеглУчете.ПустаяСсылка)
	|			ТОГДА СведенияОДоходах.Ссылка.СпособОтраженияВБухучете.СчетКтНУ
	|		ИНАЧЕ &парамСчетКтНуПоУмолчаниюКонтрагенты
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА СведенияОДоходах.СпособОтраженияВБухучете <> ЗНАЧЕНИЕ(Справочник.СпособыОтраженияЗарплатыВРеглУчете.ПустаяСсылка)
	|			ТОГДА СведенияОДоходах.СпособОтраженияВБухучете.СубконтоДт1
	|		КОГДА СведенияОДоходах.Ссылка.СпособОтраженияВБухучете <> ЗНАЧЕНИЕ(Справочник.СпособыОтраженияЗарплатыВРеглУчете.ПустаяСсылка)
	|			ТОГДА СведенияОДоходах.Ссылка.СпособОтраженияВБухучете.СубконтоДт1
	|		КОГДА СведенияОДоходах.ВидРасчета.СпособОтраженияВБухучете <> ЗНАЧЕНИЕ(Справочник.СпособыОтраженияЗарплатыВРеглУчете.ПустаяСсылка)
	|			ТОГДА СведенияОДоходах.ВидРасчета.СпособОтраженияВБухучете.СубконтоДт1
	|		КОГДА НЕ УчетЗаработкаПодразделенияОрганизации.СпособОтраженияВБухучете ЕСТЬ NULL 
	|				И УчетЗаработкаПодразделенияОрганизации.СпособОтраженияВБухучете <> ЗНАЧЕНИЕ(Справочник.СпособыОтраженияЗарплатыВРеглУчете.ПустаяСсылка)
	|			ТОГДА УчетЗаработкаПодразделенияОрганизации.СпособОтраженияВБухучете.СубконтоДт1
	|		ИНАЧЕ &парамСпособПоУмолчаниюСубконтоДт1
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА СведенияОДоходах.СпособОтраженияВБухучете <> ЗНАЧЕНИЕ(Справочник.СпособыОтраженияЗарплатыВРеглУчете.ПустаяСсылка)
	|			ТОГДА СведенияОДоходах.СпособОтраженияВБухучете.СубконтоДт2
	|		КОГДА СведенияОДоходах.Ссылка.СпособОтраженияВБухучете <> ЗНАЧЕНИЕ(Справочник.СпособыОтраженияЗарплатыВРеглУчете.ПустаяСсылка)
	|			ТОГДА СведенияОДоходах.Ссылка.СпособОтраженияВБухучете.СубконтоДт2
	|		КОГДА СведенияОДоходах.ВидРасчета.СпособОтраженияВБухучете <> ЗНАЧЕНИЕ(Справочник.СпособыОтраженияЗарплатыВРеглУчете.ПустаяСсылка)
	|			ТОГДА СведенияОДоходах.ВидРасчета.СпособОтраженияВБухучете.СубконтоДт2
	|		КОГДА НЕ УчетЗаработкаПодразделенияОрганизации.СпособОтраженияВБухучете ЕСТЬ NULL 
	|				И УчетЗаработкаПодразделенияОрганизации.СпособОтраженияВБухучете <> ЗНАЧЕНИЕ(Справочник.СпособыОтраженияЗарплатыВРеглУчете.ПустаяСсылка)
	|			ТОГДА УчетЗаработкаПодразделенияОрганизации.СпособОтраженияВБухучете.СубконтоДт2
	|		ИНАЧЕ &парамСпособПоУмолчаниюСубконтоДт2
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА СведенияОДоходах.СпособОтраженияВБухучете <> ЗНАЧЕНИЕ(Справочник.СпособыОтраженияЗарплатыВРеглУчете.ПустаяСсылка)
	|			ТОГДА СведенияОДоходах.СпособОтраженияВБухучете.СубконтоДт3
	|		КОГДА СведенияОДоходах.Ссылка.СпособОтраженияВБухучете <> ЗНАЧЕНИЕ(Справочник.СпособыОтраженияЗарплатыВРеглУчете.ПустаяСсылка)
	|			ТОГДА СведенияОДоходах.Ссылка.СпособОтраженияВБухучете.СубконтоДт3
	|		КОГДА СведенияОДоходах.ВидРасчета.СпособОтраженияВБухучете <> ЗНАЧЕНИЕ(Справочник.СпособыОтраженияЗарплатыВРеглУчете.ПустаяСсылка)
	|			ТОГДА СведенияОДоходах.ВидРасчета.СпособОтраженияВБухучете.СубконтоДт3
	|		КОГДА НЕ УчетЗаработкаПодразделенияОрганизации.СпособОтраженияВБухучете ЕСТЬ NULL 
	|				И УчетЗаработкаПодразделенияОрганизации.СпособОтраженияВБухучете <> ЗНАЧЕНИЕ(Справочник.СпособыОтраженияЗарплатыВРеглУчете.ПустаяСсылка)
	|			ТОГДА УчетЗаработкаПодразделенияОрганизации.СпособОтраженияВБухучете.СубконтоДт3
	|		ИНАЧЕ &парамСпособПоУмолчаниюСубконтоДт3
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА СведенияОДоходах.СпособОтраженияВБухучете <> ЗНАЧЕНИЕ(Справочник.СпособыОтраженияЗарплатыВРеглУчете.ПустаяСсылка)
	|			ТОГДА СведенияОДоходах.СпособОтраженияВБухучете.СубконтоДтНУ1
	|		КОГДА СведенияОДоходах.Ссылка.СпособОтраженияВБухучете <> ЗНАЧЕНИЕ(Справочник.СпособыОтраженияЗарплатыВРеглУчете.ПустаяСсылка)
	|			ТОГДА СведенияОДоходах.Ссылка.СпособОтраженияВБухучете.СубконтоДтНУ1
	|		КОГДА СведенияОДоходах.ВидРасчета.СпособОтраженияВБухучете <> ЗНАЧЕНИЕ(Справочник.СпособыОтраженияЗарплатыВРеглУчете.ПустаяСсылка)
	|			ТОГДА СведенияОДоходах.ВидРасчета.СпособОтраженияВБухучете.СубконтоДтНУ1
	|		КОГДА НЕ УчетЗаработкаПодразделенияОрганизации.СпособОтраженияВБухучете ЕСТЬ NULL 
	|				И УчетЗаработкаПодразделенияОрганизации.СпособОтраженияВБухучете <> ЗНАЧЕНИЕ(Справочник.СпособыОтраженияЗарплатыВРеглУчете.ПустаяСсылка)
	|			ТОГДА УчетЗаработкаПодразделенияОрганизации.СпособОтраженияВБухучете.СубконтоДтНУ1
	|		ИНАЧЕ &парамСпособПоУмолчаниюСубконтоДтНУ1
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА СведенияОДоходах.СпособОтраженияВБухучете <> ЗНАЧЕНИЕ(Справочник.СпособыОтраженияЗарплатыВРеглУчете.ПустаяСсылка)
	|			ТОГДА СведенияОДоходах.СпособОтраженияВБухучете.СубконтоДтНУ2
	|		КОГДА СведенияОДоходах.Ссылка.СпособОтраженияВБухучете <> ЗНАЧЕНИЕ(Справочник.СпособыОтраженияЗарплатыВРеглУчете.ПустаяСсылка)
	|			ТОГДА СведенияОДоходах.Ссылка.СпособОтраженияВБухучете.СубконтоДтНУ2
	|		КОГДА СведенияОДоходах.ВидРасчета.СпособОтраженияВБухучете <> ЗНАЧЕНИЕ(Справочник.СпособыОтраженияЗарплатыВРеглУчете.ПустаяСсылка)
	|			ТОГДА СведенияОДоходах.ВидРасчета.СпособОтраженияВБухучете.СубконтоДтНУ2
	|		КОГДА НЕ УчетЗаработкаПодразделенияОрганизации.СпособОтраженияВБухучете ЕСТЬ NULL 
	|				И УчетЗаработкаПодразделенияОрганизации.СпособОтраженияВБухучете <> ЗНАЧЕНИЕ(Справочник.СпособыОтраженияЗарплатыВРеглУчете.ПустаяСсылка)
	|			ТОГДА УчетЗаработкаПодразделенияОрганизации.СпособОтраженияВБухучете.СубконтоДтНУ2
	|		ИНАЧЕ &парамСпособПоУмолчаниюСубконтоДтНУ2
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА СведенияОДоходах.СпособОтраженияВБухучете <> ЗНАЧЕНИЕ(Справочник.СпособыОтраженияЗарплатыВРеглУчете.ПустаяСсылка)
	|			ТОГДА СведенияОДоходах.СпособОтраженияВБухучете.СубконтоДтНУ3
	|		КОГДА СведенияОДоходах.Ссылка.СпособОтраженияВБухучете <> ЗНАЧЕНИЕ(Справочник.СпособыОтраженияЗарплатыВРеглУчете.ПустаяСсылка)
	|			ТОГДА СведенияОДоходах.Ссылка.СпособОтраженияВБухучете.СубконтоДтНУ3
	|		КОГДА СведенияОДоходах.ВидРасчета.СпособОтраженияВБухучете <> ЗНАЧЕНИЕ(Справочник.СпособыОтраженияЗарплатыВРеглУчете.ПустаяСсылка)
	|			ТОГДА СведенияОДоходах.ВидРасчета.СпособОтраженияВБухучете.СубконтоДтНУ3
	|		КОГДА НЕ УчетЗаработкаПодразделенияОрганизации.СпособОтраженияВБухучете ЕСТЬ NULL 
	|				И УчетЗаработкаПодразделенияОрганизации.СпособОтраженияВБухучете <> ЗНАЧЕНИЕ(Справочник.СпособыОтраженияЗарплатыВРеглУчете.ПустаяСсылка)
	|			ТОГДА УчетЗаработкаПодразделенияОрганизации.СпособОтраженияВБухучете.СубконтоДтНУ3
	|		ИНАЧЕ &парамСпособПоУмолчаниюСубконтоДтНУ3
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА СведенияОДоходах.СпособОтраженияВБухучете <> ЗНАЧЕНИЕ(Справочник.СпособыОтраженияЗарплатыВРеглУчете.ПустаяСсылка)
	|			ТОГДА СведенияОДоходах.СпособОтраженияВБухучете.СубконтоКт1
	|		КОГДА СведенияОДоходах.Ссылка.СпособОтраженияВБухучете <> ЗНАЧЕНИЕ(Справочник.СпособыОтраженияЗарплатыВРеглУчете.ПустаяСсылка)
	|			ТОГДА СведенияОДоходах.Ссылка.СпособОтраженияВБухучете.СубконтоКт1
	|		ИНАЧЕ НЕОПРЕДЕЛЕНО
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА СведенияОДоходах.СпособОтраженияВБухучете <> ЗНАЧЕНИЕ(Справочник.СпособыОтраженияЗарплатыВРеглУчете.ПустаяСсылка)
	|			ТОГДА СведенияОДоходах.СпособОтраженияВБухучете.СубконтоКт2
	|		КОГДА СведенияОДоходах.Ссылка.СпособОтраженияВБухучете <> ЗНАЧЕНИЕ(Справочник.СпособыОтраженияЗарплатыВРеглУчете.ПустаяСсылка)
	|			ТОГДА СведенияОДоходах.Ссылка.СпособОтраженияВБухучете.СубконтоКт2
	|		ИНАЧЕ НЕОПРЕДЕЛЕНО
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА СведенияОДоходах.СпособОтраженияВБухучете <> ЗНАЧЕНИЕ(Справочник.СпособыОтраженияЗарплатыВРеглУчете.ПустаяСсылка)
	|			ТОГДА СведенияОДоходах.СпособОтраженияВБухучете.СубконтоКт3
	|		КОГДА СведенияОДоходах.Ссылка.СпособОтраженияВБухучете <> ЗНАЧЕНИЕ(Справочник.СпособыОтраженияЗарплатыВРеглУчете.ПустаяСсылка)
	|			ТОГДА СведенияОДоходах.Ссылка.СпособОтраженияВБухучете.СубконтоКт3
	|		ИНАЧЕ НЕОПРЕДЕЛЕНО
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА СведенияОДоходах.СпособОтраженияВБухучете <> ЗНАЧЕНИЕ(Справочник.СпособыОтраженияЗарплатыВРеглУчете.ПустаяСсылка)
	|			ТОГДА СведенияОДоходах.СпособОтраженияВБухучете.СубконтоКтНУ1
	|		КОГДА СведенияОДоходах.Ссылка.СпособОтраженияВБухучете <> ЗНАЧЕНИЕ(Справочник.СпособыОтраженияЗарплатыВРеглУчете.ПустаяСсылка)
	|			ТОГДА СведенияОДоходах.Ссылка.СпособОтраженияВБухучете.СубконтоКтНУ1
	|		ИНАЧЕ НЕОПРЕДЕЛЕНО
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА СведенияОДоходах.СпособОтраженияВБухучете <> ЗНАЧЕНИЕ(Справочник.СпособыОтраженияЗарплатыВРеглУчете.ПустаяСсылка)
	|			ТОГДА СведенияОДоходах.СпособОтраженияВБухучете.СубконтоКтНУ2
	|		КОГДА СведенияОДоходах.Ссылка.СпособОтраженияВБухучете <> ЗНАЧЕНИЕ(Справочник.СпособыОтраженияЗарплатыВРеглУчете.ПустаяСсылка)
	|			ТОГДА СведенияОДоходах.Ссылка.СпособОтраженияВБухучете.СубконтоКтНУ2
	|		ИНАЧЕ НЕОПРЕДЕЛЕНО
	|	КОНЕЦ,
	|	ВЫБОР
	|		КОГДА СведенияОДоходах.СпособОтраженияВБухучете <> ЗНАЧЕНИЕ(Справочник.СпособыОтраженияЗарплатыВРеглУчете.ПустаяСсылка)
	|			ТОГДА СведенияОДоходах.СпособОтраженияВБухучете.СубконтоКтНУ3
	|		КОГДА СведенияОДоходах.Ссылка.СпособОтраженияВБухучете <> ЗНАЧЕНИЕ(Справочник.СпособыОтраженияЗарплатыВРеглУчете.ПустаяСсылка)
	|			ТОГДА СведенияОДоходах.Ссылка.СпособОтраженияВБухучете.СубконтоКтНУ3
	|		ИНАЧЕ НЕОПРЕДЕЛЕНО
	|	КОНЕЦ,
	|	СведенияОДоходах.ВидРасчета,
	|	СведенияОДоходах.СтруктурноеПодразделение,
	|	&парамСтруктурноеПодразделениеРаботников,
	|	СведенияОДоходах.ПодразделениеОрганизации,
	|	СведенияОДоходах.СуммаДохода,
	|	СведенияОДоходах.Контрагент,
	|	СведенияОДоходах.ДоговорКонтрагента
	|ИЗ
	|	ВТ_НачисленияКонтрагентов КАК СведенияОДоходах
	|		ЛЕВОЕ СОЕДИНЕНИЕ ВТ_УчетЗаработкаПодразделенияОрганизации КАК УчетЗаработкаПодразделенияОрганизации
	|		ПО СведенияОДоходах.ПодразделениеОрганизации = УчетЗаработкаПодразделенияОрганизации.ПодразделениеОрганизации
	|			И (УчетЗаработкаПодразделенияОрганизации.ДатаДохода = СведенияОДоходах.ДатаДохода)
	|			И (УчетЗаработкаПодразделенияОрганизации.Контрагент = СведенияОДоходах.Контрагент)
	|			И (УчетЗаработкаПодразделенияОрганизации.ФизЛицо = СведенияОДоходах.ФизЛицо)
	|ГДЕ
	|	ВЫБОР
	|			КОГДА СведенияОДоходах.СпособОтраженияВБухучете <> ЗНАЧЕНИЕ(Справочник.СпособыОтраженияЗарплатыВРеглУчете.ПустаяСсылка)
	|				ТОГДА СведенияОДоходах.СпособОтраженияВБухучете
	|			КОГДА СведенияОДоходах.Ссылка.СпособОтраженияВБухучете <> ЗНАЧЕНИЕ(Справочник.СпособыОтраженияЗарплатыВРеглУчете.ПустаяСсылка)
	|				ТОГДА СведенияОДоходах.Ссылка.СпособОтраженияВБухучете
	|			КОГДА СведенияОДоходах.ВидРасчета.СпособОтраженияВБухучете <> ЗНАЧЕНИЕ(Справочник.СпособыОтраженияЗарплатыВРеглУчете.ПустаяСсылка)
	|				ТОГДА СведенияОДоходах.ВидРасчета.СпособОтраженияВБухучете
	|			КОГДА НЕ УчетЗаработкаПодразделенияОрганизации.СпособОтраженияВБухучете ЕСТЬ NULL 
	|					И УчетЗаработкаПодразделенияОрганизации.СпособОтраженияВБухучете <> ЗНАЧЕНИЕ(Справочник.СпособыОтраженияЗарплатыВРеглУчете.ПустаяСсылка)
	|				ТОГДА УчетЗаработкаПодразделенияОрганизации.СпособОтраженияВБухучете
	|			ИНАЧЕ &парамСпособПоУмолчанию
	|		КОНЕЦ <> &парамСпособНеОтражать
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	СчетДт,
	|	СчетКт,
	|	СчетДтНУ,
	|	СчетКтНУ
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ РАЗРЕШЕННЫЕ
	|	ДанныеУчета.ФизЛицо,
	|	ВЫБОР
	|		КОГДА ВидСубконтоСчетаДт1.ВидСубконто = ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоТиповые.Резервы)
	|			ТОГДА ЗНАЧЕНИЕ(Справочник.ПодразделенияОрганизаций.ПустаяСсылка)
	|		ИНАЧЕ ДанныеУчета.СтруктурноеПодразделениеДт
	|	КОНЕЦ КАК СтруктурноеПодразделениеДт,
	|	ДанныеУчета.СчетДт,
	|	ДанныеУчета.СчетДтНУ,
	|	ДанныеУчета.СубконтоДт1,
	|	ДанныеУчета.СубконтоДт2,
	|	ДанныеУчета.СубконтоДт3,
	|	ДанныеУчета.СубконтоДтНУ1,
	|	ДанныеУчета.СубконтоДтНУ2,
	|	ДанныеУчета.СубконтоДтНУ3,
	|	ДанныеУчета.СтруктурноеПодразделениеКт,
	|	ДанныеУчета.СчетКт,
	|	ДанныеУчета.СчетКтНУ,
	|	ДанныеУчета.СубконтоКт1,
	|	ДанныеУчета.СубконтоКт2,
	|	ДанныеУчета.СубконтоКт3,
	|	ДанныеУчета.СубконтоКтНУ1,
	|	ДанныеУчета.СубконтоКтНУ2,
	|	ДанныеУчета.СубконтоКтНУ3,
	|	ДанныеУчета.ВидРасчета,
	|	ДанныеУчета.ПодразделениеОрганизации,
	|	ДанныеУчета.Результат,
	|	ДанныеУчета.Контрагент,
	|	ДанныеУчета.ДоговорКонтрагента,
	|	ЕСТЬNULL(ВидыСубконтоРаботникиОрганизацийДт.НомерСтроки, 0) КАК НомерСубконтоРаботникиОрганизацийДт,
	|	ЕСТЬNULL(ВидыСубконтоРаботникиОрганизацийКт.НомерСтроки, 0) КАК НомерСубконтоРаботникиОрганизацийКт,
	|	ЕСТЬNULL(ВидыСубконтоПодразделенияДт.НомерСтроки, 0) КАК НомерСубконтоПодразделенияДт,
	|	ЕСТЬNULL(ВидыСубконтоДебиторыКредиторыОрганизацииКт.НомерСтроки, 0) КАК НомерСубконтоДебиторыКредиторыОрганизацииКт,
	|	ЕСТЬNULL(ВидыСубконтоКонтрагентыКт.НомерСтроки, 0) КАК НомерСубконтоКонтрагентыКт,
	|	ЕСТЬNULL(ВидыСубконтоДоговорыКонтрагентовКт.НомерСтроки, 0) КАК НомерСубконтоДоговорыКонтрагентовКт,
	|	ЕСТЬNULL(ВидыСубконтоРаботникиОрганизацийДтНУ.НомерСтроки, 0) КАК НомерСубконтоРаботникиОрганизацийДтНУ,
	|	ЕСТЬNULL(ВидыСубконтоРаботникиОрганизацийКтНУ.НомерСтроки, 0) КАК НомерСубконтоРаботникиОрганизацийКтНУ,
	|	ЕСТЬNULL(ВидыСубконтоПодразделенияДтНУ.НомерСтроки, 0) КАК НомерСубконтоПодразделенияДтНУ,
	|	ЕСТЬNULL(ВидыСубконтоКонтрагентыКтНУ.НомерСтроки, 0) КАК НомерСубконтоКонтрагентыКтНУ,
	|	ЕСТЬNULL(ВидыСубконтоДоговорыКонтрагентовКтНУ.НомерСтроки, 0) КАК НомерСубконтоДоговорыКонтрагентовКтНУ
	|ИЗ
	|	ВТ_ДанныеУчета КАК ДанныеУчета
	|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Типовой.ВидыСубконто КАК ВидыСубконтоРаботникиОрганизацийДт
	|		ПО (ДанныеУчета.СчетДт <> &парамПустойСчет)
	|			И ДанныеУчета.СчетДт = ВидыСубконтоРаботникиОрганизацийДт.Ссылка
	|			И (ВидыСубконтоРаботникиОрганизацийДт.ВидСубконто = &парамВидСубконтоРаботникиОрганизаций)
	|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Типовой.ВидыСубконто КАК ВидыСубконтоРаботникиОрганизацийКт
	|		ПО (ДанныеУчета.СчетКт <> &парамПустойСчет)
	|			И ДанныеУчета.СчетКт = ВидыСубконтоРаботникиОрганизацийКт.Ссылка
	|			И (ВидыСубконтоРаботникиОрганизацийКт.ВидСубконто = &парамВидСубконтоРаботникиОрганизаций)
	|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Типовой.ВидыСубконто КАК ВидыСубконтоПодразделенияДт
	|		ПО (ДанныеУчета.СчетДт <> &парамПустойСчет)
	|			И ДанныеУчета.СчетДт = ВидыСубконтоПодразделенияДт.Ссылка
	|			И (ВидыСубконтоПодразделенияДт.ВидСубконто = &парамВидСубконтоПодразделения)
	|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Типовой.ВидыСубконто КАК ВидСубконтоСчетаДт1
	|		ПО (ВидСубконтоСчетаДт1.НомерСтроки = 1)
	|			И ДанныеУчета.СчетДт = ВидСубконтоСчетаДт1.Ссылка
	|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Налоговый.ВидыСубконто КАК ВидыСубконтоРаботникиОрганизацийДтНУ
	|		ПО (ДанныеУчета.СчетДтНУ <> &парамПустойСчетНУ)
	|			И ДанныеУчета.СчетДтНУ = ВидыСубконтоРаботникиОрганизацийДтНУ.Ссылка
	|			И (ВидыСубконтоРаботникиОрганизацийДтНУ.ВидСубконто = &парамВидСубконтоРаботникиОрганизаций)
	|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Налоговый.ВидыСубконто КАК ВидыСубконтоРаботникиОрганизацийКтНУ
	|		ПО (ДанныеУчета.СчетКтНУ <> &парамПустойСчетНУ)
	|			И ДанныеУчета.СчетКтНУ = ВидыСубконтоРаботникиОрганизацийКтНУ.Ссылка
	|			И (ВидыСубконтоРаботникиОрганизацийКтНУ.ВидСубконто = &парамВидСубконтоРаботникиОрганизаций)
	|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Налоговый.ВидыСубконто КАК ВидыСубконтоПодразделенияДтНУ
	|		ПО (ДанныеУчета.СчетДтНУ <> &парамПустойСчетНУ)
	|			И ДанныеУчета.СчетДтНУ = ВидыСубконтоПодразделенияДтНУ.Ссылка
	|			И (ВидыСубконтоПодразделенияДтНУ.ВидСубконто = &парамВидСубконтоПодразделения)
	|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Типовой.ВидыСубконто КАК ВидыСубконтоДебиторыКредиторыОрганизацииКт
	|		ПО (ДанныеУчета.СчетКт <> &парамПустойСчет)
	|			И ДанныеУчета.СчетКт = ВидыСубконтоДебиторыКредиторыОрганизацииКт.Ссылка
	|			И (ВидыСубконтоДебиторыКредиторыОрганизацииКт.ВидСубконто = &парамВидСубконтоДебиторыКредиторыОрганизации)
	|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Типовой.ВидыСубконто КАК ВидыСубконтоКонтрагентыКт 
	|		ПО (ДанныеУчета.СчетКт <> &парамПустойСчет)
	|			И ДанныеУчета.СчетКт = ВидыСубконтоКонтрагентыКт.Ссылка
	|			И (ВидыСубконтоКонтрагентыКт.ВидСубконто = &парамВидСубконтоКонтрагенты)
	|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Типовой.ВидыСубконто КАК ВидыСубконтоДоговорыКонтрагентовКт
	|		ПО (ДанныеУчета.СчетКт <> &парамПустойСчет)
	|			И ДанныеУчета.СчетКт = ВидыСубконтоДоговорыКонтрагентовКт.Ссылка
	|			И (ВидыСубконтоДоговорыКонтрагентовКт.ВидСубконто = &парамВидСубконтоДоговорыКонтрагентов)
	|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Налоговый.ВидыСубконто КАК ВидыСубконтоКонтрагентыКтНУ
	|		ПО (ДанныеУчета.СчетКтНУ <> &парамПустойСчетНУ)
	|			И ДанныеУчета.СчетКтНУ = ВидыСубконтоКонтрагентыКтНУ.Ссылка
	|			И (ВидыСубконтоКонтрагентыКтНУ.ВидСубконто = &парамВидСубконтоКонтрагенты)
	|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Налоговый.ВидыСубконто КАК ВидыСубконтоДоговорыКонтрагентовКтНУ
	|		ПО (ДанныеУчета.СчетКтНУ <> &парамПустойСчетНУ)
	|			И ДанныеУчета.СчетКтНУ = ВидыСубконтоДоговорыКонтрагентовКтНУ.Ссылка
	|			И (ВидыСубконтоДоговорыКонтрагентовКтНУ.ВидСубконто = &парамВидСубконтоДоговорыКонтрагентов)
	|ГДЕ
	|	ЕСТЬNULL(ДанныеУчета.Результат, 0) <> 0
	|
	|УПОРЯДОЧИТЬ ПО
	|	ДанныеУчета.ФизЛицо.Наименование,
	|	ДанныеУчета.ВидРасчета.ЗачетОтработанногоВремени УБЫВ";

	Запрос.Текст = ТекстЗапроса;
	Возврат Запрос.Выполнить().Выбрать();

КонецФункции 

// Автозаполнерие субконто по данным строки.
//
Процедура АвтозаполнениеСубконто(ДанныеУчета, СтрокаДанных, ПустойСчет, ПустойСчетНУ)
	// если не пустой счет - заполним "автозаполняемые" субконто
	Если ДанныеУчета.СчетДт <> ПустойСчет Тогда
		Если ДанныеУчета.НомерСубконтоРаботникиОрганизацийДт <> 0 Тогда
			Субконто = ДанныеУчета["СубконтоДт" + ДанныеУчета.НомерСубконтоРаботникиОрганизацийДт];
			Если НЕ ЗначениеЗаполнено(Субконто) Тогда
				СтрокаДанных["СубконтоДт" + ДанныеУчета.НомерСубконтоРаботникиОрганизацийДт] = ДанныеУчета.Физлицо;
			КонецЕсли;
		КонецЕсли;
		Если ДанныеУчета.НомерСубконтоПодразделенияДт <> 0 Тогда
			Субконто = ДанныеУчета["СубконтоДт" + ДанныеУчета.НомерСубконтоПодразделенияДт];
			Если НЕ ЗначениеЗаполнено(Субконто) Тогда
				СтрокаДанных["СубконтоДт" + ДанныеУчета.НомерСубконтоПодразделенияДт] = ДанныеУчета.ПодразделениеОрганизации;
			КонецЕсли;
		КонецЕсли;
	КонецЕсли;
	Если ДанныеУчета.СчетКт <> ПустойСчет Тогда
 		Если ДанныеУчета.НомерСубконтоРаботникиОрганизацийКт <> 0 Тогда
 			Субконто = ДанныеУчета["СубконтоКт" + ДанныеУчета.НомерСубконтоРаботникиОрганизацийКт];
			Если НЕ ЗначениеЗаполнено(Субконто) Тогда
 				СтрокаДанных["СубконтоКт" + ДанныеУчета.НомерСубконтоРаботникиОрганизацийКт] = ДанныеУчета.Физлицо;
			КонецЕсли;
		КонецЕсли;
		Если ДанныеУчета.НомерСубконтоДебиторыКредиторыОрганизацииКт  <> 0 Тогда
 			Субконто = ДанныеУчета["СубконтоКт" + ДанныеУчета.НомерСубконтоДебиторыКредиторыОрганизацииКт];
			Если НЕ ЗначениеЗаполнено(Субконто) Тогда
				Если ЗначениеЗаполнено(ДанныеУчета.Физлицо) Тогда
					СтрокаДанных["СубконтоКт" + ДанныеУчета.НомерСубконтоДебиторыКредиторыОрганизацииКт] = ДанныеУчета.Физлицо;
				ИначеЕсли ЗначениеЗаполнено(ДанныеУчета.Контрагент) Тогда
					СтрокаДанных["СубконтоКт" + ДанныеУчета.НомерСубконтоДебиторыКредиторыОрганизацииКт] = ДанныеУчета.Контрагент;
				КонецЕсли;	
			КонецЕсли;
		КонецЕсли;
		Если ДанныеУчета.НомерСубконтоКонтрагентыКт <> 0 Тогда
 			Субконто = ДанныеУчета["СубконтоКт" + ДанныеУчета.НомерСубконтоКонтрагентыКт];
			Если НЕ ЗначениеЗаполнено(Субконто) Тогда
 				СтрокаДанных["СубконтоКт" + ДанныеУчета.НомерСубконтоКонтрагентыКт] = ДанныеУчета.Контрагент;
			КонецЕсли;
		КонецЕсли;
		Если ДанныеУчета.НомерСубконтоДоговорыКонтрагентовКт <> 0 Тогда
 			Субконто = ДанныеУчета["СубконтоКт" + ДанныеУчета.НомерСубконтоДоговорыКонтрагентовКт];
			Если НЕ ЗначениеЗаполнено(Субконто) Тогда
 				СтрокаДанных["СубконтоКт" + ДанныеУчета.НомерСубконтоДоговорыКонтрагентовКт] = ДанныеУчета.ДоговорКонтрагента;
			КонецЕсли;
		КонецЕсли;
	КонецЕсли;
	
	// тоже самое для налогового учета
	Если ДанныеУчета.СчетДтНУ <> ПустойСчетНУ Тогда
		Если ДанныеУчета.НомерСубконтоРаботникиОрганизацийДтНУ <> 0 Тогда
			Субконто = ДанныеУчета["СубконтоДтНУ" + ДанныеУчета.НомерСубконтоРаботникиОрганизацийДтНУ];
			Если НЕ ЗначениеЗаполнено(Субконто) Тогда
				СтрокаДанных["СубконтоДтНУ" + ДанныеУчета.НомерСубконтоРаботникиОрганизацийДтНУ] = ДанныеУчета.Физлицо;
			КонецЕсли;
		КонецЕсли;
		Если ДанныеУчета.НомерСубконтоПодразделенияДтНУ <> 0 Тогда
			Субконто = ДанныеУчета["СубконтоДтНУ" + ДанныеУчета.НомерСубконтоПодразделенияДтНУ];
			Если НЕ ЗначениеЗаполнено(Субконто) Тогда
				СтрокаДанных["СубконтоДтНУ" + ДанныеУчета.НомерСубконтоПодразделенияДтНУ] = ДанныеУчета.ПодразделениеОрганизации;
			КонецЕсли;
		КонецЕсли;
	КонецЕсли;
	Если ДанныеУчета.СчетКтНУ <> ПустойСчетНУ Тогда
 		Если ДанныеУчета.НомерСубконтоРаботникиОрганизацийКтНУ <> 0 Тогда
 			Субконто = ДанныеУчета["СубконтоКтНУ" + ДанныеУчета.НомерСубконтоРаботникиОрганизацийКтНУ];
			Если НЕ ЗначениеЗаполнено(Субконто) Тогда
 				СтрокаДанных["СубконтоКтНУ" + ДанныеУчета.НомерСубконтоРаботникиОрганизацийКтНУ] = ДанныеУчета.Физлицо;
			КонецЕсли;
		КонецЕсли;
		Если ДанныеУчета.НомерСубконтоКонтрагентыКтНУ <> 0 Тогда
 			Субконто = ДанныеУчета["СубконтоКтНУ" + ДанныеУчета.НомерСубконтоКонтрагентыКтНУ];
			Если НЕ ЗначениеЗаполнено(Субконто) Тогда
 				СтрокаДанных["СубконтоКтНУ" + ДанныеУчета.НомерСубконтоКонтрагентыКтНУ] = ДанныеУчета.Контрагент;
			КонецЕсли;
		КонецЕсли;
		Если ДанныеУчета.НомерСубконтоДоговорыКонтрагентовКтНУ <> 0 Тогда
 			Субконто = ДанныеУчета["СубконтоКтНУ" + ДанныеУчета.НомерСубконтоДоговорыКонтрагентовКтНУ];
			Если НЕ ЗначениеЗаполнено(Субконто) Тогда
 				СтрокаДанных["СубконтоКтНУ" + ДанныеУчета.НомерСубконтоДоговорыКонтрагентовКтНУ] = ДанныеУчета.ДоговорКонтрагента;
			КонецЕсли;
		КонецЕсли;
	КонецЕсли;
	
КонецПроцедуры // АвтозаполнениеСубконто()

Процедура АвтозаполнениеПроводокНУ(Объект) Экспорт
	
	Запрос = Новый Запрос;
	Запрос.УстановитьПараметр("парамДокументСсылка", Объект.Ссылка);
	
	Запрос.Текст = "ВЫБРАТЬ РАЗРЕШЕННЫЕ
	               |	ОтражениеЗарплатыВРеглУчетеОтражениеВУчете.Ссылка,
	               |	ОтражениеЗарплатыВРеглУчетеОтражениеВУчете.НомерСтроки,
	               |	ОтражениеЗарплатыВРеглУчетеОтражениеВУчете.СчетДт,
	               |	ОтражениеЗарплатыВРеглУчетеОтражениеВУчете.СубконтоДт1,
	               |	ОтражениеЗарплатыВРеглУчетеОтражениеВУчете.СубконтоДт2,
	               |	ОтражениеЗарплатыВРеглУчетеОтражениеВУчете.СубконтоДт3,
	               |	ОтражениеЗарплатыВРеглУчетеОтражениеВУчете.СчетКт,
	               |	ОтражениеЗарплатыВРеглУчетеОтражениеВУчете.СубконтоКт1,
	               |	ОтражениеЗарплатыВРеглУчетеОтражениеВУчете.СубконтоКт2,
	               |	ОтражениеЗарплатыВРеглУчетеОтражениеВУчете.СубконтоКт3,
	               |	ОтражениеЗарплатыВРеглУчетеОтражениеВУчете.Сумма,
	               |	ОтражениеЗарплатыВРеглУчетеОтражениеВУчете.ВидРасчета,
	               |	ОтражениеЗарплатыВРеглУчетеОтражениеВУчете.ФизЛицо
	               |ПОМЕСТИТЬ ВТ_ОтражениеВУчете
	               |ИЗ
	               |	Документ.ОтражениеЗарплатыВРеглУчете.ОтражениеВУчете КАК ОтражениеЗарплатыВРеглУчетеОтражениеВУчете
	               |ГДЕ
	               |	ОтражениеЗарплатыВРеглУчетеОтражениеВУчете.Ссылка = &парамДокументСсылка
	               |;
	               |
	               |////////////////////////////////////////////////////////////////////////////////
	               |ВЫБРАТЬ РАЗРЕШЕННЫЕ
	               |	ОтражениеВУчете.НомерСтроки,
	               |	ОтражениеВУчете.ВидРасчета,
	               |	НалогиСборыОтчисления.СчетУчетаРасчетовСКонтрагентомНУ КАК СчетКтНУ,
	               |	ВЫБОР
	               |		КОГДА ВидыСубконтоБУКт1.ВидСубконто = ВидыСубконтоНУКт1.ВидСубконто
	               |			ТОГДА ОтражениеВУчете.СубконтоКт1
	               |		КОГДА ВидыСубконтоБУКт2.ВидСубконто = ВидыСубконтоНУКт1.ВидСубконто
	               |			ТОГДА ОтражениеВУчете.СубконтоКт2
	               |		КОГДА ВидыСубконтоБУКт3.ВидСубконто = ВидыСубконтоНУКт1.ВидСубконто
	               |			ТОГДА ОтражениеВУчете.СубконтоКт3
	               |	КОНЕЦ КАК СубконтоКтНУ1,
	               |	ВЫБОР
	               |		КОГДА ВидыСубконтоБУКт1.ВидСубконто = ВидыСубконтоНУКт2.ВидСубконто
	               |			ТОГДА ОтражениеВУчете.СубконтоКт1
	               |		КОГДА ВидыСубконтоБУКт2.ВидСубконто = ВидыСубконтоНУКт2.ВидСубконто
	               |			ТОГДА ОтражениеВУчете.СубконтоКт2
	               |		КОГДА ВидыСубконтоБУКт3.ВидСубконто = ВидыСубконтоНУКт2.ВидСубконто
	               |			ТОГДА ОтражениеВУчете.СубконтоКт3
	               |	КОНЕЦ КАК СубконтоКтНУ2,
	               |	ВЫБОР
	               |		КОГДА ВидыСубконтоБУКт1.ВидСубконто = ВидыСубконтоНУКт3.ВидСубконто
	               |			ТОГДА ОтражениеВУчете.СубконтоКт1
	               |		КОГДА ВидыСубконтоБУКт2.ВидСубконто = ВидыСубконтоНУКт3.ВидСубконто
	               |			ТОГДА ОтражениеВУчете.СубконтоКт2
	               |		КОГДА ВидыСубконтоБУКт3.ВидСубконто = ВидыСубконтоНУКт3.ВидСубконто
	               |			ТОГДА ОтражениеВУчете.СубконтоКт3
	               |	КОНЕЦ КАК СубконтоКтНУ3
	               |ПОМЕСТИТЬ ВТ_НалогиСборыОтчисления
	               |ИЗ
	               |	ВТ_ОтражениеВУчете КАК ОтражениеВУчете
	               |		ЛЕВОЕ СОЕДИНЕНИЕ Справочник.НалогиСборыОтчисления КАК НалогиСборыОтчисления
	               |		ПО ОтражениеВУчете.ВидРасчета = НалогиСборыОтчисления.Ссылка
	               |			И ОтражениеВУчете.СчетКт = НалогиСборыОтчисления.СчетУчетаРасчетовСКонтрагентомБУ
	               |		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Типовой.ВидыСубконто КАК ВидыСубконтоБУКт1
	               |		ПО ОтражениеВУчете.СчетКт = ВидыСубконтоБУКт1.Ссылка
	               |			И (ВидыСубконтоБУКт1.НомерСтроки = 1)
	               |		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Типовой.ВидыСубконто КАК ВидыСубконтоБУКт2
	               |		ПО ОтражениеВУчете.СчетКт = ВидыСубконтоБУКт2.Ссылка
	               |			И (ВидыСубконтоБУКт2.НомерСтроки = 2)
	               |		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Типовой.ВидыСубконто КАК ВидыСубконтоБУКт3
	               |		ПО ОтражениеВУчете.СчетКт = ВидыСубконтоБУКт3.Ссылка
	               |			И (ВидыСубконтоБУКт3.НомерСтроки = 3)
	               |		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Налоговый.ВидыСубконто КАК ВидыСубконтоНУКт1
	               |		ПО (НалогиСборыОтчисления.СчетУчетаРасчетовСКонтрагентомНУ = ВидыСубконтоНУКт1.Ссылка)
	               |			И (ВидыСубконтоНУКт1.НомерСтроки = 1)
	               |		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Налоговый.ВидыСубконто КАК ВидыСубконтоНУКт2
	               |		ПО (НалогиСборыОтчисления.СчетУчетаРасчетовСКонтрагентомНУ = ВидыСубконтоНУКт2.Ссылка)
	               |			И (ВидыСубконтоНУКт2.НомерСтроки = 2)
	               |		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Налоговый.ВидыСубконто КАК ВидыСубконтоНУКт3
	               |		ПО (НалогиСборыОтчисления.СчетУчетаРасчетовСКонтрагентомНУ = ВидыСубконтоНУКт3.Ссылка)
	               |			И (ВидыСубконтоНУКт3.НомерСтроки = 3)
	               |ГДЕ
	               |	ОтражениеВУчете.ВидРасчета ССЫЛКА Справочник.НалогиСборыОтчисления
	               |	И (НЕ НалогиСборыОтчисления.Ссылка ЕСТЬ NULL )
	               |;
	               |
	               |////////////////////////////////////////////////////////////////////////////////
	               |ВЫБРАТЬ РАЗРЕШЕННЫЕ
	               |	ОтражениеВУчете.НомерСтроки,
	               |	ОтражениеВУчете.СчетДт.СчетНУ КАК СчетДтНУ,
	               |	ВЫБОР
	               |		КОГДА ВидыСубконтоБУДт1.ВидСубконто = ВидыСубконтоНУДт1.ВидСубконто
	               |			ТОГДА ОтражениеВУчете.СубконтоДт1
	               |		КОГДА ВидыСубконтоБУДт2.ВидСубконто = ВидыСубконтоНУДт1.ВидСубконто
	               |			ТОГДА ОтражениеВУчете.СубконтоДт2
	               |		КОГДА ВидыСубконтоБУДт3.ВидСубконто = ВидыСубконтоНУДт1.ВидСубконто
	               |			ТОГДА ОтражениеВУчете.СубконтоДт3
	               |	КОНЕЦ КАК СубконтоДтНУ1,
	               |	ВЫБОР
	               |		КОГДА ВидыСубконтоБУДт1.ВидСубконто = ВидыСубконтоНУДт2.ВидСубконто
	               |			ТОГДА ОтражениеВУчете.СубконтоДт1
	               |		КОГДА ВидыСубконтоБУДт2.ВидСубконто = ВидыСубконтоНУДт2.ВидСубконто
	               |			ТОГДА ОтражениеВУчете.СубконтоДт2
	               |		КОГДА ВидыСубконтоБУДт3.ВидСубконто = ВидыСубконтоНУДт2.ВидСубконто
	               |			ТОГДА ОтражениеВУчете.СубконтоДт3
	               |	КОНЕЦ КАК СубконтоДтНУ2,
	               |	ВЫБОР
	               |		КОГДА ВидыСубконтоБУДт1.ВидСубконто = ВидыСубконтоНУДт3.ВидСубконто
	               |			ТОГДА ОтражениеВУчете.СубконтоДт1
	               |		КОГДА ВидыСубконтоБУДт2.ВидСубконто = ВидыСубконтоНУДт3.ВидСубконто
	               |			ТОГДА ОтражениеВУчете.СубконтоДт2
	               |		КОГДА ВидыСубконтоБУДт3.ВидСубконто = ВидыСубконтоНУДт3.ВидСубконто
	               |			ТОГДА ОтражениеВУчете.СубконтоДт3
	               |	КОНЕЦ КАК СубконтоДтНУ3,
	               |	ОтражениеВУчете.СчетКт.СчетНУ КАК СчетКтНУ,
	               |	ВЫБОР
	               |		КОГДА ВидыСубконтоБУКт1.ВидСубконто = ВидыСубконтоНУКт1.ВидСубконто
	               |			ТОГДА ОтражениеВУчете.СубконтоКт1
	               |		КОГДА ВидыСубконтоБУКт2.ВидСубконто = ВидыСубконтоНУКт1.ВидСубконто
	               |			ТОГДА ОтражениеВУчете.СубконтоКт2
	               |		КОГДА ВидыСубконтоБУКт3.ВидСубконто = ВидыСубконтоНУКт1.ВидСубконто
	               |			ТОГДА ОтражениеВУчете.СубконтоКт3
	               |	КОНЕЦ КАК СубконтоКтНУ1,
	               |	ВЫБОР
	               |		КОГДА ВидыСубконтоБУКт1.ВидСубконто = ВидыСубконтоНУКт2.ВидСубконто
	               |			ТОГДА ОтражениеВУчете.СубконтоКт1
	               |		КОГДА ВидыСубконтоБУКт2.ВидСубконто = ВидыСубконтоНУКт2.ВидСубконто
	               |			ТОГДА ОтражениеВУчете.СубконтоКт2
	               |		КОГДА ВидыСубконтоБУКт3.ВидСубконто = ВидыСубконтоНУКт2.ВидСубконто
	               |			ТОГДА ОтражениеВУчете.СубконтоКт3
	               |	КОНЕЦ КАК СубконтоКтНУ2,
	               |	ВЫБОР
	               |		КОГДА ВидыСубконтоБУКт1.ВидСубконто = ВидыСубконтоНУКт3.ВидСубконто
	               |			ТОГДА ОтражениеВУчете.СубконтоКт1
	               |		КОГДА ВидыСубконтоБУКт2.ВидСубконто = ВидыСубконтоНУКт3.ВидСубконто
	               |			ТОГДА ОтражениеВУчете.СубконтоКт2
	               |		КОГДА ВидыСубконтоБУКт3.ВидСубконто = ВидыСубконтоНУКт3.ВидСубконто
	               |			ТОГДА ОтражениеВУчете.СубконтоКт3
	               |	КОНЕЦ КАК СубконтоКтНУ3
	               |ПОМЕСТИТЬ ВТ_СоответствиеСчетовБУиНУ
	               |ИЗ
	               |	ВТ_ОтражениеВУчете КАК ОтражениеВУчете
	               |		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Типовой.ВидыСубконто КАК ВидыСубконтоБУДт1
	               |		ПО ОтражениеВУчете.СчетДт = ВидыСубконтоБУДт1.Ссылка
	               |			И (ВидыСубконтоБУДт1.НомерСтроки = 1)
	               |		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Типовой.ВидыСубконто КАК ВидыСубконтоБУДт2
	               |		ПО ОтражениеВУчете.СчетДт = ВидыСубконтоБУДт2.Ссылка
	               |			И (ВидыСубконтоБУДт2.НомерСтроки = 2)
	               |		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Типовой.ВидыСубконто КАК ВидыСубконтоБУДт3
	               |		ПО ОтражениеВУчете.СчетДт = ВидыСубконтоБУДт3.Ссылка
	               |			И (ВидыСубконтоБУДт3.НомерСтроки = 3)
	               |		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Типовой.ВидыСубконто КАК ВидыСубконтоБУКт1
	               |		ПО ОтражениеВУчете.СчетКт = ВидыСубконтоБУКт1.Ссылка
	               |			И (ВидыСубконтоБУКт1.НомерСтроки = 1)
	               |		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Типовой.ВидыСубконто КАК ВидыСубконтоБУКт2
	               |		ПО ОтражениеВУчете.СчетКт = ВидыСубконтоБУКт2.Ссылка
	               |			И (ВидыСубконтоБУКт2.НомерСтроки = 2)
	               |		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Типовой.ВидыСубконто КАК ВидыСубконтоБУКт3
	               |		ПО ОтражениеВУчете.СчетКт = ВидыСубконтоБУКт3.Ссылка
	               |			И (ВидыСубконтоБУКт3.НомерСтроки = 3)
	               |		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Налоговый.ВидыСубконто КАК ВидыСубконтоНУДт1
	               |		ПО ОтражениеВУчете.СчетДт.СчетНУ = ВидыСубконтоНУДт1.Ссылка
	               |			И (ВидыСубконтоНУДт1.НомерСтроки = 1)
	               |		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Налоговый.ВидыСубконто КАК ВидыСубконтоНУДт2
	               |		ПО ОтражениеВУчете.СчетДт.СчетНУ = ВидыСубконтоНУДт2.Ссылка
	               |			И (ВидыСубконтоНУДт2.НомерСтроки = 2)
	               |		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Налоговый.ВидыСубконто КАК ВидыСубконтоНУДт3
	               |		ПО ОтражениеВУчете.СчетДт.СчетНУ = ВидыСубконтоНУДт3.Ссылка
	               |			И (ВидыСубконтоНУДт3.НомерСтроки = 3)
	               |		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Налоговый.ВидыСубконто КАК ВидыСубконтоНУКт1
	               |		ПО ОтражениеВУчете.СчетКт.СчетНУ = ВидыСубконтоНУКт1.Ссылка
	               |			И (ВидыСубконтоНУКт1.НомерСтроки = 1)
	               |		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Налоговый.ВидыСубконто КАК ВидыСубконтоНУКт2
	               |		ПО ОтражениеВУчете.СчетКт.СчетНУ = ВидыСубконтоНУКт2.Ссылка
	               |			И (ВидыСубконтоНУКт2.НомерСтроки = 2)
	               |		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Налоговый.ВидыСубконто КАК ВидыСубконтоНУКт3
	               |		ПО ОтражениеВУчете.СчетКт.СчетНУ = ВидыСубконтоНУКт3.Ссылка
	               |			И (ВидыСубконтоНУКт3.НомерСтроки = 3)
	               |;
	               |
	               |////////////////////////////////////////////////////////////////////////////////
	               |ВЫБРАТЬ РАЗРЕШЕННЫЕ
	               |	ОтражениеВУчете.НомерСтроки,
	               |	СоответствиеСчетовБУиНУ.СчетДтНУ,
	               |	СоответствиеСчетовБУиНУ.СубконтоДтНУ1,
	               |	СоответствиеСчетовБУиНУ.СубконтоДтНУ2,
	               |	СоответствиеСчетовБУиНУ.СубконтоДтНУ3,
	               |	ВЫБОР
	               |		КОГДА НалогиСборыОтчисления.СчетКтНУ <> ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
	               |			ТОГДА НалогиСборыОтчисления.СчетКтНУ
	               |		ИНАЧЕ СоответствиеСчетовБУиНУ.СчетКтНУ
	               |	КОНЕЦ КАК СчетКтНУ,
	               |	ВЫБОР
	               |		КОГДА НалогиСборыОтчисления.СчетКтНУ <> ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
	               |			ТОГДА НалогиСборыОтчисления.СубконтоКтНУ1
	               |		ИНАЧЕ СоответствиеСчетовБУиНУ.СубконтоКтНУ1
	               |	КОНЕЦ КАК СубконтоКтНУ1,
	               |	ВЫБОР
	               |		КОГДА НалогиСборыОтчисления.СчетКтНУ <> ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
	               |			ТОГДА НалогиСборыОтчисления.СубконтоКтНУ2
	               |		ИНАЧЕ СоответствиеСчетовБУиНУ.СубконтоКтНУ2
	               |	КОНЕЦ КАК СубконтоКтНУ2,
	               |	ВЫБОР
	               |		КОГДА НалогиСборыОтчисления.СчетКтНУ <> ЗНАЧЕНИЕ(ПланСчетов.Налоговый.ПустаяСсылка)
	               |			ТОГДА НалогиСборыОтчисления.СубконтоКтНУ3
	               |		ИНАЧЕ СоответствиеСчетовБУиНУ.СубконтоКтНУ3
	               |	КОНЕЦ КАК СубконтоКтНУ3
	               |ИЗ
	               |	ВТ_ОтражениеВУчете КАК ОтражениеВУчете
	               |		ЛЕВОЕ СОЕДИНЕНИЕ ВТ_НалогиСборыОтчисления КАК НалогиСборыОтчисления
	               |		ПО ОтражениеВУчете.НомерСтроки = НалогиСборыОтчисления.НомерСтроки
	               |		ЛЕВОЕ СОЕДИНЕНИЕ ВТ_СоответствиеСчетовБУиНУ КАК СоответствиеСчетовБУиНУ
	               |		ПО ОтражениеВУчете.НомерСтроки = СоответствиеСчетовБУиНУ.НомерСтроки";
	
	Выборка = Запрос.Выполнить().Выбрать();
	Пока Выборка.Следующий() Цикл
		СтрокаТЧ = Объект.ОтражениеВУчете[Выборка.НомерСтроки - 1];
		ЗаполнитьЗначенияСвойств(СтрокаТЧ, Выборка);
	КонецЦикла;

КонецПроцедуры // АвтозаполнениеПроводокНУ()

////////////////////////////////////////////////////////////////////////////////
//Проведение

Функция ПодготовитьПараметрыПроведения(ДокументСсылка, Отказ) Экспорт

	ВалютаРеглУчета     = Константы.ВалютаРегламентированногоУчета.Получить();
	
	ПараметрыПроведения = Новый Структура;
	ПараметрыПроведения.Вставить("ВалютаРеглУчета", ВалютаРеглУчета);
	ПараметрыПроведения.Вставить("ДокументСсылка",  ДокументСсылка);
	
	Запрос = Новый Запрос;
	МенеджерВременныхТаблиц  = Новый МенеджерВременныхТаблиц;
	Запрос.МенеджерВременныхТаблиц = МенеджерВременныхТаблиц;
	Запрос.УстановитьПараметр("Ссылка", ДокументСсылка);
	Запрос.УстановитьПараметр("ВалютаРеглУчета", ВалютаРеглУчета);
	
	НомераТаблиц = Новый Структура;
	
	Запрос.Текст = ТекстЗапросаРеквизитыДокумента(НомераТаблиц);
	Результат = Запрос.ВыполнитьПакет();
	ТаблицаРеквизиты = Результат[НомераТаблиц["Реквизиты"]].Выгрузить();
	ПараметрыПроведения.Вставить("Реквизиты", ТаблицаРеквизиты);
	
	Реквизиты = ОбщегоНазначения.СтрокаТаблицыЗначенийВСтруктуру(ТаблицаРеквизиты[0]);

	Если НЕ УчетнаяПолитикаСервер.Существует(Реквизиты.Организация, Реквизиты.Дата, "БУ", Истина, ДокументСсылка)
		ИЛИ НЕ УчетнаяПолитикаСервер.Существует(Реквизиты.Организация, Реквизиты.Дата, "НУ", Истина, ДокументСсылка) Тогда
		Отказ = Истина;
	КонецЕсли;
	
	Если Отказ Тогда
		Возврат ПараметрыПроведения;
	КонецЕсли;      
	
	ОрганизацияПлательщикНалогаНаПрибыль 			= ПроцедурыНалоговогоУчета.ПолучитьПризнакПлательщикаНалогаНаПрибыль(Реквизиты.Организация, Реквизиты.Дата);
	ВедениеУчетаВременныхРазницБалансовымМетодом    = УчетнаяПолитикаСервер.ВедетсяУчетВременныхРазницБалансовымМетодом(Реквизиты.Организация, Реквизиты.Дата);
	ВедениеУчетаПоСотрудникам = ОбщегоНазначенияБК.ПолучитьПризнакВеденияУчетаПоСотрудникам();
	
	Реквизиты.Вставить("ОрганизацияПлательщикНалогаНаПрибыль", 			 ОрганизацияПлательщикНалогаНаПрибыль);
	Реквизиты.Вставить("ВедениеУчетаВременныхРазницБалансовымМетодом",   ВедениеУчетаВременныхРазницБалансовымМетодом);
	Реквизиты.Вставить("ВедениеУчетаПоСотрудникам", 				     ВедениеУчетаПоСотрудникам);		
	
	ПараметрыПроведения.Реквизиты.ЗаполнитьЗначения(ОрганизацияПлательщикНалогаНаПрибыль, "ОрганизацияПлательщикНалогаНаПрибыль");		
	ПараметрыПроведения.Реквизиты.ЗаполнитьЗначения(ВедениеУчетаВременныхРазницБалансовымМетодом, "ВедениеУчетаВременныхРазницБалансовымМетодом");	
	ПараметрыПроведения.Реквизиты.ЗаполнитьЗначения(ВедениеУчетаПоСотрудникам, "ВедениеУчетаПоСотрудникам");
		
	Запрос.УстановитьПараметр("ВедениеУчетаПоСотрудникам"      , ВедениеУчетаПоСотрудникам);
	Запрос.УстановитьПараметр("ВидСубконтоРаботникиОрганизаций", ПланыВидовХарактеристик.ВидыСубконтоТиповые.РаботникиОрганизаций);
	Запрос.УстановитьПараметр("Организация"     			   , Реквизиты.Организация);
	Запрос.УстановитьПараметр("ПериодРегистрации"              , КонецМесяца(Реквизиты.ПериодРегистрации));
	
	Запрос.УстановитьПараметр("СчетаЗП" , ПроцедурыБухгалтерскогоУчетаВызовСервераПовтИсп.ПолучитьСписокСчетовСОтключаемойАналитикойРаботникиОрганизации());
	
	НомераТаблиц = Новый Структура;

	Запрос.Текст = ТекстЗапросаВременныеТаблицыДокумента(НомераТаблиц)
		+ ТекстЗапросаПоОтражениюВУчете(НомераТаблиц)
		+ ТекстЗапросаПоРезервам(НомераТаблиц);
		
	Результат = Запрос.ВыполнитьПакет();

	Для Каждого НомерТаблицы ИЗ НомераТаблиц Цикл
		ПараметрыПроведения.Вставить(НомерТаблицы.Ключ, Результат[НомерТаблицы.Значение].Выгрузить());
	КонецЦикла;

	Возврат ПараметрыПроведения;

КонецФункции

Функция ТекстЗапросаРеквизитыДокумента(НомераТаблиц)
	
	НомераТаблиц.Вставить("ВременнаяТаблицаРеквизиты", НомераТаблиц.Количество());
	НомераТаблиц.Вставить("Реквизиты", НомераТаблиц.Количество());
	
	ТекстЗапроса =
	"ВЫБРАТЬ
	|	Реквизиты.Ссылка КАК Ссылка,
	|	Реквизиты.Ссылка КАК Регистратор,
	|	Реквизиты.Дата КАК Дата,
	|	ВЫБОР
	|		КОГДА Реквизиты.Дата >= Реквизиты.ПериодРегистрации И
	|			Реквизиты.Дата <= КОНЕЦПЕРИОДА(Реквизиты.ПериодРегистрации, МЕСЯЦ) 
	|		ТОГДА Реквизиты.Дата
	|		ИНАЧЕ КОНЕЦПЕРИОДА(Реквизиты.ПериодРегистрации, МЕСЯЦ)
	|	КОНЕЦ КАК Период,
	|	Реквизиты.Номер КАК Номер,
	|	Реквизиты.Организация КАК Организация,
	|	Реквизиты.ПериодРегистрации КАК ПериодРегистрации,
	|	Реквизиты.СтруктурноеПодразделение КАК СтруктурноеПодразделение,
	|	&ВалютаРеглУчета КАК ВалютаРеглУчета,
	|	ЛОЖЬ КАК ВедениеУчетаВременныхРазницБалансовымМетодом,
	|	ЛОЖЬ КАК ОрганизацияПлательщикНалогаНаПрибыль,
	|	ЛОЖЬ КАК ВедениеУчетаПоСотрудникам,
	|	ЗНАЧЕНИЕ(Справочник.ВидыУчетаНУ.НУ) КАК ВидУчетаНУ   // для дальнейшего отражения затрат на ремонт производственных ОС
	|
	|ПОМЕСТИТЬ Реквизиты
	|ИЗ
	|	Документ.ОтражениеЗарплатыВРеглУчете КАК Реквизиты
	|ГДЕ
	|	Реквизиты.Ссылка = &Ссылка
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	Реквизиты.Ссылка КАК Ссылка,
	|	Реквизиты.Ссылка КАК Регистратор,
	|	Реквизиты.Дата КАК Дата,
	|	Реквизиты.Период КАК Период,
	|	Реквизиты.Номер КАК Номер,
	|	Реквизиты.Организация КАК Организация,
	|	Реквизиты.ПериодРегистрации КАК ПериодРегистрации,
	|	Реквизиты.СтруктурноеПодразделение КАК СтруктурноеПодразделение,
	|	Реквизиты.ВалютаРеглУчета КАК ВалютаРеглУчета,
	|	Реквизиты.ВедениеУчетаВременныхРазницБалансовымМетодом КАК ВедениеУчетаВременныхРазницБалансовымМетодом,
	|	Реквизиты.ОрганизацияПлательщикНалогаНаПрибыль КАК ОрганизацияПлательщикНалогаНаПрибыль,
	|	Реквизиты.ВедениеУчетаПоСотрудникам КАК ВедениеУчетаПоСотрудникам,
	|	Реквизиты.ВидУчетаНУ КАК ВидУчетаНУ
	|ИЗ
	|	Реквизиты КАК Реквизиты";

	Возврат ТекстЗапроса + ОбщегоНазначенияБКВызовСервера.ТекстРазделителяЗапросовПакета();
	
КонецФункции

Функция ТекстЗапросаВременныеТаблицыДокумента(НомераТаблиц)
	
	ТекстЗапроса = "";
	
	ТекстЗапроса = ТекстЗапроса +
		"ВЫБРАТЬ
		|	ТаблицаОтражениеВУчете.Ссылка КАК Ссылка,
		|	ТаблицаОтражениеВУчете.ФизЛицо КАК ФизЛицо,
		|	ТаблицаОтражениеВУчете.СтруктурноеПодразделениеДт КАК СтруктурноеПодразделениеДт,
		|	ТаблицаОтражениеВУчете.СтруктурноеПодразделениеКт КАК СтруктурноеПодразделениеКт,
		|	ТаблицаОтражениеВУчете.ВидРасчета КАК ВидРасчета,
		|	ТаблицаОтражениеВУчете.НомерСтроки КАК НомерСтроки,
		|	ТаблицаОтражениеВУчете.СчетДт КАК СчетДт,
		|	ТаблицаОтражениеВУчете.СчетДтНУ КАК СчетДтНУ,
		|	ТаблицаОтражениеВУчете.СубконтоДт1 КАК СубконтоДт1,
		|	ТаблицаОтражениеВУчете.СубконтоДт2 КАК СубконтоДт2,
		|	ТаблицаОтражениеВУчете.СубконтоДт3 КАК СубконтоДт3,
		|	ТаблицаОтражениеВУчете.СубконтоДтНУ1 КАК СубконтоДтНУ1,
		|	ТаблицаОтражениеВУчете.СубконтоДтНУ2 КАК СубконтоДтНУ2,
		|	ТаблицаОтражениеВУчете.СубконтоДтНУ3 КАК СубконтоДтНУ3,
		|	ТаблицаОтражениеВУчете.СчетКт КАК СчетКт,
		|	ТаблицаОтражениеВУчете.СчетКтНУ КАК СчетКтНУ,
		|	ТаблицаОтражениеВУчете.СубконтоКт1 КАК СубконтоКт1,
		|	ТаблицаОтражениеВУчете.СубконтоКт2 КАК СубконтоКт2,
		|	ТаблицаОтражениеВУчете.СубконтоКт3 КАК СубконтоКт3,
		|	ТаблицаОтражениеВУчете.СубконтоКтНУ1 КАК СубконтоКтНУ1,
		|	ТаблицаОтражениеВУчете.СубконтоКтНУ2 КАК СубконтоКтНУ2,
		|	ТаблицаОтражениеВУчете.СубконтоКтНУ3 КАК СубконтоКтНУ3,
		|	ТаблицаОтражениеВУчете.Сумма КАК Сумма  
		|ПОМЕСТИТЬ ТаблицаОтражениеВУчете
		|ИЗ
		|	Документ.ОтражениеЗарплатыВРеглУчете.ОтражениеВУчете КАК ТаблицаОтражениеВУчете
		|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Реквизиты КАК Реквизиты
		|		ПО ТаблицаОтражениеВУчете.Ссылка = Реквизиты.Ссылка
		|ГДЕ
		|	ТаблицаОтражениеВУчете.Сумма <> 0"
		
		 + ОбщегоНазначенияБКВызовСервера.ТекстРазделителяЗапросовПакета();
		
	НомераТаблиц.Вставить("ВременнаяТаблицаОтражениеВУчете", НомераТаблиц.Количество());
	
	Возврат ТекстЗапроса;
	
КонецФункции

Функция ТекстЗапросаПоОтражениюВУчете(НомераТаблиц)
	
	НомераТаблиц.Вставить("ТаблицаОтражениеВУчетеБУ", НомераТаблиц.Количество());
	НомераТаблиц.Вставить("ТаблицаОтражениеВУчетеНУ", НомераТаблиц.Количество());
	
	ТекстЗапроса =
	"ВЫБРАТЬ
	|	Реквизиты.Дата КАК Дата,
	|	Реквизиты.Период КАК Период,
	|	Реквизиты.Номер КАК Номер,
	|	Реквизиты.Регистратор КАК Регистратор,
	|	Реквизиты.Организация КАК Организация,
	|	ВЫБОР
	|		КОГДА &ВедениеУчетаПоСотрудникам
	|			ТОГДА ТаблицаОтражениеВУчете.ФизЛицо
	|		ИНАЧЕ ЗНАЧЕНИЕ(Справочник.ФизическиеЛица.ПустаяСсылка)
	|	КОНЕЦ КАК ФизЛицо,
	|	ВЫБОР
	|		КОГДА &ВедениеУчетаПоСотрудникам
	|			ТОГДА ТаблицаОтражениеВУчете.ФизЛицо.Наименование
	|		ИНАЧЕ """"
	|	КОНЕЦ КАК ФИОРаботника,
	|	ТаблицаОтражениеВУчете.СтруктурноеПодразделениеДт,
	|	ТаблицаОтражениеВУчете.СтруктурноеПодразделениеКт,
	|	ТаблицаОтражениеВУчете.ВидРасчета КАК ВидРасчета,
	|	ТаблицаОтражениеВУчете.ВидРасчета.Наименование КАК ВидРасчетаНаименование,
	|	ТаблицаОтражениеВУчете.НомерСтроки КАК НомерСтроки,
	|	ТаблицаОтражениеВУчете.СчетДт,
	|	ТаблицаОтражениеВУчете.СчетДт.Наименование КАК НаименованиеСчетДт,	
	|	ВЫБОР
	|		КОГДА ДтВидСубконто1.ВидСубконто = &ВидСубконтоРаботникиОрганизаций
	|			ТОГДА ВЫБОР
	|					КОГДА ТаблицаОтражениеВУчете.СубконтоДт1 = ЗНАЧЕНИЕ(Справочник.ФизическиеЛица.ПустаяСсылка)
	|						ТОГДА ТаблицаОтражениеВУчете.ФизЛицо
	|					ИНАЧЕ ТаблицаОтражениеВУчете.СубконтоДт1
	|				КОНЕЦ
	|		ИНАЧЕ ВЫБОР
	|				КОГДА (НЕ &ВедениеУчетаПоСотрудникам)
	|						И ТаблицаОтражениеВУчете.СубконтоДт1 ССЫЛКА Справочник.ФизическиеЛица
	|						И ТаблицаОтражениеВУчете.СчетДт В (&СчетаЗП)	
	|					ТОГДА ЗНАЧЕНИЕ(Справочник.ФизическиеЛица.ПустаяСсылка)
	|				ИНАЧЕ ТаблицаОтражениеВУчете.СубконтоДт1
	|			КОНЕЦ
	|	КОНЕЦ КАК СубконтоДт1,
	|	ДтВидСубконто1.ВидСубконто КАК ДтВидСубконто1,
	|	ВЫБОР
	|		КОГДА ДтВидСубконто2.ВидСубконто = &ВидСубконтоРаботникиОрганизаций
	|			ТОГДА ВЫБОР
	|					КОГДА ТаблицаОтражениеВУчете.СубконтоДт2 = ЗНАЧЕНИЕ(Справочник.ФизическиеЛица.ПустаяСсылка)
	|						ТОГДА ТаблицаОтражениеВУчете.ФизЛицо
	|					ИНАЧЕ ТаблицаОтражениеВУчете.СубконтоДт2
	|				КОНЕЦ
	|		ИНАЧЕ ВЫБОР
	|				КОГДА (НЕ &ВедениеУчетаПоСотрудникам)
	|						И ТаблицаОтражениеВУчете.СубконтоДт2 ССЫЛКА Справочник.ФизическиеЛица
	|						И ТаблицаОтражениеВУчете.СчетДт В (&СчетаЗП)
	|					ТОГДА ЗНАЧЕНИЕ(Справочник.ФизическиеЛица.ПустаяСсылка)
	|				ИНАЧЕ ТаблицаОтражениеВУчете.СубконтоДт2
	|			КОНЕЦ
	|	КОНЕЦ КАК СубконтоДт2,
	|	ДтВидСубконто2.ВидСубконто КАК ДтВидСубконто2,
	|	ВЫБОР
	|		КОГДА ДтВидСубконто3.ВидСубконто = &ВидСубконтоРаботникиОрганизаций
	|			ТОГДА ВЫБОР
	|					КОГДА ТаблицаОтражениеВУчете.СубконтоДт3 = ЗНАЧЕНИЕ(Справочник.ФизическиеЛица.ПустаяСсылка)
	|						ТОГДА ТаблицаОтражениеВУчете.ФизЛицо
	|					ИНАЧЕ ТаблицаОтражениеВУчете.СубконтоДт3
	|				КОНЕЦ
	|		ИНАЧЕ ВЫБОР
	|				КОГДА (НЕ &ВедениеУчетаПоСотрудникам)
	|						И ТаблицаОтражениеВУчете.СубконтоДт3 ССЫЛКА Справочник.ФизическиеЛица
	|						И ТаблицаОтражениеВУчете.СчетДт В (&СчетаЗП)	
	|					ТОГДА ЗНАЧЕНИЕ(Справочник.ФизическиеЛица.ПустаяСсылка)
	|				ИНАЧЕ ТаблицаОтражениеВУчете.СубконтоДт3
	|			КОНЕЦ
	|	КОНЕЦ КАК СубконтоДт3,
	|	ДтВидСубконто3.ВидСубконто КАК ДтВидСубконто3,
	|	ТаблицаОтражениеВУчете.СчетКт,	
	|	ВЫБОР
	|		КОГДА КтВидСубконто1.ВидСубконто = &ВидСубконтоРаботникиОрганизаций
	|			ТОГДА ВЫБОР
	|					КОГДА ТаблицаОтражениеВУчете.СубконтоКт1 = ЗНАЧЕНИЕ(Справочник.ФизическиеЛица.ПустаяСсылка)
	|						ТОГДА ТаблицаОтражениеВУчете.ФизЛицо
	|					ИНАЧЕ ТаблицаОтражениеВУчете.СубконтоКт1
	|				КОНЕЦ
	|		ИНАЧЕ ВЫБОР
	|				КОГДА (НЕ &ВедениеУчетаПоСотрудникам)
	|						И ТаблицаОтражениеВУчете.СубконтоКт1 ССЫЛКА Справочник.ФизическиеЛица
	|						И ТаблицаОтражениеВУчете.СчетКт В (&СчетаЗП)	
	|					ТОГДА ЗНАЧЕНИЕ(Справочник.ФизическиеЛица.ПустаяСсылка)
	|				ИНАЧЕ ТаблицаОтражениеВУчете.СубконтоКт1
	|			КОНЕЦ
	|	КОНЕЦ КАК СубконтоКт1,
	|	КтВидСубконто1.ВидСубконто КАК КтВидСубконто1,
	|	ВЫБОР
	|		КОГДА КтВидСубконто2.ВидСубконто = &ВидСубконтоРаботникиОрганизаций
	|			ТОГДА ВЫБОР
	|					КОГДА ТаблицаОтражениеВУчете.СубконтоКт2 = ЗНАЧЕНИЕ(Справочник.ФизическиеЛица.ПустаяСсылка)
	|						ТОГДА ТаблицаОтражениеВУчете.ФизЛицо
	|					ИНАЧЕ ТаблицаОтражениеВУчете.СубконтоКт2
	|				КОНЕЦ
	|		ИНАЧЕ ВЫБОР
	|				КОГДА (НЕ &ВедениеУчетаПоСотрудникам)
	|						И ТаблицаОтражениеВУчете.СубконтоКт2 ССЫЛКА Справочник.ФизическиеЛица
	|						И ТаблицаОтражениеВУчете.СчетКт В (&СчетаЗП)
	|					ТОГДА ЗНАЧЕНИЕ(Справочник.ФизическиеЛица.ПустаяСсылка)
	|				ИНАЧЕ ТаблицаОтражениеВУчете.СубконтоКт2
	|			КОНЕЦ
	|	КОНЕЦ КАК СубконтоКт2,
	|	КтВидСубконто2.ВидСубконто КАК КтВидСубконто2,
	|	ВЫБОР
	|		КОГДА КтВидСубконто3.ВидСубконто = &ВидСубконтоРаботникиОрганизаций
	|			ТОГДА ВЫБОР
	|					КОГДА ТаблицаОтражениеВУчете.СубконтоКт3 = ЗНАЧЕНИЕ(Справочник.ФизическиеЛица.ПустаяСсылка)
	|						ТОГДА ТаблицаОтражениеВУчете.ФизЛицо
	|					ИНАЧЕ ТаблицаОтражениеВУчете.СубконтоКт3
	|				КОНЕЦ
	|		ИНАЧЕ ВЫБОР
	|				КОГДА (НЕ &ВедениеУчетаПоСотрудникам)
	|						И ТаблицаОтражениеВУчете.СубконтоКт3 ССЫЛКА Справочник.ФизическиеЛица
	|						И ТаблицаОтражениеВУчете.СчетКт В (&СчетаЗП)
	|					ТОГДА ЗНАЧЕНИЕ(Справочник.ФизическиеЛица.ПустаяСсылка)
	|				ИНАЧЕ ТаблицаОтражениеВУчете.СубконтоКт3
	|			КОНЕЦ
	|	КОНЕЦ КАК СубконтоКт3,
	|	КтВидСубконто3.ВидСубконто КАК КтВидСубконто3,
	|	ТаблицаОтражениеВУчете.Сумма,
	|	ВЫБОР
	|		КОГДА &ВедениеУчетаПоСотрудникам
	|			ТОГДА ВЫБОР
	|					КОГДА ДтВидСубконто1.ВидСубконто = &ВидСубконтоРаботникиОрганизаций
	|							ИЛИ ДтВидСубконто2.ВидСубконто = &ВидСубконтоРаботникиОрганизаций
	|							ИЛИ ДтВидСубконто3.ВидСубконто = &ВидСубконтоРаботникиОрганизаций
	|							ИЛИ КтВидСубконто1.ВидСубконто = &ВидСубконтоРаботникиОрганизаций
	|							ИЛИ КтВидСубконто2.ВидСубконто = &ВидСубконтоРаботникиОрганизаций
	|							ИЛИ КтВидСубконто3.ВидСубконто = &ВидСубконтоРаботникиОрганизаций
	|						ТОГДА ЛОЖЬ
	|					ИНАЧЕ ИСТИНА
	|				КОНЕЦ
	|		ИНАЧЕ ЛОЖЬ
	|	КОНЕЦ КАК ВключатьФИОРаботникаВСодержание,
	|	ВЫБОР
	|		КОГДА ТаблицаОтражениеВУчете.ВидРасчета = ТаблицаОтражениеВУчете.СубконтоДт1
	|				ИЛИ ТаблицаОтражениеВУчете.ВидРасчета = ТаблицаОтражениеВУчете.СубконтоДт2
	|				ИЛИ ТаблицаОтражениеВУчете.ВидРасчета = ТаблицаОтражениеВУчете.СубконтоДт3
	|				ИЛИ ТаблицаОтражениеВУчете.ВидРасчета = ТаблицаОтражениеВУчете.СубконтоКт1
	|				ИЛИ ТаблицаОтражениеВУчете.ВидРасчета = ТаблицаОтражениеВУчете.СубконтоКт2
	|				ИЛИ ТаблицаОтражениеВУчете.ВидРасчета = ТаблицаОтражениеВУчете.СубконтоКт3
	|			ТОГДА ЛОЖЬ
	|		ИНАЧЕ ИСТИНА
	|	КОНЕЦ КАК ВключатьВидРасчетаВСодержание
	|ИЗ
	|	Реквизиты КАК Реквизиты
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ТаблицаОтражениеВУчете КАК ТаблицаОтражениеВУчете
	|		ПО (ИСТИНА)
	|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Типовой.ВидыСубконто КАК ДтВидСубконто1
	|		ПО (ДтВидСубконто1.Ссылка = ТаблицаОтражениеВУчете.СчетДт)
	|			И (ДтВидСубконто1.НомерСтроки = 1)
	|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Типовой.ВидыСубконто КАК ДтВидСубконто2
	|		ПО (ДтВидСубконто2.Ссылка = ТаблицаОтражениеВУчете.СчетДт)
	|			И (ДтВидСубконто2.НомерСтроки = 2)
	|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Типовой.ВидыСубконто КАК ДтВидСубконто3
	|		ПО (ДтВидСубконто3.Ссылка = ТаблицаОтражениеВУчете.СчетДт)
	|			И (ДтВидСубконто3.НомерСтроки = 3)
	|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Типовой.ВидыСубконто КАК КтВидСубконто1
	|		ПО (КтВидСубконто1.Ссылка = ТаблицаОтражениеВУчете.СчетКт)
	|			И (КтВидСубконто1.НомерСтроки = 1)
	|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Типовой.ВидыСубконто КАК КтВидСубконто2
	|		ПО (КтВидСубконто2.Ссылка = ТаблицаОтражениеВУчете.СчетКт)
	|			И (КтВидСубконто2.НомерСтроки = 2)
	|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Типовой.ВидыСубконто КАК КтВидСубконто3
	|		ПО (КтВидСубконто3.Ссылка = ТаблицаОтражениеВУчете.СчетКт)
	|			И (КтВидСубконто3.НомерСтроки = 3)	
	|
	|УПОРЯДОЧИТЬ ПО
	|	ТаблицаОтражениеВУчете.НомерСтроки
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	Реквизиты.Дата КАК Дата,
	|	Реквизиты.Период КАК Период,
	|	Реквизиты.Номер КАК Номер,
	|	Реквизиты.Регистратор КАК Регистратор,
	|	Реквизиты.Организация КАК Организация,
	|	ТаблицаОтражениеВУчете.ФизЛицо,
	|	ТаблицаОтражениеВУчете.ФизЛицо.Наименование КАК ФИОРаботника,
	|	ТаблицаОтражениеВУчете.СтруктурноеПодразделениеДт,
	|	ТаблицаОтражениеВУчете.СтруктурноеПодразделениеКт,
	|	ТаблицаОтражениеВУчете.ВидРасчета КАК ВидРасчета,
	|	ТаблицаОтражениеВУчете.ВидРасчета.Наименование КАК ВидРасчетаНаименование,
	|	ТаблицаОтражениеВУчете.НомерСтроки КАК НомерСтроки,
	|	ТаблицаОтражениеВУчете.СчетДтНУ,
	|	ВЫБОР
	|		КОГДА ДтВидСубконтоНУ1.ВидСубконто = &ВидСубконтоРаботникиОрганизаций
	|			ТОГДА ВЫБОР
	|					КОГДА ТаблицаОтражениеВУчете.СубконтоДтНУ1 = ЗНАЧЕНИЕ(Справочник.ФизическиеЛица.ПустаяСсылка)
	|						ТОГДА ТаблицаОтражениеВУчете.ФизЛицо
	|					ИНАЧЕ ТаблицаОтражениеВУчете.СубконтоДтНУ1
	|				КОНЕЦ
	|		ИНАЧЕ ВЫБОР
	|				КОГДА (НЕ &ВедениеУчетаПоСотрудникам)
	|						И ТаблицаОтражениеВУчете.СубконтоДтНУ1 ССЫЛКА Справочник.ФизическиеЛица
	|					ТОГДА ЗНАЧЕНИЕ(Справочник.ФизическиеЛица.ПустаяСсылка)
	|				ИНАЧЕ ТаблицаОтражениеВУчете.СубконтоДтНУ1
	|			КОНЕЦ
	|	КОНЕЦ КАК СубконтоДтНУ1,
	|	ДтВидСубконтоНУ1.ВидСубконто КАК ДтВидСубконтоНУ1,
	|	ВЫБОР
	|		КОГДА ДтВидСубконтоНУ2.ВидСубконто = &ВидСубконтоРаботникиОрганизаций
	|			ТОГДА ВЫБОР
	|					КОГДА ТаблицаОтражениеВУчете.СубконтоДтНУ2 = ЗНАЧЕНИЕ(Справочник.ФизическиеЛица.ПустаяСсылка)
	|						ТОГДА ТаблицаОтражениеВУчете.ФизЛицо
	|					ИНАЧЕ ТаблицаОтражениеВУчете.СубконтоДтНУ2
	|				КОНЕЦ
	|		ИНАЧЕ ВЫБОР
	|				КОГДА (НЕ &ВедениеУчетаПоСотрудникам)
	|						И ТаблицаОтражениеВУчете.СубконтоДтНУ1 ССЫЛКА Справочник.ФизическиеЛица
	|					ТОГДА ЗНАЧЕНИЕ(Справочник.ФизическиеЛица.ПустаяСсылка)
	|				ИНАЧЕ ТаблицаОтражениеВУчете.СубконтоДтНУ2
	|			КОНЕЦ
	|	КОНЕЦ КАК СубконтоДтНУ2,
	|	ДтВидСубконтоНУ2.ВидСубконто КАК ДтВидСубконтоНУ2,
	|	ВЫБОР
	|		КОГДА ДтВидСубконтоНУ3.ВидСубконто = &ВидСубконтоРаботникиОрганизаций
	|			ТОГДА ВЫБОР
	|					КОГДА ТаблицаОтражениеВУчете.СубконтоДтНУ3 = ЗНАЧЕНИЕ(Справочник.ФизическиеЛица.ПустаяСсылка)
	|						ТОГДА ТаблицаОтражениеВУчете.ФизЛицо
	|					ИНАЧЕ ТаблицаОтражениеВУчете.СубконтоДтНУ3
	|				КОНЕЦ
	|		ИНАЧЕ ВЫБОР
	|				КОГДА (НЕ &ВедениеУчетаПоСотрудникам)
	|						И ТаблицаОтражениеВУчете.СубконтоДтНУ3 ССЫЛКА Справочник.ФизическиеЛица
	|					ТОГДА ЗНАЧЕНИЕ(Справочник.ФизическиеЛица.ПустаяСсылка)
	|				ИНАЧЕ ТаблицаОтражениеВУчете.СубконтоДтНУ3
	|			КОНЕЦ
	|	КОНЕЦ КАК СубконтоДтНУ3,
	|	ДтВидСубконтоНУ3.ВидСубконто КАК ДтВидСубконтоНУ3,	
	|	ТаблицаОтражениеВУчете.СчетКтНУ,
	|	ВЫБОР
	|		КОГДА КтВидСубконтоНУ1.ВидСубконто = &ВидСубконтоРаботникиОрганизаций
	|			ТОГДА ВЫБОР
	|					КОГДА ТаблицаОтражениеВУчете.СубконтоКтНУ1 = ЗНАЧЕНИЕ(Справочник.ФизическиеЛица.ПустаяСсылка)
	|						ТОГДА ТаблицаОтражениеВУчете.ФизЛицо
	|					ИНАЧЕ ТаблицаОтражениеВУчете.СубконтоКтНУ1
	|				КОНЕЦ
	|		ИНАЧЕ ВЫБОР
	|				КОГДА (НЕ &ВедениеУчетаПоСотрудникам)
	|						И ТаблицаОтражениеВУчете.СубконтоКтНУ1 ССЫЛКА Справочник.ФизическиеЛица
	|					ТОГДА ЗНАЧЕНИЕ(Справочник.ФизическиеЛица.ПустаяСсылка)
	|				ИНАЧЕ ТаблицаОтражениеВУчете.СубконтоКтНУ1
	|			КОНЕЦ
	|	КОНЕЦ КАК СубконтоКтНУ1,
	|	КтВидСубконтоНУ1.ВидСубконто КАК КтВидСубконтоНУ1,
	|	ВЫБОР
	|		КОГДА КтВидСубконтоНУ2.ВидСубконто = &ВидСубконтоРаботникиОрганизаций
	|			ТОГДА ВЫБОР
	|					КОГДА ТаблицаОтражениеВУчете.СубконтоКтНУ2 = ЗНАЧЕНИЕ(Справочник.ФизическиеЛица.ПустаяСсылка)
	|						ТОГДА ТаблицаОтражениеВУчете.ФизЛицо
	|					ИНАЧЕ ТаблицаОтражениеВУчете.СубконтоКтНУ2
	|				КОНЕЦ
	|		ИНАЧЕ ВЫБОР
	|				КОГДА (НЕ &ВедениеУчетаПоСотрудникам)
	|						И ТаблицаОтражениеВУчете.СубконтоКтНУ2 ССЫЛКА Справочник.ФизическиеЛица
	|					ТОГДА ЗНАЧЕНИЕ(Справочник.ФизическиеЛица.ПустаяСсылка)
	|				ИНАЧЕ ТаблицаОтражениеВУчете.СубконтоКтНУ2
	|			КОНЕЦ
	|	КОНЕЦ КАК СубконтоКтНУ2,
	|	КтВидСубконтоНУ2.ВидСубконто КАК КтВидСубконтоНУ2,
	|	ВЫБОР
	|		КОГДА КтВидСубконтоНУ3.ВидСубконто = &ВидСубконтоРаботникиОрганизаций
	|			ТОГДА ВЫБОР
	|					КОГДА ТаблицаОтражениеВУчете.СубконтоКтНУ3 = ЗНАЧЕНИЕ(Справочник.ФизическиеЛица.ПустаяСсылка)
	|						ТОГДА ТаблицаОтражениеВУчете.ФизЛицо
	|					ИНАЧЕ ТаблицаОтражениеВУчете.СубконтоКтНУ3
	|				КОНЕЦ
	|		ИНАЧЕ ВЫБОР
	|				КОГДА (НЕ &ВедениеУчетаПоСотрудникам)
	|						И ТаблицаОтражениеВУчете.СубконтоКтНУ3 ССЫЛКА Справочник.ФизическиеЛица
	|					ТОГДА ЗНАЧЕНИЕ(Справочник.ФизическиеЛица.ПустаяСсылка)
	|				ИНАЧЕ ТаблицаОтражениеВУчете.СубконтоКтНУ3
	|			КОНЕЦ
	|	КОНЕЦ КАК СубконтоКтНУ3,
	|	КтВидСубконтоНУ3.ВидСубконто КАК КтВидСубконтоНУ3,
	|	ТаблицаОтражениеВУчете.Сумма,
	|	ВЫБОР
	|		КОГДА &ВедениеУчетаПоСотрудникам
	|			ТОГДА ВЫБОР
	|					КОГДА ДтВидСубконтоНУ1.ВидСубконто = &ВидСубконтоРаботникиОрганизаций
	|							ИЛИ ДтВидСубконтоНУ2.ВидСубконто = &ВидСубконтоРаботникиОрганизаций
	|							ИЛИ ДтВидСубконтоНУ3.ВидСубконто = &ВидСубконтоРаботникиОрганизаций
	|							ИЛИ КтВидСубконтоНУ1.ВидСубконто = &ВидСубконтоРаботникиОрганизаций
	|							ИЛИ КтВидСубконтоНУ2.ВидСубконто = &ВидСубконтоРаботникиОрганизаций
	|							ИЛИ КтВидСубконтоНУ3.ВидСубконто = &ВидСубконтоРаботникиОрганизаций
	|						ТОГДА ЛОЖЬ
	|					ИНАЧЕ ИСТИНА
	|				КОНЕЦ
	|		ИНАЧЕ ЛОЖЬ
	|	КОНЕЦ КАК ВключатьФИОРаботникаВСодержание,
	|	ВЫБОР
	|		КОГДА ТаблицаОтражениеВУчете.ВидРасчета = ТаблицаОтражениеВУчете.СубконтоДт1
	|				ИЛИ ТаблицаОтражениеВУчете.ВидРасчета = ТаблицаОтражениеВУчете.СубконтоДт2
	|				ИЛИ ТаблицаОтражениеВУчете.ВидРасчета = ТаблицаОтражениеВУчете.СубконтоДт3
	|				ИЛИ ТаблицаОтражениеВУчете.ВидРасчета = ТаблицаОтражениеВУчете.СубконтоКт1
	|				ИЛИ ТаблицаОтражениеВУчете.ВидРасчета = ТаблицаОтражениеВУчете.СубконтоКт2
	|				ИЛИ ТаблицаОтражениеВУчете.ВидРасчета = ТаблицаОтражениеВУчете.СубконтоКт3
	|			ТОГДА ЛОЖЬ
	|		ИНАЧЕ ИСТИНА
	|	КОНЕЦ КАК ВключатьВидРасчетаВСодержание,
	|	ЗНАЧЕНИЕ(Справочник.ВидыУчетаНУ.ПустаяСсылка) КАК ВидУчетаДт, 
	|	ЗНАЧЕНИЕ(Справочник.ВидыУчетаНУ.ПустаяСсылка) КАК ВидУчетаКт, 
	|	ЛОЖЬ КАК ПризнакПроизводственногоСчета
	|ИЗ
	|	Реквизиты КАК Реквизиты
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ТаблицаОтражениеВУчете КАК ТаблицаОтражениеВУчете
	|		ПО (ИСТИНА)
	|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Налоговый.ВидыСубконто КАК ДтВидСубконтоНУ1
	|		ПО (ДтВидСубконтоНУ1.Ссылка = ТаблицаОтражениеВУчете.СчетДтНУ)
	|			И (ДтВидСубконтоНУ1.НомерСтроки = 1)
	|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Налоговый.ВидыСубконто КАК ДтВидСубконтоНУ2
	|		ПО (ДтВидСубконтоНУ2.Ссылка = ТаблицаОтражениеВУчете.СчетДтНУ)
	|			И (ДтВидСубконтоНУ2.НомерСтроки = 2)
	|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Налоговый.ВидыСубконто КАК ДтВидСубконтоНУ3
	|		ПО (ДтВидСубконтоНУ3.Ссылка = ТаблицаОтражениеВУчете.СчетДтНУ)
	|			И (ДтВидСубконтоНУ3.НомерСтроки = 3)
	|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Налоговый.ВидыСубконто КАК КтВидСубконтоНУ1
	|		ПО (КтВидСубконтоНУ1.Ссылка = ТаблицаОтражениеВУчете.СчетКтНУ)
	|			И (КтВидСубконтоНУ1.НомерСтроки = 1)
	|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Налоговый.ВидыСубконто КАК КтВидСубконтоНУ2
	|		ПО (КтВидСубконтоНУ2.Ссылка = ТаблицаОтражениеВУчете.СчетКтНУ)
	|			И (КтВидСубконтоНУ2.НомерСтроки = 2)
	|		ЛЕВОЕ СОЕДИНЕНИЕ ПланСчетов.Налоговый.ВидыСубконто КАК КтВидСубконтоНУ3
	|		ПО (КтВидСубконтоНУ3.Ссылка = ТаблицаОтражениеВУчете.СчетКтНУ)
	|			И (КтВидСубконтоНУ3.НомерСтроки = 3)
	|
	|УПОРЯДОЧИТЬ ПО
	|	ТаблицаОтражениеВУчете.НомерСтроки
	|";
	
	Возврат ТекстЗапроса + ОбщегоНазначенияБКВызовСервера.ТекстРазделителяЗапросовПакета();
		
КонецФункции

Функция ТекстЗапросаПоРезервам(НомераТаблиц)
	
	ТекстЗапроса = "";
	
	ТекстЗапроса = ТекстЗапроса +
	   "ВЫБРАТЬ РАЗРЕШЕННЫЕ РАЗЛИЧНЫЕ
       |	РазмерыОтчисленийВРезервыСрезПоследних.Резерв,
       |	РазмерыОтчисленийВРезервыСрезПоследних.СчетУчета,
       |	РазмерыОтчисленийВРезервыСрезПоследних.Резерв.ПринятиеКВычетуПоНалоговомуУчету КАК ПринятиеКВычетуПоНалоговомуУчету,
       |	РазмерыОтчисленийВРезервыСрезПоследних.Резерв.СтатьяЗатрат КАК СтатьяЗатрат
       |ИЗ
       |	РегистрСведений.РазмерыОтчисленийВРезервы.СрезПоследних(
       |			&ПериодРегистрации,
       |			Организация = &Организация
       |				И Резерв.ВидРезерва = ЗНАЧЕНИЕ(Перечисление.ВидыРезервов.ПоВознаграждениямРаботникам)) КАК РазмерыОтчисленийВРезервыСрезПоследних"
					
		 + ОбщегоНазначенияБКВызовСервера.ТекстРазделителяЗапросовПакета();
		
	НомераТаблиц.Вставить("ТаблицаПоРезервам", НомераТаблиц.Количество());
	
	Возврат ТекстЗапроса;
	
КонецФункции

////////////////////////////////////////////////////////////////////////////////
// Интерфейс для работы с подсистемой Печать.

// Заполняет список команд печати.
// 
// Параметры:
//   КомандыПечати - ТаблицаЗначений - состав полей см. в функции УправлениеПечатью.СоздатьКоллекциюКомандПечати
//
Процедура ДобавитьКомандыПечати(КомандыПечати) Экспорт
	
КонецПроцедуры
#КонецЕсли
