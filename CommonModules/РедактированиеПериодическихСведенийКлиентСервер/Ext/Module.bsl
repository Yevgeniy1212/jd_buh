
////////////////////////////////////////////////////////////////////////////////
// РедактированиеПериодическихСведенийКлиентСервер
//  
////////////////////////////////////////////////////////////////////////////////


////////////////////////////////////////////////////////////////////////////////
// ПРОГРАММНЫЙ ИНТЕРФЕЙС

Функция МассивЗаписейИстории(Форма, ИмяРегистра, ВедущийОбъект) Экспорт
	
	ОбновитьНаборЗаписейИстории(Форма, ИмяРегистра, ВедущийОбъект);
	
	Возврат МассивЗаписейИсторииВФорме(Форма, ИмяРегистра);
	
КонецФункции

Функция МассивЗаписейИсторииВФорме(Форма, ИмяРегистра) Экспорт
	
	Массив = Новый Массив();
	Для Каждого Строка Из Форма[ИмяРегистра + "НаборЗаписей"] Цикл
		НоваяСтрока = Новый Структура(Форма[ИмяРегистра + "КлючСтруктуры"]);
		ЗаполнитьЗначенияСвойств(НоваяСтрока, Строка);
		Массив.Добавить(НоваяСтрока);
	КонецЦикла;
	
	Возврат Массив;
	
КонецФункции

////////////////////////////////////////////////////////////////////////////////
// СЛУЖЕБНЫЕ ПРОЦЕДУРЫ И ФУНКЦИИ

Процедура ОбновитьНаборЗаписейИстории(Форма, ИмяРегистра, ВедущийОбъект) Экспорт
	
	Если Не Форма[ИмяРегистра + "НаборЗаписейПрочитан"] Тогда
		
		Форма.ПрочитатьНаборЗаписейПериодическихСведений(ИмяРегистра, ВедущийОбъект);
		
	КонецЕсли;
	
КонецПроцедуры
