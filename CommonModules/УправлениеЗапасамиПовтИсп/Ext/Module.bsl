////////////////////////////////////////////////////////////////////////////////
// УправлениеЗапасамиПовтИсп: 
//  
////////////////////////////////////////////////////////////////////////////////

////////////////////////////////////////////////////////////////////////////////
// ПРОГРАММНЫЙ ИНТЕРФЕЙС

// Определяется ведется или нет партионный учет для конкретного счета
//
// Параметры
//  Счет, Дата
//
// Возвращаемое значение:
//   Булево - истина - партионный учет ведется,
//			  ложь   - партионный учет не ведтся.
//
Функция ВедетсяПартионныйУчетДляСчета(Счет) Экспорт
	
	ВедетсяПартионныйУчет = Ложь;
	
	ЗапросКСчетам = Новый Запрос();
	
	// самый высокий приоритет, когда заполнена и организация и счет
	ЗапросКСчетам.Текст = "ВЫБРАТЬ
	|	СпособОценкиЗапасовБУ.СпособОценки
	|ИЗ
	|	РегистрСведений.СпособОценкиЗапасовБУ КАК СпособОценкиЗапасовБУ
	|ГДЕ
	|	СпособОценкиЗапасовБУ.СчетЗапасов = &СчетЗапасов";
	
	ЗапросКСчетам.УстановитьПараметр("СчетЗапасов", Счет);
	
	Выборка = ЗапросКСчетам.Выполнить().Выбрать();
	Пока Выборка.Следующий() Цикл
	
		Если ЗначениеЗаполнено(Выборка.СпособОценки) Тогда
		
			Если Выборка.СпособОценки = Перечисления.СпособыОценки.ЛИФО 
			 ИЛИ Выборка.СпособОценки = Перечисления.СпособыОценки.ФИФО Тогда
				ВедетсяПартионныйУчет = Истина;
			КонецЕсли;
			
			Прервать;
		
		КонецЕсли; 
	
	КонецЦикла; 
	
	Возврат ВедетсяПартионныйУчет;
	
КонецФункции // ВедетсяПартионныйУчетДляСчета()

// Определяется стратегию списания для счета
//
// Параметры
//  Счет
//
// Возвращаемое значение:
//   (ЛИФО, ФИФО, ПоСредней)
//
Функция ПолучитьСтратегиюСписанияСчета(Счет) Экспорт
		
	ЗапросКСчетам = Новый Запрос();
	ЗапросКСчетам.Текст = "ВЫБРАТЬ
	|	СпособОценкиЗапасовБУ.СпособОценки
	|ИЗ
	|	РегистрСведений.СпособОценкиЗапасовБУ КАК СпособОценкиЗапасовБУ
	|ГДЕ
	|	СпособОценкиЗапасовБУ.СчетЗапасов = &СчетЗапасов";
	
	ЗапросКСчетам.УстановитьПараметр("СчетЗапасов",Счет);
	
	Выборка = ЗапросКСчетам.Выполнить().Выбрать();
	
	Если Выборка.Следующий() Тогда
		Возврат Выборка.СпособОценки;
	КонецЕсли; 
	
	Возврат Перечисления.СпособыОценки.ПоСредней;
	
КонецФункции // ПолучитьСтратегиюСписанияСчета()

////////////////////////////////////////////////////////////////////////////////
// СЛУЖЕБНЫЕ ПРОЦЕДУРЫ И ФУНКЦИИ
