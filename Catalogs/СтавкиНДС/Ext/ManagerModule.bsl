#Если Сервер Или ТолстыйКлиентОбычноеПриложение Или ВнешнееСоединение Тогда
	
////////////////////////////////////////////////////////////////////////////////
// ПРОГРАММНЫЙ ИНТЕРФЕЙС

// Функция ищет первый элемент справочника, у которого:
//  Ставка = 0;
//  ДляОсвобожденногоОборота = Истина.
//
// Возвращаемые значения:
//  Ссылка на элемент справочника - если есть такой элемент
//  ПустаяСсылка - если такой элемент не найден
//
Функция ПолучитьСтавкуБезНДС(Сообщать = Истина) Экспорт
	
	Отбор = Новый Структура("Ставка", 0);
	Выборка = Выбрать(,, Отбор);
	
	СтавкаБезНДС = ПустаяСсылка();
	Пока Выборка.Следующий() Цикл
		Если Выборка.ДляОсвобожденногоОборота Тогда
			СтавкаБезНДС = Выборка.Ссылка;
			Прервать;
		КонецЕсли;
	КонецЦикла;
	
	Если Сообщать И НЕ ЗначениеЗаполнено(СтавкаБезНДС) Тогда
		ТекстСообщения = НСтр("ru = 'Внимание! В справочнике ""Ставки НДС"" не найдена ставка ""Без НДС"" (для освобожденного оборота).'");
		ОбщегоНазначения.СообщитьПользователю(ТекстСообщения);
	КонецЕсли;

	Возврат СтавкаБезНДС;

КонецФункции 

#КонецЕсли
