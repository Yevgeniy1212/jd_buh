
#Если Сервер Или ТолстыйКлиентОбычноеПриложение Или ВнешнееСоединение Тогда
	
////////////////////////////////////////////////////////////////////////////////
// ПРОГРАММНЫЙ ИНТЕРФЕЙС

////////////////////////////////////////////////////////////////////////////////
// ОБРАБОТЧИКИ СОБЫТИЙ

Процедура ОбработкаПолученияДанныхВыбора(ДанныеВыбора, Параметры, СтандартнаяОбработка)
	
	Если  Параметры.Свойство("ВыбиратьКомпенсируемыеУдержания") И Параметры.ВыбиратьКомпенсируемыеУдержания Тогда
		
		СтандартнаяОбработка = Ложь;
		
		СтрокаПоиска = Неопределено;
		Параметры.Свойство("СтрокаПоиска", СтрокаПоиска);
		
		ТекстУсловия 	= "";
		Если СтрокаПоиска <> Неопределено Тогда 
			ТекстУсловия = "И УдержанияОрганизаций.Наименование ПОДОБНО &ШаблонНаименования ";
		КонецЕсли;
		
		Запрос = Новый Запрос;  		
		СписокСпособовРасчета = Новый СписокЗначений;
		СписокСпособовРасчета.Добавить(Перечисления.СпособыРасчетаОплатыТруда.ФиксированнойСуммой);
		СписокСпособовРасчета.Добавить(Перечисления.СпособыРасчетаОплатыТруда.Процентом);
		
		Запрос.УстановитьПараметр("СпособРасчета", СписокСпособовРасчета);
		
		Запрос.Текст = 
		"ВЫБРАТЬ
		|	УдержанияОрганизаций.СпособРасчета,
		|	УдержанияОрганизаций.Ссылка,
		|	УдержанияОрганизаций.Наименование КАК Наименование,
		|	УдержанияОрганизаций.ПометкаУдаления КАК ПометкаУдаления
		|ИЗ
		|	ПланВидовРасчета.УдержанияОрганизаций КАК УдержанияОрганизаций
		|ГДЕ
		|	УдержанияОрганизаций.СпособРасчета В(&СпособРасчета)
		|	" + ТекстУсловия + "
		|
		|УПОРЯДОЧИТЬ ПО
		|	Наименование";

		Запрос.УстановитьПараметр("ШаблонНаименования", "%" + СтрокаПоиска + "%");
		
		Выборка = Запрос.Выполнить().Выбрать();
		
		ДанныеВыбора = Новый СписокЗначений();
		
		Пока Выборка.Следующий() Цикл 
			Если Выборка.ПометкаУдаления Тогда
				СтруктураЗначение = Новый Структура("Значение, ПометкаУдаления", Выборка.Ссылка, Выборка.ПометкаУдаления);
				ДанныеВыбора.Добавить(СтруктураЗначение,,,БиблиотекаКартинок.ПомеченныйНаУдалениеЭлемент);
			Иначе
				ДанныеВыбора.Добавить(Выборка.Ссылка,);
			КонецЕсли;			
		КонецЦикла;
	КонецЕсли;
	
КонецПроцедуры

////////////////////////////////////////////////////////////////////////////////
// СЛУЖЕБНЫЕ ПРОЦЕДУРЫ И ФУНКЦИИ

#КонецЕсли